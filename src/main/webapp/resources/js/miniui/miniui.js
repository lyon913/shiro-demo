mini={components:{},uids:{},ux:{},doc:document,window:window,isReady:false,byClass:function(d,c){if(typeof c=="string"){c=mini.byId(c)}return jQuery("."+d,c)[0]},getComponents:function(){var f=[];for(var g in mini.components){var c=mini.components[g];if(c.isControl){f.push(c)}}return f},get:function(c){if(!c){return null}if(mini.isControl(c)){return c}if(typeof c=="string"){if(c.charAt(0)=="#"){c=c.substr(1)}}if(typeof c=="string"){return mini.components[c]}else{var d=mini.uids[c.uid];if(d&&d.el==c){return d}}return null},getbyUID:function(b){return mini.uids[b]},findControls:function(n,o){if(!n){return[]}o=o||mini;var j=[];var l=mini.uids;for(var p in l){var k=l[p];var i=n.call(o,k);if(i===true||i===1){j.push(k);if(i===1){break}}}return j},getChildControls:function(d){var g=d.el?d.el:d;var f=mini.findControls(function(a){if(!a.el||d==a){return false}if(mini.isAncestor(g,a.el)&&a.within){return true}return false});return f},emptyFn:function(){},createNameControls:function(l,n){if(!l||!l.el){return}if(!n){n="_"}var o=l.el;var c=mini.findControls(function(a){if(!a.el||!a.name){return false}if(mini.isAncestor(o,a.el)){return true}return false});for(var p=0,i=c.length;p<i;p++){var k=c[p];var q=n+k.name;if(n===true){q=k.name[0].toUpperCase()+k.name.substring(1,k.name.length)}l[q]=k}},getsbyName:function(l,i){var g=mini.isControl(i);var k=i;if(i&&g){i=i.el}i=mini.byId(i);i=i||document.body;var n=mini.findControls(function(a){if(!a.el){return false}if(a.name==l&&mini.isAncestor(i,a.el)){return true}return false},this);if(g&&n.length==0&&k&&k.getbyName){var j=k.getbyName(l);if(j){n.push(j)}}return n},getbyName:function(c,d){return mini.getsbyName(c,d)[0]},getParams:function(i){if(!i){i=location.href}i=i.split("?")[1];var k={};if(i){var n=i.split("&");for(var o=0,j=n.length;o<j;o++){var l=n[o].split("=");try{k[l[0]]=decodeURIComponent(unescape(l[1]))}catch(p){}}}return k},reg:function(b){this.components[b.id]=b;this.uids[b.uid]=b},unreg:function(b){delete mini.components[b.id];delete mini.uids[b.uid]},classes:{},uiClasses:{},getClass:function(b){if(!b){return null}return this.classes[b.toLowerCase()]},getClassByUICls:function(b){return this.uiClasses[b.toLowerCase()]},idPre:"mini-",idIndex:1,newId:function(b){return(b||this.idPre)+this.idIndex++},copyTo:function(g,d){if(g&&d){for(var f in d){g[f]=d[f]}}return g},copyIf:function(g,d){if(g&&d){for(var f in d){if(mini.isNull(g[f])){g[f]=d[f]}}}return g},createDelegate:function(c,d){if(!c){return function(){}}return function(){return c.apply(d,arguments)}},isControl:function(b){return !!(b&&b.isControl)},isElement:function(b){return b&&b.appendChild},isDate:function(b){return !!(b&&b.getFullYear)},isArray:function(b){return !!(b&&!!b.unshift)},isNull:function(b){return b===null||b===undefined},isNumber:function(b){return !isNaN(b)&&typeof b=="number"},isEquals:function(a,b){if(a!==0&&b!==0){if((mini.isNull(a)||a=="")&&(mini.isNull(b)||b=="")){return true}}if(a&&b&&a.getFullYear&&b.getFullYear){return a.getTime()===b.getTime()}if(typeof a=="object"&&typeof b=="object"){return a===b}return String(a)===String(b)},forEach:function(k,l,p){var o=k.clone();for(var i=0,j=o.length;i<j;i++){var n=o[i];if(l.call(p,n,i,k)===false){break}}},sort:function(g,d,f){f=f||g;g.sort(d)},removeNode:function(b){jQuery(b).remove()},elWarp:document.createElement("div")};if(typeof mini_debugger=="undefined"){mini_debugger=true}if(typeof mini_useShims=="undefined"){mini_useShims=false}mini_regClass=function(f,d){d=d.toLowerCase();if(!mini.classes[d]){mini.classes[d]=f;f.prototype.type=d}var g=f.prototype.uiCls;if(!mini.isNull(g)&&!mini.uiClasses[g]){mini.uiClasses[g]=f}};mini_extend=function(n,i,l){if(typeof i!="function"){return this}var k=n,o=k.prototype,j=i.prototype;if(k.superclass==j){return}k.superclass=j;k.superclass.constructor=i;for(var p in j){o[p]=j[p]}if(l){for(var p in l){o[p]=l[p]}}return k};mini.copyTo(mini,{extend:mini_extend,regClass:mini_regClass,debug:false});mini.namespace=function(j){if(typeof j!="string"){return}j=j.split(".");var l=window;for(var n=0,i=j.length;n<i;n++){var g=j[n];var k=l[g];if(!k){k=l[g]={}}l=k}};mini._BindCallbacks=[];mini._BindEvents=function(c,d){mini._BindCallbacks.push([c,d]);if(!mini._EventTimer){mini._EventTimer=setTimeout(function(){mini._FireBindEvents()},50)}};mini._FireBindEvents=function(){for(var d=0,f=mini._BindCallbacks.length;d<f;d++){var g=mini._BindCallbacks[d];g[0].call(g[1])}mini._BindCallbacks=[];mini._EventTimer=null};mini._getFunctoin=function(j){if(typeof j!="string"){return null}var k=j.split(".");var l=null;for(var n=0,i=k.length;n<i;n++){var g=k[n];if(!l){l=window[g]}else{l=l[g]}if(!l){break}}return l};mini._getMap=function(name,obj){if(!name){return null}var index=name.indexOf(".");if(index==-1&&name.indexOf("[")==-1){return obj[name]}if(index==(name.length-1)){return obj[name]}var s="obj."+name;try{var v=eval(s)}catch(e){return null}return v};mini._setMap=function(v,i,r){if(!r){return}if(typeof v!="string"){return}var l=v.split(".");function p(c,f,g,j){var a=c[f];if(!a){a=c[f]=[]}for(var d=0;d<=g;d++){var b=a[d];if(!b){if(j===null||j===undefined){b=a[d]={}}else{b=a[d]=j}}}return c[f][g]}var t=null;for(var q=0,s=l.length;q<=s-1;q++){var v=l[q];if(q==s-1){if(v.indexOf("]")==-1){r[v]=i}else{var u=v.split("[");var n=u[0],o=parseInt(u[1]);p(r,n,o,"");r[n][o]=i}break}if(v.indexOf("]")==-1){t=r[v];if(q<=s-2&&t==null){r[v]=t={}}r=t}else{var u=v.split("[");var n=u[0],o=parseInt(u[1]);r=p(r,n,o)}}return i};mini.getAndCreate=function(b){if(!b){return null}if(typeof b=="string"){return mini.components[b]}if(typeof b=="object"){if(mini.isControl(b)){return b}else{if(mini.isElement(b)){return mini.uids[b.uid]}else{return mini.create(b)}}}return null};mini.create=function(f){if(!f){return null}if(mini.get(f.id)===f){return f}var d=this.getClass(f.type);if(!d){return null}var g=new d();g.set(f);return g};mini.Component=function(){this._events={};this.uid=mini.newId(this._idPre);this._id=this.uid;if(!this.id){this.id=this.uid}mini.reg(this)};mini.Component.prototype={isControl:true,id:null,_idPre:"mini-",_idSet:false,_canFire:true,set:function(o){if(typeof o=="string"){return this}var p=this._allowLayout;this._allowLayout=false;var n=o.renderTo||o.render;delete o.renderTo;delete o.render;for(var i in o){if(i.toLowerCase().indexOf("on")==0){if(this["_$"+i]){continue}var q=o[i];this.on(i.substring(2,i.length).toLowerCase(),q);delete o[i]}}for(var i in o){var j=o[i];var k="set"+i.charAt(0).toUpperCase()+i.substring(1,i.length);var l=this[k];if(l){l.call(this,j)}else{this[i]=j}}if(n&&this.render){this.render(n)}this._allowLayout=p;if(this.doLayout){this.doLayout()}return this},fire:function(l,k){if(this._canFire==false){return}l=l.toLowerCase();var g=this._events[l];if(g){if(!k){k={}}if(k&&k!=this){k.source=k.sender=this;if(!k.type){k.type=l}}for(var n=0,i=g.length;n<i;n++){var j=g[n];if(j){j[0].apply(j[1],[k])}}}},on:function(type,fn,scope){if(typeof fn=="string"){var f=mini._getFunctoin(fn);if(!f){var id=mini.newId("__str_");window[id]=fn;eval("fn = function(e){var s = "+id+";var fn = mini._getFunctoin(s); if(fn) {fn.call(this, e)}else{eval(s);}}")}else{fn=f}}if(typeof fn!="function"||!type){return false}type=type.toLowerCase();var event=this._events[type];if(!event){event=this._events[type]=[]}scope=scope||this;if(!this.findListener(type,fn,scope)){event.push([fn,scope])}return this},un:function(k,f,g){if(typeof f!="function"){return false}k=k.toLowerCase();var j=this._events[k];if(j){g=g||this;var i=this.findListener(k,f,g);if(i){j.remove(i)}}return this},findListener:function(l,n,o){l=l.toLowerCase();o=o||this;var i=this._events[l];if(i){for(var p=0,j=i.length;p<j;p++){var k=i[p];if(k[0]===n&&k[1]===o){return k}}}},setId:function(b){if(!b){throw new Error("id not null")}if(this._idSet){throw new Error("id just set only one")}mini.unreg(this);this.id=b;if(this.el){this.el.id=b}if(this._valueEl){this._valueEl.id=b+"$value"}if(this._textEl){this._textEl.id=b+"$text"}this._idSet=true;mini.reg(this)},getId:function(){return this.id},destroy:function(){mini.unreg(this);this.fire("destroy")}};mini.Control=function(){mini.Control.superclass.constructor.call(this);this._create();this.el.uid=this.uid;this._initEvents();if(this._clearBorder){this.el.style.borderWidth="0"}this.addCls(this.uiCls);this.setWidth(this.width);this.setHeight(this.height);this.el.style.display=this.visible?this._displayStyle:"none"};mini.extend(mini.Control,mini.Component,{jsName:null,width:"",height:"",visible:true,readOnly:false,enabled:true,tooltip:"",_readOnlyCls:"mini-readonly",_disabledCls:"mini-disabled",_create:function(){this.el=document.createElement("div")},_initEvents:function(){},within:function(b){if(mini.isAncestor(this.el,b.target)){return true}return false},name:"",setName:function(b){this.name=b},getName:function(){return this.name},isAutoHeight:function(){var b=this.el.style.height;return b=="auto"||b==""},isAutoWidth:function(){var b=this.el.style.width;return b=="auto"||b==""},isFixedSize:function(){var c=this.width;var d=this.height;if(parseInt(c)+"px"==c&&parseInt(d)+"px"==d){return true}return false},isRender:function(b){return !!(this.el&&this.el.parentNode&&this.el.parentNode.tagName)},render:function(c,d){if(typeof c==="string"){if(c=="#body"){c=document.body}else{c=mini.byId(c)}}if(!c){return}if(!d){d="append"}d=d.toLowerCase();if(d=="before"){jQuery(c).before(this.el)}else{if(d=="preend"){jQuery(c).preend(this.el)}else{if(d=="after"){jQuery(c).after(this.el)}else{c.appendChild(this.el)}}}this.el.id=this.id;this.doLayout();this.fire("render")},getEl:function(){return this.el},setJsName:function(b){this.jsName=b;window[b]=this},getJsName:function(){return this.jsName},setTooltip:function(b){this.tooltip=b;this.el.title=b;if(this.tooltipPlacement){jQuery(this.el).attr("data-placement",this.tooltipPlacement)}},getTooltip:function(){return this.tooltip},_sizeChanged:function(){this.doLayout()},setWidth:function(b){if(parseInt(b)==b){b+="px"}this.width=b;this.el.style.width=b;this._sizeChanged()},getWidth:function(i){var j=this.el;var g=i?jQuery(j).width():jQuery(j).outerWidth();if(i&&this._borderEl){var f=mini.getBorders(this._borderEl);g=g-f.left-f.right}return g},setHeight:function(b){if(parseInt(b)==b){b+="px"}this.height=b;this.el.style.height=b;this._sizeChanged()},getHeight:function(g){var d=g?jQuery(this.el).height():jQuery(this.el).outerHeight();if(g&&this._borderEl){var f=mini.getBorders(this._borderEl);d=d-f.top-f.bottom}return d},getBox:function(){return mini.getBox(this.el)},setBorderStyle:function(c){var d=this._borderEl||this.el;mini.setStyle(d,c);this.doLayout()},getBorderStyle:function(){return this.borderStyle},_clearBorder:true,setStyle:function(b){this.style=b;mini.setStyle(this.el,b);if(this._clearBorder){this.el.style.borderWidth="0";this.el.style.padding="0px"}this.width=this.el.style.width;this.height=this.el.style.height;this._sizeChanged()},getStyle:function(){return this.style},setCls:function(b){this.addCls(b)},getCls:function(){return this.cls},addCls:function(b){mini.addClass(this.el,b)},removeCls:function(b){mini.removeClass(this.el,b)},_doReadOnly:function(){if(this.readOnly){this.addCls(this._readOnlyCls)}else{this.removeCls(this._readOnlyCls)}},setReadOnly:function(b){this.readOnly=b;this._doReadOnly()},getReadOnly:function(){return this.readOnly},getParent:function(i){var f=document;var g=this.el.parentNode;while(g!=f&&g!=null){var j=mini.get(g);if(j){if(!mini.isControl(j)){return null}if(!i||j.uiCls==i){return j}}g=g.parentNode}return null},isReadOnly:function(){if(this.readOnly||!this.enabled){return true}var b=this.getParent();if(b){return b.isReadOnly()}return false},setEnabled:function(b){this.enabled=b;if(this.enabled){this.removeCls(this._disabledCls)}else{this.addCls(this._disabledCls)}this._doReadOnly()},getEnabled:function(){return this.enabled},enable:function(){this.setEnabled(true)},disable:function(){this.setEnabled(false)},_displayStyle:"",setVisible:function(b){this.visible=b;if(this.el){this.el.style.display=b?this._displayStyle:"none";this.doLayout()}},getVisible:function(){return this.visible},show:function(){this.setVisible(true)},hide:function(){this.setVisible(false)},isDisplay:function(g){if(mini.WindowVisible==false||!this.el){return false}var d=document.body;var f=this.el;while(1){if(f==null||!f.style){return false}if(f&&f.style&&f.style.display=="none"){if(g){if(g(f)!==true){return false}}else{return false}}if(f==d){return true}f=f.parentNode}return true},_allowUpdate:true,beginUpdate:function(){this._allowUpdate=false},endUpdate:function(){this._allowUpdate=true;this.doUpdate()},doUpdate:function(){},canLayout:function(){if(this._allowLayout==false){return false}return this.isDisplay()},doLayout:function(){},layoutChanged:function(){if(this.canLayout()==false){return}this.doLayout()},_destroyChildren:function(j){if(this.el){var k=mini.getChildControls(this);for(var f=0,g=k.length;f<g;f++){var i=k[f];if(i.destroyed!==true){i.destroy(j)}}}},destroy:function(d){if(this.destroyed!==true){this._destroyChildren(d)}if(this.el){mini.clearEvent(this.el);if(d!==false){var c=this.el.parentNode;if(c){c.removeChild(this.el)}}}this._borderEl=null;this.el=null;mini.unreg(this);this.destroyed=true;this.fire("destroy")},focus:function(){try{var d=this;d.el.focus()}catch(c){}},blur:function(){try{var d=this;d.el.blur()}catch(c){}},allowAnim:true,setAllowAnim:function(b){this.allowAnim=b},getAllowAnim:function(){return this.allowAnim},_getMaskWrapEl:function(){return this.el},mask:function(b){if(typeof b=="string"){b={html:b}}b=b||{};b.el=this._getMaskWrapEl();if(!b.cls){b.cls=this._maskCls}mini.mask(b)},unmask:function(){mini.unmask(this._getMaskWrapEl());this.isLoading=false},_maskCls:"mini-mask-loading",loadingMsg:"Loading...",loading:function(b){this.mask(b||this.loadingMsg)},setLoadingMsg:function(b){this.loadingMsg=b},getLoadingMsg:function(){return this.loadingMsg},_getContextMenu:function(c){var d=c;if(typeof c=="string"){d=mini.get(c);if(!d){mini.parse(c);d=mini.get(c)}}else{if(mini.isArray(c)){d={type:"menu",items:c}}else{if(!mini.isControl(c)){d=mini.create(c)}}}return d},__OnHtmlContextMenu:function(c){var d={popupEl:this.el,htmlEvent:c,cancel:false};this.contextMenu.fire("BeforeOpen",d);if(d.cancel==true){return}this.contextMenu.fire("opening",d);if(d.cancel==true){return}this.contextMenu.showAtPos(c.pageX,c.pageY);this.contextMenu.fire("Open",d);return false},contextMenu:null,setContextMenu:function(c){var d=this._getContextMenu(c);if(!d){return}if(this.contextMenu!==d){this.contextMenu=d;this.contextMenu.owner=this;mini.on(this.el,"contextmenu",this.__OnHtmlContextMenu,this)}},getContextMenu:function(){return this.contextMenu},setDefaultValue:function(b){this.defaultValue=b},getDefaultValue:function(){return this.defaultValue},setValue:function(b){this.value=b},getValue:function(){return this.value},ajaxData:null,ajaxType:"",setAjaxData:function(b){this.ajaxData=b},getAjaxData:function(){return this.ajaxData},setAjaxType:function(b){this.ajaxType=b},getAjaxType:function(){return this.ajaxType},_afterApply:function(b){},dataField:"",setDataField:function(b){this.dataField=b},getDataField:function(){return this.dataField},tabIndex:0,setTabIndex:function(c){var d=this._textEl||this.el;d.tabIndex=c;this.tabIndex=c},getTabIndex:function(){return this.tabIndex},getAttrs:function(el){var attrs={};var cls=el.className;if(cls){attrs.cls=cls}if(el.value){attrs.value=el.value}mini._ParseString(el,attrs,["id","name","width","height","borderStyle","value","defaultValue","tabIndex","contextMenu","tooltip","ondestroy","data-options","ajaxData","ajaxType","dataField","ajaxOptions","data-placement"]);if(attrs["data-placement"]){this.tooltipPlacement=attrs["data-placement"]}mini._ParseBool(el,attrs,["visible","enabled","readOnly"]);if(el.readOnly&&el.readOnly!="false"){attrs.readOnly=true}var style=el.style.cssText;if(style){attrs.style=style}if(isIE9){var bg=el.style.background;if(bg){if(!attrs.style){attrs.style=""}attrs.style+=";background:"+bg}}if(this.style){if(attrs.style){attrs.style=this.style+";"+attrs.style}else{attrs.style=this.style}}if(this.borderStyle){if(attrs.borderStyle){attrs.borderStyle=this.borderStyle+";"+attrs.borderStyle}else{attrs.borderStyle=this.borderStyle}}if(typeof attrs.ajaxOptions=="string"){attrs.ajaxOptions=eval("("+attrs.ajaxOptions+")")}var ts=mini._attrs;if(ts){for(var i=0,l=ts.length;i<l;i++){var t=ts[i];var name=t[0];var type=t[1];if(!type){type="string"}if(type=="string"){mini._ParseString(el,attrs,[name])}else{if(type=="bool"){mini._ParseBool(el,attrs,[name])}else{if(type=="int"){mini._ParseInt(el,attrs,[name])}}}}}var options=attrs["data-options"];if(options){options=eval("("+options+")");if(options){mini.copyTo(attrs,options)}}return attrs}});mini._attrs=null;mini.regHtmlAttr=function(d,c){if(!d){return}if(!c){c="string"}if(!mini._attrs){mini._attrs=[]}mini._attrs.push([d,c])};__mini_setControls=function(c,k,l){k=k||this._contentEl;l=l||this;if(!c){c=[]}if(!mini.isArray(c)){c=[c]}for(var n=0,i=c.length;n<i;n++){var j=c[n];if(typeof j=="string"){if(j.indexOf("#")==0){j=mini.byId(j)}}else{if(mini.isElement(j)){}else{j=mini.getAndCreate(j);j=j.el}}if(!j){continue}mini.append(k,j)}mini.parse(k);l.doLayout();return l};mini.Container=function(){mini.Container.superclass.constructor.call(this);this._contentEl=this.el};mini.extend(mini.Container,mini.Control,{setControls:__mini_setControls,getContentEl:function(){return this._contentEl},getBodyEl:function(){return this._contentEl},within:function(k){if(mini.isAncestor(this.el,k.target)){return true}var c=mini.getChildControls(this);for(var l=0,i=c.length;l<i;l++){var j=c[l];if(j.within(k)){return true}}return false}});mini.ValidatorBase=function(){mini.ValidatorBase.superclass.constructor.call(this)};mini.extend(mini.ValidatorBase,mini.Control,{required:false,requiredErrorText:"This field is required.",_requiredCls:"mini-required",errorText:"",_errorCls:"mini-error",_invalidCls:"mini-invalid",errorMode:"icon",validateOnChanged:true,validateOnLeave:true,_IsValid:true,isEditable:function(){if(this.readOnly||!this.allowInput||!this.enabled){return false}return true},_tryValidate:function(){if(this._tryValidateTimer){clearTimeout(this._tryValidateTimer)}var b=this;this._tryValidateTimer=setTimeout(function(){b.validate()},30)},validate:function(){if(this.enabled==false){this.setIsValid(true);return true}var b={value:this.getValue(),errorText:"",isValid:true};if(this.required){if(mini.isNull(b.value)||String(b.value).trim()===""){b.isValid=false;b.errorText=this.requiredErrorText}}this.fire("validation",b);this.errorText=b.errorText;this.setIsValid(b.isValid);return this.isValid()},isValid:function(){return this._IsValid},setIsValid:function(b){this._IsValid=b;this.doUpdateValid()},getIsValid:function(){return this._IsValid},setValidateOnChanged:function(b){this.validateOnChanged=b},getValidateOnChanged:function(b){return this.validateOnChanged},setValidateOnLeave:function(b){this.validateOnLeave=b},getValidateOnLeave:function(b){return this.validateOnLeave},setErrorMode:function(b){if(!b){b="none"}this.errorMode=b.toLowerCase();if(this._IsValid==false){this.doUpdateValid()}},getErrorMode:function(){return this.errorMode},setErrorText:function(b){this.errorText=b;if(this._IsValid==false){this.doUpdateValid()}},getErrorText:function(){return this.errorText},setRequired:function(b){this.required=b;if(this.required){this.addCls(this._requiredCls)}else{this.removeCls(this._requiredCls)}},getRequired:function(){return this.required},setRequiredErrorText:function(b){this.requiredErrorText=b},getRequiredErrorText:function(){return this.requiredErrorText},errorIconEl:null,getErrorIconEl:function(){return this._errorIconEl},_RemoveErrorIcon:function(){},doUpdateValid:function(){var b=this;b.__doUpdateValid()},errorTooltipPlacement:"right",__doUpdateValid:function(){if(!this.el){return}this.removeCls(this._errorCls);this.removeCls(this._invalidCls);if(this._IsValid==false){switch(this.errorMode){case"icon":this.addCls(this._errorCls);var b=this.getErrorIconEl();if(b){b.title=this.errorText;jQuery(b).attr("data-placement",this.errorTooltipPlacement)}break;case"border":this.addCls(this._invalidCls);this.el.title=this.errorText;default:this._RemoveErrorIcon();break}}else{this._RemoveErrorIcon()}this.doLayout()},doValueChanged:function(){this._OnValueChanged()},_OnValueChanged:function(){if(this.validateOnChanged){this._tryValidate()}this.fire("valuechanged",{value:this.getValue()})},onValueChanged:function(c,d){this.on("valuechanged",c,d)},onValidation:function(c,d){this.on("validation",c,d)},getAttrs:function(f){var g=mini.ValidatorBase.superclass.getAttrs.call(this,f);mini._ParseString(f,g,["onvaluechanged","onvalidation","label","labelStyle","requiredErrorText","errorMode","errorTooltipPlacement"]);mini._ParseBool(f,g,["validateOnChanged","validateOnLeave","labelField"]);var i=f.getAttribute("required");if(!i){i=f.required}if(!i){var j=f.attributes.required;if(j){i=j.value=="null"?null:"true"}}if(i){g.required=i!="false"?true:false}return g},_labelLayout:function(){var c=this._borderEl;if(!c){return}this._labelLayouted=true;if(this.labelField){var d=this._labelEl.offsetWidth;c.style.marginLeft=d+"px";this._doLabelLayout=d===0}else{c.style.marginLeft=0}},_labelFieldCls:"mini-labelfield",labelField:false,label:"",labelStyle:"",setLabelField:function(b){if(this.labelField!=b){this.labelField=b;if(!this._borderEl){return}if(!this._labelEl){this._labelEl=mini.append(this.el,'<label class="mini-labelfield-label"></label>');this._labelEl.innerHTML=this.label;mini.setStyle(this._labelEl,this.labelStyle)}this._labelEl.style.display=b?"block":"none";if(b){mini.addClass(this.el,this._labelFieldCls)}else{mini.removeClass(this.el,this._labelFieldCls)}this._labelLayout()}},getLabelField:function(){this.labelField},setLabel:function(b){if(this.label!=b){this.label=b;if(this._labelEl){this._labelEl.innerHTML=b}this._labelLayout()}},getLabel:function(){this.label},setLabelStyle:function(b){if(this.labelStyle!=b){this.labelStyle=b;if(this._labelEl){mini.setStyle(this._labelEl,b)}this._labelLayout()}},getLabelStyle:function(){this.labelStyle}});mini.ListControl=function(){this.data=[];this._selecteds=[];mini.ListControl.superclass.constructor.call(this);this.doUpdate()};mini.ListControl.ajaxType="get";mini.extend(mini.ListControl,mini.ValidatorBase,{defaultValue:"",value:"",valueField:"id",textField:"text",dataField:"",delimiter:",",data:null,url:"",_itemCls:"mini-list-item",_itemHoverCls:"mini-list-item-hover",_itemSelectedCls:"mini-list-item-selected",set:function(i){if(typeof i=="string"){return this}var j=i.value;delete i.value;var g=i.url;delete i.url;var f=i.data;delete i.data;mini.ListControl.superclass.set.call(this,i);if(!mini.isNull(f)){this.setData(f)}if(!mini.isNull(g)){this.setUrl(g)}if(!mini.isNull(j)){this.setValue(j)}return this},uiCls:"mini-list",_create:function(){},_initEvents:function(){mini._BindEvents(function(){mini_onOne(this.el,"click",this.__OnClick,this);mini_onOne(this.el,"dblclick",this.__OnDblClick,this);mini_onOne(this.el,"mousedown",this.__OnMouseDown,this);mini_onOne(this.el,"mouseup",this.__OnMouseUp,this);mini_onOne(this.el,"mousemove",this.__OnMouseMove,this);mini_onOne(this.el,"mouseover",this.__OnMouseOver,this);mini_onOne(this.el,"mouseout",this.__OnMouseOut,this);mini_onOne(this.el,"keydown",this.__OnKeyDown,this);mini_onOne(this.el,"keyup",this.__OnKeyUp,this);mini_onOne(this.el,"contextmenu",this.__OnContextMenu,this)},this)},destroy:function(b){if(this.el){this.el.onclick=null;this.el.ondblclick=null;this.el.onmousedown=null;this.el.onmouseup=null;this.el.onmousemove=null;this.el.onmouseover=null;this.el.onmouseout=null;this.el.onkeydown=null;this.el.onkeyup=null;this.el.oncontextmenu=null}mini.ListControl.superclass.destroy.call(this,b)},name:"",setName:function(b){this.name=b;if(this._valueEl){mini.setAttr(this._valueEl,"name",this.name)}},getItemByEvent:function(g){var d=mini.findParent(g.target,this._itemCls);if(d){var f=parseInt(mini.getAttr(d,"index"));return this.data[f]}},addItemCls:function(g,f){var d=this.getItemEl(g);if(d){mini.addClass(d,f)}},removeItemCls:function(g,f){var d=this.getItemEl(g);if(d){mini.removeClass(d,f)}},getItemEl:function(d){d=this.getItem(d);var f=this.data.indexOf(d);var g=this._createItemId(f);return document.getElementById(g)},_focusItem:function(d,f){d=this.getItem(d);if(!d){return}var g=this.getItemEl(d);if(f&&g){this.scrollIntoView(d)}if(this._focusedItem==d){if(g){mini.addClass(g,this._itemHoverCls)}return}this._blurItem();this._focusedItem=d;if(g){mini.addClass(g,this._itemHoverCls)}},_blurItem:function(){if(!this._focusedItem){return}var b=this.getItemEl(this._focusedItem);if(b){mini.removeClass(b,this._itemHoverCls)}this._focusedItem=null},getFocusedItem:function(){var b=this._focusedItem;return this.indexOf(b)==-1?null:b},getFocusedIndex:function(){return this.data.indexOf(this._focusedItem)},_scrollViewEl:null,scrollIntoView:function(j){try{var f=this.getItemEl(j);var g=this._scrollViewEl||this.el;mini.scrollIntoView(f,g,false)}catch(i){}},getItem:function(b){if(typeof b=="object"){return b}if(typeof b=="number"){return this.data[b]}return this.findItems(b)[0]},getCount:function(){return this.data.length},indexOf:function(b){return this.data.indexOf(b)},getAt:function(b){return this.data[b]},updateItem:function(c,d){c=this.getItem(c);if(!c){return}mini.copyTo(c,d);this.doUpdate()},load:function(b){if(typeof b=="string"){this.setUrl(b)}else{this.setData(b)}},loadData:function(b){this.setData(b)},setData:function(data){if(typeof data=="string"){data=eval(data)}if(!mini.isArray(data)){data=[]}this.data=data;this.doUpdate();if(this.value!=""){this.deselectAll();var records=this.findItems(this.value);this.selects(records)}},getData:function(){return this.data.clone()},setUrl:function(b){this.url=b;this._doLoad({})},getUrl:function(){return this.url},ajaxData:null,_doLoad:function(params){try{var url=eval(this.url);if(url!=undefined){this.url=url}}catch(e){}var url=this.url;var ajaxMethod=mini.ListControl.ajaxType;if(url){if(url.indexOf(".txt")!=-1||url.indexOf(".json")!=-1){ajaxMethod="get"}}var obj=mini._evalAjaxData(this.ajaxData,this);mini.copyTo(params,obj);var e={url:this.url,async:false,type:this.ajaxType?this.ajaxType:ajaxMethod,data:params,params:params,cache:false,cancel:false};this.fire("beforeload",e);if(e.data!=e.params&&e.params!=params){e.data=e.params}if(e.cancel==true){return}var sf=me=this;var url=e.url;mini.copyTo(e,{success:function(text,textStatus,xhr){delete e.params;var obj={text:text,result:null,sender:me,options:e,xhr:xhr};var result=null;try{mini_doload(obj);result=obj.result;if(!result){result=mini.decode(text)}}catch(ex){if(mini_debugger==true){alert(url+"\njson is error.")}}if(mini.isArray(result)){result={data:result}}if(sf.dataField){result.data=mini._getMap(sf.dataField,result)}if(!result.data){result.data=[]}var ex={data:result.data,cancel:false};sf.fire("preload",ex);if(ex.cancel==true){return}sf.setData(ex.data);sf.fire("load");setTimeout(function(){sf.doLayout()},100)},error:function(xhr,textStatus,errorThrown){var e={xhr:xhr,text:xhr.responseText,textStatus:textStatus,errorMsg:xhr.responseText,errorCode:xhr.status};if(mini_debugger==true){alert(url+"\n"+e.errorCode+"\n"+e.errorMsg)}sf.fire("loaderror",e)}});this._ajaxer=mini.ajax(e)},setValue:function(c){if(mini.isNull(c)){c=""}if(this.value!==c){this.deselectAll();this.value=c;if(this._valueEl){this._valueEl.value=c}var d=this.findItems(this.value);this.selects(d);this.setSelected(d[0])}},getValue:function(){return this.value},getFormValue:function(){return this.value},setValueField:function(b){this.valueField=b},getValueField:function(){return this.valueField},setTextField:function(b){this.textField=b},getTextField:function(){return this.textField},getItemValue:function(b){return String(mini._getMap(this.valueField,b))},getItemText:function(c){var d=mini._getMap(this.textField,c);return mini.isNull(d)?"":String(d)},getValueAndText:function(l){if(mini.isNull(l)){l=[]}if(!mini.isArray(l)){l=this.findItems(l)}var n=[];var j=[];for(var k=0,g=l.length;k<g;k++){var i=l[k];if(i){n.push(this.getItemValue(i));j.push(this.getItemText(i))}}return[n.join(this.delimiter),j.join(this.delimiter)]},findItems:function(k){if(mini.isNull(k)||k===""){return[]}if(typeof k=="function"){var l=k;var s=[];var u=this.data;for(var w=0,x=u.length;w<x;w++){var t=u[w];if(l(t,w)===true){s.push(t)}}return s}var i=String(k).split(this.delimiter);var u=this.data;var r={};for(var w=0,x=u.length;w<x;w++){var t=u[w];var j=t[this.valueField];r[j]=t}var z=[];for(var v=0,y=i.length;v<y;v++){var j=i[v];var t=r[j];if(t){z.push(t)}}return z},removeAll:function(){var b=this.getData();this.removeItems(b)},addItems:function(d,c){if(!mini.isArray(d)){return}if(mini.isNull(c)){c=this.data.length}this.data.insertRange(c,d);this.doUpdate()},addItem:function(c,d){if(!c){return}if(this.data.indexOf(c)!=-1){return}if(mini.isNull(d)){d=this.data.length}this.data.insert(d,c);this.doUpdate()},removeItems:function(b){if(!mini.isArray(b)){return}this.data.removeRange(b);this._checkSelecteds();this.doUpdate()},removeItem:function(c){var d=this.data.indexOf(c);if(d!=-1){this.data.removeAt(d);this._checkSelecteds();this.doUpdate()}},moveItem:function(c,d){if(!c||!mini.isNumber(d)){return}if(d<0){d=0}if(d>this.data.length){d=this.data.length}this.data.remove(c);this.data.insert(d,c);this.doUpdate()},_selected:null,_selecteds:[],multiSelect:false,_checkSelecteds:function(){for(var d=this._selecteds.length-1;d>=0;d--){var f=this._selecteds[d];if(this.data.indexOf(f)==-1){this._selecteds.removeAt(d)}}var g=this.getValueAndText(this._selecteds);this.value=g[0];if(this._valueEl){this._valueEl.value=this.value}},setMultiSelect:function(b){this.multiSelect=b},getMultiSelect:function(){return this.multiSelect},isSelected:function(b){if(!b){return false}return this._selecteds.indexOf(b)!=-1},getSelecteds:function(){var d=this._selecteds.clone();var c=this;mini.sort(d,function(g,i){var a=c.indexOf(g);var b=c.indexOf(i);if(a>b){return 1}if(a<b){return -1}return 0});return d},setSelected:function(b){if(b){this._selected=b;this.select(b)}},getSelected:function(){return this._selected},select:function(b){b=this.getItem(b);if(!b){return}if(this.isSelected(b)){return}this.selects([b])},deselect:function(b){b=this.getItem(b);if(!b){return}if(!this.isSelected(b)){return}this.deselects([b])},selectAll:function(){var b=this.data.clone();this.selects(b)},deselectAll:function(){this.deselects(this._selecteds)},clearSelect:function(){this.deselectAll()},selects:function(k){if(!k||k.length==0){return}k=k.clone();if(this.multiSelect==false&&k.length>1){k.length=1}for(var j=0,f=k.length;j<f;j++){var g=k[j];if(!this.isSelected(g)){this._selecteds.push(g)}}var i=this;i._doSelects()},deselects:function(f){if(!f||f.length==0){return}f=f.clone();for(var j=f.length-1;j>=0;j--){var g=f[j];if(this.isSelected(g)){this._selecteds.remove(g)}}var i=this;i._doSelects()},_doSelects:function(){var l=this.getValueAndText(this._selecteds);this.value=l[0];if(this._valueEl){this._valueEl.value=this.value}for(var o=0,q=this.data.length;o<q;o++){var i=this.data[o];var j=this.isSelected(i);if(j){this.addItemCls(i,this._itemSelectedCls)}else{this.removeItemCls(i,this._itemSelectedCls)}var p=this.data.indexOf(i);var k=this._createCheckId(p);var n=document.getElementById(k);if(n){n.checked=!!j}}},_OnSelectionChanged:function(f,g){var j=this.getValueAndText(this._selecteds);this.value=j[0];if(this._valueEl){this._valueEl.value=this.value}var i={selecteds:this.getSelecteds(),selected:this.getSelected(),value:this.getValue()};this.fire("SelectionChanged",i)},_createCheckId:function(b){return this.uid+"$ck$"+b},_createItemId:function(b){return this.uid+"$"+b},__OnClick:function(b){this._fireEvent(b,"Click")},__OnDblClick:function(b){this._fireEvent(b,"Dblclick")},__OnMouseDown:function(b){this._fireEvent(b,"MouseDown")},__OnMouseUp:function(b){this._fireEvent(b,"MouseUp")},__OnMouseMove:function(b){this._fireEvent(b,"MouseMove")},__OnMouseOver:function(b){this._fireEvent(b,"MouseOver")},__OnMouseOut:function(b){this._fireEvent(b,"MouseOut")},__OnKeyDown:function(b){this._fireEvent(b,"KeyDown")},__OnKeyUp:function(b){this._fireEvent(b,"KeyUp")},__OnContextMenu:function(b){this._fireEvent(b,"ContextMenu")},_fireEvent:function(j,i){if(!this.enabled){return}var k=this.getItemByEvent(j);if(!k){return}var l=this["_OnItem"+i];if(l){l.call(this,k,j)}else{var g={item:k,htmlEvent:j};this.fire("item"+i,g)}},_OnItemClick:function(f,g){if(this.isReadOnly()||this.enabled==false||f.enabled===false){g.preventDefault();return}var d=this.getValue();if(this.multiSelect){if(this.isSelected(f)){this.deselect(f);if(this._selected==f){this._selected=null}}else{this.select(f);this._selected=f}this._OnSelectionChanged()}else{if(!this.isSelected(f)){this.deselectAll();this.select(f);this._selected=f;this._OnSelectionChanged()}}if(d!=this.getValue()){this._OnValueChanged()}var g={item:f,htmlEvent:g};this.fire("itemclick",g)},_blurOnOut:true,_OnItemMouseOut:function(d,c){if(!this.enabled){return}if(this._blurOnOut){this._blurItem()}var c={item:d,htmlEvent:c};this.fire("itemmouseout",c)},_OnItemMouseMove:function(d,c){if(!this.enabled||d.enabled===false){return}this._focusItem(d);var c={item:d,htmlEvent:c};this.fire("itemmousemove",c)},onItemClick:function(c,d){this.on("itemclick",c,d)},onItemMouseDown:function(c,d){this.on("itemmousedown",c,d)},onBeforeLoad:function(c,d){this.on("beforeload",c,d)},onLoad:function(c,d){this.on("load",c,d)},onLoadError:function(c,d){this.on("loaderror",c,d)},onPreLoad:function(c,d){this.on("preload",c,d)},getAttrs:function(r){var k=mini.ListControl.superclass.getAttrs.call(this,r);mini._ParseString(r,k,["url","data","value","textField","valueField","onitemclick","onitemmousemove","onselectionchanged","onitemdblclick","onbeforeload","onload","onloaderror","ondataload"]);mini._ParseBool(r,k,["multiSelect"]);var i=k.valueField||this.valueField;var q=k.textField||this.textField;if(r.nodeName.toLowerCase()=="select"){var o=[];for(var n=0,p=r.length;n<p;n++){var l=r.options[n];var s={};s[q]=l.text;s[i]=l.value;o.push(s)}if(o.length>0){k.data=o}}return k}});mini._Layouts={};mini.layout=function(d,f){if(!document.body){return}function g(b){if(!b){return}var a=mini.get(b);if(a){if(a.doLayout){if(!mini._Layouts[a.uid]){mini._Layouts[a.uid]=a;if(f!==false||a.isFixedSize()==false){a.doLayout(false)}delete mini._Layouts[a.uid]}}}else{var c=b.childNodes;if(c){for(var k=0,l=c.length;k<l;k++){var i=c[k];g(i)}}}}if(!d){d=document.body}g(d);if(d==document.body){mini.layoutIFrames()}};mini.applyTo=function(d){d=mini.byId(d);if(!d){return this}if(mini.get(d)){throw new Error("not applyTo a mini control")}var f=this.getAttrs(d);delete f._applyTo;if(mini.isNull(f.defaultValue)&&!mini.isNull(f.value)){f.defaultValue=f.value}if(mini.isNull(f.defaultText)&&!mini.isNull(f.text)){f.defaultText=f.text}var g=d.parentNode;if(g&&this.el!=d){g.replaceChild(this.el,d)}this.set(f);this._afterApply(d);return this};mini._doParse=function(w){if(!w){return}var l=w.nodeName.toLowerCase();if(!l){return}var p=String(w.className);if(p){var s=mini.get(w);if(!s){var u=p.split(" ");for(var r=0,t=u.length;r<t;r++){var i=u[r];var q=mini.getClassByUICls(i);if(q){mini.removeClass(w,i);var o=new q();mini.applyTo.call(o,w);w=o.el;break}}}}if(l=="select"||mini.hasClass(w,"mini-menu")||mini.hasClass(w,"mini-datagrid")||mini.hasClass(w,"mini-treegrid")||mini.hasClass(w,"mini-tree")||mini.hasClass(w,"mini-button")||mini.hasClass(w,"mini-textbox")||mini.hasClass(w,"mini-buttonedit")){return}var x=mini.getChildNodes(w,true);for(var r=0,t=x.length;r<t;r++){var v=x[r];if(v.nodeType==1){if(v.parentNode==w){mini._doParse(v)}}}};mini._Removes=[];mini._firstParse=true;mini.parse=function(q,l){if(mini._firstParse){mini._firstParse=false;var d=document.getElementsByTagName("iframe");var r=[];for(var n=0,o=d.length;n<o;n++){var i=d[n];r.push(i)}for(var n=0,o=r.length;n<o;n++){var i=r[n];var t=$(i).attr("src");if(!t){continue}i.loaded=false;i._onload=i.onload;i._src=t;i.onload=function(){};i.src=""}setTimeout(function(){for(var b=0,c=r.length;b<c;b++){var a=r[b];if(a._src&&$(a).attr("src")==""){a.loaded=true;a.onload=a._onload;a.src=a._src;a._src=a._onload=null}}},20)}if(typeof q=="string"){var s=q;q=mini.byId(s);if(!q){q=document.body}}if(q&&!mini.isElement(q)){q=q.el}if(!q){q=document.body}var p=mini.WindowVisible;if(isIE){mini.WindowVisible=false}mini._doParse(q);mini.WindowVisible=p;if(l!==false){mini.layout(q)}};mini._ParseString=function(n,p,i){for(var o=0,j=i.length;o<j;o++){var k=i[o];var l=mini.getAttr(n,k);if(l){p[k]=l}}};mini._ParseBool=function(n,p,i){for(var o=0,j=i.length;o<j;o++){var k=i[o];var l=mini.getAttr(n,k);if(l){p[k]=l=="true"?true:false}}};mini._ParseInt=function(n,p,i){for(var o=0,j=i.length;o<j;o++){var k=i[o];var l=parseInt(mini.getAttr(n,k));if(!isNaN(l)){p[k]=l}}};mini._ParseColumns=function(el){var columns=[];var cs=mini.getChildNodes(el);for(var i=0,l=cs.length;i<l;i++){var node=cs[i];var jq=jQuery(node);var column={};var editor=null,filter=null;var subCs=mini.getChildNodes(node);if(subCs){for(var ii=0,li=subCs.length;ii<li;ii++){var subNode=subCs[ii];var property=jQuery(subNode).attr("property");if(!property){continue}property=property.toLowerCase();if(property=="columns"){column.columns=mini._ParseColumns(subNode);jQuery(subNode).remove()}if(property=="editor"||property=="filter"){var className=subNode.className;var classes=className.split(" ");for(var i3=0,l3=classes.length;i3<l3;i3++){var cls=classes[i3];var clazz=mini.getClassByUICls(cls);if(clazz){var ui=new clazz();if(property=="filter"){filter=ui.getAttrs(subNode);filter.type=ui.type}else{editor=ui.getAttrs(subNode);editor.type=ui.type}break}}jQuery(subNode).remove()}}}column.header=node.innerHTML;mini._ParseString(node,column,["name","header","field","editor","filter","renderer","width","type","renderer","headerAlign","align","headerCls","cellCls","headerStyle","cellStyle","displayField","dateFormat","listFormat","mapFormat","trueValue","falseValue","dataType","vtype","currencyUnit","summaryType","summaryRenderer","groupSummaryType","groupSummaryRenderer","defaultValue","defaultText","decimalPlaces","data-options"]);mini._ParseBool(node,column,["visible","readOnly","allowSort","allowResize","allowMove","allowDrag","autoShowPopup","unique","autoEscape","enabled","hideable"]);if(editor){column.editor=editor}if(filter){column.filter=filter}if(column.dataType){column.dataType=column.dataType.toLowerCase()}if(column.defaultValue==="true"){column.defaultValue=true}if(column.defaultValue==="false"){column.defaultValue=false}columns.push(column);var options=column["data-options"];if(options){options=eval("("+options+")");if(options){mini.copyTo(column,options)}}}return columns};mini._Columns={};mini._getColumn=function(c){var d=mini._Columns[c.toLowerCase()];if(!d){return{}}return d()};mini.IndexColumn=function(b){return mini.copyTo({width:30,cellCls:"",align:"center",draggable:false,allowDrag:true,hideable:true,init:function(a){a.on("addrow",this.__OnIndexChanged,this);a.on("removerow",this.__OnIndexChanged,this);a.on("moverow",this.__OnIndexChanged,this);if(a.isTree){a.on("addnode",this.__OnIndexChanged,this);a.on("removenode",this.__OnIndexChanged,this);a.on("movenode",this.__OnIndexChanged,this);a.on("loadnode",this.__OnIndexChanged,this);this._gridUID=a.uid;this._rowIdField="_id"}},getNumberId:function(a){return this._gridUID+"$number$"+a[this._rowIdField]},createNumber:function(a,d){if(mini.isNull(a.pageIndex)){return d+1}else{return(a.pageIndex*a.pageSize)+d+1}},renderer:function(f){var a=f.sender;if(this.draggable){if(!f.cellStyle){f.cellStyle=""}f.cellStyle+=";cursor:move;"}var g='<div id="'+this.getNumberId(f.record)+'">';if(mini.isNull(a.getPageIndex)){g+=f.rowIndex+1}else{g+=(a.getPageIndex()*a.getPageSize())+f.rowIndex+1}g+="</div>";return g},__OnIndexChanged:function(l){var n=l.sender;var p=n.getDataView();for(var o=0,r=p.length;o<r;o++){var a=p[o];var i=this.getNumberId(a);var q=document.getElementById(i);if(q){q.innerHTML=this.createNumber(n,o)}}}},b)};mini._Columns.indexcolumn=mini.IndexColumn;mini.CheckColumn=function(b){return mini.copyTo({width:30,cellCls:"mini-checkcolumn",headerCls:"mini-checkcolumn",hideable:true,_multiRowSelect:true,header:function(g){var f=this.uid+"checkall";var a='<input type="checkbox" id="'+f+'" />';if(this.multiSelect==false){a=""}return a},getCheckId:function(a,d){return this._gridUID+"$checkcolumn$"+a[this._rowIdField]+"$"+d._id},init:function(a){a.on("selectionchanged",this.__OnSelectionChanged,this);a.on("HeaderCellClick",this.__OnHeaderCellClick,this)},renderer:function(j){var i=this.getCheckId(j.record,j.column);var k=j.sender.isSelected?j.sender.isSelected(j.record):false;var l="checkbox";var n=j.sender;if(n.getMultiSelect()==false){l="radio"}var a='<input type="'+l+'" id="'+i+'" '+(k?"checked":"")+' hidefocus style="outline:none;" onclick="return false"/>';a+='<div class="mini-grid-radio-mask"></div>';return a},__OnHeaderCellClick:function(j){var l=j.sender;if(j.column!=this){return}var i=l.uid+"checkall";var a=document.getElementById(i);if(a){if(l.getMultiSelect()){if(a.checked){l.deselectAll();var k=l.getDataView();l.selects(k)}else{l.deselectAll()}}else{l.deselectAll();if(a.checked){l.select(0)}}l.fire("checkall")}},__OnSelectionChanged:function(o){var u=o.sender;var s=u.toArray();var l=this;for(var q=0,r=s.length;q<r;q++){var p=s[q];var i=u.isSelected(p);var t=l.getCheckId(p,l);var a=document.getElementById(t);if(a){a.checked=i}}if(!this._timer){this._timer=setTimeout(function(){l._doCheckState(u);l._timer=null},10)}},_doCheckState:function(i){var f=i.uid+"checkall";var a=document.getElementById(f);if(a&&i._getSelectAllCheckState){var g=i._getSelectAllCheckState();if(g=="has"){a.indeterminate=true;a.checked=true}else{a.indeterminate=false;a.checked=g}}}},b)};mini._Columns.checkcolumn=mini.CheckColumn;mini.ExpandColumn=function(b){return mini.copyTo({width:30,headerAlign:"center",align:"center",draggable:false,cellStyle:"padding:0",cellCls:"mini-grid-expandCell",hideable:true,renderer:function(a){return'<a class="mini-grid-ecIcon" href="javascript:#" onclick="return false"></a>'},init:function(a){a.on("cellclick",this.__OnCellClick,this)},__OnCellClick:function(f){var g=f.sender;if(f.column==this&&g.isShowRowDetail){if(mini.findParent(f.htmlEvent.target,"mini-grid-ecIcon")){var a=g.isShowRowDetail(f.record);if(!a){f.cancel=false;g.fire("beforeshowrowdetail",f);if(f.cancel===true){return}}else{f.cancel=false;g.fire("beforehiderowdetail",f);if(f.cancel===true){return}}if(g.autoHideRowDetail){g.hideAllRowDetail()}if(a){g.hideRowDetail(f.record)}else{g.showRowDetail(f.record)}}}}},b)};mini._Columns.expandcolumn=mini.ExpandColumn;mini.CheckBoxColumn=function(b){return mini.copyTo({_type:"checkboxcolumn",header:"",headerAlign:"center",cellCls:"mini-checkcolumn",trueValue:true,falseValue:false,readOnly:false,getCheckId:function(a,d){return this._gridUID+"$checkbox$"+a[this._rowIdField]+"$"+d._id},getCheckBoxEl:function(a,d){return document.getElementById(this.getCheckId(a,d))},renderer:function(j){var i=this.getCheckId(j.record,j.column);var a=mini._getMap(j.field,j.record);var k=a==this.trueValue?true:false;var l="checkbox";return'<input type="'+l+'" id="'+i+'" '+(k?"checked":"")+' hidefocus style="outline:none;" onclick="return false;"/>'},init:function(i){this.grid=i;function a(c){if(i.isReadOnly()||this.readOnly){return}c.value=mini._getMap(c.field,c.record);i.fire("cellbeginedit",c);if(c.cancel!==true){var f=mini._getMap(c.column.field,c.record);var d=f==this.trueValue?this.falseValue:this.trueValue;if(i._OnCellCommitEdit){i._OnCellCommitEdit(c.record,c.column,d);i._OnCellEndEdit(c.record,c.column)}}}function j(d){if(d.column==this){var c=this.getCheckId(d.record,d.column);var f=d.htmlEvent.target;if(f.id==c){if(i.allowCellEdit){d.cancel=false;a.call(this,d)}else{if(this.readOnly){return}d.value=mini._getMap(d.column.field,d.record);i.fire("cellbeginedit",d);if(d.cancel==true){return}if(i.isEditingRow&&i.isEditingRow(d.record)){setTimeout(function(){f.checked=!f.checked},1)}}}}}i.on("cellclick",j,this);mini.on(this.grid.el,"keydown",function(d){if(d.keyCode==32&&i.allowCellEdit){var c=i.getCurrentCell();if(!c){return}if(c[1]!=this){return}var f={record:c[0],column:c[1]};f.field=f.column.field;a.call(this,f);d.preventDefault()}},this);var k=parseInt(this.trueValue),g=parseInt(this.falseValue);if(!isNaN(k)){this.trueValue=k}if(!isNaN(g)){this.falseValue=g}}},b)};mini._Columns.checkboxcolumn=mini.CheckBoxColumn;mini.RadioButtonColumn=function(b){return mini.copyTo({_type:"radiobuttoncolumn",header:"",headerAlign:"center",cellCls:"mini-checkcolumn",trueValue:true,falseValue:false,readOnly:false,getCheckId:function(a,d){return this._gridUID+"$radio$"+a[this._rowIdField]+"$"+d._id},getCheckBoxEl:function(a,d){return document.getElementById(this.getCheckId(a,d))},renderer:function(p){var t=p.sender;var r=this.getCheckId(p.record,p.column);var l=mini._getMap(p.field,p.record);var n=l==this.trueValue?true:false;var o="radio";var s=t._id+p.column.field;var q="";var a='<div style="position:relative;">';a+='<input name="'+s+'" type="'+o+'" id="'+r+'" '+(n?"checked":"")+' hidefocus style="outline:none;" onclick="return false;" style="position:relative;z-index:1;"/>';if(!t.allowCellEdit){if(!t.isEditingRow(p.record)){a+='<div class="mini-grid-radio-mask"></div>'}}a+="</div>";return a},init:function(i){this.grid=i;function a(r){if(i.isReadOnly()||this.readOnly){return}r.value=mini._getMap(r.field,r.record);i.fire("cellbeginedit",r);if(r.cancel!==true){var l=mini._getMap(r.column.field,r.record);if(l==this.trueValue){return}var c=l==this.trueValue?this.falseValue:this.trueValue;var d=i.getData();for(var f=0,p=d.length;f<p;f++){var q=d[f];if(q==r.record){continue}var l=mini._getMap(r.column.field,q);if(l!=this.falseValue){i.updateRow(q,r.column.field,this.falseValue)}}if(i._OnCellCommitEdit){i._OnCellCommitEdit(r.record,r.column,c)}}}function j(d){if(d.column==this){var c=this.getCheckId(d.record,d.column);var l=d.htmlEvent.target;if(l.id==c){if(i.allowCellEdit){d.cancel=false;a.call(this,d)}else{if(i.isEditingRow&&i.isEditingRow(d.record)){var f=this;setTimeout(function(){l.checked=true;var x=i.getData();for(var y=0,t=x.length;y<t;y++){var u=x[y];if(u==d.record){continue}var w=d.column.field;var o=mini._getMap(w,u);if(o!=f.falseValue){if(u!=d.record){if(i._dataSource){mini._setMap(d.column.field,f.falseValue,u);i._dataSource._setModified(u,w,o)}else{var v={};mini._setMap(w,f.falseValue,v);i._doUpdateRow(u,v)}}}}},1)}}}}}i.on("cellclick",j,this);mini.on(this.grid.el,"keydown",function(d){if(d.keyCode==32&&i.allowCellEdit){var c=i.getCurrentCell();if(!c){return}if(c[1]!=this){return}var f={record:c[0],column:c[1]};f.field=f.column.field;a.call(this,f);d.preventDefault()}},this);var k=parseInt(this.trueValue),g=parseInt(this.falseValue);if(!isNaN(k)){this.trueValue=k}if(!isNaN(g)){this.falseValue=g}}},b)};mini._Columns.radiobuttoncolumn=mini.RadioButtonColumn;mini.ComboBoxColumn=function(b){return mini.copyTo({renderer:function(l){var i=!mini.isNull(l.value)?String(l.value):"";var a=i.split(",");var D="id",x="text";var w={};var o=l.column.editor;if(o&&o.type=="combobox"){var A=this.__editor;if(!A){if(mini.isControl(o)){A=o}else{o=mini.clone(o);A=mini.create(o)}this.__editor=A}D=A.getValueField();x=A.getTextField();w=this._valueMaps;if(!w){w={};var u=A.getData();for(var v=0,y=u.length;v<y;v++){var B=u[v];w[B[D]]=B}this._valueMaps=w}}var z=[];for(var v=0,y=a.length;v<y;v++){var C=a[v];var B=w[C];if(B){var E=B[x];if(E===null||E===undefined){E=""}z.push(E)}}return z.join(",")}},b)};mini._Columns.comboboxcolumn=mini.ComboBoxColumn;mini._Resizer=function(b){this.owner=b;mini.on(this.owner.el,"mousedown",this.__OnMouseDown,this)};mini._Resizer.prototype={__OnMouseDown:function(g){var f=mini.hasClass(g.target,"mini-resizer-trigger");if(f&&this.owner.allowResize){var d=this._getResizeDrag();d.start(g)}},_getResizeDrag:function(){if(!this._resizeDragger){this._resizeDragger=new mini.Drag({capture:true,onStart:mini.createDelegate(this._OnDragStart,this),onMove:mini.createDelegate(this._OnDragMove,this),onStop:mini.createDelegate(this._OnDragStop,this)})}return this._resizeDragger},_OnDragStart:function(b){this.mask=mini.append(document.body,'<div class="mini-resizer-mask mini-fixed"></div>');this.proxy=mini.append(document.body,'<div class="mini-resizer-proxy"></div>');this.proxy.style.cursor="se-resize";this.elBox=mini.getBox(this.owner.el);mini.setBox(this.proxy,this.elBox)},_OnDragMove:function(k){var g=this.owner;var l=k.now[0]-k.init[0];var j=k.now[1]-k.init[1];var i=this.elBox.width+l;var n=this.elBox.height+j;if(i<g.minWidth){i=g.minWidth}if(n<g.minHeight){n=g.minHeight}if(i>g.maxWidth){i=g.maxWidth}if(n>g.maxHeight){n=g.maxHeight}mini.setSize(this.proxy,i,n)},_OnDragStop:function(f,g){if(!this.proxy){return}var d=mini.getBox(this.proxy);jQuery(this.mask).remove();jQuery(this.proxy).remove();this.proxy=null;this.elBox=null;if(g){this.owner.setWidth(d.width);this.owner.setHeight(d.height);this.owner.fire("resize")}}};mini._topWindow=null;mini._getTopWindow=function(f){if(mini._topWindow){return mini._topWindow}var g=[];function d(a){try{a.___try=1;g.push(a)}catch(b){}if(a.parent&&a.parent!=a){d(a.parent)}}d(window);mini._topWindow=g[g.length-1];return mini._topWindow};var __ps=mini.getParams();if(__ps._winid){try{window.Owner=mini._getTopWindow()[__ps._winid]}catch(ex){}}mini._WindowID="w"+Math.floor(Math.random()*10000);mini._getTopWindow()[mini._WindowID]=window;mini.__IFrameCreateCount=1;mini.createIFrame=function(x,q){var w="__iframe_onload"+mini.__IFrameCreateCount++;window[w]=v;if(!x){x=""}var r=x.split("#");x=r[0];var o="_t="+Math.floor(Math.random()*1000000);if(x.indexOf("?")==-1){x+="?"+o}else{x+="&"+o}if(x&&x.indexOf("_winid")==-1){var o="_winid="+mini._WindowID;if(x.indexOf("?")==-1){x+="?"+o}else{x+="&"+o}}if(r[1]){x=x+"#"+r[1]}var p=x.indexOf(".mht")!=-1;var z=p?x:"";var n='<iframe src="'+z+'" style="width:100%;height:100%;" onload="'+w+'()"  frameborder="0"></iframe>';var y=document.createElement("div");var t=mini.append(y,n);var u=false;if(p){u=true}else{setTimeout(function(){if(t){t.src=x;u=true}},5)}var s=true;function v(){if(u==false){return}setTimeout(function(){if(q){q(t,s)}s=false},1)}t._ondestroy=function(){window[w]=mini.emptyFn;t.src="";try{t.contentWindow.document.write("");t.contentWindow.document.close()}catch(a){}t._ondestroy=null;t=null};return t};mini._doOpen=function(r){if(typeof r=="string"){r={url:r}}r=mini.copyTo({width:700,height:400,allowResize:true,allowModal:true,closeAction:"destroy",title:"",titleIcon:"",iconCls:"",iconStyle:"",bodyStyle:"padding: 0",url:"",showCloseButton:true,showFooter:false},r);r.closeAction="destroy";var l=r.onload;delete r.onload;var n=r.ondestroy;delete r.ondestroy;var j=r.url;delete r.url;var p=mini.getViewportBox();if(r.width&&String(r.width).indexOf("%")!=-1){var k=parseInt(r.width);r.width=parseInt(p.width*(k/100))}if(r.height&&String(r.height).indexOf("%")!=-1){var q=parseInt(r.height);r.height=parseInt(p.height*(q/100))}var o=new mini.Window();o.set(r);o.load(j,l,n);o.show();return o};mini.open=function(i){if(!i){return}var j=i.url;if(!j){j=""}var l=j.split("#");var j=l[0];if(j&&j.indexOf("_winid")==-1){var p="_winid="+mini._WindowID;if(j.indexOf("?")==-1){j+="?"+p}else{j+="&"+p}if(l[1]){j=j+"#"+l[1]}}i.url=j;i.Owner=window;var k=[];function o(a){try{if(a.mini){k.push(a)}if(a.parent&&a.parent!=a){o(a.parent)}}catch(b){}}o(window);var n=k[k.length-1];return n.mini._doOpen(i)};mini.openTop=mini.open;mini._getResult=function(w,v,q,r,s,l){var o=null;var p=mini.getText(w,v,function(a,b){o=b;if(q){if(q){q(a,b)}}},r,s);var u={text:p,result:null,sender:{type:""},options:{url:w,data:v,type:s},xhr:o};var n=null;try{mini_doload(u);n=u.result;if(!n){n=mini.decode(p)}}catch(t){if(mini_debugger==true){alert(w+"\njson is error")}}if(!mini.isArray(n)&&l){n=mini._getMap(l,n)}if(mini.isArray(n)){n={data:n}}return n?n.data:null};mini.getData=function(i,k,l,j,p){var n=mini.getText(i,k,l,j,p);var o=mini.decode(n);return o};mini.getText=function(g,j,k,i,n){var l=null;mini.ajax({url:g,data:j,async:false,type:n?n:"get",cache:false,dataType:"text",success:function(b,a,c){l=b;if(k){k(b,c)}},error:i});return l};if(!window.mini_RootPath){mini_RootPath="/"}mini_CreateJSPath=function(l){var j=document.getElementsByTagName("script");var n="";for(var o=0,i=j.length;o<i;o++){var k=j[o].src;if(k.indexOf(l)!=-1){var p=k.split(l);n=p[0];break}}var q=location.href;q=q.split("#")[0];q=q.split("?")[0];var p=q.split("/");p.length=p.length-1;q=p.join("/");if(n.indexOf("http:")==-1&&n.indexOf("file:")==-1){n=q+"/"+n}return n};if(!window.mini_JSPath){mini_JSPath=mini_CreateJSPath("miniui.js")}mini.update=function(f,g){if(typeof f=="string"){f={url:f}}if(g){f.el=g}var d=mini.loadText(f.url);mini.innerHTML(f.el,d);mini.parse(f.el)};mini.createSingle=function(d){if(typeof d=="string"){d=mini.getClass(d)}if(typeof d!="function"){return}var c=d.single;if(!c){c=d.single=new d()}return c};mini.createTopSingle=function(c){if(typeof c!="function"){return}var d=c.prototype.type;if(top&&top!=window&&top.mini&&top.mini.getClass(d)){return top.mini.createSingle(d)}else{return mini.createSingle(c)}};mini.sortTypes={string:function(b){return String(b).toUpperCase()},date:function(b){if(!b){return 0}if(mini.isDate(b)){return b.getTime()}return mini.parseDate(String(b))},"float":function(d){var c=parseFloat(String(d).replace(/,/g,""));return isNaN(c)?0:c},"int":function(d){var c=parseInt(String(d).replace(/,/g,""),10);return isNaN(c)?0:c},currency:function(d){var c=parseFloat(String(d).replace(/,/g,""));return isNaN(c)?0:c}};mini._ValidateVType=function(z,s,x,i){var t=z.split(";");for(var y=0,A=t.length;y<A;y++){var z=t[y].trim();var r=z.split(":");var q=r[0];var v=z.substr(q.length+1,1000);if(v){v=v.split(",")}else{v=[]}var u=mini.VTypes[q];if(u){var l=u(s,v);if(l!==true){x.isValid=false;var w=r[0]+"ErrorText";x.errorText=i[w]||mini.VTypes[w]||"";x.errorText=String.format(x.errorText,v[0],v[1],v[2],v[3],v[4]);break}}}};mini._getErrorText=function(c,d){if(c&&c[d]){return c[d]}else{return mini.VTypes[d]}};mini.VTypes={minDateErrorText:"Date can not be less than {0}",maxDateErrorText:"Date can not be greater than {0}",uniqueErrorText:"This field is unique.",requiredErrorText:"This field is required.",emailErrorText:"Please enter a valid email address.",urlErrorText:"Please enter a valid URL.",floatErrorText:"Please enter a valid number.",intErrorText:"Please enter only digits",dateErrorText:"Please enter a valid date. Date format is {0}",maxLengthErrorText:"Please enter no more than {0} characters.",minLengthErrorText:"Please enter at least {0} characters.",maxErrorText:"Please enter a value less than or equal to {0}.",minErrorText:"Please enter a value greater than or equal to {0}.",rangeLengthErrorText:"Please enter a value between {0} and {1} characters long.",rangeCharErrorText:"Please enter a value between {0} and {1} characters long.",rangeErrorText:"Please enter a value between {0} and {1}.",required:function(d,c){if(mini.isNull(d)||d===""){return false}return true},email:function(d,c){if(mini.isNull(d)||d===""){return true}if(d.search(/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/)!=-1){return true}else{return false}},url:function(f,d){if(mini.isNull(f)||f===""){return true}function g(a){a=a.toLowerCase().split("?")[0];var b="^((https|http|ftp|rtsp|mms)?://)?(([0-9a-z_!~*'().&=+$%-]+: )?[0-9a-z_!~*'().&=+$%-]+@)?(([0-9]{1,3}.){3}[0-9]{1,3}|([0-9a-z_!~*'()-]+.)*([0-9a-z][0-9a-z-]{0,61})?[0-9a-z].[a-z]{2,6})(:[0-9]{1,5})?((/?)|(/[0-9a-z_!~*'().;?:@&=+$,%#-]+)+/?)$";var c=new RegExp(b);if(c.test(a)){return(true)}else{return(false)}}return g(f)},"int":function(f,d){if(mini.isNull(f)||f===""){return true}function g(b){if(b<0){b=-b}var a=String(b);return a.length>0&&!(/[^0-9]/).test(a)}return g(f)},"float":function(d,g){if(mini.isNull(d)||d===""){return true}function f(b){if(b<0){b=-b}var a=String(b);if(a.split(".").length>2){return false}return a.length>0&&!(/[^0-9.]/).test(a)}return f(d)},date:function(f,d){if(mini.isNull(f)||f===""){return true}if(!f){return false}var g=null;var i=d[0];if(i){g=mini.parseDate(f,i);if(g&&g.getFullYear){if(mini.formatDate(g,i)==f){return true}}}else{g=mini.parseDate(f,"yyyy-MM-dd");if(!g){g=mini.parseDate(f,"yyyy/MM/dd")}if(!g){g=mini.parseDate(f,"MM/dd/yyyy")}if(g&&g.getFullYear){return true}}return false},maxLength:function(f,d){if(mini.isNull(f)||f===""){return true}var g=parseInt(d);if(!f||isNaN(g)){return true}if(f.length<=g){return true}else{return false}},minLength:function(f,d){if(mini.isNull(f)||f===""){return true}var g=parseInt(d);if(isNaN(g)){return true}if(f.length>=g){return true}else{return false}},rangeLength:function(f,j){if(mini.isNull(f)||f===""){return true}if(!f){return false}var i=parseFloat(j[0]),g=parseFloat(j[1]);if(isNaN(i)||isNaN(g)){return true}if(i<=f.length&&f.length<=g){return true}return false},rangeChar:function(k,o){if(mini.isNull(k)||k===""){return true}var r=parseFloat(o[0]),n=parseFloat(o[1]);if(isNaN(r)||isNaN(n)){return true}function l(b){var a=new RegExp("^[\u4e00-\u9fa5]+$");if(a.test(b)){return true}return false}var p=0;var i=String(k).split("");for(var q=0,s=i.length;q<s;q++){if(l(i[q])){p+=2}else{p+=1}}if(r<=p&&p<=n){return true}return false},range:function(f,j){if(mini.VTypes["float"](f,j)==false){return false}if(mini.isNull(f)||f===""){return true}f=parseFloat(f);if(isNaN(f)){return false}var i=parseFloat(j[0]),g=parseFloat(j[1]);if(isNaN(i)||isNaN(g)){return true}if(i<=f&&f<=g){return true}return false},min:function(f,d){if(mini.VTypes["float"](f,d)==false){return false}if(mini.isNull(f)||f===""){return true}f=parseFloat(f);if(isNaN(f)){return false}var g=parseFloat(d[0]);if(isNaN(g)){return true}if(g<=f){return true}return false},max:function(d,g){if(mini.VTypes["float"](d,g)==false){return false}if(mini.isNull(d)||d===""){return true}d=parseFloat(d);if(isNaN(d)){return false}var f=parseFloat(g[0]);if(isNaN(f)){return true}if(d<=f){return true}return false}};mini.summaryTypes={count:function(b){if(!b){b=[]}return b.length},max:function(n,l){if(!n){n=[]}var j=null;for(var p=0,i=n.length;p<i;p++){var k=n[p];var o=parseFloat(k[l]);if(o===null||o===undefined||isNaN(o)){continue}if(j==null||j<o){j=o}}return j},min:function(n,l){if(!n){n=[]}var p=null;for(var i=0,j=n.length;i<j;i++){var k=n[i];var o=parseFloat(k[l]);if(o===null||o===undefined||isNaN(o)){continue}if(p==null||p>o){p=o}}return p},avg:function(n,l){if(!n){n=[]}if(n.length==0){return 0}var p=0;for(var q=0,j=n.length;q<j;q++){var k=n[q];var o=parseFloat(k[l]);if(o===null||o===undefined||isNaN(o)){continue}p+=o}var i=p/n.length;return i},sum:function(n,l){if(!n){n=[]}var p=0;for(var i=0,j=n.length;i<j;i++){var k=n[i];var o=parseFloat(k[l]);if(o===null||o===undefined||isNaN(o)){continue}p+=o}return p}};mini.formatCurrency=function(f,g){if(f===null||f===undefined){null==""}f=String(f).replace(/\$|\,/g,"");if(isNaN(f)){f="0"}sign=(f==(f=Math.abs(f)));f=Math.floor(f*100+0.50000000001);cents=f%100;f=Math.floor(f/100).toString();if(cents<10){cents="0"+cents}for(var d=0;d<Math.floor((f.length-(1+d))/3);d++){f=f.substring(0,f.length-(4*d+3))+","+f.substring(f.length-(4*d+3))}g=g||"";return g+(((sign)?"":"-")+f+"."+cents)};mini.emptyFn=function(){};mini.Drag=function(b){mini.copyTo(this,b)};mini.Drag.prototype={onStart:mini.emptyFn,onMove:mini.emptyFn,onStop:mini.emptyFn,capture:false,fps:20,event:null,delay:80,start:function(c){c.preventDefault();if(c){this.event=c}this.now=this.init=[this.event.pageX,this.event.pageY];var d=document;mini.on(d,"mousemove",this.move,this);mini.on(d,"mouseup",this.stop,this);mini.on(d,"contextmenu",this.contextmenu,this);if(this.context){mini.on(this.context,"contextmenu",this.contextmenu,this)}this.trigger=c.target;mini.selectable(this.trigger,false);mini.selectable(d.body,false);if(this.capture){if(isIE){this.trigger.setCapture(true)}else{if(document.captureEvents){document.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP|Event.MOUSEDOWN)}}}this.started=false;this.startTime=new Date()},contextmenu:function(b){if(this.context){mini.un(this.context,"contextmenu",this.contextmenu,this)}mini.un(document,"contextmenu",this.contextmenu,this);b.preventDefault();b.stopPropagation()},move:function(c){if(this.delay){if(new Date()-this.startTime<this.delay){return}}if(!this.started){this.started=true;this.onStart(this)}var d=this;if(!this.timer){this.timer=setTimeout(function(){d.now=[c.pageX,c.pageY];d.event=c;d.onMove(d);d.timer=null},5)}},stop:function(j){this.now=[j.pageX,j.pageY];this.event=j;if(this.timer){clearTimeout(this.timer);this.timer=null}var f=document;mini.selectable(this.trigger,true);mini.selectable(f.body,true);if(isIE){this.trigger.setCapture(false);this.trigger.releaseCapture()}var i=mini.MouseButton.Right!=j.button;if(i==false){j.preventDefault()}mini.un(f,"mousemove",this.move,this);mini.un(f,"mouseup",this.stop,this);var g=this;setTimeout(function(){mini.un(document,"contextmenu",g.contextmenu,g);if(g.context){mini.un(g.context,"contextmenu",g.contextmenu,g)}},1);if(this.started){this.onStop(this,i)}}};mini.JSON=new (function(){var sb=[];var _dateFormat=null;var useHasOwn=!!{}.hasOwnProperty,replaceString=function(a,b){var c=m[b];if(c){return c}c=b.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)},doEncode=function(o,field){if(o===null){sb[sb.length]="null";return}var t=typeof o;if(t=="undefined"){sb[sb.length]="null";return}else{if(o.push){sb[sb.length]="[";var b,i,l=o.length,v;for(i=0;i<l;i+=1){v=o[i];t=typeof v;if(t=="undefined"||t=="function"||t=="unknown"){}else{if(b){sb[sb.length]=","}doEncode(v);b=true}}sb[sb.length]="]";return}else{if(o.getFullYear){if(_dateFormat){sb[sb.length]='"';if(typeof _dateFormat=="function"){sb[sb.length]=_dateFormat(o,field)}else{sb[sb.length]=mini.formatDate(o,_dateFormat)}sb[sb.length]='"'}else{var n;sb[sb.length]='"';sb[sb.length]=o.getFullYear();sb[sb.length]="-";n=o.getMonth()+1;sb[sb.length]=n<10?"0"+n:n;sb[sb.length]="-";n=o.getDate();sb[sb.length]=n<10?"0"+n:n;sb[sb.length]="T";n=o.getHours();sb[sb.length]=n<10?"0"+n:n;sb[sb.length]=":";n=o.getMinutes();sb[sb.length]=n<10?"0"+n:n;sb[sb.length]=":";n=o.getSeconds();sb[sb.length]=n<10?"0"+n:n;sb[sb.length]='"'}return}else{if(t=="string"){if(strReg1.test(o)){sb[sb.length]='"';sb[sb.length]=o.replace(strReg2,replaceString);sb[sb.length]='"';return}sb[sb.length]='"'+o+'"';return}else{if(t=="number"){sb[sb.length]=o;return}else{if(t=="boolean"){sb[sb.length]=String(o);return}else{sb[sb.length]="{";var b,i,v;for(i in o){if(!useHasOwn||Object.prototype.hasOwnProperty.call(o,i)){v=o[i];t=typeof v;if(t=="undefined"||t=="function"||t=="unknown"){}else{if(b){sb[sb.length]=","}doEncode(i);sb[sb.length]=":";doEncode(v,i);b=true}}}sb[sb.length]="}";return}}}}}}},m={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},strReg1=/["\\\x00-\x1f]/,strReg2=/([\x00-\x1f\\"])/g;this.encode=function(){var ec;return function(o,dateFormat){sb=[];_dateFormat=dateFormat;doEncode(o);_dateFormat=null;return sb.join("")}}();this.decode=function(){var dateRe1=/^(\d{4})-(\d{2})-(\d{2})[T ](\d{2}):(\d{2}):(\d{2}(?:\.*\d*)?)Z*$/;var dateRe2=new RegExp("^/+Date\\((-?[0-9]+).*\\)/+$","g");var re=/[\"\'](\d{4})-(\d{2})-(\d{2})[T ](\d{2}):(\d{2}):(\d{2})[\"\']/g;return function(json,parseDate){if(json===""||json===null||json===undefined){return json}if(typeof json=="object"){json=this.encode(json)}function evalParse(json){if(parseDate!==false){json=json.replace(__js_dateRegEx,"$1new Date($2)");json=json.replace(re,"new Date($1,$2-1,$3,$4,$5,$6)");json=json.replace(__js_dateRegEx2,"new Date($1)")}return eval("("+json+")")}var data=null;if(window.JSON&&window.JSON.parse){var dateReviver=function(key,value){if(typeof value==="string"&&parseDate!==false){dateRe1.lastIndex=0;var a=dateRe1.exec(value);if(a){value=new Date(a[1],a[2]-1,a[3],a[4],a[5],a[6]);return value}dateRe2.lastIndex=0;var a=dateRe2.exec(value);if(a){value=new Date(parseInt(a[1]));return value}}return value};try{var json2=json.replace(__js_dateRegEx,'$1"/Date($2)/"');data=window.JSON.parse(json2,dateReviver)}catch(ex){data=evalParse(json)}}else{data=evalParse(json)}return data}}()})();__js_dateRegEx=new RegExp('(^|[^\\\\])\\"\\\\/Date\\((-?[0-9]+)(?:[a-zA-Z]|(?:\\+|-)[0-9]{4})?\\)\\\\/\\"',"g");__js_dateRegEx2=new RegExp("[\"']/Date\\(([0-9]+)\\)/[\"']","g");mini.encode=mini.JSON.encode;mini.decode=mini.JSON.decode;mini.clone=function(i,k){if(i===null||i===undefined){return i}var f=mini.encode(i);var j=mini.decode(f);function g(n){for(var c=0,l=n.length;c<l;c++){var a=n[c];delete a._state;delete a._id;delete a._pid;delete a._uid;for(var b in a){var d=a[b];if(d instanceof Array){g(d)}}}}if(k!==false){g(j instanceof Array?j:[j])}return j};var DAY_MS=86400000,HOUR_MS=3600000,MINUTE_MS=60000;mini.copyTo(mini,{clearTime:function(b){if(!b){return null}return new Date(b.getFullYear(),b.getMonth(),b.getDate())},maxTime:function(b){if(!b){return null}return new Date(b.getFullYear(),b.getMonth(),b.getDate(),23,59,59)},cloneDate:function(b){if(!b){return null}return new Date(b.getTime())},addDate:function(d,f,g){if(!g){g="D"}d=new Date(d.getTime());switch(g.toUpperCase()){case"Y":d.setFullYear(d.getFullYear()+f);break;case"MO":d.setMonth(d.getMonth()+f);break;case"D":d.setDate(d.getDate()+f);break;case"H":d.setHours(d.getHours()+f);break;case"M":d.setMinutes(d.getMinutes()+f);break;case"S":d.setSeconds(d.getSeconds()+f);break;case"MS":d.setMilliseconds(d.getMilliseconds()+f);break}return d},getWeek:function(q,s,o){var n=Math.floor((14-(s))/12);var p=q+4800-n;var t=(s)+(12*n)-3;var l=o+Math.floor(((153*t)+2)/5)+(365*p)+Math.floor(p/4)-Math.floor(p/100)+Math.floor(p/400)-32045;var a=(l+31741-(l%7))%146097%36524%1461;var r=Math.floor(a/1460);var u=((a-r)%365)+r;NumberOfWeek=Math.floor(u/7)+1;return NumberOfWeek},getWeekStartDate:function(k,j){if(!j){j=0}if(j>6||j<0){throw new Error("out of weekday")}var g=k.getDay();var d=j-g;if(g<j){d-=7}var i=new Date(k.getFullYear(),k.getMonth(),k.getDate()+d);return i},getShortWeek:function(d){var c=this.dateInfo.daysShort;return c[d]},getLongWeek:function(d){var c=this.dateInfo.daysLong;return c[d]},getShortMonth:function(c){var d=this.dateInfo.monthsShort;return d[c]},getLongMonth:function(c){var d=this.dateInfo.monthsLong;return d[c]},dateInfo:{monthsLong:["January","Febraury","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],daysLong:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Su","Mo","Tu","We","Th","Fr","Sa"],quarterLong:["Q1","Q2","Q3","Q4"],quarterShort:["Q1","Q2","Q3","Q4"],halfYearLong:["first half","second half"],patterns:{d:"M/d/yyyy",D:"dddd, MMMM dd, yyyy",f:"dddd, MMMM dd, yyyy H:mm tt",F:"dddd, MMMM dd, yyyy H:mm:ss tt",g:"M/d/yyyy H:mm tt",G:"M/d/yyyy H:mm:ss tt",m:"MMMM dd",o:"yyyy-MM-ddTHH:mm:ss.fff",s:"yyyy-MM-ddTHH:mm:ss",t:"H:mm tt",T:"H:mm:ss tt",U:"dddd, MMMM dd, yyyy HH:mm:ss tt",y:"MMM, yyyy"},tt:{AM:"AM",PM:"PM"},ten:{Early:"Early",Mid:"Mid",Late:"Late"},today:"Today",clockType:24}});Date.prototype.getHalfYear=function(){if(!this.getMonth){return null}var b=this.getMonth();if(b<6){return 0}return 1};Date.prototype.getQuarter=function(){if(!this.getMonth){return null}var b=this.getMonth();if(b<3){return 0}if(b<6){return 1}if(b<9){return 2}return 3};mini.formatDate=function(E,s,u){if(!E||!E.getFullYear||isNaN(E)){return""}var H=E.toString();var I=mini.dateInfo;if(!I){I=mini.dateInfo}if(typeof(I)!=="undefined"){var z=typeof(I.patterns[s])!=="undefined"?I.patterns[s]:s;var y=E.getFullYear();var A=E.getMonth();var x=E.getDate();if(s=="yyyy-MM-dd"){A=A+1<10?"0"+(A+1):A+1;x=x<10?"0"+x:x;return y+"-"+A+"-"+x}if(s=="MM/dd/yyyy"){A=A+1<10?"0"+(A+1):A+1;x=x<10?"0"+x:x;return A+"/"+x+"/"+y}H=z.replace(/yyyy/g,y);H=H.replace(/yy/g,(y+"").substring(2));var v=E.getHalfYear();H=H.replace(/hy/g,I.halfYearLong[v]);var G=E.getQuarter();H=H.replace(/Q/g,I.quarterLong[G]);H=H.replace(/q/g,I.quarterShort[G]);H=H.replace(/MMMM/g,I.monthsLong[A].escapeDateTimeTokens());H=H.replace(/MMM/g,I.monthsShort[A].escapeDateTimeTokens());H=H.replace(/MM/g,A+1<10?"0"+(A+1):A+1);H=H.replace(/(\\)?M/g,function(a,b){return b?a:A+1});var F=E.getDay();H=H.replace(/dddd/g,I.daysLong[F].escapeDateTimeTokens());H=H.replace(/ddd/g,I.daysShort[F].escapeDateTimeTokens());H=H.replace(/dd/g,x<10?"0"+x:x);H=H.replace(/(\\)?d/g,function(a,b){return b?a:x});var C=E.getHours();var w=C>12?C-12:C;if(I.clockType==12){if(C>12){C-=12}}H=H.replace(/HH/g,C<10?"0"+C:C);H=H.replace(/(\\)?H/g,function(a,b){return b?a:C});H=H.replace(/hh/g,w<10?"0"+w:w);H=H.replace(/(\\)?h/g,function(a,b){return b?a:w});var D=E.getMinutes();H=H.replace(/mm/g,D<10?"0"+D:D);H=H.replace(/(\\)?m/g,function(a,b){return b?a:D});var t=E.getSeconds();H=H.replace(/ss/g,t<10?"0"+t:t);H=H.replace(/(\\)?s/g,function(a,b){return b?a:t});H=H.replace(/fff/g,E.getMilliseconds());H=H.replace(/tt/g,E.getHours()>12||E.getHours()==0?I.tt.PM:I.tt.AM);var E=E.getDate();var B="";if(E<=10){B=I.ten.Early}else{if(E<=20){B=I.ten.Mid}else{B=I.ten.Late}}H=H.replace(/ten/g,B)}return H.replace(/\\/g,"")};String.prototype.escapeDateTimeTokens=function(){return this.replace(/([dMyHmsft])/g,"\\$1")};mini.fixDate=function(c,d){if(+c){while(c.getDate()!=d.getDate()){c.setTime(+c+(c<d?1:-1)*HOUR_MS)}}};mini.parseDate=function(s,ignoreTimezone){try{var d=eval(s);if(d&&d.getFullYear){return d}}catch(ex){}if(typeof s=="object"){return isNaN(s)?null:s}if(typeof s=="number"){var d=new Date(s*1000);if(d.getTime()!=s){return null}return isNaN(d)?null:d}if(typeof s=="string"){m=s.match(/^([0-9]{4})([0-9]{2})([0-9]{2})$/);if(m){var date=new Date(m[1],m[2]-1,m[3]);return date}m=s.match(/^([0-9]{4}).([0-9]*)$/);if(m){var date=new Date(m[1],m[2]-1);return date}if(s.match(/^\d+(\.\d+)?$/)){var d=new Date(parseFloat(s)*1000);if(d.getTime()!=s){return null}else{return d}}if(ignoreTimezone===undefined){ignoreTimezone=true}var d=mini.parseISO8601(s,ignoreTimezone)||(s?new Date(s):null);return isNaN(d)?null:d}return null};mini.parseISO8601=function(k,g){var i=k.match(/^([0-9]{4})([-\/]([0-9]{1,2})([-\/]([0-9]{1,2})([T ]([0-9]{1,2}):([0-9]{1,2})(:([0-9]{1,2})(\.([0-9]+))?)?(Z|(([-+])([0-9]{2})(:?([0-9]{2}))?))?)?)?)?$/);if(!i){i=k.match(/^([0-9]{4})[-\/]([0-9]{2})[-\/]([0-9]{2})[T ]([0-9]{1,2})/);if(i){var l=new Date(i[1],i[2]-1,i[3],i[4]);return l}i=k.match(/^([0-9]{4}).([0-9]*)/);if(i){var l=new Date(i[1],i[2]-1);return l}i=k.match(/^([0-9]{4}).([0-9]*).([0-9]*)/);if(i){var l=new Date(i[1],i[2]-1,i[3]);return l}i=k.match(/^([0-9]{2})-([0-9]{2})-([0-9]{4})$/);if(!i){return null}else{var l=new Date(i[3],i[1]-1,i[2]);return l}}var l=new Date(i[1],0,1);if(g||!i[14]){var n=new Date(i[1],0,1,9,0);if(i[3]){l.setMonth(i[3]-1);n.setMonth(i[3]-1)}if(i[5]){l.setDate(i[5]);n.setDate(i[5])}mini.fixDate(l,n);if(i[7]){l.setHours(i[7])}if(i[8]){l.setMinutes(i[8])}if(i[10]){l.setSeconds(i[10])}if(i[12]){l.setMilliseconds(Number("0."+i[12])*1000)}mini.fixDate(l,n)}else{l.setUTCFullYear(i[1],i[3]?i[3]-1:0,i[5]||1);l.setUTCHours(i[7]||0,i[8]||0,i[10]||0,i[12]?Number("0."+i[12])*1000:0);var j=Number(i[16])*60+(i[18]?Number(i[18]):0);j*=i[15]=="-"?1:-1;l=new Date(+l+(j*60*1000))}return l};mini.parseTime=function(p,n){if(!p){return null}var k=parseInt(p);if(k==p&&n){l=new Date(0);if(n[0]=="H"){l.setHours(k)}else{if(n[0]=="m"){l.setMinutes(k)}else{if(n[0]=="s"){l.setSeconds(k)}}}return l}var l=mini.parseDate(p);if(!l){var d=p.split(":");var o=parseInt(parseFloat(d[0]));var q=parseInt(parseFloat(d[1]));var j=parseInt(parseFloat(d[2]));if(!isNaN(o)&&!isNaN(q)&&!isNaN(j)){l=new Date(0);l.setHours(o);l.setMinutes(q);l.setSeconds(j)}if(!isNaN(o)&&(n=="H"||n=="HH")){l=new Date(0);l.setHours(o)}else{if(!isNaN(o)&&!isNaN(q)&&(n=="H:mm"||n=="HH:mm")){l=new Date(0);l.setHours(o);l.setMinutes(q)}else{if(!isNaN(o)&&!isNaN(q)&&n=="mm:ss"){l=new Date(0);l.setMinutes(o);l.setSeconds(q)}}}}return l};mini.dateInfo={monthsLong:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthsShort:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],daysLong:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],daysShort:["日","一","二","三","四","五","六"],quarterLong:["一季度","二季度","三季度","四季度"],quarterShort:["Q1","Q2","Q2","Q4"],halfYearLong:["上半年","下半年"],patterns:{d:"yyyy-M-d",D:"yyyy年M月d日",f:"yyyy年M月d日 H:mm",F:"yyyy年M月d日 H:mm:ss",g:"yyyy-M-d H:mm",G:"yyyy-M-d H:mm:ss",m:"MMMd日",o:"yyyy-MM-ddTHH:mm:ss.fff",s:"yyyy-MM-ddTHH:mm:ss",t:"H:mm",T:"H:mm:ss",U:"yyyy年M月d日 HH:mm:ss",y:"yyyy年MM月"},tt:{AM:"上午",PM:"下午"},ten:{Early:"上旬",Mid:"中旬",Late:"下旬"},today:"今天",clockType:24};mini.append=function(g,f){g=mini.byId(g);if(!f||!g){return}if(typeof f=="string"){if(f.charAt(0)=="#"){f=mini.byId(f);if(!f){return}g.appendChild(f);return f}else{if(f.indexOf("<tr")==0){return jQuery(g).append(f)[0].lastChild;return}var d=document.createElement("div");d.innerHTML=f;f=d.firstChild;while(d.firstChild){g.appendChild(d.firstChild)}return f}}else{g.appendChild(f);return f}};mini.prepend=function(g,f){if(typeof f=="string"){if(f.charAt(0)=="#"){f=mini.byId(f)}else{var d=document.createElement("div");d.innerHTML=f;f=d.firstChild}}return jQuery(g).prepend(f)[0].firstChild};mini.after=function(g,f){if(typeof f=="string"){if(f.charAt(0)=="#"){f=mini.byId(f)}else{var d=document.createElement("div");d.innerHTML=f;f=d.firstChild}}if(!f||!g){return}g.nextSibling?g.parentNode.insertBefore(f,g.nextSibling):g.parentNode.appendChild(f);return f};mini.before=function(g,f){if(typeof f=="string"){if(f.charAt(0)=="#"){f=mini.byId(f)}else{var d=document.createElement("div");d.innerHTML=f;f=d.firstChild}}if(!f||!g){return}g.parentNode.insertBefore(f,g);return f};mini.__wrap=document.createElement("div");mini.createElements=function(c){mini.removeChilds(mini.__wrap);var d=c.indexOf("<tr")==0;if(d){c="<table>"+c+"</table>"}mini.__wrap.innerHTML=c;return d?mini.__wrap.firstChild.rows:mini.__wrap.childNodes};mini_byId=function(k,n){if(typeof k=="string"){if(k.charAt(0)=="#"){k=k.substr(1)}var l=document.getElementById(k);if(l){return l}if(n&&!mini.isAncestor(document.body,n)){var o=n.getElementsByTagName("*");for(var i=0,j=o.length;i<j;i++){var l=o[i];if(l.id==k){return l}}l=null}return l}else{return k}};mini_hasClass=function(g,d){g=mini.byId(g);if(!g){return}if(!g.className){return false}var f=String(g.className).split(" ");return f.indexOf(d)!=-1};mini_addClass=function(c,d){if(!d){return}if(mini.hasClass(c,d)==false){jQuery(c).addClass(d)}};mini_removeClass=function(c,d){if(!d){return}jQuery(c).removeClass(d)};mini_getMargins=function(d){d=mini.byId(d);var c=jQuery(d);return{top:parseInt(c.css("margin-top"),10)||0,left:parseInt(c.css("margin-left"),10)||0,bottom:parseInt(c.css("margin-bottom"),10)||0,right:parseInt(c.css("margin-right"),10)||0}};mini_getBorders=function(d){d=mini.byId(d);var c=jQuery(d);return{top:parseInt(c.css("border-top-width"),10)||0,left:parseInt(c.css("border-left-width"),10)||0,bottom:parseInt(c.css("border-bottom-width"),10)||0,right:parseInt(c.css("border-right-width"),10)||0}};mini_getPaddings=function(d){d=mini.byId(d);var c=jQuery(d);return{top:parseInt(c.css("padding-top"),10)||0,left:parseInt(c.css("padding-left"),10)||0,bottom:parseInt(c.css("padding-bottom"),10)||0,right:parseInt(c.css("padding-right"),10)||0}};mini_setWidth=function(i,j){i=mini.byId(i);j=parseInt(j);if(isNaN(j)||!i){return}if(jQuery.boxModel){var g=mini.getPaddings(i);var b=mini.getBorders(i);j=j-g.left-g.right-b.left-b.right}if(j<0){j=0}i.style.width=j+"px"};mini_setHeight=function(i,j){i=mini.byId(i);j=parseInt(j);if(isNaN(j)||!i){return}if(jQuery.boxModel){var g=mini.getPaddings(i);var b=mini.getBorders(i);j=j-g.top-g.bottom-b.top-b.bottom}if(j<0){j=0}i.style.height=j+"px"};mini_getWidth=function(d,c){d=mini.byId(d);if(d.style.display=="none"||d.type=="text/javascript"){return 0}return c?jQuery(d).width():jQuery(d).outerWidth()};mini_getHeight=function(d,c){d=mini.byId(d);if(d.style.display=="none"||d.type=="text/javascript"){return 0}return c?jQuery(d).height():jQuery(d).outerHeight()};mini_setBox=function(k,g,j,l,i){if(j===undefined){j=g.y;l=g.width;i=g.height;g=g.x}mini.setXY(k,g,j);mini.setWidth(k,l);mini.setHeight(k,i)};mini_getBox=function(f){var g=mini.getXY(f);var d={x:g[0],y:g[1],width:mini.getWidth(f),height:mini.getHeight(f)};d.left=d.x;d.top=d.y;d.right=d.x+d.width;d.bottom=d.y+d.height;return d};mini_setStyle=function(t,u){t=mini.byId(t);if(!t||typeof u!="string"){return}var s=jQuery(t);var n=u.toLowerCase().split(";");for(var q=0,r=n.length;q<r;q++){var l=n[q];var i=l.split(":");if(i.length>1){if(i.length>2){var o=i[0].trim();i.removeAt(0);var p=i.join(":").trim();s.css(o,p)}else{s.css(i[0].trim(),i[1].trim())}}}};mini_getStyle=function(){var b=document.defaultView;return new Function("el","style",["style.indexOf('-')>-1 && (style=style.replace(/-(\\w)/g,function(m,a){return a.toUpperCase()}));","style=='float' && (style='",b?"cssFloat":"styleFloat","');return el.style[style] || ",b?"window.getComputedStyle(el, null)[style]":"el.currentStyle[style]"," || null;"].join(""))}();mini_isAncestor=function(j,i){var g=false;j=mini.byId(j);i=mini.byId(i);if(j===i){return true}if(j&&i){if(j.contains){try{return j.contains(i)}catch(c){return false}}else{if(j.compareDocumentPosition){return !!(j.compareDocumentPosition(i)&16)}else{while(i=i.parentNode){g=i==j||g}}}}return g};mini_findParent=function(k,n,i){k=mini.byId(k);var b=document.body,j=0,l;i=i||50;if(typeof i!="number"){l=mini.byId(i);i=10}while(k&&k.nodeType==1&&j<i&&k!=b&&k!=l){if(mini.hasClass(k,n)){return k}j++;k=k.parentNode}return null};mini.copyTo(mini,{byId:mini_byId,hasClass:mini_hasClass,addClass:mini_addClass,removeClass:mini_removeClass,getMargins:mini_getMargins,getBorders:mini_getBorders,getPaddings:mini_getPaddings,setWidth:mini_setWidth,setHeight:mini_setHeight,getWidth:mini_getWidth,getHeight:mini_getHeight,setBox:mini_setBox,getBox:mini_getBox,setStyle:mini_setStyle,getStyle:mini_getStyle,repaint:function(b){if(!b){b=document.body}mini.addClass(b,"mini-repaint");setTimeout(function(){mini.removeClass(b,"mini-repaint")},1)},getSize:function(d,c){return{width:mini.getWidth(d,c),height:mini.getHeight(d,c)}},setSize:function(g,d,f){mini.setWidth(g,d);mini.setHeight(g,f)},setX:function(f,g){g=parseInt(g);var j=jQuery(f).offset();var i=parseInt(j.top);if(i===undefined){i=j[1]}mini.setXY(f,g,i)},setY:function(f,i){i=parseInt(i);var j=jQuery(f).offset();var g=parseInt(j.left);if(g===undefined){g=j[0]}mini.setXY(f,g,i)},setXY:function(f,g,i){var j={left:parseInt(g),top:parseInt(i)};jQuery(f).offset(j);jQuery(f).offset(j)},getXY:function(d){var c=jQuery(d).offset();return[parseInt(c.left),parseInt(c.top)]},getViewportBox:function(){var f=jQuery(window).width(),j=jQuery(window).height();var g=jQuery(document).scrollLeft(),i=jQuery(document.body).scrollTop();if(i==0&&document.documentElement){i=document.documentElement.scrollTop}return{x:g,y:i,top:i,left:g,width:f,height:j,right:g+f,bottom:i+j}},showAt:function(n){var t=jQuery;n=t.extend({el:null,x:"center",y:"center",offset:[0,0],fixed:false,zindex:mini.zindex(),timeout:0,timeoutHandler:null,animation:false},n);var w=t(n.el)[0],r=n.x,s=n.y,x=n.offset[0],y=n.offset[1],q=n.zindex,u=n.fixed,v=n.animation;if(!w){return}if(n.timeout){setTimeout(function(){if(n.timeoutHandler){n.timeoutHandler()}},n.timeout)}var o=";position:absolute;display:block;left:auto;top:auto;right:auto;bottom:auto;margin:0;z-index:"+q+";";mini.setStyle(w,o);var o="";if(n&&mini.isNumber(n.x)&&mini.isNumber(n.y)){if(n.fixed&&!mini.isIE6){o+=";position:fixed;"}mini.setStyle(w,o);mini.setXY(n.el,n.x,n.y);return}if(r=="left"){o+="left:"+x+"px;"}else{if(r=="right"){o+="right:"+x+"px;"}else{var p=mini.getSize(w);o+="left:50%;margin-left:"+(-p.width*0.5)+"px;"}}if(s=="top"){o+="top:"+y+"px;"}else{if(s=="bottom"){o+="bottom:"+y+"px;"}else{var p=mini.getSize(w);o+="top:50%;margin-top:"+(-p.height*0.5)+"px;"}}if(u&&!mini.isIE6){o+="position:fixed"}mini.setStyle(w,o)},getChildNodes:function(l,n){l=mini.byId(l);if(!l){return}var c=l.childNodes;var o=[];for(var p=0,i=c.length;p<i;p++){var k=c[p];if(k.nodeType==1||n===true){o.push(k)}}return o},removeChilds:function(k,i){k=mini.byId(k);if(!k){return}var l=mini.getChildNodes(k,true);for(var n=0,c=l.length;n<c;n++){var j=l[n];if(i&&j==i){}else{k.removeChild(l[n])}}},isAncestor:mini_isAncestor,findParent:mini_findParent,findChild:function(j,g){j=mini.byId(j);var k=j.getElementsByTagName("*");for(var l=0,i=k.length;l<i;l++){var j=k[l];if(mini.hasClass(j,g)){return j}}},isAncestor:function(j,i){var g=false;j=mini.byId(j);i=mini.byId(i);if(j===i){return true}if(j&&i){if(j.contains){try{return j.contains(i)}catch(c){return false}}else{if(j.compareDocumentPosition){return !!(j.compareDocumentPosition(i)&16)}else{while(i=i.parentNode){g=i==j||g}}}}return g},getOffsetsTo:function(g,j){var i=this.getXY(g),f=this.getXY(j);return[i[0]-f[0],i[1]-f[1]]},scrollIntoView:function(w,y,v){var c=mini.byId(y)||document.body,x=this.getOffsetsTo(w,c),r=x[0]+c.scrollLeft,B=x[1]+c.scrollTop,b=B+w.offsetHeight,z=r+w.offsetWidth,A=c.clientHeight,o=parseInt(c.scrollTop,10),C=parseInt(c.scrollLeft,10),t=o+A,l=C+c.clientWidth;if(w.offsetHeight>A||B<o){c.scrollTop=B}else{if(b>t){c.scrollTop=b-A}}c.scrollTop=c.scrollTop;if(v!==false){if(w.offsetWidth>c.clientWidth||r<C){c.scrollLeft=r}else{if(z>l){c.scrollLeft=z-c.clientWidth}}c.scrollLeft=c.scrollLeft}return this},setOpacity:function(c,d){jQuery(c).css({opacity:d})},selectable:function(c,d){c=mini.byId(c);if(!!d){jQuery(c).removeClass("mini-unselectable");if(isIE){c.unselectable="off"}else{c.style.MozUserSelect="";c.style.KhtmlUserSelect="";c.style.UserSelect=""}}else{jQuery(c).addClass("mini-unselectable");if(isIE){c.unselectable="on"}else{c.style.MozUserSelect="none";c.style.UserSelect="none";c.style.KhtmlUserSelect="none"}}},selectRange:function(l,g,i){if(l.createTextRange){var j=l.createTextRange();j.moveStart("character",g);j.moveEnd("character",i-l.value.length);j.select()}else{if(l.setSelectionRange){l.setSelectionRange(g,i)}}try{l.focus()}catch(k){}},getSelectRange:function(g){g=mini.byId(g);if(!g){return}try{g.focus()}catch(k){}var j=0,i=0;if(g.createTextRange&&document.selection){var l=document.selection.createRange().duplicate();l.moveEnd("character",g.value.length);if(l.text===""){j=g.value.length}else{j=g.value.lastIndexOf(l.text)}var l=document.selection.createRange().duplicate();l.moveStart("character",-g.value.length);i=l.text.length}else{j=g.selectionStart;i=g.selectionEnd}return[j,i]}});(function(){var f={tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"};var g=document.createElement("div");g.setAttribute("class","t");var d=g.className==="t";mini.setAttr=function(b,c,a){b.setAttribute(d?c:(f[c]||c),a)};mini.getAttr=function(b,c){if(c=="value"&&(isIE6||isIE7)){var k=b.attributes[c];return k?k.value:null}var j=b.getAttribute(d?c:(f[c]||c));if(typeof j=="function"){j=b.attributes[c].value}if(!j&&c=="onload"){var a=b.getAttributeNode?b.getAttributeNode(c):null;if(a){j=a.nodeValue}}return j}})();mini_preventDefault=function(){if(window.event){window.event.returnValue=false}};mini_stopPropogation=function(){if(window.event){window.event.cancelBubble=true}};mini_onOne=function(j,k,l,g){if(!j){return}var i="on"+k.toLowerCase();j[i]=function(a){a=a||window.event;if(!a.target){a.target=a.srcElement}if(!a.preventDefault){a.preventDefault=mini_preventDefault}if(!a.stopPropogation){a.stopPropogation=mini_stopPropogation}var b=l.call(g,a);if(b===false){return false}}};mini_on=function(n,o,i,j){n=mini.byId(n);j=j||n;if(!n||!o||!i||!j){return false}var l=mini.findListener(n,o,i,j);if(l){return false}var k=mini.createDelegate(i,j);mini.listeners.push([n,o,i,j,k]);if(mini.isFirefox&&o=="mousewheel"){o="DOMMouseScroll"}jQuery(n).bind(o,k)};mini_un=function(k,l,g,i){k=mini.byId(k);i=i||k;if(!k||!l||!g||!i){return false}var j=mini.findListener(k,l,g,i);if(!j){return false}mini.listeners.remove(j);if(mini.isFirefox&&l=="mousewheel"){l="DOMMouseScroll"}jQuery(k).unbind(l,j[4])};mini.copyTo(mini,{listeners:[],on:mini_on,un:mini_un,_getListeners:function(){var k=mini.listeners;for(var l=k.length-1;l>=0;l--){var j=k[l];try{if(j[0]==1&&j[1]==1&&j[2]==1&&j[3]==1){var i=1}}catch(g){k.removeAt(l)}}return k},findListener:function(n,o,p,q){n=mini.byId(n);q=q||n;if(!n||!o||!p||!q){return false}var r=mini._getListeners();for(var i=r.length-1;i>=0;i--){var l=r[i];try{if(l[0]==n&&l[1]==o&&l[2]==p&&l[3]==q){return l}}catch(k){}}},clearEvent:function(k,l){k=mini.byId(k);if(!k){return false}var g=mini._getListeners();for(var i=g.length-1;i>=0;i--){var j=g[i];if(j[0]==k){if(!l||l==j[1]){mini.un(k,j[1],j[2],j[3])}}}k.onmouseover=k.onmousedown=null}});mini.__windowResizes=[];mini.onWindowResize=function(c,d){mini.__windowResizes.push([c,d])};mini.on(window,"resize",function(j){var l=mini.__windowResizes;for(var g=0,i=l.length;g<i;g++){var k=l[g];k[0].call(k[1],j)}});mini.htmlEncode=function(c){if(typeof c!=="string"){return c}var d="";if(c.length==0){return""}d=c;d=d.replace(/&/g,"&amp;");d=d.replace(/</g,"&lt;");d=d.replace(/>/g,"&gt;");d=d.replace(/ /g,"&nbsp;");d=d.replace(/\'/g,"&#39;");d=d.replace(/\"/g,"&quot;");return d};mini.htmlDecode=function(c){if(typeof c!=="string"){return c}var d="";if(c.length==0){return""}d=c.replace(/&gt;/g,"&");d=d.replace(/&lt;/g,"<");d=d.replace(/&gt;/g,">");d=d.replace(/&nbsp;/g," ");d=d.replace(/&#39;/g,"'");d=d.replace(/&quot;/g,'"');return d};mini.copyTo(Array.prototype,{add:Array.prototype.enqueue=function(b){this[this.length]=b;return this},getRange:function(j,g){var i=[];for(var l=j;l<=g;l++){var k=this[l];if(k){i[i.length]=k}}return i},addRange:function(g){for(var d=0,f=g.length;d<f;d++){this[this.length]=g[d]}return this},clear:function(){this.length=0;return this},clone:function(){if(this.length===1){return[this[0]]}else{return Array.apply(null,this)}},contains:function(b){return(this.indexOf(b)>=0)},indexOf:function(j,i){var g=this.length;for(var f=(i<0)?Math.max(0,g+i):i||0;f<g;f++){if(this[f]===j){return f}}return -1},dequeue:function(){return this.shift()},insert:function(d,c){this.splice(d,0,c);return this},insertRange:function(f,g){for(var j=g.length-1;j>=0;j--){var i=g[j];this.splice(f,0,i)}return this},remove:function(c){var d=this.indexOf(c);if(d>=0){this.splice(d,1)}return(d>=0)},removeAt:function(d){var c=this[d];this.splice(d,1);return c},removeRange:function(d){d=d.clone();for(var g=0,f=d.length;g<f;g++){this.remove(d[g])}}});mini.Keyboard={Left:37,Top:38,Right:39,Bottom:40,PageUp:33,PageDown:34,End:35,Home:36,Enter:13,ESC:27,Space:32,Tab:9,Del:46,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123};var ua=navigator.userAgent.toLowerCase(),check=function(b){return b.test(ua)},DOC=document,isStrict=document.compatMode=="CSS1Compat",version=function(g,d){var f;return(g&&(f=d.exec(ua)))?parseFloat(f[1]):0},docMode=document.documentMode,isOpera=check(/opera/),isOpera10_5=isOpera&&check(/version\/10\.5/),isChrome=check(/\bchrome\b/),isWebKit=check(/webkit/),isSafari=!isChrome&&check(/safari/),isSafari2=isSafari&&check(/applewebkit\/4/),isSafari3=isSafari&&check(/version\/3/),isSafari4=isSafari&&check(/version\/4/),isSafari5_0=isSafari&&check(/version\/5\.0/),isSafari5=isSafari&&check(/version\/5/),isIE=!isOpera&&check(/msie/),isIE7=isIE&&((check(/msie 7/)&&docMode!=8&&docMode!=9&&docMode!=10)||docMode==7),isIE8=isIE&&((check(/msie 8/)&&docMode!=7&&docMode!=9&&docMode!=10)||docMode==8),isIE9=isIE&&((check(/msie 9/)&&docMode!=7&&docMode!=8&&docMode!=10)||docMode==9),isIE10=isIE&&((check(/msie 10/)&&docMode!=7&&docMode!=8&&docMode!=9)||docMode==10),isIE6=isIE&&!isIE7&&!isIE8&&!isIE9&&!isIE10,isIE11=(ua.indexOf("trident")>-1&&ua.indexOf("rv")>-1),isFirefox=navigator.userAgent.indexOf("Firefox")>0,isGecko=!isWebKit&&check(/gecko/),isGecko3=isGecko&&check(/rv:1\.9/),isGecko4=isGecko&&check(/rv:2\.0/),isGecko5=isGecko&&check(/rv:5\./),isGecko10=isGecko&&check(/rv:10\./),isFF3_0=isGecko3&&check(/rv:1\.9\.0/),isFF3_5=isGecko3&&check(/rv:1\.9\.1/),isFF3_6=isGecko3&&check(/rv:1\.9\.2/),isWindows=check(/windows|win32/),isMac=check(/macintosh|mac os x/),isAir=check(/adobeair/),isLinux=check(/linux/),scrollbarSize=null,chromeVersion=version(true,/\bchrome\/(\d+\.\d+)/),firefoxVersion=version(true,/\bfirefox\/(\d+\.\d+)/),ieVersion=version(isIE,/msie (\d+\.\d+)/),operaVersion=version(isOpera,/version\/(\d+\.\d+)/),safariVersion=version(isSafari,/version\/(\d+\.\d+)/),webKitVersion=version(isWebKit,/webkit\/(\d+\.\d+)/),isSecure=/^https/i.test(window.location.protocol),isBorderBox=isIE&&!isStrict;if(isIE6){try{DOC.execCommand("BackgroundImageCache",false,true)}catch(e){}}mini.boxModel=!isBorderBox;mini.isIE=isIE;mini.isIE6=isIE6;mini.isIE7=isIE7;mini.isIE8=isIE8;mini.isIE9=isIE9;mini.isIE10=isIE10;mini.isIE11=isIE11;mini.isFirefox=isFirefox;mini.isOpera=isOpera;mini.isSafari=isSafari;mini.isChrome=isChrome;if(jQuery){jQuery.boxModel=mini.boxModel}mini.noBorderBox=false;if(jQuery.boxModel==false&&isIE&&isIE9==false){mini.noBorderBox=true}mini.MouseButton={Left:0,Middle:1,Right:2};if(isIE&&!isIE9&&!isIE10){mini.MouseButton={Left:1,Middle:4,Right:2}}mini._MaskID=1;mini._MaskObjects={};mini.mask=function(l){var k=mini.byId(l);if(mini.isElement(k)){l={el:k}}else{if(typeof l=="string"){l={html:l}}}l=mini.copyTo({html:"",cls:"",style:"",backStyle:"background:#ccc"},l);l.el=mini.byId(l.el);if(!l.el){l.el=document.body}var k=l.el;mini.unmask(l.el);k._maskid=mini._MaskID++;mini._MaskObjects[k._maskid]=l;var j=mini.append(k,'<div class="mini-mask"><div class="mini-mask-background" style="'+l.backStyle+'"></div><div class="mini-mask-msg '+l.cls+'" style="'+l.style+'">'+l.html+"</div></div>");if(k==document.body){mini.addClass(j,"mini-fixed")}l.maskEl=j;if(!mini.isNull(l.opacity)){mini.setOpacity(j.firstChild,l.opacity)}function i(){g.style.display="block";var a=mini.getSize(g);g.style.marginLeft=-a.width/2+"px";g.style.marginTop=-a.height/2+"px"}var g=j.lastChild;g.style.display="none";setTimeout(function(){i()},0)};mini.unmask=function(d){d=mini.byId(d);if(!d){d=document.body}var f=mini._MaskObjects[d._maskid];if(!f){return}delete mini._MaskObjects[d._maskid];var g=f.maskEl;f.maskEl=null;if(g&&g.parentNode){g.parentNode.removeChild(g)}};mini.Cookie={get:function(l){var o=document.cookie.split("; ");var k=null;for(var n=0;n<o.length;n++){var j=o[n].split("=");if(l==j[0]){k=j}}if(k){var i=k[1];if(i===undefined){return i}return unescape(i)}return null},set:function(g,j,i,k){var l=new Date();if(i!=null){l=new Date(l.getTime()+(i*1000*3600*24))}document.cookie=g+"="+escape(j)+((i==null)?"":("; expires="+l.toGMTString()))+";path=/"+(k?"; domain="+k:"")},del:function(d,c){this.set(d,null,-100,c)}};mini.copyTo(mini,{treeToArray:function(y,l,w,q,r){if(!l){l="children"}var p=[];for(var t=0,u=y.length;t<u;t++){var v=y[t];p[p.length]=v;if(q){v[q]=r}var i=v[l];if(i&&i.length>0){var x=v[w];var s=this.treeToArray(i,l,w,q,x);p.addRange(s)}}return p},arrayToTree:function(p,i,t,l){if(!i){i="children"}t=t||"_id";l=l||"_pid";var w=[];var r={};for(var o=0,q=p.length;o<q;o++){var s=p[o];if(!s){continue}var u=s[t];if(u!==null&&u!==undefined){r[u]=s}delete s[i]}for(var o=0,q=p.length;o<q;o++){var s=p[o];var v=r[s[l]];if(!v){w.push(s);continue}if(!v[i]){v[i]=[]}v[i].push(s)}return w}});mini.treeToList=mini.treeToArray;mini.listToTree=mini.arrayToTree;function UUID(){var d=[],g="0123456789ABCDEF".split("");for(var f=0;f<36;f++){d[f]=Math.floor(Math.random()*16)}d[14]=4;d[19]=(d[19]&3)|8;for(var f=0;f<36;f++){d[f]=g[d[f]]}d[8]=d[13]=d[18]=d[23]="-";return d.join("")}String.format=function(c){var d=Array.prototype.slice.call(arguments,1);c=c||"";return c.replace(/\{(\d+)\}/g,function(b,a){return d[a]})};String.prototype.trim=function(){var b=/^\s+|\s+$/g;return function(){return this.replace(b,"")}}();mini.copyTo(mini,{measureText:function(s,n,t){if(!this.measureEl){this.measureEl=mini.append(document.body,"<div></div>")}this.measureEl.style.cssText="position:absolute;left:-1000px;top:-1000px;visibility:hidden;";if(typeof s=="string"){this.measureEl.className=s}else{this.measureEl.className="";var i=jQuery(s);var l=jQuery(this.measureEl);var r=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"];for(var p=0,q=r.length;p<q;p++){var o=r[p];l.css(o,i.css(o))}}if(t){mini.setStyle(this.measureEl,t)}this.measureEl.innerHTML=n;return mini.getSize(this.measureEl)}});if(typeof mini_layoutOnParse=="undefined"){mini_layoutOnParse=true}jQuery(function(){var b=new Date();mini.isReady=true;mini.parse(null,mini_layoutOnParse);mini._FireBindEvents();if((mini.getStyle(document.body,"overflow")=="hidden"||mini.getStyle(document.documentElement,"overflow")=="hidden")&&(isIE6||isIE7)){jQuery(document.body).css("overflow","visible");jQuery(document.documentElement).css("overflow","visible")}mini.__LastWindowWidth=document.documentElement.clientWidth;mini.__LastWindowHeight=document.documentElement.clientHeight});mini_onload=function(b){mini.layout(null,mini_layoutOnParse?false:true);mini.on(window,"resize",mini_onresize)};mini.on(window,"load",mini_onload);mini.__LastWindowWidth=document.documentElement.clientWidth;mini.__LastWindowHeight=document.documentElement.clientHeight;mini.doWindowResizeTimer=null;mini.allowLayout=true;mini_onresize=function(g){if(mini.doWindowResizeTimer){clearTimeout(mini.doWindowResizeTimer)}mini.WindowVisible=mini.isWindowDisplay();if(mini.WindowVisible==false||mini.allowLayout==false){return}if(typeof Ext!="undefined"){mini.doWindowResizeTimer=setTimeout(function(){var a=document.documentElement.clientWidth;var b=document.documentElement.clientHeight;if(mini.__LastWindowWidth==a&&mini.__LastWindowHeight==b){}else{mini.__LastWindowWidth=a;mini.__LastWindowHeight=b;mini.layout(null,false)}mini.doWindowResizeTimer=null},300)}else{var f=100;try{if(parent&&parent!=window&&parent.mini){f=0}}catch(d){}mini.doWindowResizeTimer=setTimeout(function(){var a=document.documentElement.clientWidth;var b=document.documentElement.clientHeight;if(mini.__LastWindowWidth==a&&mini.__LastWindowHeight==b){}else{mini.__LastWindowWidth=a;mini.__LastWindowHeight=b;mini.layout(null,false)}mini.doWindowResizeTimer=null},f)}};mini.isDisplay=function(g,f){var d=f||document.body;while(1){if(g==null||!g.style){return false}if(g&&g.style&&g.style.display=="none"){return false}if(g==d){return true}g=g.parentNode}return true};mini.isWindowDisplay=function(){try{var s=window.parent;var i=s!=window;if(i){var p=s.document.getElementsByTagName("iframe");var u=s.document.getElementsByTagName("frame");var n=[];for(var o=0,r=p.length;o<r;o++){n.push(p[o])}for(var o=0,r=u.length;o<r;o++){n.push(u[o])}var q=null;for(var o=0,r=n.length;o<r;o++){var t=n[o];if(t.contentWindow==window){q=t;break}}if(!q){return false}return mini.isDisplay(q,s.document.body)}else{return true}}catch(l){return true}};mini.WindowVisible=mini.isWindowDisplay();mini.layoutIFrames=function(d){if(!document.body){return}if(!d){d=document.body}var c=d.getElementsByTagName("iframe");setTimeout(function(){for(var b=0,j=c.length;b<j;b++){var a=c[b];try{if(mini.isDisplay(a)&&mini.isAncestor(d,a)){if(a.contentWindow.mini){if(a.contentWindow.mini.WindowVisible==false){a.contentWindow.mini.WindowVisible=a.contentWindow.mini.isWindowDisplay();a.contentWindow.mini.layout()}else{a.contentWindow.mini.layout(null,false)}}a.contentWindow.mini.layoutIFrames()}}catch(i){}}},30)};$.ajaxSetup({cache:false});if(isIE){setInterval(function(){},20000)}mini_unload=function(l){try{var n=mini._getTopWindow();n[mini._WindowID]="";delete n[mini._WindowID]}catch(i){}var p=document.body.getElementsByTagName("iframe");if(p.length>0){var q=[];for(var r=0,u=p.length;r<u;r++){q.push(p[r])}for(var r=0,u=q.length;r<u;r++){try{var t=q[r];t._ondestroy=null;t.onload=function(){};jQuery(t).unbind("load");t.src="";try{t.contentWindow.document.write("");t.contentWindow.document.close()}catch(i){}if(t.parentNode){t.parentNode.removeChild(t)}}catch(l){}}}var o=mini.getComponents();for(var r=0,u=o.length;r<u;r++){var s=o[r];if(s.destroyed!==true){s.destroy(false)}}o.length=0;o=null;mini.un(window,"unload",mini_unload);mini.un(window,"load",mini_onload);mini.un(window,"resize",mini_onresize);mini.components={};mini.classes={};mini.uiClasses={};mini.uids={};mini._topWindow=null;window.mini=null;window.Owner=null;window.CloseOwnerWindow=null;try{}catch(l){}};mini.on(window,"unload",mini_unload);function __OnIFrameMouseDown(){jQuery(document).trigger("mousedown")}function __BindIFrames(){if(mini.isIE10){return}var k=document.getElementsByTagName("iframe");for(var i=0,j=k.length;i<j;i++){var o=k[i];try{if(o.contentWindow&&o.contentWindow.document&&!o.contentWindow.__mousedownbinded){o.contentWindow.__mousedownbinded=true;var l=o.contentWindow.document}}catch(n){}}}setInterval(function(){__BindIFrames()},1500);mini.zIndex=1000;mini.zindex=mini.getMaxZIndex=function(){return mini.zIndex++};function js_isTouchDevice(){try{document.createEvent("TouchEvent");return true}catch(b){return false}}function js_touchScroll(g){if(js_isTouchDevice()){var f=typeof g=="string"?document.getElementById(g):g;var d=0;f.addEventListener("touchstart",function(a){d=this.scrollTop+a.touches[0].pageY;a.preventDefault()},false);f.addEventListener("touchmove",function(a){this.scrollTop=d-a.touches[0].pageY;a.preventDefault()},false)}}mini._placeholder=function(d){d=mini.byId(d);if(!d||!isIE||isIE10){return}function g(){var b=d._placeholder_label;if(!b){return}var a=d.getAttribute("placeholder");if(!a){a=d.placeholder}if(!d.value&&!d.disabled){b.innerHTML=a;b.style.display=""}else{b.style.display="none"}}if(d._placeholder){g();return}d._placeholder=true;var f=document.createElement("label");f.className="mini-placeholder-label";d.parentNode.appendChild(f);d._placeholder_label=f;f.onmousedown=function(){d.focus()};d.onpropertychange=function(a){a=a||window.event;if(a.propertyName=="value"){g()}};g();mini.on(d,"focus",function(a){if(!d.readOnly){f.style.display="none"}});mini.on(d,"blur",function(a){g()})};mini.ajax=function(b){if(!b.dataType){b.dataType="text"}return window.jQuery.ajax(b)};mini._evalAjaxData=function(ajaxData,scope){var obj=ajaxData;var t=typeof ajaxData;if(t=="string"){obj=eval("("+ajaxData+")");if(typeof obj=="function"){obj=obj.call(scope)}}return obj};if(!jQuery.fn.on){jQuery.fn.on=function(j,g,i,f){return this.delegate(g,j,i,f)}}if(typeof window.rootpath=="undefined"){rootpath="/"}mini.loadJS=function(d,c){if(!d){return}if(typeof c=="function"){return loadJS._async(d,c)}else{return loadJS._sync(d)}};mini.loadJS._js={};mini.loadJS._async=function(k,j){var n=mini.loadJS._js[k];if(!n){n=mini.loadJS._js[k]={create:false,loaded:false,callbacks:[]}}if(n.loaded){setTimeout(function(){j()},1);return}else{n.callbacks.push(j);if(n.create){return}}n.create=true;var i=document.getElementsByTagName("head")[0];var l=document.createElement("script");l.src=k;l.type="text/javascript";function g(){for(var b=0;b<n.callbacks.length;b++){var a=n.callbacks[b];if(a){a()}}n.callbacks.length=0}setTimeout(function(){if(document.all){l.onreadystatechange=function(){if(l.readyState=="loaded"||l.readyState=="complete"){g();n.loaded=true}}}else{l.onload=function(){g();n.loaded=true}}i.appendChild(l)},1);return l};mini.loadJS._sync=function(g){if(loadJS._js[g]){return}loadJS._js[g]={create:true,loaded:true,callbacks:[]};var f=document.getElementsByTagName("head")[0];var d=document.createElement("script");d.type="text/javascript";d.text=loadText(g);f.appendChild(d);return d};mini.loadText=function(i){var j="";var n=document.all&&location.protocol=="file:";var d=null;if(n){d=new ActiveXObject("Microsoft.XMLHTTP")}else{if(window.XMLHttpRequest){d=new XMLHttpRequest()}else{if(window.ActiveXObject){d=new ActiveXObject("Microsoft.XMLHTTP")}}}d.onreadystatechange=l;var k="_t="+new Date().getTime();if(i.indexOf("?")==-1){k="?"+k}else{k="&"+k}i+=k;d.open("GET",i,false);d.send(null);function l(){if(d.readyState==4){var a=n?0:200;if(d.status==a){j=d.responseText}else{}}}return j};mini.loadJSON=function(url){var text=loadText(url);var o=eval("("+text+")");return o};mini.loadCSS=function(j,i){if(!j){return}if(loadCSS._css[j]){return}var g=document.getElementsByTagName("head")[0];var f=document.createElement("link");if(i){f.id=i}f.href=j;f.rel="stylesheet";f.type="text/css";g.appendChild(f);return f};mini.loadCSS._css={};mini.innerHTML=function(d,f){if(typeof d=="string"){d=document.getElementById(d)}if(!d){return}f='<div style="display:none">&nbsp;</div>'+f;d.innerHTML=f;mini.__executeScripts(d);var g=d.firstChild};mini.__executeScripts=function(j){var i=j.getElementsByTagName("script");for(var o=0,d=i.length;o<d;o++){var k=i[o];var l=k.src;if(l){mini.loadJS(l)}else{var n=document.createElement("script");n.type="text/javascript";n.text=k.text;j.appendChild(n)}}for(var o=i.length-1;o>=0;o--){var k=i[o];k.parentNode.removeChild(k)}};mini.Hidden=function(){mini.Hidden.superclass.constructor.call(this)};mini.extend(mini.Hidden,mini.Control,{_clearBorder:false,formField:true,value:"",uiCls:"mini-hidden",_create:function(){this.el=document.createElement("input");this.el.type="hidden";this.el.className="mini-hidden"},setName:function(b){this.name=b;this.el.name=b},setValue:function(d){if(d===null||d===undefined){d=""}this.value=d;if(mini.isDate(d)){var g=d.getFullYear();var f=d.getMonth()+1;var i=d.getDate();f=f<10?"0"+f:f;i=i<10?"0"+i:i;this.el.value=g+"-"+f+"-"+i}else{this.el.value=d}},getValue:function(){return this.value},getFormValue:function(){return this.el.value}});mini.regClass(mini.Hidden,"hidden");mini.Popup=function(){mini.Popup.superclass.constructor.call(this);this.setVisible(false);this.setAllowDrag(this.allowDrag);this.setAllowResize(this.allowResize)};mini.extend(mini.Popup,mini.Container,{_clearBorder:false,uiCls:"mini-popup",_create:function(){var b=this.el=document.createElement("div");this.el.className="mini-popup";this._contentEl=this.el},_initEvents:function(){mini._BindEvents(function(){mini_onOne(this.el,"mouseover",this.__OnMouseOver,this)},this)},doLayout:function(){if(!this.canLayout()){return}mini.Popup.superclass.doLayout.call(this);this._doShadow();var i=this.el.childNodes;if(i){for(var f=0,g=i.length;f<g;f++){var j=i[f];mini.layout(j)}}},destroy:function(b){if(this.el){this.el.onmouseover=null}mini.un(document,"mousedown",this.__OnBodyMouseDown,this);mini.un(window,"resize",this.__OnWindowResize,this);if(this._modalEl){jQuery(this._modalEl).remove();this._modalEl=null}if(this.shadowEl){jQuery(this.shadowEl).remove();this.shadowEl=null}if(this._shim){jQuery(this._shim).remove();this._shim=null}mini.Popup.superclass.destroy.call(this,b)},setWidth:function(b){if(parseInt(b)==b){b+="px"}this.width=b;if(b.indexOf("px")!=-1){mini.setWidth(this.el,b)}else{this.el.style.width=b}this._sizeChanged()},setHeight:function(b){if(parseInt(b)==b){b+="px"}this.height=b;if(b.indexOf("px")!=-1){mini.setHeight(this.el,b)}else{this.el.style.height=b}this._sizeChanged()},setBody:function(g){if(!g){return}if(!mini.isArray(g)){g=[g]}for(var d=0,f=g.length;d<f;d++){mini.append(this._contentEl,g[d])}},getAttrs:function(g){var f=mini.Popup.superclass.getAttrs.call(this,g);mini._ParseString(g,f,["popupEl","popupCls","showAction","hideAction","xAlign","yAlign","modalStyle","onbeforeopen","open","onbeforeclose","onclose"]);mini._ParseBool(g,f,["showModal","showShadow","allowDrag","allowResize"]);mini._ParseInt(g,f,["showDelay","hideDelay","xOffset","yOffset","minWidth","minHeight","maxWidth","maxHeight"]);var d=mini.getChildNodes(g,true);f.body=d;return f}});mini.regClass(mini.Popup,"popup");mini.Popup_prototype={isPopup:false,popupEl:null,popupCls:"",showAction:"mouseover",hideAction:"outerclick",showDelay:300,hideDelay:500,xAlign:"left",yAlign:"below",xOffset:0,yOffset:0,minWidth:50,minHeight:25,maxWidth:2000,maxHeight:2000,showModal:false,showShadow:true,modalStyle:"opacity:0.2",_dragCls:"mini-popup-drag",_resizeCls:"mini-popup-resize",allowDrag:false,allowResize:false,_unbindPopupEl:function(){if(!this.popupEl){return}mini.un(this.popupEl,"click",this.__OnLeftClick,this);mini.un(this.popupEl,"contextmenu",this.__OnRightClick,this);mini.un(this.popupEl,"mouseover",this.__OnMouseOver,this)},_bindPopupEl:function(){if(!this.popupEl){return}mini.on(this.popupEl,"click",this.__OnLeftClick,this);mini.on(this.popupEl,"contextmenu",this.__OnRightClick,this);mini.on(this.popupEl,"mouseover",this.__OnMouseOver,this)},doShow:function(g){var d={popupEl:this.popupEl,htmlEvent:g,cancel:false};this.fire("BeforeOpen",d);if(d.cancel==true){return}this.fire("opening",d);if(d.cancel==true){return}if(!this.popupEl){this.show()}else{var f={};if(g){f.xy=[g.pageX,g.pageY]}this.showAtEl(this.popupEl,f)}},doHide:function(c){var d={popupEl:this.popupEl,htmlEvent:c,cancel:false};this.fire("BeforeClose",d);if(d.cancel==true){return}this.close()},show:function(c,d){this.showAtPos(c,d)},showAtPos:function(g,i){this.render(document.body);if(!g){g="center"}if(!i){i="middle"}this.el.style.position="absolute";this.el.style.left="-2000px";this.el.style.top="-2000px";this.el.style.display="";this._measureSize();var f=mini.getViewportBox();var j=mini.getBox(this.el);if(g=="left"){g=0}if(g=="center"){g=f.width/2-j.width/2}if(g=="right"){g=f.width-j.width}if(i=="top"){i=0}if(i=="middle"){i=f.y+f.height/2-j.height/2}if(i=="bottom"){i=f.height-j.height}if(g+j.width>f.right){g=f.right-j.width}if(i+j.height>f.bottom){i=f.bottom-j.height-20}this._Show(g,i)},_doModal:function(){jQuery(this._modalEl).remove();if(!this.showModal){return}if(this.visible==false){return}var g=document.documentElement;var n=parseInt(Math.max(document.body.scrollWidth,g?g.scrollWidth:0));var j=parseInt(Math.max(document.body.scrollHeight,g?g.scrollHeight:0));var l=mini.getViewportBox();var i=l.height;if(i<j){i=j}var k=l.width;if(k<n){k=n}this._modalEl=mini.append(document.body,'<div class="mini-modal"></div>');this._modalEl.style.height=i+"px";this._modalEl.style.width=k+"px";this._modalEl.style.zIndex=mini.getStyle(this.el,"zIndex")-1;mini.setStyle(this._modalEl,this.modalStyle)},_doShim:function(){if(!mini.isIE||!mini_useShims){return}if(!this._shimEl){var d="<iframe frameborder='0' style='position: absolute; z-index: -1; width: 0; height: 0; top: 0;left:0;scrolling:no;'></iframe>";this._shimEl=mini.append(document.body,d)}function f(){this._shimEl.style.display="";var a=mini.getBox(this.el);var b=this._shimEl.style;b.width=a.width+"px";b.height=a.height+"px";b.left=a.x+"px";b.top=a.y+"px";var c=mini.getStyle(this.el,"zIndex");if(!isNaN(c)){this._shimEl.style.zIndex=c-3}}this._shimEl.style.display="none";if(this._doShimTimer){clearTimeout(this._doShimTimer);this._doShimTimer=null}var g=this;this._doShimTimer=setTimeout(function(){g._doShimTimer=null;f.call(g)},20)},_doShadow:function(){if(!this.shadowEl){this.shadowEl=mini.append(document.body,'<div class="mini-shadow"></div>')}this.shadowEl.style.display=this.showShadow?"":"none";if(this.showShadow){function c(){this.shadowEl.style.display="";var a=mini.getBox(this.el);var b=this.shadowEl.style;b.width=a.width+"px";b.height=a.height+"px";b.left=a.x+"px";b.top=a.y+"px";var f=mini.getStyle(this.el,"zIndex");if(!isNaN(f)){this.shadowEl.style.zIndex=f-2}}this.shadowEl.style.display="none";if(this._doShadowTimer){clearTimeout(this._doShadowTimer);this._doShadowTimer=null}var d=this;this._doShadowTimer=setTimeout(function(){d._doShadowTimer=null;c.call(d)},20)}},_measureSize:function(){this.el.style.display="";var b=mini.getBox(this.el);if(b.width>this.maxWidth){mini.setWidth(this.el,this.maxWidth);b=mini.getBox(this.el)}if(b.height>this.maxHeight){mini.setHeight(this.el,this.maxHeight);b=mini.getBox(this.el)}if(b.width<this.minWidth){mini.setWidth(this.el,this.minWidth);b=mini.getBox(this.el)}if(b.height<this.minHeight){mini.setHeight(this.el,this.minHeight);b=mini.getBox(this.el)}},_getWindowOffset:function(b){return[0,0]},showAtEl:function(F,c){F=mini.byId(F);if(!F){return}if(!this.isRender()||this.el.parentNode!=document.body){this.render(document.body)}var A={atEl:F,popupEl:this.el,xAlign:this.xAlign,yAlign:this.yAlign,xOffset:this.xOffset,yOffset:this.yOffset,popupCls:this.popupCls};mini.copyTo(A,c);mini.addClass(F,A.popupCls);F.popupCls=A.popupCls;this._popupEl=F;this.el.style.position="absolute";this.el.style.left="-2000px";this.el.style.top="-2000px";this.el.style.display="";this.doLayout();this._measureSize();var z=mini.getViewportBox();var C=mini.getBox(this.el);var D=mini.getBox(F);var s=A.xy;var B=A.xAlign,t=A.yAlign;var w=z.width/2-C.width/2,x=0;if(s){w=s[0];x=s[1]}switch(A.xAlign){case"outleft":w=D.x-C.width;break;case"left":w=D.x;break;case"center":w=D.x+D.width/2-C.width/2;break;case"right":w=D.right-C.width;break;case"outright":w=D.right;break;default:break}switch(A.yAlign){case"above":x=D.y-C.height;break;case"top":x=D.y;break;case"middle":x=D.y+D.height/2-C.height/2;break;case"bottom":x=D.bottom-C.height;break;case"below":x=D.bottom;break;default:break}w=parseInt(w);x=parseInt(x);var v=this._getWindowOffset(c);if(A.outYAlign||A.outXAlign){if(A.outYAlign=="above"){if(x+C.height>z.bottom){var y=D.y-z.y;var G=z.bottom-D.bottom;if(y>G){x=D.y-C.height}}}if(A.outYAlign=="below"){if(x+C.height>z.bottom){var y=D.y-z.y;var G=z.bottom-D.bottom;if(y>G){x=D.y+D.height-C.height}}}if(A.outXAlign=="outleft"){if(w+C.width>z.right){var E=D.x-z.x;var u=z.right-D.right;if(E>u){w=D.x-C.width}}}if(A.outXAlign=="right"){if(w+C.width>z.right){w=D.right-C.width}}this._Show(w+v[0],x+v[1])}else{this.showAtPos(w+A.xOffset+v[0],x+A.yOffset+v[1])}},_Show:function(f,g){this.el.style.display="";this.el.style.zIndex=mini.getMaxZIndex();mini.setX(this.el,f);mini.setY(this.el,g);this.setVisible(true);if(this.hideAction=="mouseout"){mini.on(document,"mousemove",this.__OnBodyMouseMove,this)}var d=this;this._doShadow();this._doModal();this._doShim();mini.layoutIFrames(this.el);this.isPopup=true;mini.on(document,"mousedown",this.__OnBodyMouseDown,this);mini.on(window,"resize",this.__OnWindowResize,this);this.fire("Open")},open:function(){this.show()},close:function(){this.hide()},hide:function(){if(!this.el){return}if(this.popupEl){mini.removeClass(this.popupEl,this.popupEl.popupCls)}if(this._popupEl){mini.removeClass(this._popupEl,this._popupEl.popupCls)}this._popupEl=null;jQuery(this._modalEl).remove();if(this.shadowEl){this.shadowEl.style.display="none"}if(this._shimEl){this._shimEl.style.display="none"}mini.un(document,"mousemove",this.__OnBodyMouseMove,this);mini.un(document,"mousedown",this.__OnBodyMouseDown,this);mini.un(window,"resize",this.__OnWindowResize,this);this.setVisible(false);this.isPopup=false;this.fire("Close")},setPopupEl:function(b){b=mini.byId(b);if(!b){return}this._unbindPopupEl();this.popupEl=b;this._bindPopupEl()},setPopupCls:function(b){this.popupCls=b},setShowAction:function(b){this.showAction=b},setHideAction:function(b){this.hideAction=b},setShowDelay:function(b){this.showDelay=b},setHideDelay:function(b){this.hideDelay=b},setXAlign:function(b){this.xAlign=b},setYAlign:function(b){this.yAlign=b},setxOffset:function(b){b=parseInt(b);if(isNaN(b)){b=0}this.xOffset=b},setyOffset:function(b){b=parseInt(b);if(isNaN(b)){b=0}this.yOffset=b},setShowModal:function(b){this.showModal=b},setShowShadow:function(b){this.showShadow=b},setMinWidth:function(b){if(isNaN(b)){return}this.minWidth=b},setMinHeight:function(b){if(isNaN(b)){return}this.minHeight=b},setMaxWidth:function(b){if(isNaN(b)){return}this.maxWidth=b},setMaxHeight:function(b){if(isNaN(b)){return}this.maxHeight=b},setAllowDrag:function(b){this.allowDrag=b;mini.removeClass(this.el,this._dragCls);if(b){mini.addClass(this.el,this._dragCls)}},setAllowResize:function(b){this.allowResize=b;mini.removeClass(this.el,this._resizeCls);if(b){mini.addClass(this.el,this._resizeCls)}},__OnLeftClick:function(c){if(this._inAniming){return}if(this.showAction!="leftclick"){return}var d=jQuery(this.popupEl).attr("allowPopup");if(String(d)=="false"){return}this.doShow(c)},__OnRightClick:function(c){if(this._inAniming){return}if(this.showAction!="rightclick"){return}var d=jQuery(this.popupEl).attr("allowPopup");if(String(d)=="false"){return}c.preventDefault();this.doShow(c)},__OnMouseOver:function(g){if(this._inAniming){return}if(this.showAction!="mouseover"){return}var f=jQuery(this.popupEl).attr("allowPopup");if(String(f)=="false"){return}clearTimeout(this._hideTimer);this._hideTimer=null;if(this.isPopup){return}var d=this;this._showTimer=setTimeout(function(){d.doShow(g)},this.showDelay)},__OnBodyMouseMove:function(b){if(this.hideAction!="mouseout"){return}this._tryHide(b)},__OnBodyMouseDown:function(b){if(this.hideAction!="outerclick"){return}if(!this.isPopup){return}if(this.within(b)||(this.popupEl&&mini.isAncestor(this.popupEl,b.target))){}else{this.doHide(b)}},_tryHide:function(c){if(mini.isAncestor(this.el,c.target)||(this.popupEl&&mini.isAncestor(this.popupEl,c.target))){}else{clearTimeout(this._showTimer);this._showTimer=null;if(this._hideTimer){return}var d=this;this._hideTimer=setTimeout(function(){d.doHide(c)},this.hideDelay)}},__OnWindowResize:function(b){if(this.isDisplay()&&!mini.isIE6){this._doModal()}},within:function(k){if(mini.isAncestor(this.el,k.target)){return true}var c=mini.getChildControls(this);for(var l=0,i=c.length;l<i;l++){var j=c[l];if(j.within(k)){return true}}return false}};mini.copyTo(mini.Popup.prototype,mini.Popup_prototype);mini.Button=function(){mini.Button.superclass.constructor.call(this)};mini.extend(mini.Button,mini.Control,{text:"",iconCls:"",iconStyle:"",plain:false,checkOnClick:false,checked:false,groupName:"",_plainCls:"mini-button-plain",_hoverCls:"mini-button-hover",_pressedCls:"mini-button-pressed",_checkedCls:"mini-button-checked",_disabledCls:"mini-button-disabled",allowCls:"",_clearBorder:false,set:function(b){if(typeof b=="string"){return this}this._allowUpdate=b.text||b.iconStyle||b.iconCls||b.iconPosition;mini.Button.superclass.set.call(this,b);if(this._allowUpdate===false){this._allowUpdate=true;this.doUpdate()}return this},uiCls:"mini-button",_create:function(){this.el=document.createElement("a");this.el.className="mini-button";this.el.hideFocus=true;this.el.href="javascript:void(0)";this.doUpdate()},_initEvents:function(){mini._BindEvents(function(){mini_onOne(this.el,"mousedown",this.__OnMouseDown,this);mini_onOne(this.el,"click",this.__OnClick,this)},this)},destroy:function(b){if(this.el){this.el.onclick=null;this.el.onmousedown=null}if(this.menu){this.menu.owner=null}this.menu=null;mini.Button.superclass.destroy.call(this,b)},doUpdate:function(){if(this._allowUpdate===false){return}var f="",i=this.text;var g=this.iconStyle||this.iconCls||this.img;if(g&&i){f=" mini-button-icon "+this.iconCls}else{if(g&&i===""){f=" mini-button-iconOnly "+this.iconCls;i="&nbsp;"}else{if(i==""){i="&nbsp;"}}}var j=this.iconStyle||"";if(!j&&this.img){j="background-image:url("+this.img+")"}var k='<span class="mini-button-text '+f+'" style="'+j+'">'+i+"</span>";if(this.allowCls){k=k+'<span class="mini-button-allow '+this.allowCls+'"></span>'}this.el.innerHTML=k},href:"",setHref:function(c){this.href=c;this.el.href=c;var d=this.el;setTimeout(function(){d.onclick=null},100)},getHref:function(){return this.href},target:"",setTarget:function(b){this.target=b;this.el.target=b},getTarget:function(){return this.target},setText:function(b){if(this.text!=b){this.text=b;this.doUpdate()}},getText:function(){return this.text},setIconCls:function(b){this.iconCls=b;this.doUpdate()},getIconCls:function(){return this.iconCls},setIconStyle:function(b){this.iconStyle=b;this.doUpdate()},getIconStyle:function(){return this.iconStyle},img:"",setImg:function(b){this.img=b;this.doUpdate()},getImg:function(){return this.img},setIconPosition:function(b){this.iconPosition="left";this.doUpdate()},getIconPosition:function(){return this.iconPosition},setPlain:function(b){this.plain=b;if(b){this.addCls(this._plainCls)}else{this.removeCls(this._plainCls)}},getPlain:function(){return this.plain},setGroupName:function(b){this.groupName=b},getGroupName:function(){return this.groupName},setCheckOnClick:function(b){this.checkOnClick=b},getCheckOnClick:function(){return this.checkOnClick},setChecked:function(c){var d=this.checked!=c;this.checked=c;if(c){this.addCls(this._checkedCls)}else{this.removeCls(this._checkedCls)}if(d){this.fire("CheckedChanged")}},getChecked:function(){return this.checked},doClick:function(){this.__OnClick(null)},__OnClick:function(l){if(!this.href&&l){l.preventDefault()}if(this.readOnly||this.enabled==false){return}this.focus();if(this.checkOnClick){if(this.groupName){var k=this.groupName;var n=mini.findControls(function(a){if(a.type=="button"&&a.groupName==k){return true}});if(n.length>0){for(var o=0,j=n.length;o<j;o++){var i=n[o];if(i!=this){i.setChecked(false)}}this.setChecked(true)}else{this.setChecked(!this.checked)}}else{this.setChecked(!this.checked)}}this.fire("click",{htmlEvent:l})},__OnMouseDown:function(b){if(this.isReadOnly()){return}this.addCls(this._pressedCls);mini.on(document,"mouseup",this.__OnDocMouseUp,this)},__OnDocMouseUp:function(b){this.removeCls(this._pressedCls);mini.un(document,"mouseup",this.__OnDocMouseUp,this)},onClick:function(c,d){this.on("click",c,d)},getAttrs:function(c){var d=mini.Button.superclass.getAttrs.call(this,c);d.text=c.innerHTML;mini._ParseString(c,d,["text","href","iconCls","iconStyle","iconPosition","groupName","menu","onclick","oncheckedchanged","target","img"]);mini._ParseBool(c,d,["plain","checkOnClick","checked"]);return d}});mini.regClass(mini.Button,"button");mini.MenuButton=function(){mini.MenuButton.superclass.constructor.call(this)};mini.extend(mini.MenuButton,mini.Button,{uiCls:"mini-menubutton",allowCls:"mini-button-menu",setMenu:function(c){if(mini.isArray(c)){c={type:"menu",items:c}}if(typeof c=="string"){var d=mini.byId(c);if(!d){return}mini.parse(c);c=mini.get(c)}if(this.menu!==c){this.menu=mini.getAndCreate(c);this.menu.setPopupEl(this.el);this.menu.setPopupCls("mini-button-popup");this.menu.setShowAction("leftclick");this.menu.setHideAction("outerclick");this.menu.setXAlign("left");this.menu.setYAlign("below");this.menu.hide();this.menu.owner=this}},setEnabled:function(b){this.enabled=b;if(b){this.removeCls(this._disabledCls)}else{this.addCls(this._disabledCls)}jQuery(this.el).attr("allowPopup",!!b)}});mini.regClass(mini.MenuButton,"menubutton");mini.SplitButton=function(){mini.SplitButton.superclass.constructor.call(this)};mini.extend(mini.SplitButton,mini.MenuButton,{uiCls:"mini-splitbutton",allowCls:"mini-button-split"});mini.regClass(mini.SplitButton,"splitbutton");mini.CheckBox=function(){mini.CheckBox.superclass.constructor.call(this)};mini.extend(mini.CheckBox,mini.Control,{formField:true,_clearText:false,text:"",checked:false,defaultValue:false,trueValue:true,falseValue:false,uiCls:"mini-checkbox",_create:function(){var b=this.uid+"$check";this.el=document.createElement("span");this.el.className="mini-checkbox";this.el.innerHTML='<input id="'+b+'" name="'+this.id+'" type="checkbox" class="mini-checkbox-check"><label for="'+b+'" onclick="return false;">'+this.text+"</label>";this._checkEl=this.el.firstChild;this._labelEl=this.el.lastChild},destroy:function(b){if(this._checkEl){this._checkEl.onmouseup=null;this._checkEl.onclick=null;this._checkEl=null}mini.CheckBox.superclass.destroy.call(this,b)},_initEvents:function(){mini._BindEvents(function(){mini.on(this.el,"click",this.__onClick,this);this._checkEl.onmouseup=function(){return false};var b=this;this._checkEl.onclick=function(){if(b.isReadOnly()){return false}}},this)},setName:function(b){this.name=b;mini.setAttr(this._checkEl,"name",this.name)},setText:function(b){if(this.text!==b){this.text=b;this._labelEl.innerHTML=b}},getText:function(){return this.text},setChecked:function(b){if(b===true){b=true}else{if(b==this.trueValue){b=true}else{if(b=="true"){b=true}else{if(b===1){b=true}else{if(b=="Y"){b=true}else{b=false}}}}}if(this.checked!==b){this.checked=!!b;this._checkEl.checked=this.checked;this.value=this.getValue()}},getChecked:function(){return this.checked},setValue:function(b){if(this.checked!==b){this.setChecked(b);this.value=this.getValue()}},getValue:function(){return String(this.checked==true?this.trueValue:this.falseValue)},getFormValue:function(){return this.getValue()},setTrueValue:function(b){this._checkEl.value=b;this.trueValue=b},getTrueValue:function(){return this.trueValue},setFalseValue:function(b){this.falseValue=b},getFalseValue:function(){return this.falseValue},__onClick:function(b){if(this.isReadOnly()){return}this.setChecked(!this.checked);this.fire("checkedchanged",{checked:this.checked});this.fire("valuechanged",{value:this.getValue()});this.fire("click",b,this)},getAttrs:function(n){var g=mini.CheckBox.superclass.getAttrs.call(this,n);var j=jQuery(n);g.text=n.innerHTML;mini._ParseString(n,g,["text","oncheckedchanged","onclick","onvaluechanged"]);mini._ParseBool(n,g,["enabled"]);var k=mini.getAttr(n,"checked");if(k){g.checked=(k=="true"||k=="checked")?true:false}var i=j.attr("trueValue");if(i){g.trueValue=i;i=parseInt(i);if(!isNaN(i)){g.trueValue=i}}var l=j.attr("falseValue");if(l){g.falseValue=l;l=parseInt(l);if(!isNaN(l)){g.falseValue=l}}return g}});mini.regClass(mini.CheckBox,"checkbox");mini.ButtonEdit=function(){mini.ButtonEdit.superclass.constructor.call(this);var b=this.isReadOnly();if(b||this.allowInput==false){this._textEl.readOnly=true}if(this.enabled==false){this.addCls(this._disabledCls)}if(b){this.addCls(this._readOnlyCls)}if(this.required){this.addCls(this._requiredCls)}};mini.extend(mini.ButtonEdit,mini.ValidatorBase,{name:"",formField:true,selectOnFocus:false,showClose:false,emptyText:"",defaultValue:"",defaultText:"",value:"",text:"",maxLength:1000,minLength:0,height:21,inputAsValue:false,allowInput:true,_noInputCls:"mini-buttonedit-noInput",_readOnlyCls:"mini-buttonedit-readOnly",_disabledCls:"mini-buttonedit-disabled",_emptyCls:"mini-buttonedit-empty",_focusCls:"mini-buttonedit-focus",_buttonCls:"mini-buttonedit-button",_buttonHoverCls:"mini-buttonedit-button-hover",_buttonPressedCls:"mini-buttonedit-button-pressed",_closeCls:"mini-buttonedit-close",set:function(d){if(typeof d=="string"){return this}var f=d.value;delete d.value;var g=d.text;delete d.text;this._allowUpdate=!(d.enabled==false||d.allowInput==false||d.readOnly);mini.ButtonEdit.superclass.set.call(this,d);if(this._allowUpdate===false){this._allowUpdate=true;this.doUpdate()}if(!mini.isNull(g)){this.setText(g)}if(!mini.isNull(f)){this.setValue(f)}return this},uiCls:"mini-buttonedit",_getButtonsHTML:function(){var b='<span class="mini-buttonedit-close"></span>'+this._getButtonHtml();return'<span class="mini-buttonedit-buttons">'+b+"</span>"},_getButtonHtml:function(){var b="onmouseover=\"mini.addClass(this, '"+this._buttonHoverCls+"');\" onmouseout=\"mini.removeClass(this, '"+this._buttonHoverCls+"');\"";return'<span class="mini-buttonedit-button" '+b+'><span class="mini-buttonedit-icon"></span></span>'},_create:function(){this.el=document.createElement("span");this.el.className="mini-buttonedit";var b=this._getButtonsHTML();this.el.innerHTML='<span class="mini-buttonedit-border"><input type="input" class="mini-buttonedit-input" autocomplete="off"/>'+b+'</span><input name="'+this.name+'" type="hidden"/>';this._borderEl=this.el.firstChild;this._textEl=this._borderEl.firstChild;this._valueEl=this.el.lastChild;this._buttonsEl=this._borderEl.lastChild;this._buttonEl=this._buttonsEl.lastChild;this._closeEl=this._buttonEl.previousSibling;this._doEmpty()},destroy:function(b){if(this.el){this.el.onmousedown=null;this.el.onmousewheel=null;this.el.onmouseover=null;this.el.onmouseout=null}if(this._textEl){this._textEl.onchange=null;this._textEl.onfocus=null;mini.clearEvent(this._textEl);this._textEl=null}mini.ButtonEdit.superclass.destroy.call(this,b)},_initEvents:function(){mini._BindEvents(function(){mini_onOne(this.el,"mousedown",this.__OnMouseDown,this);mini_onOne(this._textEl,"focus",this.__OnFocus,this);mini_onOne(this._textEl,"change",this.__OnInputTextChanged,this);var b=this.text;this.text=null;if(this.el){this.setText(b)}},this)},_inputEventsInited:false,_initInputEvents:function(){if(this._inputEventsInited){return}this._inputEventsInited=true;mini.on(this.el,"click",this.__OnClick,this);mini.on(this._textEl,"blur",this.__OnBlur,this);mini.on(this._textEl,"keydown",this.__OnInputKeyDown,this);mini.on(this._textEl,"keyup",this.__OnInputKeyUp,this);mini.on(this._textEl,"keypress",this.__OnInputKeyPress,this)},_buttonWidth:20,_closeWidth:20,_doInputLayout:function(c){if(this._closeEl){this._closeEl.style.display=this.showClose?"inline-block":"none"}var d=this._buttonsEl.offsetWidth+2;if(d==2){this._noLayout=true}else{this._noLayout=false}this._borderEl.style.paddingRight=d+"px";if(c!==false){this.doLayout()}},doLayout:function(){if(this._noLayout){this._doInputLayout(false)}if(this._doLabelLayout){this._labelLayout()}},setHeight:function(b){if(parseInt(b)==b){b+="px"}this.height=b},focus:function(){try{this._textEl.focus();var d=this;setTimeout(function(){if(d._focused){d._textEl.focus()}},10)}catch(c){}},blur:function(){try{this._textEl.blur()}catch(b){}},selectText:function(){this._textEl.select()},getTextEl:function(){return this._textEl},setName:function(b){this.name=b;if(this._valueEl){mini.setAttr(this._valueEl,"name",this.name)}},setText:function(c){if(c===null||c===undefined){c=""}var d=this.text!==c;this.text=c;this._textEl.value=c;this._doEmpty()},getText:function(){var b=this._textEl.value;return b},setValue:function(c){if(c===null||c===undefined){c=""}var d=this.value!==c;this.value=c;this._valueEl.value=this.getFormValue()},getValue:function(){return this.value},getFormValue:function(){var b=this.value;if(b===null||b===undefined){b=""}return String(b)},_doEmpty:function(){this._textEl.placeholder=this.emptyText;if(this.emptyText){mini._placeholder(this._textEl)}},setEmptyText:function(b){if(this.emptyText!=b){this.emptyText=b;this._doEmpty()}},getEmptyText:function(){return this.emptyText},setMaxLength:function(b){b=parseInt(b);if(isNaN(b)){return}this.maxLength=b;this._textEl.maxLength=b},getMaxLength:function(){return this.maxLength},setMinLength:function(b){b=parseInt(b);if(isNaN(b)){return}this.minLength=b},getMinLength:function(){return this.minLength},setEnabled:function(b){mini.ButtonEdit.superclass.setEnabled.call(this,b)},_doReadOnly:function(){var b=this.isReadOnly();if(b||this.allowInput==false){this._textEl.readOnly=true}else{this._textEl.readOnly=false}if(b){this.addCls(this._readOnlyCls)}else{this.removeCls(this._readOnlyCls)}if(this.allowInput){this.removeCls(this._noInputCls)}else{this.addCls(this._noInputCls)}if(this.enabled){this._textEl.disabled=false}else{this._textEl.disabled=true}},setAllowInput:function(b){this.allowInput=b;this._doReadOnly()},getAllowInput:function(){return this.allowInput},setInputAsValue:function(b){this.inputAsValue=b},getInputAsValue:function(){return this.inputAsValue},_errorIconEl:null,getErrorIconEl:function(){if(!this._errorIconEl){this._errorIconEl=mini.append(this.el,'<span class="mini-errorIcon"></span>')}return this._errorIconEl},_RemoveErrorIcon:function(){if(this._errorIconEl){var b=this._errorIconEl;jQuery(b).remove()}this._errorIconEl=null},__OnClick:function(c){if(this.enabled==false){return}this.fire("click",{htmlEvent:c});if(this.isReadOnly()){return}if(!mini.isAncestor(this._borderEl,c.target)){return}var d=new Date();if(mini.isAncestor(this._buttonEl,c.target)){this._OnButtonClick(c)}if(mini.findParent(c.target,this._closeCls)){this.fire("closeclick",{htmlEvent:c})}},__OnMouseDown:function(j){if(this.isReadOnly()||this.enabled==false){return}if(!mini.isAncestor(this._borderEl,j.target)){return}if(!mini.isAncestor(this._textEl,j.target)){this._clickTarget=j.target;var f=this;setTimeout(function(){f.focus();mini.selectRange(f._textEl,1000,1000)},1);if(mini.isAncestor(this._buttonEl,j.target)){var g=mini.findParent(j.target,"mini-buttonedit-up");var i=mini.findParent(j.target,"mini-buttonedit-down");if(g){mini.addClass(g,this._buttonPressedCls);this._OnButtonMouseDown(j,"up")}else{if(i){mini.addClass(i,this._buttonPressedCls);this._OnButtonMouseDown(j,"down")}else{mini.addClass(this._buttonEl,this._buttonPressedCls);this._OnButtonMouseDown(j)}}mini.on(document,"mouseup",this.__OnDocMouseUp,this)}}},__OnDocMouseUp:function(c){this._clickTarget=null;var d=this;setTimeout(function(){var a=d._buttonEl.getElementsByTagName("*");for(var b=0,f=a.length;b<f;b++){mini.removeClass(a[b],d._buttonPressedCls)}mini.removeClass(d._buttonEl,d._buttonPressedCls);mini.removeClass(d.el,d._pressedCls)},80);mini.un(document,"mouseup",this.__OnDocMouseUp,this)},__OnFocus:function(b){this.doUpdate();this._initInputEvents();if(this.isReadOnly()){return}this._focused=true;this.addCls(this._focusCls);if(this.selectOnFocus){this.selectText()}this.fire("focus",{htmlEvent:b})},__doFocusCls:function(){if(this._focused==false){this.removeCls(this._focusCls)}},__fireBlur:function(g){var f=this;function d(){if(f._focused==false){f.removeCls(f._focusCls);if(f.validateOnLeave&&f.isEditable()){f._tryValidate()}this.fire("blur",{htmlEvent:g})}}setTimeout(function(){d.call(f)},2)},__OnBlur:function(c){var d=this;d._focused=false;setTimeout(function(){d.__fireBlur(c)},10)},__OnInputKeyDown:function(i){var g={htmlEvent:i};this.fire("keydown",g);if(i.keyCode==8&&(this.isReadOnly()||this.allowInput==false)){return false}if(i.keyCode==27||i.keyCode==13||i.keyCode==9){var j=this;j.__OnInputTextChanged(null);if(i.keyCode==13){var f=this;f.fire("enter",g)}}if(i.keyCode==27){i.preventDefault()}},__OnInputTextChanged:function(){var d=this._textEl.value;if(d==this.text){return}var c=this.getValue();this.setText(d);this.setValue(d);if(c!==this.getFormValue()){this._OnValueChanged()}},__OnInputKeyUp:function(b){this.fire("keyup",{htmlEvent:b})},__OnInputKeyPress:function(b){this.fire("keypress",{htmlEvent:b})},_OnButtonClick:function(d){var c={htmlEvent:d,cancel:false};this.fire("beforebuttonclick",c);if(c.cancel==true){return}this.fire("buttonclick",c)},_OnButtonMouseDown:function(d,c){this.focus();this.addCls(this._focusCls);this.fire("buttonmousedown",{htmlEvent:d,spinType:c})},onButtonClick:function(c,d){this.on("buttonclick",c,d)},onButtonMouseDown:function(c,d){this.on("buttonmousedown",c,d)},onTextChanged:function(c,d){this.on("textchanged",c,d)},textName:"",setTextName:function(b){this.textName=b;if(this._textEl){mini.setAttr(this._textEl,"name",this.textName)}},getTextName:function(){return this.textName},setSelectOnFocus:function(b){this.selectOnFocus=b},getSelectOnFocus:function(b){return this.selectOnFocus},setShowClose:function(b){this.showClose=b;this._doInputLayout()},getShowClose:function(b){return this.showClose},inputStyle:"",setInputStyle:function(b){this.inputStyle=b;mini.setStyle(this._textEl,b)},getAttrs:function(d){var f=mini.ButtonEdit.superclass.getAttrs.call(this,d);var g=jQuery(d);mini._ParseString(d,f,["value","text","textName","emptyText","inputStyle","defaultText","onenter","onkeydown","onkeyup","onkeypress","onbuttonclick","onbuttonmousedown","ontextchanged","onfocus","onblur","oncloseclick","onclick"]);mini._ParseBool(d,f,["allowInput","inputAsValue","selectOnFocus","showClose"]);mini._ParseInt(d,f,["maxLength","minLength"]);return f}});mini.regClass(mini.ButtonEdit,"buttonedit");mini.TextBox=function(){mini.TextBox.superclass.constructor.call(this)};mini.extend(mini.TextBox,mini.ValidatorBase,{name:"",formField:true,selectOnFocus:false,allowInput:true,minWidth:10,minHeight:15,maxLength:5000,emptyText:"",text:"",value:"",defaultValue:"",height:21,_emptyCls:"mini-textbox-empty",_focusCls:"mini-textbox-focus",_disabledCls:"mini-textbox-disabled",uiCls:"mini-textbox",_InputType:"text",_create:function(){var b='<input  type="'+this._InputType+'" class="mini-textbox-input" autocomplete="off"/>';if(this._InputType=="textarea"){b='<textarea  class="mini-textbox-input" autocomplete="off"/></textarea>'}b='<span class="mini-textbox-border">'+b+"</span>";b+='<input type="hidden"/>';this.el=document.createElement("span");this.el.className="mini-textbox";this.el.innerHTML=b;this._borderEl=this.el.firstChild;this._textEl=this._borderEl.firstChild;this._valueEl=this._borderEl.lastChild;this._doEmpty()},_initEvents:function(){mini._BindEvents(function(){mini_onOne(this._textEl,"drop",this.__OnDropText,this);mini_onOne(this._textEl,"change",this.__OnInputTextChanged,this);mini_onOne(this._textEl,"focus",this.__OnFocus,this);mini_onOne(this.el,"mousedown",this.__OnMouseDown,this);var b=this.value;this.value=null;if(this.el){this.setValue(b)}},this);this.on("validation",this.__OnValidation,this)},_inputEventsInited:false,_initInputEvents:function(){if(this._inputEventsInited){return}this._inputEventsInited=true;mini.on(this._textEl,"blur",this.__OnBlur,this);mini.on(this._textEl,"keydown",this.__OnInputKeyDown,this);mini.on(this._textEl,"keyup",this.__OnInputKeyUp,this);mini.on(this._textEl,"keypress",this.__OnInputKeyPress,this)},destroy:function(b){if(this.el){this.el.onmousedown=null}if(this._textEl){this._textEl.ondrop=null;this._textEl.onchange=null;this._textEl.onfocus=null;mini.clearEvent(this._textEl);this._textEl=null}if(this._valueEl){mini.clearEvent(this._valueEl);this._valueEl=null}mini.TextBox.superclass.destroy.call(this,b)},doLayout:function(){if(this._doLabelLayout){this._labelLayout()}},setHeight:function(b){if(parseInt(b)==b){b+="px"}this.height=b;if(this._InputType=="textarea"){this.el.style.height=b;this.doLayout()}},setName:function(b){if(this.name!=b){this.name=b;if(this._valueEl){mini.setAttr(this._valueEl,"name",this.name)}}},setValue:function(b){if(b===null||b===undefined){b=""}b=String(b);if(b.length>this.maxLength){b=b.substring(0,this.maxLength)}if(this.value!==b){this.value=b;this._valueEl.value=this._textEl.value=b;this._doEmpty()}},getValue:function(){return this.value},getFormValue:function(){var b=this.value;if(b===null||b===undefined){b=""}return String(b)},setAllowInput:function(b){if(this.allowInput!=b){this.allowInput=b;this.doUpdate()}},getAllowInput:function(){return this.allowInput},_placeholdered:false,_doEmpty:function(){this._textEl.placeholder=this.emptyText;if(this.emptyText){mini._placeholder(this._textEl)}},setEmptyText:function(b){if(this.emptyText!=b){this.emptyText=b;this._doEmpty()}},getEmptyText:function(){return this.emptyText},setMaxLength:function(b){this.maxLength=b;mini.setAttr(this._textEl,"maxLength",b);if(this._InputType=="textarea"&&mini.isIE){mini.on(this._textEl,"keypress",this.__OnMaxLengthKeyUp,this)}},__OnMaxLengthKeyUp:function(b){if(this._textEl.value.length>=this.maxLength){b.preventDefault()}},getMaxLength:function(){return this.maxLength},setReadOnly:function(b){if(this.readOnly!=b){this.readOnly=b;this.doUpdate()}},setEnabled:function(b){if(this.enabled!=b){this.enabled=b;this.doUpdate()}},doUpdate:function(){if(this.enabled){this.removeCls(this._disabledCls)}else{this.addCls(this._disabledCls)}if(this.isReadOnly()||this.allowInput==false){this._textEl.readOnly=true;mini.addClass(this.el,"mini-textbox-readOnly")}else{this._textEl.readOnly=false;mini.removeClass(this.el,"mini-textbox-readOnly")}if(this.required){this.addCls(this._requiredCls)}else{this.removeCls(this._requiredCls)}if(this.enabled){this._textEl.disabled=false}else{this._textEl.disabled=true}},focus:function(){var b=this;setTimeout(function(){try{b._textEl.focus()}catch(a){}},10)},blur:function(){try{this._textEl.blur()}catch(b){}},selectText:function(){var c=this;function d(){try{c._textEl.select()}catch(a){}}d();setTimeout(function(){d()},30)},getTextEl:function(){return this._textEl},getInputText:function(){return this._textEl.value},setSelectOnFocus:function(b){this.selectOnFocus=b},getSelectOnFocus:function(b){return this.selectOnFocus},_errorIconEl:null,getErrorIconEl:function(){if(!this._errorIconEl){this._errorIconEl=mini.append(this.el,'<span class="mini-errorIcon"></span>')}return this._errorIconEl},_RemoveErrorIcon:function(){if(this._errorIconEl){var b=this._errorIconEl;jQuery(b).remove()}this._errorIconEl=null},__OnMouseDown:function(c){var d=this;if(!mini.isAncestor(this._textEl,c.target)){setTimeout(function(){d.focus();mini.selectRange(d._textEl,1000,1000)},1)}else{setTimeout(function(){try{d._textEl.focus()}catch(a){}},1)}},__OnInputTextChanged:function(g,f){var d=this.value;this.setValue(this._textEl.value);if(d!==this.getValue()||f===true){this._OnValueChanged()}},__OnDropText:function(c){var d=this;setTimeout(function(){d.__OnInputTextChanged(c)},0)},__OnInputKeyDown:function(g){var f={htmlEvent:g};this.fire("keydown",f);if(g.keyCode==8&&(this.isReadOnly()||this.allowInput==false)){return false}if(g.keyCode==27||g.keyCode==13||g.keyCode==9){if(this._InputType=="textarea"&&g.keyCode==13){}else{this.__OnInputTextChanged(null,true);if(g.keyCode==13){var d=this;d.fire("enter",f)}}}if(g.keyCode==27){g.preventDefault()}},__OnInputKeyUp:function(b){this.fire("keyup",{htmlEvent:b})},__OnInputKeyPress:function(b){this.fire("keypress",{htmlEvent:b})},__OnFocus:function(b){this.doUpdate();if(this.isReadOnly()){return}this._focused=true;this.addCls(this._focusCls);this._initInputEvents();if(this.selectOnFocus){this.selectText()}this.fire("focus",{htmlEvent:b})},__OnBlur:function(c){this._focused=false;var d=this;setTimeout(function(){if(d._focused==false){d.removeCls(d._focusCls)}},2);this.fire("blur",{htmlEvent:c});if(this.validateOnLeave&&this.isEditable()){this._tryValidate()}},inputStyle:"",setInputStyle:function(b){this.inputStyle=b;mini.setStyle(this._textEl,b)},getAttrs:function(d){var f=mini.TextBox.superclass.getAttrs.call(this,d);var g=jQuery(d);mini._ParseString(d,f,["value","text","emptyText","inputStyle","onenter","onkeydown","onkeyup","onkeypress","maxLengthErrorText","minLengthErrorText","onfocus","onblur","vtype","emailErrorText","urlErrorText","floatErrorText","intErrorText","dateErrorText","minErrorText","maxErrorText","rangeLengthErrorText","rangeErrorText","rangeCharErrorText"]);mini._ParseBool(d,f,["allowInput","selectOnFocus"]);mini._ParseInt(d,f,["maxLength","minLength","minHeight","minWidth"]);return f},vtype:"",setVtype:function(b){this.vtype=b},getVtype:function(){return this.vtype},__OnValidation:function(b){if(b.isValid==false){return}mini._ValidateVType(this.vtype,b.value,b,this)},setEmailErrorText:function(b){this.emailErrorText=b},getEmailErrorText:function(){return this.emailErrorText},setUrlErrorText:function(b){this.urlErrorText=b},getUrlErrorText:function(){return this.urlErrorText},setFloatErrorText:function(b){this.floatErrorText=b},getFloatErrorText:function(){return this.floatErrorText},setIntErrorText:function(b){this.intErrorText=b},getIntErrorText:function(){return this.intErrorText},setDateErrorText:function(b){this.dateErrorText=b},getDateErrorText:function(){return this.dateErrorText},setMaxLengthErrorText:function(b){this.maxLengthErrorText=b},getMaxLengthErrorText:function(){return this.maxLengthErrorText},setMinLengthErrorText:function(b){this.minLengthErrorText=b},getMinLengthErrorText:function(){return this.minLengthErrorText},setMaxErrorText:function(b){this.maxErrorText=b},getMaxErrorText:function(){return this.maxErrorText},setMinErrorText:function(b){this.minErrorText=b},getMinErrorText:function(){return this.minErrorText},setRangeLengthErrorText:function(b){this.rangeLengthErrorText=b},getRangeLengthErrorText:function(){return this.rangeLengthErrorText},setRangeCharErrorText:function(b){this.rangeCharErrorText=b},getRangeCharErrorText:function(){return this.rangeCharErrorText},setRangeErrorText:function(b){this.rangeErrorText=b},getRangeErrorText:function(){return this.rangeErrorText}});mini.regClass(mini.TextBox,"textbox");mini.Password=function(){mini.Password.superclass.constructor.call(this)};mini.extend(mini.Password,mini.TextBox,{uiCls:"mini-password",_InputType:"password",setEmptyText:function(b){this.emptyText=""},getValue:function(){return this._textEl.value}});mini.regClass(mini.Password,"password");mini.TextArea=function(){mini.TextArea.superclass.constructor.call(this)};mini.extend(mini.TextArea,mini.TextBox,{maxLength:10000000,height:"",minHeight:50,_InputType:"textarea",uiCls:"mini-textarea",doLayout:function(){if(!this.canLayout()){return}mini.TextArea.superclass.doLayout.call(this);var b=mini.getHeight(this.el);if(mini.isIE6){mini.setHeight(this._borderEl,b)}b-=2;if(b<0){b=0}this._textEl.style.height=b+"px"}});mini.regClass(mini.TextArea,"textarea");mini.PopupEdit=function(){mini.PopupEdit.superclass.constructor.call(this);this._createPopup();this.el.className+=" mini-popupedit"};mini.extend(mini.PopupEdit,mini.ButtonEdit,{uiCls:"mini-popupedit",popup:null,popupCls:"mini-buttonedit-popup",_hoverCls:"mini-buttonedit-hover",_pressedCls:"mini-buttonedit-pressed",_destroyPopup:true,destroy:function(b){if(this.isShowPopup()){this.hidePopup()}if(this.popup){if(this._destroyPopup){this.popup.destroy()}this.popup=null}if(this._popupInner){this._popupInner.owner=null;this._popupInner=null}mini.PopupEdit.superclass.destroy.call(this,b)},_initEvents:function(){mini.PopupEdit.superclass._initEvents.call(this);mini._BindEvents(function(){mini_onOne(this.el,"mouseover",this.__OnMouseOver,this);mini_onOne(this.el,"mouseout",this.__OnMouseOut,this)},this)},_initButtons:function(){this.buttons=[];var b=this.createButton({cls:"mini-buttonedit-popup",iconCls:"mini-buttonedit-icons-popup",name:"popup"});this.buttons.push(b)},__OnBlur:function(b){this._focused=false;if(this._clickTarget&&mini.isAncestor(this.el,this._clickTarget)){return}if(this.isShowPopup()){return}mini.PopupEdit.superclass.__OnBlur.call(this,b)},__OnMouseOver:function(b){if(this.isReadOnly()||this.allowInput){return}if(mini.findParent(b.target,"mini-buttonedit-border")){this.addCls(this._hoverCls)}},__OnMouseOut:function(b){if(this.isReadOnly()||this.allowInput){return}this.removeCls(this._hoverCls)},__OnMouseDown:function(b){if(this.isReadOnly()){return}mini.PopupEdit.superclass.__OnMouseDown.call(this,b);if(this.allowInput==false&&mini.findParent(b.target,"mini-buttonedit-border")){mini.addClass(this.el,this._pressedCls);mini.on(document,"mouseup",this.__OnDocMouseUp,this)}},__OnInputKeyDown:function(b){this.fire("keydown",{htmlEvent:b});if(b.keyCode==8&&(this.isReadOnly()||this.allowInput==false)){return false}if(b.keyCode==9){this.hidePopup();return}if(b.keyCode==27){this.hidePopup();return}if(b.keyCode==13){this.fire("enter")}if(this.isShowPopup()){if(b.keyCode==13||b.keyCode==27){b.stopPropagation()}}},within:function(b){if(mini.isAncestor(this.el,b.target)){return true}if(this.popup.within(b)){return true}return false},popupWidth:"100%",popupMinWidth:50,popupMaxWidth:2000,popupHeight:"",popupMinHeight:30,popupMaxHeight:2000,setPopup:function(d){if(typeof d=="string"){mini.parse(d);d=mini.get(d)}var c=mini.getAndCreate(d);if(!c){return}c.setVisible(false);this._popupInner=c;c.owner=this;c.on("beforebuttonclick",this.__OnPopupButtonClick,this)},getPopup:function(){if(!this.popup){this._createPopup()}return this.popup},_createPopup:function(){this.popup=new mini.Popup();this.popup.setShowAction("none");this.popup.setHideAction("outerclick");this.popup.setPopupEl(this.el);this.popup.on("BeforeClose",this.__OnPopupBeforeClose,this);mini.on(this.popup.el,"keydown",this.__OnPopupKeyDown,this)},__OnPopupBeforeClose:function(b){if(this.within(b.htmlEvent)){b.cancel=true}else{this._unDocumentMousewheel()}},__OnPopupKeyDown:function(b){},showPopup:function(){var c={cancel:false};if(this._firebeforeshowpopup!==false){this.fire("beforeshowpopup",c);if(c.cancel==true){return false}}var d=this.getPopup();this._syncShowPopup();d.on("Close",this.__OnPopupHide,this);this._onDocumentMousewheel();this.fire("showpopup")},_unDocumentMousewheel:function(){mini.un(document,"mousewheel",this.__OnDocumentMousewheel,this);this._mousewheelXY=null},_onDocumentMousewheel:function(){this._unDocumentMousewheel();this._mousewheelXY=mini.getXY(this.el);mini.on(document,"mousewheel",this.__OnDocumentMousewheel,this)},__OnDocumentMousewheel:function(g){var d=this;function f(){if(!d.isShowPopup()){return}var b=d._mousewheelXY;var a=mini.getXY(d.el);if(b[0]!=a[0]||b[1]!=a[1]){d.hidePopup()}else{setTimeout(f,300)}}setTimeout(f,300)},doLayout:function(){mini.PopupEdit.superclass.doLayout.call(this);if(this.isShowPopup()){}},_syncShowPopup:function(){var f=this.getPopup();if(this._popupInner&&this._popupInner.el.parentNode!=this.popup._contentEl){this.popup._contentEl.appendChild(this._popupInner.el);this._popupInner.setVisible(true)}var i=mini.getBox(this._borderEl);var g=this.popupWidth;if(this.popupWidth=="100%"){g=i.width}f.setWidth(g);var j=parseInt(this.popupHeight);if(!isNaN(j)){f.setHeight(j)}else{f.setHeight("auto")}f.setMinWidth(this.popupMinWidth);f.setMinHeight(this.popupMinHeight);f.setMaxWidth(this.popupMaxWidth);f.setMaxHeight(this.popupMaxHeight);var k={xAlign:"left",yAlign:"below",outYAlign:"above",outXAlign:"right",popupCls:this.popupCls};this._doShowAtEl(this._borderEl,k)},_doShowAtEl:function(g,d){var f=this.getPopup();f.showAtEl(g,d)},__OnPopupHide:function(b){this.__doFocusCls();this.fire("hidepopup")},hidePopup:function(){if(this.isShowPopup()){var b=this.getPopup();b.close();this.blur()}},isShowPopup:function(){if(this.popup&&this.popup.isDisplay()){return true}else{return false}},setPopupWidth:function(b){this.popupWidth=b},setPopupMaxWidth:function(b){this.popupMaxWidth=b},setPopupMinWidth:function(b){this.popupMinWidth=b},getPopupWidth:function(b){return this.popupWidth},getPopupMaxWidth:function(b){return this.popupMaxWidth},getPopupMinWidth:function(b){return this.popupMinWidth},setPopupHeight:function(b){this.popupHeight=b},setPopupMaxHeight:function(b){this.popupMaxHeight=b},setPopupMinHeight:function(b){this.popupMinHeight=b},getPopupHeight:function(b){return this.popupHeight},getPopupMaxHeight:function(b){return this.popupMaxHeight},getPopupMinHeight:function(b){return this.popupMinHeight},__OnClick:function(c){if(this.enabled==false){return}this.fire("click",{htmlEvent:c});if(this.isReadOnly()){return}if(mini.isAncestor(this._buttonEl,c.target)){this._OnButtonClick(c)}if(mini.findParent(c.target,this._closeCls)){if(this.isShowPopup()){this.hidePopup()}this.fire("closeclick",{htmlEvent:c});return}if(this.allowInput==false||mini.isAncestor(this._buttonEl,c.target)){if(this.isShowPopup()){this.hidePopup()}else{var d=this;setTimeout(function(){d.showPopup()},1)}}},__OnPopupButtonClick:function(b){if(b.name=="close"){this.hidePopup()}b.cancel=true},getAttrs:function(c){var d=mini.PopupEdit.superclass.getAttrs.call(this,c);mini._ParseString(c,d,["popupWidth","popupHeight","popup","onshowpopup","onhidepopup","onbeforeshowpopup"]);mini._ParseInt(c,d,["popupMinWidth","popupMaxWidth","popupMinHeight","popupMaxHeight"]);return d}});mini.regClass(mini.PopupEdit,"popupedit");mini.ComboBox=function(){this.data=[];this.columns=[];mini.ComboBox.superclass.constructor.call(this);var b=this;if(isFirefox){this._textEl.oninput=function(){b._tryQuery()}}};mini.extend(mini.ComboBox,mini.PopupEdit,{text:"",value:"",valueField:"id",textField:"text",dataField:"",delimiter:",",multiSelect:false,data:[],url:"",columns:[],allowInput:false,valueFromSelect:false,popupMaxHeight:200,set:function(i){if(typeof i=="string"){return this}var j=i.value;delete i.value;var g=i.url;delete i.url;var f=i.data;delete i.data;mini.ComboBox.superclass.set.call(this,i);if(!mini.isNull(f)){this.setData(f);i.data=f}if(!mini.isNull(g)){this.setUrl(g);i.url=g}if(!mini.isNull(j)){this.setValue(j);i.value=j}return this},uiCls:"mini-combobox",_createPopup:function(){mini.ComboBox.superclass._createPopup.call(this);this._listbox=new mini.ListBox();this._listbox.setBorderStyle("border:0;");this._listbox.setStyle("width:100%;height:auto;");this._listbox.render(this.popup._contentEl);this._listbox.on("itemclick",this.__OnItemClick,this);this._listbox.on("drawcell",this.__OnItemDrawCell,this);var b=this;this._listbox.on("beforeload",function(a){b.fire("beforeload",a)},this);this._listbox.on("preload",function(a){b.fire("preload",a)},this);this._listbox.on("load",function(a){b.fire("load",a)},this);this._listbox.on("loaderror",function(a){b.fire("loaderror",a)},this)},showPopup:function(){var d={cancel:false};this.fire("beforeshowpopup",d);this._firebeforeshowpopup=false;if(d.cancel==true){return}this._listbox.setHeight("auto");mini.ComboBox.superclass.showPopup.call(this);var c=this.popup.el.style.height;if(c==""||c=="auto"){this._listbox.setHeight("auto")}else{this._listbox.setHeight("100%")}this._listbox.setValue(this.value)},select:function(b){this._listbox.deselectAll();b=this.getItem(b);if(b){this._listbox.select(b);this.__OnItemClick({item:b})}},selects:function(d){if(!d){return}var c=this._listbox.getValueAndText(d);this.setValue(c[0])},getItem:function(b){return typeof b=="object"?b:this.data[b]},indexOf:function(b){return this.data.indexOf(b)},getAt:function(b){return this.data[b]},load:function(b){if(typeof b=="string"){this.setUrl(b)}else{this.setData(b)}},_eval:function(_){return eval("("+_+")")},setData:function(c){if(typeof c=="string"){c=this._eval(c)}if(!mini.isArray(c)){c=[]}this._listbox.setData(c);this.data=this._listbox.data;var d=this._listbox.getValueAndText(this.value);this.text=this._textEl.value=d[1]},getData:function(){return this.data},setUrl:function(d){this.getPopup();this._listbox.setUrl(d);this.url=this._listbox.url;this.data=this._listbox.data;var c=this._listbox.getValueAndText(this.value);this.text=this._textEl.value=c[1]},getUrl:function(){return this.url},setValueField:function(b){this.valueField=b;if(this._listbox){this._listbox.setValueField(b)}},getValueField:function(){return this.valueField},setTextField:function(b){if(this._listbox){this._listbox.setTextField(b)}this.textField=b},getTextField:function(){return this.textField},pinyinField:"tag",setPinyinField:function(b){this.pinyinField=b},getPinyinField:function(){return this.pinyinField},setDisplayField:function(b){this.setTextField(b)},setDataField:function(b){if(this._listbox){this._listbox.setDataField(b)}this.dataField=b},getDataField:function(){return this.dataField},setValue:function(c){if(this.value!==c){var d=this._listbox.getValueAndText(c);this.value=c;this._valueEl.value=this.value;this.text=this._textEl.value=d[1];this._doEmpty()}else{var d=this._listbox.getValueAndText(c);this.text=this._textEl.value=d[1]}},setMultiSelect:function(b){if(this.multiSelect!=b){this.multiSelect=b;if(this._listbox){this._listbox.setMultiSelect(b);this._listbox.setShowCheckBox(b)}}},getMultiSelect:function(){return this.multiSelect},setColumns:function(b){if(!mini.isArray(b)){b=[]}this.columns=b;this._listbox.setColumns(b)},getColumns:function(){return this.columns},showNullItem:false,setShowNullItem:function(b){if(this.showNullItem!=b){this.showNullItem=b;this._listbox.setShowNullItem(b)}},getShowNullItem:function(){return this.showNullItem},setNullItemText:function(b){if(this.nullItemText!=b){this.nullItemText=b;this._listbox.setNullItemText(b)}},getNullItemText:function(){return this.nullItemText},setValueFromSelect:function(b){this.valueFromSelect=b},getValueFromSelect:function(){return this.valueFromSelect},_OnValueChanged:function(){if(this.validateOnChanged){this._tryValidate()}var i=this.getValue();var f=this.getSelecteds();var g=f[0];var j=this;j.fire("valuechanged",{value:i,selecteds:f,selected:g})},getSelecteds:function(){return this._listbox.findItems(this.value)},getSelected:function(){return this.getSelecteds()[0]},__OnItemDrawCell:function(b){this.fire("drawcell",b)},__OnItemClick:function(k){var o={item:k.item,cancel:false};this.fire("beforeitemclick",o);if(o.cancel){return}var j=this._listbox.getSelecteds();var l=this._listbox.getValueAndText(j);var n=this.getValue();this.setValue(l[0]);this.setText(l[1]);if(k){if(n!=this.getValue()){var i=this;setTimeout(function(){i._OnValueChanged()},1)}if(!this.multiSelect){this.hidePopup()}this.focus();this.fire("itemclick",{item:k.item})}},__OnInputKeyDown:function(l,o){var r={htmlEvent:l};this.fire("keydown",r);if(l.keyCode==8&&(this.isReadOnly()||this.allowInput==false)){return false}if(l.keyCode==9){if(this.isShowPopup()){this.hidePopup()}return}if(this.isReadOnly()){return}switch(l.keyCode){case 27:l.preventDefault();if(this.isShowPopup()){l.stopPropagation()}this.hidePopup();this.focus();break;case 13:if(this.isShowPopup()){l.preventDefault();l.stopPropagation();var j=this._listbox.getFocusedIndex();if(j!=-1){var p=this._listbox.getAt(j);var q={item:p,cancel:false};this.fire("beforeitemclick",q);if(q.cancel==false){if(this.multiSelect){}else{this._listbox.deselectAll();this._listbox.select(p)}var k=this._listbox.getSelecteds();var n=this._listbox.getValueAndText(k);this.setValue(n[0]);this.setText(n[1]);this._OnValueChanged()}}this.hidePopup();this.focus()}else{this.fire("enter",r)}break;case 37:break;case 38:l.preventDefault();var j=this._listbox.getFocusedIndex();if(j==-1){j=0;if(!this.multiSelect){var p=this._listbox.findItems(this.value)[0];if(p){j=this._listbox.indexOf(p)}}}if(this.isShowPopup()){if(!this.multiSelect){j-=1;if(j<0){j=0}this._listbox._focusItem(j,true)}}break;case 39:break;case 40:l.preventDefault();var j=this._listbox.getFocusedIndex();if(j==-1){j=0;if(!this.multiSelect){var p=this._listbox.findItems(this.value)[0];if(p){j=this._listbox.indexOf(p)}}}if(this.isShowPopup()){if(!this.multiSelect){j+=1;if(j>this._listbox.getCount()-1){j=this._listbox.getCount()-1}this._listbox._focusItem(j,true)}}else{this.showPopup();if(!this.multiSelect){this._listbox._focusItem(j,true)}}break;default:if(this.allowInput==false){}else{this._tryQuery(this._textEl.value)}break}},__OnInputKeyUp:function(b){this.fire("keyup",{htmlEvent:b})},__OnInputKeyPress:function(b){this.fire("keypress",{htmlEvent:b})},_tryQuery:function(d){var c=this;setTimeout(function(){var a=c._textEl.value;if(a!=d){c._doQuery(a)}},10)},_doQuery:function(k){if(this.multiSelect==true){return}var l=[];k=k.toUpperCase();for(var q=0,r=this.data.length;q<r;q++){var s=this.data[q];var i=mini._getMap(this.textField,s);var p=mini._getMap(this.pinyinField,s);i=i?String(i).toUpperCase():"";p=p?String(p).toUpperCase():"";if(i.indexOf(k)!=-1||p.indexOf(k)!=-1){l.push(s)}}this._listbox.setData(l);this._filtered=true;if(k!==""||this.isShowPopup()){this.showPopup();var o=0;if(this._listbox.getShowNullItem()){o=1}var n=this;n._listbox._focusItem(o,true)}},__OnPopupHide:function(b){if(this._filtered){this._filtered=false;if(this._listbox.el){this._listbox.setData(this.data)}}this.__doFocusCls();this.fire("hidepopup")},findItems:function(b){return this._listbox.findItems(b)},__OnInputTextChanged:function(s){if(this.multiSelect==false){var l=this._textEl.value;var v=this.getData();var w=null;for(var u=0,x=v.length;u<x;u++){var i=v[u];var q=i[this.textField];if(q==l){w=i;break}}if(w){this._listbox.setValue(w?w[this.valueField]:"");var p=this._listbox.getValue();var y=this._listbox.getValueAndText(p);var r=this.getValue();this.setValue(p);this.setText(y[1])}else{if(this.valueFromSelect){this.setValue("");this.setText("")}else{this.setValue(l);this.setText(l)}}if(r!=this.getValue()){var t=this;t._OnValueChanged()}}},setAjaxData:function(b){this.ajaxData=b;this._listbox.setAjaxData(b)},setAjaxType:function(b){this.ajaxType=b;this._listbox.setAjaxType(b)},getAttrs:function(w){var l=mini.ComboBox.superclass.getAttrs.call(this,w);mini._ParseString(w,l,["url","data","textField","valueField","displayField","nullItemText","pinyinField","ondrawcell","onbeforeload","onpreload","onload","onloaderror","onitemclick","onbeforeitemclick"]);mini._ParseBool(w,l,["multiSelect","showNullItem","valueFromSelect"]);if(l.displayField){l.textField=l.displayField}var i=l.valueField||this.valueField;var u=l.textField||this.textField;if(w.nodeName.toLowerCase()=="select"){var s=[];for(var r=0,t=w.length;r<t;r++){var q=w.options[r];var x={};x[u]=q.text;x[i]=q.value;s.push(x)}if(s.length>0){l.data=s}}else{var p=mini.getChildNodes(w);for(var r=0,t=p.length;r<t;r++){var v=p[r];var o=jQuery(v).attr("property");if(!o){continue}o=o.toLowerCase();if(o=="columns"){l.columns=mini._ParseColumns(v)}else{if(o=="data"){l.data=v.innerHTML}}}}return l}});mini.regClass(mini.ComboBox,"combobox");mini.DatePicker=function(){mini.DatePicker.superclass.constructor.call(this);mini.addClass(this.el,"mini-datepicker");this.on("validation",this.__OnValidation,this)};mini.extend(mini.DatePicker,mini.PopupEdit,{valueFormat:"",format:"yyyy-MM-dd",maxDate:null,minDate:null,popupWidth:"",viewDate:new Date(),showTime:false,timeFormat:"H:mm",showTodayButton:true,showClearButton:true,showOkButton:false,uiCls:"mini-datepicker",_getCalendar:function(){if(!mini.DatePicker._Calendar){var b=mini.DatePicker._Calendar=new mini.Calendar();b.setStyle("border:0;")}return mini.DatePicker._Calendar},destroy:function(b){if(this._destroyPopup){mini.DatePicker._Calendar=null}mini.DatePicker.superclass.destroy.call(this,b)},_createPopup:function(){mini.DatePicker.superclass._createPopup.call(this);this._calendar=this._getCalendar()},_monthPicker:false,showPopup:function(){var f={cancel:false};this.fire("beforeshowpopup",f);if(f.cancel==true){return}this._calendar=this._getCalendar();this._calendar.beginUpdate();this._calendar._allowLayout=false;if(this._calendar.el.parentNode!=this.popup._contentEl){this._calendar.render(this.popup._contentEl)}this._calendar.set({monthPicker:this._monthPicker,showTime:this.showTime,timeFormat:this.timeFormat,showClearButton:this.showClearButton,showTodayButton:this.showTodayButton,showOkButton:this.showOkButton,showWeekNumber:this.showWeekNumber});this._calendar.setValue(this.value);if(this.value){this._calendar.setViewDate(this.value)}else{this._calendar.setViewDate(this.viewDate)}function g(){if(this._calendar._target){var a=this._calendar._target;this._calendar.un("timechanged",a.__OnTimeChanged,a);this._calendar.un("dateclick",a.__OnDateClick,a);this._calendar.un("drawdate",a.__OnDrawDate,a)}this._calendar.on("timechanged",this.__OnTimeChanged,this);this._calendar.on("dateclick",this.__OnDateClick,this);this._calendar.on("drawdate",this.__OnDrawDate,this);this._calendar.endUpdate();this._calendar._allowLayout=true;this._calendar.doLayout();this._calendar.focus();this._calendar._target=this}var d=this;g.call(d);mini.DatePicker.superclass.showPopup.call(this)},hidePopup:function(){mini.DatePicker.superclass.hidePopup.call(this);this._calendar.un("timechanged",this.__OnTimeChanged,this);this._calendar.un("dateclick",this.__OnDateClick,this);this._calendar.un("drawdate",this.__OnDrawDate,this)},within:function(b){if(mini.isAncestor(this.el,b.target)){return true}if(this._calendar.within(b)){return true}return false},__OnPopupKeyDown:function(b){if(b.keyCode==13){this.__OnDateClick()}if(b.keyCode==27){this.hidePopup();this.focus()}},minDateErrorText:"",maxDateErrorText:"",__OnValidation:function(n){if(n.isValid==false){return}var i=this.value;if(!mini.isDate(i)){return}var k=mini.parseDate(this.maxDate);var o=mini.parseDate(this.minDate);var j=this.maxDateErrorText||mini.VTypes.maxDateErrorText;var l=this.minDateErrorText||mini.VTypes.minDateErrorText;if(mini.isDate(k)){if(i.getTime()>k.getTime()){n.isValid=false;n.errorText=String.format(j,mini.formatDate(k,this.format))}}if(mini.isDate(o)){if(i.getTime()<o.getTime()){n.isValid=false;n.errorText=String.format(l,mini.formatDate(o,this.format))}}},__OnDrawDate:function(j){var g=j.date;var i=mini.parseDate(this.maxDate);var f=mini.parseDate(this.minDate);if(mini.isDate(i)){if(g.getTime()>i.getTime()){j.allowSelect=false}}if(mini.isDate(f)){if(g.getTime()<f.getTime()){j.allowSelect=false}}this.fire("drawdate",j)},__OnDateClick:function(g){if(this.showOkButton&&g.action!="ok"){return}var f=this._calendar.getValue();var d=this.getFormValue("U");this.setValue(f);if(d!==this.getFormValue("U")){this._OnValueChanged()}this.hidePopup();this.focus()},__OnTimeChanged:function(c){if(this.showOkButton){return}var d=this._calendar.getValue();this.setValue(d);this._OnValueChanged()},setFormat:function(b){if(typeof b!="string"){return}if(this.format!=b){this.format=b;this._textEl.value=this._valueEl.value=this.getFormValue()}},getFormat:function(){return this.format},setValueFormat:function(b){if(typeof b!="string"){return}if(this.valueFormat!=b){this.valueFormat=b}},getValueFormat:function(){return this.valueFormat},setValue:function(b){b=mini.parseDate(b);if(mini.isNull(b)){b=""}if(mini.isDate(b)){b=new Date(b.getTime())}if(this.value!=b){this.value=b;this.text=this._textEl.value=this._valueEl.value=this.getFormValue()}},nullValue:"",setNullValue:function(b){if(b=="null"){b=null}this.nullValue=b},getNullValue:function(){return this.nullValue},getValue:function(){if(!mini.isDate(this.value)){return this.nullValue}var b=this.value;if(this.valueFormat){b=mini.formatDate(b,this.valueFormat)}return b},getFormValue:function(b){if(!mini.isDate(this.value)){return""}b=b||this.format;return mini.formatDate(this.value,b)},setViewDate:function(b){b=mini.parseDate(b);if(!mini.isDate(b)){return}this.viewDate=b},getViewDate:function(){return this._calendar.getViewDate()},setShowTime:function(b){if(this.showTime!=b){this.showTime=b}},getShowTime:function(){return this.showTime},setTimeFormat:function(b){if(this.timeFormat!=b){this.timeFormat=b}},getTimeFormat:function(){return this.timeFormat},setShowTodayButton:function(b){this.showTodayButton=b},getShowTodayButton:function(){return this.showTodayButton},setShowClearButton:function(b){this.showClearButton=b},getShowClearButton:function(){return this.showClearButton},setShowOkButton:function(b){this.showOkButton=b},getShowOkButton:function(){return this.showOkButton},setShowWeekNumber:function(b){this.showWeekNumber=b},getShowWeekNumber:function(){return this.showWeekNumber},setMaxDate:function(b){this.maxDate=b},getMaxDate:function(){return this.maxDate},setMinDate:function(b){this.minDate=b},getMinDate:function(){return this.minDate},setMaxDateErrorText:function(b){this.maxDateErrorText=b},getMaxDateErrorText:function(){return this.maxDateErrorText},setMinDateErrorText:function(b){this.minDateErrorText=b},getMinDateErrorText:function(){return this.minDateErrorText},__OnInputTextChanged:function(j){var g=this._textEl.value;var i=mini.parseDate(g);if(!i||isNaN(i)||i.getFullYear()==1970){i=null}var d=this.getFormValue("U");this.setValue(i);if(i==null){this._textEl.value=""}if(d!==this.getFormValue("U")){this._OnValueChanged()}},__OnInputKeyDown:function(g){var f={htmlEvent:g};this.fire("keydown",f);if(g.keyCode==8&&(this.isReadOnly()||this.allowInput==false)){return false}if(g.keyCode==9){if(this.isShowPopup()){this.hidePopup()}return}if(this.isReadOnly()){return}switch(g.keyCode){case 27:g.preventDefault();if(this.isShowPopup()){g.stopPropagation()}this.hidePopup();break;case 9:case 13:if(this.isShowPopup()){g.preventDefault();g.stopPropagation();this.hidePopup()}else{this.__OnInputTextChanged(null);var d=this;setTimeout(function(){d.fire("enter",f)},10)}break;case 37:break;case 38:g.preventDefault();break;case 39:break;case 40:g.preventDefault();this.showPopup();break;default:break}},getAttrs:function(c){var d=mini.DatePicker.superclass.getAttrs.call(this,c);mini._ParseString(c,d,["format","viewDate","timeFormat","ondrawdate","minDate","maxDate","valueFormat","nullValue","minDateErrorText","maxDateErrorText"]);mini._ParseBool(c,d,["showTime","showTodayButton","showClearButton","showOkButton","showWeekNumber"]);return d}});mini.regClass(mini.DatePicker,"datepicker");mini.MonthPicker=function(){mini.MonthPicker.superclass.constructor.call(this)};mini.extend(mini.MonthPicker,mini.DatePicker,{uiCls:"mini-monthpicker",valueFormat:"",format:"yyyy-MM",_monthPicker:true});mini.regClass(mini.MonthPicker,"monthpicker");mini.Calendar=function(){this.viewDate=new Date();this._selectedDates=[];mini.Calendar.superclass.constructor.call(this)};mini.extend(mini.Calendar,mini.Control,{width:220,height:160,monthPicker:false,_clearBorder:false,viewDate:null,_selectedDate:"",_selectedDates:[],multiSelect:false,firstDayOfWeek:0,todayText:"Today",clearText:"Clear",okText:"OK",cancelText:"Cancel",daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],format:"MMM, yyyy",timeFormat:"H:mm",showTime:false,currentTime:true,rows:1,columns:1,headerCls:"",bodyCls:"",footerCls:"",_todayCls:"mini-calendar-today",_weekendCls:"mini-calendar-weekend",_otherMonthCls:"mini-calendar-othermonth",_selectedDateCls:"mini-calendar-selected",showHeader:true,showFooter:true,showWeekNumber:false,showDaysHeader:true,showMonthButtons:true,showYearButtons:true,showTodayButton:true,showClearButton:true,showOkButton:false,isWeekend:function(c){var d=c.getDay();return d==0||d==6},getFirstDateOfMonth:function(b){var b=new Date(b.getFullYear(),b.getMonth(),1);return mini.getWeekStartDate(b,this.firstDayOfWeek)},getShortWeek:function(b){return this.daysShort[b]},uiCls:"mini-calendar",_create:function(){var j='<tr style="width:100%;"><td style="width:100%;"></td></tr>';j+='<tr ><td><div class="mini-calendar-footer"><span style="display:inline-block;"><input name="time" class="mini-timespinner" style="width:80px" format="'+this.timeFormat+'"/><span class="mini-calendar-footerSpace"></span></span><span class="mini-calendar-tadayButton">'+this.todayText+'</span><span class="mini-calendar-footerSpace"></span><span class="mini-calendar-clearButton">'+this.clearText+'</span><span class="mini-calendar-okButton">'+this.okText+'</span><a href="#" class="mini-calendar-focus" style="position:absolute;left:-10px;top:-10px;width:0px;height:0px;outline:none" hideFocus></a></div></td></tr>';var d='<table class="mini-calendar" cellpadding="0" cellspacing="0">'+j+"</table>";var i=document.createElement("div");i.innerHTML=d;this.el=i.firstChild;var g=this.el.getElementsByTagName("tr");var k=this.el.getElementsByTagName("td");this._innerEl=k[0];this._footerEl=mini.byClass("mini-calendar-footer",this.el);this.timeWrapEl=this._footerEl.childNodes[0];this.todayButtonEl=this._footerEl.childNodes[1];this.footerSpaceEl=this._footerEl.childNodes[2];this.closeButtonEl=this._footerEl.childNodes[3];this.okButtonEl=this._footerEl.childNodes[4];this._focusEl=this._footerEl.lastChild;mini.parse(this._footerEl);this.timeSpinner=mini.getbyName("time",this.el);this.doUpdate()},focus:function(){try{this._focusEl.focus()}catch(b){}},destroy:function(b){this._innerEl=this._footerEl=this.timeWrapEl=this.todayButtonEl=this.footerSpaceEl=this.closeButtonEl=null;mini.Calendar.superclass.destroy.call(this,b)},_initEvents:function(){if(this.timeSpinner){this.timeSpinner.on("valuechanged",this.__OnTimeChanged,this)}mini._BindEvents(function(){mini.on(this.el,"click",this.__OnClick,this);mini.on(this.el,"mousedown",this.__OnMouseDown,this);mini.on(this.el,"keydown",this.__OnKeyDown,this)},this)},getDateEl:function(d){if(!d){return null}var c=this.uid+"$"+mini.clearTime(d).getTime();return document.getElementById(c)},within:function(b){if(mini.isAncestor(this.el,b.target)){return true}if(this.menuEl&&mini.isAncestor(this.menuEl,b.target)){return true}return false},setShowHeader:function(b){this.showHeader=b;this.doUpdate()},getShowHeader:function(){return this.showHeader},setShowFooter:function(b){this.showFooter=b;this.doUpdate()},getShowFooter:function(){return this.showFooter},setShowWeekNumber:function(b){this.showWeekNumber=b;this.doUpdate()},getShowWeekNumber:function(){return this.showWeekNumber},setShowDaysHeader:function(b){this.showDaysHeader=b;this.doUpdate()},getShowDaysHeader:function(){return this.showDaysHeader},setShowMonthButtons:function(b){this.showMonthButtons=b;this.doUpdate()},getShowMonthButtons:function(){return this.showMonthButtons},setShowYearButtons:function(b){this.showYearButtons=b;this.doUpdate()},getShowYearButtons:function(){return this.showYearButtons},setShowTodayButton:function(b){this.showTodayButton=b;this.todayButtonEl.style.display=this.showTodayButton?"":"none";this.doUpdate()},getShowTodayButton:function(){return this.showTodayButton},setShowClearButton:function(b){this.showClearButton=b;this.closeButtonEl.style.display=this.showClearButton?"":"none";this.doUpdate()},getShowClearButton:function(){return this.showClearButton},setShowOkButton:function(b){this.showOkButton=b;this.okButtonEl.style.display=this.showOkButton?"":"none";this.doUpdate()},getShowOkButton:function(){return this.showOkButton},setViewDate:function(b){b=mini.parseDate(b);if(!b){b=new Date()}if(mini.isDate(b)){b=new Date(b.getTime())}this.viewDate=b;this.doUpdate()},getViewDate:function(){return this.viewDate},setSelectedDate:function(c){c=mini.parseDate(c);if(!mini.isDate(c)){c=""}else{c=new Date(c.getTime())}var d=this.getDateEl(this._selectedDate);if(d){mini.removeClass(d,this._selectedDateCls)}this._selectedDate=c;if(this._selectedDate){this._selectedDate=mini.cloneDate(this._selectedDate)}var d=this.getDateEl(this._selectedDate);if(d){mini.addClass(d,this._selectedDateCls)}this.fire("datechanged")},setSelectedDates:function(b){if(!mini.isArray(b)){b=[]}this._selectedDates=b;this.doUpdate()},getSelectedDate:function(){return this._selectedDate?this._selectedDate:""},setTime:function(b){this.timeSpinner.setValue(b)},getTime:function(){return this.timeSpinner.getFormValue()},setValue:function(b){this.setSelectedDate(b);if(!b){b=new Date()}this.setTime(b)},getValue:function(){var c=this._selectedDate;if(c){c=mini.clearTime(c);if(this.showTime){var d=this.timeSpinner.getValue();if(d){c.setHours(d.getHours());c.setMinutes(d.getMinutes());c.setSeconds(d.getSeconds())}}}return c?c:""},getFormValue:function(){var b=this.getValue();if(b){return mini.formatDate(b,"yyyy-MM-dd HH:mm:ss")}return""},isSelectedDate:function(b){if(!b||!this._selectedDate){return false}return mini.clearTime(b).getTime()==mini.clearTime(this._selectedDate).getTime()},setMultiSelect:function(b){this.multiSelect=b;this.doUpdate()},getMultiSelect:function(){return this.multiSelect},setRows:function(b){if(isNaN(b)){return}if(b<1){b=1}this.rows=b;this.doUpdate()},getRows:function(){return this.rows},setColumns:function(b){if(isNaN(b)){return}if(b<1){b=1}this.columns=b;this.doUpdate()},getColumns:function(){return this.columns},setShowTime:function(b){if(this.showTime!=b){this.showTime=b;this.timeWrapEl.style.display=this.showTime?"":"none";this.doLayout()}},getShowTime:function(){return this.showTime},setTimeFormat:function(b){if(this.timeFormat!=b){this.timeSpinner.setFormat(b);this.timeFormat=this.timeSpinner.format}},getTimeFormat:function(){return this.timeFormat},doLayout:function(){if(!this.canLayout()){return}this.timeWrapEl.style.display=this.showTime?"":"none";this.todayButtonEl.style.display=this.showTodayButton?"":"none";this.closeButtonEl.style.display=this.showClearButton?"":"none";this.okButtonEl.style.display=this.showOkButton?"":"none";this.footerSpaceEl.style.display=(this.showClearButton&&this.showTodayButton)?"":"none";this._footerEl.style.display=this.showFooter?"":"none";var d=this._innerEl.firstChild;var c=this.isAutoHeight();if(!c){d.parentNode.style.height="100px";h=jQuery(this.el).height();h-=jQuery(this._footerEl).outerHeight();d.parentNode.style.height=h+"px"}else{d.parentNode.style.height=""}mini.layout(this._footerEl);if(this.monthPicker){this._tryShowMenu()}},doUpdate:function(){if(!this._allowUpdate){return}var j=new Date(this.viewDate.getTime());var p=this.rows==1&&this.columns==1;var k=100/this.rows;var i='<table class="mini-calendar-views" border="0" cellpadding="0" cellspacing="0">';for(var l=0,r=this.rows;l<r;l++){i+="<tr >";for(var o=0,q=this.columns;o<q;o++){i+='<td style="height:'+k+'%">';i+=this._CreateView(j,l,o);i+="</td>";j=new Date(j.getFullYear(),j.getMonth()+1,1)}i+="</tr>"}i+="</table>";this._innerEl.innerHTML=i;var s=this.el;setTimeout(function(){mini.repaint(s)},100);this.doLayout()},_CreateView:function(I,M,P){var k=I.getMonth();var s=this.getFirstDateOfMonth(I);var G=new Date(s.getTime());var N=mini.clearTime(new Date()).getTime();var J=this.value?mini.clearTime(this.value).getTime():-1;var E=this.rows>1||this.columns>1;var H="";H+='<table class="mini-calendar-view" border="0" cellpadding="0" cellspacing="0">';if(this.showHeader){H+='<tr ><td colSpan="10" class="mini-calendar-header"><div class="mini-calendar-headerInner">';if(M==0&&P==0){H+='<div class="mini-calendar-prev">';if(this.showYearButtons){H+='<span class="mini-calendar-yearPrev"></span>'}if(this.showMonthButtons){H+='<span class="mini-calendar-monthPrev"></span>'}H+="</div>"}if(M==0&&P==this.columns-1){H+='<div class="mini-calendar-next">';if(this.showMonthButtons){H+='<span class="mini-calendar-monthNext"></span>'}if(this.showYearButtons){H+='<span class="mini-calendar-yearNext"></span>'}H+="</div>"}H+='<span class="mini-calendar-title">'+mini.formatDate(I,this.format);+"</span>";H+="</div></td></tr>"}if(this.showDaysHeader){H+='<tr class="mini-calendar-daysheader"><td class="mini-calendar-space"></td>';if(this.showWeekNumber){H+='<td sclass="mini-calendar-weeknumber"></td>'}for(var C=this.firstDayOfWeek,D=C+7;C<D;C++){var i=this.getShortWeek(C);H+='<td yAlign="middle">';H+=i;H+="</td>";s=new Date(s.getFullYear(),s.getMonth(),s.getDate()+1)}H+='<td class="mini-calendar-space"></td></tr>'}s=G;for(var B=0;B<=5;B++){H+='<tr class="mini-calendar-days"><td class="mini-calendar-space"></td>';if(this.showWeekNumber){var L=mini.getWeek(s.getFullYear(),s.getMonth()+1,s.getDate());if(String(L).length==1){L="0"+L}H+='<td class="mini-calendar-weeknumber" yAlign="middle">'+L+"</td>"}for(var C=this.firstDayOfWeek,D=C+7;C<D;C++){var F=this.isWeekend(s);var O=mini.clearTime(s).getTime();var j=O==N;var K=this.isSelectedDate(s);if(k!=s.getMonth()&&E){O=-1}var A=this._OnDrawDate(s);H+='<td yAlign="middle" id="';H+=this.uid+"$"+O;H+='" class="mini-calendar-date ';if(F){H+=" mini-calendar-weekend "}if(A.allowSelect==false){H+=" mini-calendar-disabled "}if(k!=s.getMonth()&&E){}else{if(K){H+=" "+this._selectedDateCls+" "}if(j){H+=" mini-calendar-today "}}if(k!=s.getMonth()){H+=" mini-calendar-othermonth "}if(A.dateCls){H+=" "+A.dateCls}H+='" style="';if(A.dateStyle){H+=A.dateStyle}H+='">';if(k!=s.getMonth()&&E){}else{H+=A.dateHtml}H+="</td>";s=new Date(s.getFullYear(),s.getMonth(),s.getDate()+1)}H+='<td class="mini-calendar-space"></td></tr>'}H+='<tr class="mini-calendar-bottom" colSpan="10"><td ></td></tr>';H+="</table>";return H},_OnDrawDate:function(d){var c={date:d,dateCls:"",dateStyle:"",dateHtml:d.getDate(),allowSelect:true};this.fire("drawdate",c);return c},_OnDateClick:function(f,d){this.hideMenu();var g={date:f,action:d};this.fire("dateclick",g);this._OnValueChanged()},menuEl:null,menuYear:null,menuSelectMonth:null,menuSelectYear:null,_tryShowMenu:function(){if(!this.menuEl){var b=this;setTimeout(function(){b.showMenu()},1)}},showMenu:function(){this.hideMenu();this.menuYear=parseInt(this.viewDate.getFullYear()/10)*10;this._menuselectMonth=this.viewDate.getMonth();this._menuselectYear=this.viewDate.getFullYear();var d='<div class="mini-calendar-menu"></div>';this.menuEl=mini.append(document.body,d);this.updateMenu(this.viewDate);var c=this.getBox();if(this.el.style.borderWidth=="0px"){this.menuEl.style.border="0"}mini.setBox(this.menuEl,c);mini.on(this.menuEl,"click",this.__OnMenuClick,this);mini.on(document,"mousedown",this.__OnBodyMenuMouseDown,this)},hideMenu:function(){if(this.menuEl){mini.un(this.menuEl,"click",this.__OnMenuClick,this);mini.un(document,"mousedown",this.__OnBodyMenuMouseDown,this);jQuery(this.menuEl).remove();this.menuEl=null}},updateMenu:function(){var j='<div class="mini-calendar-menu-months">';for(var k=0,f=12;k<f;k++){var i=mini.getShortMonth(k);var g="";if(this._menuselectMonth==k){g="mini-calendar-menu-selected"}j+='<a id="'+k+'" class="mini-calendar-menu-month '+g+'" href="javascript:void(0);" hideFocus onclick="return false">'+i+"</a>"}j+='<div style="clear:both;"></div></div>';j+='<div class="mini-calendar-menu-years">';for(var k=this.menuYear,f=this.menuYear+10;k<f;k++){var i=k;var g="";if(this._menuselectYear==k){g="mini-calendar-menu-selected"}j+='<a id="'+k+'" class="mini-calendar-menu-year '+g+'" href="javascript:void(0);" hideFocus onclick="return false">'+i+"</a>"}j+='<div class="mini-calendar-menu-prevYear"></div><div class="mini-calendar-menu-nextYear"></div><div style="clear:both;"></div></div>';j+='<div class="mini-calendar-footer"><span class="mini-calendar-okButton">'+this.okText+'</span><span class="mini-calendar-footerSpace"></span><span class="mini-calendar-cancelButton">'+this.cancelText+'</span></div><div style="clear:both;"></div>';this.menuEl.innerHTML=j},__OnMenuClick:function(j){var k=j.target;var l=mini.findParent(k,"mini-calendar-menu-month");var i=mini.findParent(k,"mini-calendar-menu-year");if(l){this._menuselectMonth=parseInt(l.id);this.updateMenu()}else{if(i){this._menuselectYear=parseInt(i.id);this.updateMenu()}else{if(mini.findParent(k,"mini-calendar-menu-prevYear")){this.menuYear=this.menuYear-1;this.menuYear=parseInt(this.menuYear/10)*10;this.updateMenu()}else{if(mini.findParent(k,"mini-calendar-menu-nextYear")){this.menuYear=this.menuYear+11;this.menuYear=parseInt(this.menuYear/10)*10;this.updateMenu()}else{if(mini.findParent(k,"mini-calendar-okButton")){var g=new Date(this._menuselectYear,this._menuselectMonth,1);if(this.monthPicker){this.setViewDate(g);this.setSelectedDate(g);this._OnDateClick(g)}else{this.setViewDate(g);this.hideMenu()}}else{if(mini.findParent(k,"mini-calendar-cancelButton")){if(this.monthPicker){this._OnDateClick(null,"cancel")}else{this.hideMenu()}}}}}}}},__OnBodyMenuMouseDown:function(b){if(!mini.findParent(b.target,"mini-calendar-menu")){this.hideMenu()}},__OnClick:function(p){var d=this.viewDate;if(this.enabled==false){return}var n=p.target;var u=mini.findParent(p.target,"mini-calendar-title");if(mini.findParent(n,"mini-calendar-monthNext")){d.setMonth(d.getMonth()+1);this.setViewDate(d)}else{if(mini.findParent(n,"mini-calendar-yearNext")){d.setFullYear(d.getFullYear()+1);this.setViewDate(d)}else{if(mini.findParent(n,"mini-calendar-monthPrev")){d.setMonth(d.getMonth()-1);this.setViewDate(d)}else{if(mini.findParent(n,"mini-calendar-yearPrev")){d.setFullYear(d.getFullYear()-1);this.setViewDate(d)}else{if(mini.findParent(n,"mini-calendar-tadayButton")){var o=new Date();this.setViewDate(o);this.setSelectedDate(o);if(this.currentTime){var q=new Date();this.setTime(q)}this._OnDateClick(o,"today")}else{if(mini.findParent(n,"mini-calendar-clearButton")){this.setSelectedDate(null);this.setTime(null);this._OnDateClick(null,"clear")}else{if(mini.findParent(n,"mini-calendar-okButton")){this._OnDateClick(null,"ok")}else{if(u){this.showMenu()}}}}}}}}var r=mini.findParent(p.target,"mini-calendar-date");if(r&&!mini.hasClass(r,"mini-calendar-disabled")){var v=r.id.split("$");var s=parseInt(v[v.length-1]);if(s==-1){return}var t=new Date(s);this._OnDateClick(t)}},__OnMouseDown:function(j){if(this.enabled==false){return}var g=mini.findParent(j.target,"mini-calendar-date");if(g&&!mini.hasClass(g,"mini-calendar-disabled")){var l=g.id.split("$");var k=parseInt(l[l.length-1]);if(k==-1){return}var i=new Date(k);this.setSelectedDate(i)}},__OnTimeChanged:function(b){this.fire("timechanged");this._OnValueChanged()},__OnKeyDown:function(i){if(this.enabled==false){return}var f=this.getSelectedDate();if(!f){f=new Date(this.viewDate.getTime())}switch(i.keyCode){case 27:break;case 13:break;case 37:f=mini.addDate(f,-1,"D");break;case 38:f=mini.addDate(f,-7,"D");break;case 39:f=mini.addDate(f,1,"D");break;case 40:f=mini.addDate(f,7,"D");break;default:break}var j=this;if(f.getMonth()!=j.viewDate.getMonth()){j.setViewDate(mini.cloneDate(f));j.focus()}var g=this.getDateEl(f);if(g&&mini.hasClass(g,"mini-calendar-disabled")){return}j.setSelectedDate(f);if(i.keyCode==37||i.keyCode==38||i.keyCode==39||i.keyCode==40){i.preventDefault()}},_OnValueChanged:function(){this.fire("valuechanged")},getAttrs:function(c){var d=mini.Calendar.superclass.getAttrs.call(this,c);mini._ParseString(c,d,["viewDate","rows","columns","ondateclick","ondrawdate","ondatechanged","timeFormat","ontimechanged","onvaluechanged"]);mini._ParseBool(c,d,["multiSelect","showHeader","showFooter","showWeekNumber","showDaysHeader","showMonthButtons","showYearButtons","showTodayButton","showClearButton","showTime","showOkButton"]);return d}});mini.regClass(mini.Calendar,"calendar");mini.ListBox=function(){mini.ListBox.superclass.constructor.call(this)};mini.extend(mini.ListBox,mini.ListControl,{formField:true,columns:null,columnWidth:80,showNullItem:false,nullItemText:"",showEmpty:false,emptyText:"",showCheckBox:false,showAllCheckBox:true,multiSelect:false,_itemCls:"mini-listbox-item",_itemHoverCls:"mini-listbox-item-hover",_itemSelectedCls:"mini-listbox-item-selected",uiCls:"mini-listbox",_create:function(){var b=this.el=document.createElement("div");this.el.className="mini-listbox";this.el.innerHTML='<div class="mini-listbox-border"><div class="mini-listbox-header"></div><div class="mini-listbox-view"></div><input type="hidden"/></div><div class="mini-errorIcon"></div>';this._borderEl=this.el.firstChild;this._headerEl=this._borderEl.firstChild;this._viewEl=this._borderEl.childNodes[1];this._valueEl=this._borderEl.childNodes[2];this._errorIconEl=this.el.lastChild;this._scrollViewEl=this._viewEl;this._viewEl.innerHTML='<div class="mini-grid-rows-content"></div>'},_initEvents:function(){mini.ListBox.superclass._initEvents.call(this);mini._BindEvents(function(){mini_onOne(this._viewEl,"scroll",this.__OnScroll,this)},this)},destroy:function(b){if(this._viewEl){this._viewEl.onscroll=null;mini.clearEvent(this._viewEl);this._viewEl=null}this._borderEl=null;this._headerEl=null;this._viewEl=null;this._valueEl=null;mini.ListBox.superclass.destroy.call(this,b)},setColumns:function(l){if(!mini.isArray(l)){l=[]}this.columns=l;for(var p=0,j=this.columns.length;p<j;p++){var n=this.columns[p];if(n.type){if(!mini.isNull(n.header)&&typeof n.header!=="function"){if(n.header.trim()==""){delete n.header}}var i=mini._getColumn(n.type);if(i){var k=mini.copyTo({},n);mini.copyTo(n,i);mini.copyTo(n,k)}}var o=parseInt(n.width);if(mini.isNumber(o)&&String(o)==n.width){n.width=o+"px"}if(mini.isNull(n.width)){n.width=this.columnWidth+"px"}}this.doUpdate()},getColumns:function(){return this.columns},doUpdate:function(){if(this._allowUpdate===false){return}var N=this.columns&&this.columns.length>0;if(N){mini.addClass(this.el,"mini-listbox-showColumns")}else{mini.removeClass(this.el,"mini-listbox-showColumns")}this._headerEl.style.display=N?"":"none";var T=[];if(N){T[T.length]='<table class="mini-listbox-headerInner" cellspacing="0" cellpadding="0"><tr>';var J=this.uid+"$ck$all";T[T.length]='<td class="mini-listbox-checkbox"><input type="checkbox" id="'+J+'"></td>';for(var w=0,D=this.columns.length;w<D;w++){var Q=this.columns[w];var l=Q.header;if(mini.isNull(l)){l="&nbsp;"}var K=Q.width;if(mini.isNumber(K)){K=K+"px"}T[T.length]='<td class="';if(Q.headerCls){T[T.length]=Q.headerCls}T[T.length]='" style="';if(Q.headerStyle){T[T.length]=Q.headerStyle+";"}if(K){T[T.length]="width:"+K+";"}if(Q.headerAlign){T[T.length]="text-align:"+Q.headerAlign+";"}T[T.length]='">';T[T.length]=l;T[T.length]="</td>"}T[T.length]="</tr></table>"}this._headerEl.innerHTML=T.join("");var T=[];var F=this.data;T[T.length]='<table class="mini-listbox-items" cellspacing="0" cellpadding="0">';if(this.showEmpty&&F.length==0){T[T.length]='<tr><td colspan="20">'+this.emptyText+"</td></tr>"}else{this._doNullItem();for(var k=0,E=F.length;k<E;k++){var i=F[k];var O=-1;var G=" ";var P=-1;var H=" ";T[T.length]='<tr id="';T[T.length]=this._createItemId(k);T[T.length]='" index="';T[T.length]=k;T[T.length]='" class="mini-listbox-item ';if(i.enabled===false){T[T.length]=" mini-disabled "}O=T.length;T[T.length]=G;T[T.length]='" style="';P=T.length;T[T.length]=H;T[T.length]='">';var I=this._createCheckId(k);var L=this.name;var R=this.getItemValue(i);var S="";if(i.enabled===false){S="disabled"}T[T.length]='<td class="mini-listbox-checkbox"><input '+S+' id="'+I+'" type="checkbox" ></td>';if(N){for(var w=0,D=this.columns.length;w<D;w++){var Q=this.columns[w];var j=this._OnDrawCell(i,k,Q);var K=Q.width;if(typeof K=="number"){K=K+"px"}T[T.length]='<td class="';if(j.cellCls){T[T.length]=j.cellCls}T[T.length]='" style="';if(j.cellStyle){T[T.length]=j.cellStyle+";"}if(K){T[T.length]="width:"+K+";"}if(Q.align){T[T.length]="text-align:"+Q.align+";"}T[T.length]='">';T[T.length]=j.cellHtml;T[T.length]="</td>";if(j.rowCls){G=j.rowCls}if(j.rowStyle){H=j.rowStyle}}}else{var j=this._OnDrawCell(i,k,null);T[T.length]='<td class="';if(j.cellCls){T[T.length]=j.cellCls}T[T.length]='" style="';if(j.cellStyle){T[T.length]=j.cellStyle}T[T.length]='">';T[T.length]=j.cellHtml;T[T.length]="</td>";if(j.rowCls){G=j.rowCls}if(j.rowStyle){H=j.rowStyle}}T[O]=G;T[P]=H;T[T.length]="</tr>"}}T[T.length]="</table>";var M=T.join("");this._viewEl.firstChild.innerHTML=M;this._doSelects();this.doLayout()},doLayout:function(){if(!this.canLayout()){return}if(this.columns&&this.columns.length>0){mini.addClass(this.el,"mini-listbox-showcolumns")}else{mini.removeClass(this.el,"mini-listbox-showcolumns")}if(this.showCheckBox){mini.removeClass(this.el,"mini-listbox-hideCheckBox")}else{mini.addClass(this.el,"mini-listbox-hideCheckBox")}var t=this.uid+"$ck$all";var k=document.getElementById(t);if(k){k.style.display=this.showAllCheckBox?"":"none"}var n=this.isAutoHeight();h=this.getHeight(true);p=mini.getWidth(this._borderEl,true);var l=p;var o=this._viewEl;o.style.width=p+"px";if(!n){var s=mini.getHeight(this._headerEl);h=h-s;o.style.height=h+"px"}else{o.style.height="auto"}if(isIE){var q=this._headerEl.firstChild,r=this._viewEl.firstChild.firstChild;if(this._viewEl.offsetHeight>=this._viewEl.scrollHeight){r.style.width="100%";if(q){q.style.width="100%"}}else{var p=parseInt(r.parentNode.offsetWidth)+"px";if(q){q.style.width=p}}}if(this._viewEl.offsetHeight<this._viewEl.scrollHeight){this._headerEl.style.width=(l-17)+"px"}else{this._headerEl.style.width="100%"}},setShowCheckBox:function(b){this.showCheckBox=b;this.doLayout()},getShowCheckBox:function(){return this.showCheckBox},setShowAllCheckBox:function(b){this.showAllCheckBox=b;this.doLayout()},getShowAllCheckBox:function(){return this.showAllCheckBox},setShowNullItem:function(b){if(this.showNullItem!=b){this.showNullItem=b;this._doNullItem();this.doUpdate()}},getShowNullItem:function(){return this.showNullItem},setNullItemText:function(b){if(this.nullItemText!=b){this.nullItemText=b;this._doNullItem();this.doUpdate()}},getNullItemText:function(){return this.nullItemText},_doNullItem:function(){for(var d=0,f=this.data.length;d<f;d++){var g=this.data[d];if(g.__NullItem){this.data.removeAt(d);break}}if(this.showNullItem){var g={__NullItem:true};g[this.textField]="";g[this.valueField]="";this.data.insert(0,g)}},_OnDrawCell:function(k,j,q){var o=q?mini._getMap(q.field,k):this.getItemText(k);var n={sender:this,index:j,rowIndex:j,record:k,item:k,column:q,field:q?q.field:null,value:o,cellHtml:o,rowCls:null,cellCls:q?(q.cellCls||""):"",rowStyle:null,cellStyle:q?(q.cellStyle||""):""};var l=this.columns&&this.columns.length>0;if(!l){if(j==0&&this.showNullItem){n.cellHtml=this.nullItemText}}if(n.autoEscape==true){n.cellHtml=mini.htmlEncode(n.cellHtml)}if(q){if(q.dateFormat){if(mini.isDate(n.value)){n.cellHtml=mini.formatDate(o,q.dateFormat)}else{n.cellHtml=o}}var p=q.renderer;if(p){fn=typeof p=="function"?p:window[p];if(fn){n.cellHtml=fn.call(q,n)}}}this.fire("drawcell",n);if(n.cellHtml===null||n.cellHtml===undefined||n.cellHtml===""){n.cellHtml="&nbsp;"}return n},__OnScroll:function(b){this._headerEl.scrollLeft=this._viewEl.scrollLeft},__OnClick:function(j){var k=this.uid+"$ck$all";if(j.target.id==k){var i=document.getElementById(k);if(i){var g=i.checked;var l=this.getValue();if(g){this.selectAll()}else{this.deselectAll()}this._OnSelectionChanged();if(l!=this.getValue()){this._OnValueChanged();this.fire("itemclick",{htmlEvent:j})}}return}this._fireEvent(j,"Click")},getAttrs:function(n){var i=mini.ListBox.superclass.getAttrs.call(this,n);mini._ParseString(n,i,["nullItemText","ondrawcell"]);mini._ParseBool(n,i,["showCheckBox","showAllCheckBox","showNullItem"]);if(n.nodeName.toLowerCase()!="select"){var o=mini.getChildNodes(n);for(var p=0,j=o.length;p<j;p++){var l=o[p];var k=jQuery(l).attr("property");if(!k){continue}k=k.toLowerCase();if(k=="columns"){i.columns=mini._ParseColumns(l)}else{if(k=="data"){i.data=l.innerHTML}}}}return i}});mini.regClass(mini.ListBox,"listbox");mini.CheckBoxList=function(){mini.CheckBoxList.superclass.constructor.call(this)};mini.extend(mini.CheckBoxList,mini.ListControl,{formField:true,_labelFieldCls:"mini-labelfield-checkboxlist",multiSelect:true,repeatItems:0,repeatLayout:"none",repeatDirection:"horizontal",_itemCls:"mini-checkboxlist-item",_itemHoverCls:"mini-checkboxlist-item-hover",_itemSelectedCls:"mini-checkboxlist-item-selected",_tableCls:"mini-checkboxlist-table",_tdCls:"mini-checkboxlist-td",_checkType:"checkbox",uiCls:"mini-checkboxlist",_create:function(){var b=this.el=document.createElement("div");this.el.className=this.uiCls;this.el.innerHTML='<table cellpadding="0" border="0" cellspacing="0" style="display:table;"><tr><td><div class="mini-list-inner"></div><div class="mini-errorIcon"></div><input type="hidden" /></td></tr></table>';this.cellEl=b.getElementsByTagName("td")[0];this._innerEl=this.cellEl.firstChild;this._valueEl=this.cellEl.lastChild;this._errorIconEl=this.cellEl.childNodes[1];this._borderEl=this.el.firstChild},_getRepeatTable:function(){var l=[];if(this.repeatItems>0){if(this.repeatDirection=="horizontal"){var k=[];for(var o=0,i=this.data.length;o<i;o++){var n=this.data[o];if(k.length==this.repeatItems){l.push(k);k=[]}k.push(n)}l.push(k)}else{var j=this.repeatItems>this.data.length?this.data.length:this.repeatItems;for(var o=0,i=j;o<i;o++){l.push([])}for(var o=0,i=this.data.length;o<i;o++){var n=this.data[o];var p=o%this.repeatItems;l[p].push(n)}}}else{l=[this.data.clone()]}return l},doUpdate:function(){var o=this.data;var i="";for(var n=0,r=o.length;n<r;n++){var l=o[n];l._i=n}if(this.repeatLayout=="flow"){var k=this._getRepeatTable();for(var n=0,r=k.length;n<r;n++){var j=k[n];for(var p=0,q=j.length;p<q;p++){var l=j[p];i+=this._createItemHtml(l,l._i)}if(n!=r-1){i+="<br/>"}}}else{if(this.repeatLayout=="table"){var k=this._getRepeatTable();i+='<table class="'+this._tableCls+'" cellpadding="0" cellspacing="1">';for(var n=0,r=k.length;n<r;n++){var j=k[n];i+="<tr>";for(var p=0,q=j.length;p<q;p++){var l=j[p];i+='<td class="'+this._tdCls+'">';i+=this._createItemHtml(l,l._i);i+="</td>"}i+="</tr>"}i+="</table>"}else{for(var n=0,r=o.length;n<r;n++){var l=o[n];i+=this._createItemHtml(l,n)}}}this._innerEl.innerHTML=i;for(var n=0,r=o.length;n<r;n++){var l=o[n];delete l._i}},_createItemHtml:function(l,q){var p=this._OnDrawItem(l,q);var t=this._createItemId(q);var o=this._createCheckId(q);var s=this.getItemValue(l);var r="";var k='<div id="'+t+'" index="'+q+'" class="'+this._itemCls+" ";if(l.enabled===false){k+=" mini-disabled ";r="disabled"}var n='onclick="return false"';n='onmousedown="this._checked = this.checked;" onclick="this.checked = this._checked"';k+=p.itemCls+'" style="'+p.itemStyle+'"><input '+n+" "+r+' value="'+s+'" id="'+o+'" type="'+this._checkType+'" /><label for="'+o+'" onclick="return false;">';k+=p.itemHtml+"</label></div>";return k},_OnDrawItem:function(f,g){var j=this.getItemText(f);var i={index:g,item:f,itemHtml:j,itemCls:"",itemStyle:""};this.fire("drawitem",i);if(i.itemHtml===null||i.itemHtml===undefined){i.itemHtml=""}return i},setRepeatItems:function(b){b=parseInt(b);if(isNaN(b)){b=0}if(this.repeatItems!=b){this.repeatItems=b;this.doUpdate()}},getRepeatItems:function(){return this.repeatItems},setRepeatLayout:function(b){if(b!="flow"&&b!="table"){b="none"}if(this.repeatLayout!=b){this.repeatLayout=b;this.doUpdate()}},getRepeatLayout:function(){return this.repeatLayout},setRepeatDirection:function(b){if(b!="vertical"){b="horizontal"}if(this.repeatDirection!=b){this.repeatDirection=b;this.doUpdate()}},getRepeatDirection:function(){return this.repeatDirection},getAttrs:function(l){var g=mini.CheckBoxList.superclass.getAttrs.call(this,l);var j=jQuery(l);mini._ParseString(l,g,["ondrawitem"]);var k=parseInt(j.attr("repeatItems"));if(!isNaN(k)){g.repeatItems=k}var i=j.attr("repeatLayout");if(i){g.repeatLayout=i}var n=j.attr("repeatDirection");if(n){g.repeatDirection=n}return g}});mini.regClass(mini.CheckBoxList,"checkboxlist");mini.RadioButtonList=function(){mini.RadioButtonList.superclass.constructor.call(this)};mini.extend(mini.RadioButtonList,mini.CheckBoxList,{multiSelect:false,_itemCls:"mini-radiobuttonlist-item",_itemHoverCls:"mini-radiobuttonlist-item-hover",_itemSelectedCls:"mini-radiobuttonlist-item-selected",_tableCls:"mini-radiobuttonlist-table",_tdCls:"mini-radiobuttonlist-td",_checkType:"radio",uiCls:"mini-radiobuttonlist"});mini.regClass(mini.RadioButtonList,"radiobuttonlist");mini.TreeSelect=function(){this.data=[];mini.TreeSelect.superclass.constructor.call(this)};mini.extend(mini.TreeSelect,mini.PopupEdit,{valueFromSelect:false,text:"",value:"",autoCheckParent:false,expandOnLoad:false,valueField:"id",textField:"text",nodesField:"children",dataField:"",delimiter:",",multiSelect:false,data:[],url:"",allowInput:false,showTreeIcon:false,showTreeLines:true,resultAsTree:false,parentField:"pid",checkRecursive:false,showFolderCheckBox:false,showRadioButton:false,popupHeight:200,popupWidth:"100%",popupMaxHeight:250,popupMinWidth:100,set:function(j){if(typeof j=="string"){return this}var k=j.value;delete j.value;var i=j.text;delete j.text;var g=j.url;delete j.url;var f=j.data;delete j.data;mini.TreeSelect.superclass.set.call(this,j);if(!mini.isNull(f)){this.setData(f)}if(!mini.isNull(g)){this.setUrl(g)}if(!mini.isNull(k)){this.setValue(k)}if(!mini.isNull(i)){this.setText(i)}return this},uiCls:"mini-treeselect",_createPopup:function(){mini.TreeSelect.superclass._createPopup.call(this);this.tree=new mini.Tree();this.tree.setShowTreeIcon(true);this.tree.setStyle("border:0;width:100%;height:100%;overflow:hidden;");this.tree.setResultAsTree(this.resultAsTree);this.tree.render(this.popup._contentEl);this.tree.setCheckRecursive(this.checkRecursive);this.tree.setShowFolderCheckBox(this.showFolderCheckBox);this.tree.setShowRadioButton(this.showRadioButton);this.tree.setExpandOnNodeClick(this.expandOnNodeClick);this.tree.on("nodeclick",this.__OnNodeClick,this);this.tree.on("nodecheck",this.__OnCheckedChanged,this);this.tree.on("expand",this.__OnTreeExpand,this);this.tree.on("collapse",this.__OnTreeCollapse,this);this.tree.on("beforenodecheck",this.__OnTreeBeforeNodeCheck,this);this.tree.on("beforenodeselect",this.__OnTreeBeforeNodeSelect,this);this.tree.on("drawnode",this.__OnDrawNode,this);this.tree.useAnimation=false;var b=this;this.tree.on("beforeload",function(a){b.fire("beforeload",a)},this);this.tree.on("load",function(a){b.fire("load",a)},this);this.tree.on("loaderror",function(a){b.fire("loaderror",a)},this)},__OnDrawNode:function(b){this.fire("drawnode",b)},__OnTreeBeforeNodeCheck:function(b){b.tree=b.sender;this.fire("beforenodecheck",b)},__OnTreeBeforeNodeSelect:function(b){b.tree=b.sender;this.fire("beforenodeselect",b);if(b.cancel){this._nohide=true}},__OnTreeExpand:function(b){},__OnTreeCollapse:function(b){},findItems:function(b){return this.tree.findNodes(this.tree.getIdField(),b)},findNodes:function(b){return this.tree.getNodesByValue(b)},getSelectedNode:function(){return this.getSelectedNodes()[0]},getCheckedNodes:function(b){return this.tree.getNodesByValue(this.value)},getSelectedNodes:function(){return this.tree.getNodesByValue(this.value)},getParentNode:function(b){return this.tree.getParentNode(b)},getChildNodes:function(b){return this.tree.getChildNodes(b)},showPopup:function(){var d={cancel:false};this.fire("beforeshowpopup",d);this._firebeforeshowpopup=false;if(d.cancel==true){return}var c=this.popup.el.style.height;mini.TreeSelect.superclass.showPopup.call(this);this.tree.setValue(this.value);this._nohide=false},__OnPopupHide:function(b){this.__doFocusCls();this.tree.clearFilter();this.fire("hidepopup")},getItem:function(b){return typeof b=="object"?b:this.data[b]},indexOf:function(b){return this.data.indexOf(b)},getAt:function(b){return this.data[b]},loadList:function(d,f,g){this.tree.loadList(d,f,g);this.data=this.tree.getData();this._getCheckedValue()},getList:function(){return this.tree.getList()},load:function(b){this.tree.load(b);this.data=this.tree.data;this._getCheckedValue()},_eval:function(_){return eval("("+_+")")},setData:function(b){if(typeof b=="string"){b=this._eval(b)}if(!mini.isArray(b)){b=[]}this.tree.setData(b);this.data=this.tree.data;this._getCheckedValue()},getData:function(){return this.data},_getCheckedValue:function(){var b=this.tree.getValue();this.setValue(b)},setUrl:function(b){this.getPopup();this.tree.setUrl(b);this.url=this.tree.url;this.data=this.tree.data;this._getCheckedValue()},getUrl:function(){return this.url},virtualScroll:false,setVirtualScroll:function(b){if(this.tree){this.tree.setVirtualScroll(b)}this.virtualScroll=b},getVirtualScroll:function(){return this.virtualScroll},pinyinField:"tag",setPinyinField:function(b){this.pinyinField=b},getPinyinField:function(){return this.pinyinField},setTextField:function(b){if(this.tree){this.tree.setTextField(b)}this.textField=b},getTextField:function(){return this.textField},setNodesField:function(b){if(this.tree){this.tree.setNodesField(b)}this.nodesField=b},getNodesField:function(){return this.nodesField},setDataField:function(b){if(this.tree){this.tree.setDataField(b)}this.dataField=b},getDataField:function(){return this.dataField},getValue:function(){var b=mini.TreeSelect.superclass.getValue.call(this);if(this.valueFromSelect&&b&&this.findItems(b).length==0){return""}return b},setValue:function(c){var d=this.tree.getValueAndText(c);if(d[1]==""&&!this.valueFromSelect){d[0]=c;d[1]=c}this.value=c;this._valueEl.value=c;this.text=this._textEl.value=d[1];this._doEmpty()},setMultiSelect:function(b){if(this.multiSelect!=b){this.multiSelect=b;this.tree.setShowCheckBox(b);this.tree.setAllowSelect(!b);this.tree.setEnableHotTrack(!b)}},getMultiSelect:function(){return this.multiSelect},__OnNodeClick:function(j){if(this.multiSelect){return}var g=this.tree.getSelectedNode();var k=this.tree.getValueAndText(g);var i=k[0];var l=this.getValue();this.setValue(i);if(l!=this.getValue()){this._OnValueChanged()}if(this._nohide!==true){this.hidePopup();this.focus()}this._nohide=false;this.fire("nodeclick",{node:j.node})},__OnCheckedChanged:function(g){if(!this.multiSelect){return}var f=this.tree.getValue();var d=this.getValue();this.setValue(f);if(d!=this.getValue()){this._OnValueChanged()}this.focus()},__OnInputKeyDown:function(g){var f={htmlEvent:g};this.fire("keydown",f);if(g.keyCode==8&&(this.isReadOnly()||this.allowInput==false)){return false}if(g.keyCode==9){if(this.isShowPopup()){this.hidePopup()}return}if(this.isReadOnly()){return}switch(g.keyCode){case 27:if(this.isShowPopup()){g.stopPropagation()}this.hidePopup();break;case 13:var d=this;setTimeout(function(){d.fire("enter",f)},10);break;case 37:break;case 38:g.preventDefault();break;case 39:break;case 40:g.preventDefault();this.showPopup();break;default:if(this.allowInput==false){}else{var d=this;setTimeout(function(){d._doQuery()},10)}break}},_doQuery:function(){if(this.multiSelect){return}var g=this.textField,f=this.pinyinField;var d=this._textEl.value.toLowerCase();this.tree.filter(function(b){var a=String(b[g]?b[g]:"").toLowerCase();var c=String(b[f]?b[f]:"").toLowerCase();if(a.indexOf(d)!=-1||c.indexOf(d)!=-1){return true}else{return false}});this.tree.expandAll();this.showPopup()},setCheckRecursive:function(b){this.checkRecursive=b;if(this.tree){this.tree.setCheckRecursive(b)}},getCheckRecursive:function(){return this.checkRecursive},setResultAsTree:function(b){this.resultAsTree=b;if(this.tree){this.tree.setResultAsTree(b)}},getResultAsTree:function(){return this.resultAsTree},setParentField:function(b){this.parentField=b;if(this.tree){this.tree.setParentField(b)}},getParentField:function(){return this.parentField},setValueField:function(b){if(this.tree){this.tree.setIdField(b)}this.valueField=b},getValueField:function(){return this.valueField},setShowTreeIcon:function(b){this.showTreeIcon=b;if(this.tree){this.tree.setShowTreeIcon(b)}},getShowTreeIcon:function(){return this.showTreeIcon},setShowTreeLines:function(b){this.showTreeLines=b;if(this.tree){this.tree.setShowTreeLines(b)}},getShowTreeLines:function(){return this.showTreeLines},setShowFolderCheckBox:function(b){this.showFolderCheckBox=b;if(this.tree){this.tree.setShowFolderCheckBox(b)}},getShowFolderCheckBox:function(){return this.showFolderCheckBox},setShowRadioButton:function(b){this.showRadioButton=b;if(this.tree){this.tree.setShowRadioButton(b)}},getShowRadioButton:function(){return this.showRadioButton},setAutoCheckParent:function(b){this.autoCheckParent=b;if(this.tree){this.tree.setAutoCheckParent(b)}},getAutoCheckParent:function(){return this.autoCheckParent},setExpandOnLoad:function(b){this.expandOnLoad=b;if(this.tree){this.tree.setExpandOnLoad(b)}},getExpandOnLoad:function(){return this.expandOnLoad},setValueFromSelect:function(b){this.valueFromSelect=b},getValueFromSelect:function(){return this.valueFromSelect},setAjaxData:function(b){this.ajaxData=b;this.tree.setAjaxData(b)},setAjaxType:function(b){this.ajaxType=b;this.tree.setAjaxType(b)},expandOnNodeClick:false,setExpandOnNodeClick:function(b){this.expandOnNodeClick=b;if(this.tree){this.tree.setExpandOnNodeClick(b)}},getExpandOnNodeClick:function(){return this.expandOnNodeClick},getAttrs:function(d){var f=mini.ComboBox.superclass.getAttrs.call(this,d);mini._ParseString(d,f,["url","data","textField","pinyinField","valueField","nodesField","parentField","onbeforenodecheck","onbeforenodeselect","expandOnLoad","onnodeclick","onbeforeload","onload","onloaderror","ondrawnode"]);mini._ParseBool(d,f,["expandOnNodeClick","multiSelect","resultAsTree","checkRecursive","showTreeIcon","showTreeLines","showFolderCheckBox","showRadioButton","autoCheckParent","valueFromSelect","virtualScroll"]);if(f.expandOnLoad){var g=parseInt(f.expandOnLoad);if(mini.isNumber(g)){f.expandOnLoad=g}else{f.expandOnLoad=f.expandOnLoad=="true"?true:false}}return f}});mini.regClass(mini.TreeSelect,"TreeSelect");mini.Spinner=function(){mini.Spinner.superclass.constructor.call(this);this.setValue(this.minValue)};mini.extend(mini.Spinner,mini.ButtonEdit,{value:0,minValue:0,maxValue:100,increment:1,decimalPlaces:0,changeOnMousewheel:true,allowLimitValue:true,set:function(c){if(typeof c=="string"){return this}var d=c.value;delete c.value;mini.Spinner.superclass.set.call(this,c);if(!mini.isNull(d)){this.setValue(d)}return this},uiCls:"mini-spinner",_getButtonHtml:function(){var b="onmouseover=\"mini.addClass(this, '"+this._buttonHoverCls+"');\" onmouseout=\"mini.removeClass(this, '"+this._buttonHoverCls+"');\"";return'<span class="mini-buttonedit-button" '+b+'><span class="mini-buttonedit-up"><span></span></span><span class="mini-buttonedit-down"><span></span></span></span>'},_initEvents:function(){mini.Spinner.superclass._initEvents.call(this);mini._BindEvents(function(){this.on("buttonmousedown",this.__OnButtonMouseDown,this);mini.on(this.el,"mousewheel",this.__OnMousewheel,this)},this)},_ValueLimit:function(){if(this.allowLimitValue==false){return}if(mini.isNull(this.value)&&this.allowNull){return}if(this.minValue>this.maxValue){this.maxValue=this.minValue+100}if(this.value<this.minValue){this.setValue(this.minValue)}if(this.value>this.maxValue){this.setValue(this.maxValue)}},getFormValue:function(){var g=this.value;g=parseFloat(g);if(this.allowNull&&isNaN(g)){return""}if(isNaN(g)){g=0}var j=String(g).split(".");var k=j[0],n=j[1];if(!n){n=""}if(this.decimalPlaces>0){for(var l=n.length,i=this.decimalPlaces;l<i;l++){n+="0"}n="."+n}return k+n},allowNull:false,setValue:function(b){b=parseFloat(b);if(isNaN(b)){b=this.defaultValue}b=parseFloat(b);if(isNaN(b)&&!this.allowNull){b=this.minValue}if(isNaN(b)&&this.allowNull){b=null}if(b){b=parseFloat(b.toFixed(this.decimalPlaces))}if(this.value!=b){this.value=b;this._ValueLimit();this._valueEl.value=this.value;this.text=this._textEl.value=this.getFormValue()}else{this.text=this._textEl.value=this.getFormValue()}},setMaxValue:function(b){b=parseFloat(b);if(isNaN(b)){return}b=parseFloat(b.toFixed(this.decimalPlaces));if(this.maxValue!=b){this.maxValue=b;this._ValueLimit()}},getMaxValue:function(b){return this.maxValue},setMinValue:function(b){b=parseFloat(b);if(isNaN(b)){return}b=parseFloat(b.toFixed(this.decimalPlaces));if(this.minValue!=b){this.minValue=b;this._ValueLimit()}},getMinValue:function(b){return this.minValue},setIncrement:function(b){b=parseFloat(b);if(isNaN(b)){return}if(this.increment!=b){this.increment=b}},getIncrement:function(b){return this.increment},setDecimalPlaces:function(b){b=parseInt(b);if(isNaN(b)||b<0){return}this.decimalPlaces=b},getDecimalPlaces:function(b){return this.decimalPlaces},setChangeOnMousewheel:function(b){this.changeOnMousewheel=b},getChangeOnMousewheel:function(b){return this.changeOnMousewheel},setAllowLimitValue:function(b){this.allowLimitValue=b},getAllowLimitValue:function(b){return this.allowLimitValue},setAllowNull:function(b){this.allowNull=b},getAllowNull:function(b){return this.allowNull},_SpinTimer:null,_StartSpin:function(i,j,k){this._StopSpin();this.setValue(this.value+i);var l=this;var n=k;var g=new Date();this._SpinTimer=setInterval(function(){l.setValue(l.value+i);l._OnValueChanged();k--;if(k==0&&j>50){l._StartSpin(i,j-100,n+3)}var a=new Date();if(a-g>500){l._StopSpin()}g=a},j);mini.on(document,"mouseup",this._OnDocumentMouseUp,this)},_StopSpin:function(){clearInterval(this._SpinTimer);this._SpinTimer=null},__OnButtonMouseDown:function(b){this._DownValue=this.getValue();this.__OnInputTextChanged();if(b.spinType=="up"){this._StartSpin(this.increment,230,2)}else{this._StartSpin(-this.increment,230,2)}},__OnInputKeyDown:function(c){mini.Spinner.superclass.__OnInputKeyDown.call(this,c);var d=mini.Keyboard;switch(c.keyCode){case d.Top:this.setValue(this.value+this.increment);this._OnValueChanged();break;case d.Bottom:this.setValue(this.value-this.increment);this._OnValueChanged();break}},__OnMousewheel:function(g){if(this.isReadOnly()){return}if(this.changeOnMousewheel==false){return}var d=g.wheelDelta||g.originalEvent.wheelDelta;if(mini.isNull(d)){d=-g.detail*24}var f=this.increment;if(d<0){f=-f}this.setValue(this.value+f);this._OnValueChanged();return false},_OnDocumentMouseUp:function(b){this._StopSpin();mini.un(document,"mouseup",this._OnDocumentMouseUp,this);if(this._DownValue!=this.getValue()){this._OnValueChanged()}},__OnInputTextChanged:function(g){var f=this.getValue();var d=parseFloat(this._textEl.value);this.setValue(d);if(f!=this.getValue()){this._OnValueChanged()}},getAttrs:function(c){var d=mini.Spinner.superclass.getAttrs.call(this,c);mini._ParseString(c,d,["minValue","maxValue","increment","decimalPlaces"]);mini._ParseBool(c,d,["allowLimitValue","allowNull","changeOnMousewheel"]);return d}});mini.regClass(mini.Spinner,"spinner");mini.TimeSpinner=function(){mini.TimeSpinner.superclass.constructor.call(this);this.setValue("00:00:00")};mini.extend(mini.TimeSpinner,mini.ButtonEdit,{value:null,format:"H:mm:ss",uiCls:"mini-timespinner",_getButtonHtml:function(){var b="onmouseover=\"mini.addClass(this, '"+this._buttonHoverCls+"');\" onmouseout=\"mini.removeClass(this, '"+this._buttonHoverCls+"');\"";return'<span class="mini-buttonedit-button" '+b+'><span class="mini-buttonedit-up"><span></span></span><span class="mini-buttonedit-down"><span></span></span></span>'},_initEvents:function(){mini.TimeSpinner.superclass._initEvents.call(this);mini._BindEvents(function(){this.on("buttonmousedown",this.__OnButtonMouseDown,this);mini.on(this.el,"mousewheel",this.__OnMousewheel,this);mini.on(this._textEl,"keydown",this.__OnKeyDown,this)},this)},setFormat:function(c){if(typeof c!="string"){return}var d=["H:mm:ss","HH:mm:ss","H:mm","HH:mm","H","HH","mm:ss"];if(this.format!=c){this.format=c;this.text=this._textEl.value=this.getFormattedValue()}},getFormat:function(){return this.format},setValue:function(b){b=mini.parseTime(b,this.format);if(!b){b=null}if(mini.isDate(b)){b=new Date(b.getTime())}this.value=b;this.text=this._textEl.value=this.getFormattedValue();this._valueEl.value=this.getFormValue()},getValue:function(){return this.value==null?null:new Date(this.value.getTime())},getFormValue:function(){if(!this.value){return""}return mini.formatDate(this.value,this.format)},getFormattedValue:function(){if(!this.value){return""}return mini.formatDate(this.value,this.format)},_ChangeValue:function(i,k){var l=this.getValue();if(l){switch(k){case"hours":var g=l.getHours()+i;if(g>23){g=23}if(g<0){g=0}l.setHours(g);break;case"minutes":var n=l.getMinutes()+i;if(n>59){n=59}if(n<0){n=0}l.setMinutes(n);break;case"seconds":var j=l.getSeconds()+i;if(j>59){j=59}if(j<0){j=0}l.setSeconds(j);break}}else{l="00:00:00"}this.setValue(l)},_SpinTimer:null,_StartSpin:function(i,j,k){this._StopSpin();this._ChangeValue(i,this._timeType);var l=this;var n=k;var g=new Date();this._SpinTimer=setInterval(function(){l._ChangeValue(i,l._timeType);k--;if(k==0&&j>50){l._StartSpin(i,j-100,n+3)}var a=new Date();if(a-g>500){l._StopSpin()}g=a},j);mini.on(document,"mouseup",this._OnDocumentMouseUp,this)},_StopSpin:function(){clearInterval(this._SpinTimer);this._SpinTimer=null},__OnButtonMouseDown:function(b){this._DownValue=this.getFormValue();this._timeType="hours";if(b.spinType=="up"){this._StartSpin(1,230,2)}else{this._StartSpin(-1,230,2)}},_OnDocumentMouseUp:function(b){this._StopSpin();mini.un(document,"mouseup",this._OnDocumentMouseUp,this);if(this._DownValue!=this.getFormValue()){this._OnValueChanged()}},__OnInputTextChanged:function(c){var d=this.getFormValue();this.setValue(this._textEl.value);if(d!=this.getFormValue()){this._OnValueChanged()}},getAttrs:function(c){var d=mini.TimeSpinner.superclass.getAttrs.call(this,c);mini._ParseString(c,d,["format"]);return d}});mini.regClass(mini.TimeSpinner,"timespinner");mini.HtmlFile=function(){mini.HtmlFile.superclass.constructor.call(this);this.on("validation",this.__OnValidation,this)};mini.extend(mini.HtmlFile,mini.ButtonEdit,{buttonText:"浏览...",_buttonWidth:56,limitType:"",limitTypeErrorText:"上传文件格式为：",allowInput:false,readOnly:true,_cellSpacing:0,uiCls:"mini-htmlfile",_create:function(){mini.HtmlFile.superclass._create.call(this);this._fileEl=mini.append(this.el,'<input type="file" hideFocus class="mini-htmlfile-file" name="'+this.name+'" ContentEditable=false/>');mini.on(this._borderEl,"mousemove",this.__OnMouseMove,this);mini.on(this._fileEl,"change",this.__OnFileChange,this)},_getButtonHtml:function(){var b="onmouseover=\"mini.addClass(this, '"+this._buttonHoverCls+"');\" onmouseout=\"mini.removeClass(this, '"+this._buttonHoverCls+"');\"";return'<span class="mini-buttonedit-button" '+b+">"+this.buttonText+"</span>"},__OnFileChange:function(b){this.value=this._textEl.value=this._fileEl.value;this._OnValueChanged();b={htmlEvent:b};this.fire("fileselect",b)},__OnMouseMove:function(j){var g=j.pageX,i=j.pageY;var f=mini.getBox(this.el);g=(g-f.x-5);i=(i-f.y-5);if(this.enabled==false){g=-20;i=-20}this._fileEl.style.display="";this._fileEl.style.left=g+"px";this._fileEl.style.top=i+"px"},__OnValidation:function(j){if(!this.limitType){return}if(j.isValid==false){return}if(this.required==false&&j.value==""){return}var i=j.value.split(".");var g=("*."+i[i.length-1]).toLowerCase();var f=this.limitType.split(";");if(f.length>0&&f.indexOf(g)==-1){j.errorText=this.limitTypeErrorText+this.limitType;j.isValid=false}},setName:function(b){this.name=b;mini.setAttr(this._fileEl,"name",this.name)},getValue:function(){return this._textEl.value},setButtonText:function(c){this.buttonText=c;var d=mini.byClass("mini-buttonedit-button",this.el);if(d){d.innerHTML=c}},getButtonText:function(){return this.buttonText},setLimitType:function(b){this.limitType=b},getLimitType:function(){return this.limitType},getAttrs:function(c){var d=mini.HtmlFile.superclass.getAttrs.call(this,c);mini._ParseString(c,d,["limitType","buttonText","limitTypeErrorText","onfileselect"]);return d}});mini.regClass(mini.HtmlFile,"htmlfile");mini.FileUpload=function(b){this.postParam={};mini.FileUpload.superclass.constructor.call(this,b);this.on("validation",this.__OnValidation,this)};mini.extend(mini.FileUpload,mini.ButtonEdit,{buttonText:"浏览...",_buttonWidth:56,limitTypeErrorText:"上传文件格式为：",readOnly:true,_cellSpacing:0,limitSize:"",limitType:"",typesDescription:"上传文件格式",uploadLimit:0,queueLimit:"",flashUrl:"",uploadUrl:"",showUploadProgress:true,postParam:null,uploadOnSelect:false,uiCls:"mini-fileupload",_create:function(){mini.FileUpload.superclass._create.call(this);mini.addClass(this.el,"mini-htmlfile");this._progressbarEl=mini.append(this._borderEl,'<div id="'+this._id+'$progressbar"  class="mini-fileupload-progressbar"><div id="'+this._id+'$complete" class="mini-fileupload-complete"></div></div>');this._completeEl=this._progressbarEl.firstChild;this._uploadId=this._id+"$button_placeholder";this._fileEl=mini.append(this.el,'<span id="'+this._uploadId+'"></span>');this.uploadEl=this._fileEl;mini.on(this._borderEl,"mousemove",this.__OnMouseMove,this)},_getButtonHtml:function(){var b="onmouseover=\"mini.addClass(this, '"+this._buttonHoverCls+"');\" onmouseout=\"mini.removeClass(this, '"+this._buttonHoverCls+"');\"";return'<span class="mini-buttonedit-button" '+b+">"+this.buttonText+"</span>"},destroy:function(b){if(this._innerEl){mini.clearEvent(this._innerEl);this._innerEl=null}if(this.swfUpload){this.swfUpload.destroy();this.swfUpload=null}mini.FileUpload.superclass.destroy.call(this,b)},__OnMouseMove:function(g){if(this.enabled==false){return}var i=this;if(!this.swfUpload){var f=new SWFUpload({file_post_name:this.name,upload_url:i.uploadUrl,flash_url:i.flashUrl,file_size_limit:i.limitSize,file_types:i.limitType,file_types_description:i.typesDescription,file_upload_limit:parseInt(i.uploadLimit),file_queue_limit:i.queueLimit,file_queued_handler:mini.createDelegate(this.__on_file_queued,this),upload_error_handler:mini.createDelegate(this.__on_upload_error,this),upload_success_handler:mini.createDelegate(this.__on_upload_success,this),upload_complete_handler:mini.createDelegate(this.__on_upload_complete,this),upload_progress_handler:mini.createDelegate(this.__on_upload_progress,this),button_placeholder_id:this._uploadId,button_width:1000,button_height:50,button_window_mode:"transparent",button_action:SWFUpload.BUTTON_ACTION.SELECT_FILE,debug:false});f.flashReady();this.swfUpload=f;var j=this.swfUpload.movieElement;j.style.zIndex=1000;j.style.position="absolute";j.style.left="0px";j.style.top="0px";j.style.width="100%";j.style.height="50px"}else{}},addPostParam:function(b){mini.copyTo(this.postParam,b)},setPostParam:function(b){this.addPostParam(b)},getPostParam:function(){return this.postParam},setLimitType:function(b){this.limitType=b;if(this.swfUpload){this.swfUpload.setFileTypes(this.limitType,this.typesDescription)}},getLimitType:function(){return this.limitType},setTypesDescription:function(b){this.typesDescription=b;if(this.swfUpload){this.swfUpload.setFileTypes(this.limitType,this.typesDescription)}},getTypesDescription:function(){return this.typesDescription},setButtonText:function(b){this.buttonText=b;this._buttonEl.innerHTML=b},getButtonText:function(){return this.buttonText},setUploadLimit:function(b){this.uploadLimit=b},setQueueLimit:function(b){this.queueLimit=b},setFlashUrl:function(b){this.flashUrl=b},setUploadUrl:function(b){if(this.swfUpload){this.swfUpload.setUploadURL(b)}this.uploadUrl=b},setName:function(b){this.name=b},startUpload:function(c){var d={cancel:false};this.fire("beforeupload",d);if(d.cancel==true){return}if(this.swfUpload){this.swfUpload.setPostParams(this.postParam);this.swfUpload.startUpload()}},setShowUploadProgress:function(b){this.showUploadProgress=b;this._progressbarEl.style.display=b?"block":"none"},getShowUploadProgress:function(){return this.showUploadProgress},__on_upload_progress:function(o,i,l){if(this.showUploadProgress){var j=mini.getWidth(this._progressbarEl);var n=j*i/l;mini.setWidth(this._completeEl,n)}this._progressbarEl.style.display=this.showUploadProgress?"block":"none";var k={file:o,complete:i,total:l};this.fire("uploadprogress",k)},__on_file_queued:function(j){var g=this.swfUpload.getStats().files_queued;if(g>1){for(var f=0;f<g-1;f++){this.swfUpload.cancelUpload()}}var i={file:j};if(this.uploadOnSelect){this.startUpload()}this.setText(j.name);this.fire("fileselect",i)},__on_upload_success:function(d,f){var g={file:d,serverData:f};this.fire("uploadsuccess",g);this._progressbarEl.style.display="none"},__on_upload_error:function(g,j,f){this._progressbarEl.style.display="none";var i={file:g,code:j,message:f};this.fire("uploaderror",i)},__on_upload_complete:function(b){this._progressbarEl.style.display="none";this.fire("uploadcomplete",b)},__fileError:function(){},getAttrs:function(c){var d=mini.FileUpload.superclass.getAttrs.call(this,c);mini._ParseString(c,d,["limitType","limitSize","flashUrl","uploadUrl","uploadLimit","buttonText","showUploadProgress","onuploadsuccess","onuploaderror","onuploadcomplete","onfileselect","onuploadprogress"]);mini._ParseBool(c,d,["uploadOnSelect"]);return d}});mini.regClass(mini.FileUpload,"fileupload");mini.Lookup=function(){this.data=[];mini.Lookup.superclass.constructor.call(this);mini.on(this._textEl,"mouseup",this.__OnMouseUp,this);this.on("showpopup",this.__OnShowPopup,this)};mini.extend(mini.Lookup,mini.PopupEdit,{allowInput:true,valueField:"id",textField:"text",delimiter:",",multiSelect:false,data:[],grid:null,_destroyPopup:false,uiCls:"mini-lookup",destroy:function(b){if(this.grid){this.grid.un("rowclick",this.__OnGridRowClickChanged,this);this.grid.un("load",this.__OnGridLoad,this);this.grid=null}mini.Lookup.superclass.destroy.call(this,b)},setMultiSelect:function(b){this.multiSelect=b;if(this.grid){this.grid.setMultiSelect(b)}},setGrid:function(b){if(typeof b=="string"){mini.parse(b);b=mini.get(b)}this.grid=mini.getAndCreate(b);if(this.grid){this.grid.setMultiSelect(this.multiSelect);this.grid.setCheckSelectOnLoad(false);this.grid.on("rowclick",this.__OnGridRowClickChanged,this);this.grid.on("load",this.__OnGridLoad,this);this.grid.on("checkall",this.__OnGridRowClickChanged,this)}},getGrid:function(){return this.grid},setValueField:function(b){this.valueField=b},getValueField:function(){return this.valueField},setTextField:function(b){this.textField=b},getTextField:function(){return this.textField},deselectAll:function(){this.data=[];this.setValue("");this.setText("");if(this.grid){this.grid.deselectAll()}},getItemValue:function(b){return String(b[this.valueField])},getItemText:function(c){var d=c[this.textField];return mini.isNull(d)?"":String(d)},getValueAndText:function(l){if(mini.isNull(l)){l=[]}var n=[];var j=[];for(var k=0,g=l.length;k<g;k++){var i=l[k];if(i){n.push(this.getItemValue(i));j.push(this.getItemText(i))}}return[n.join(this.delimiter),j.join(this.delimiter)]},_createData:function(){this.value=mini.isNull(this.value)?"":String(this.value);this.text=mini.isNull(this.text)?"":String(this.text);var p=[];var l=this.value.split(this.delimiter);var r=this.text.split(this.delimiter);var n=l.length;if(this.value){for(var o=0,q=n;o<q;o++){var i={};var s=l[o];var k=r[o];i[this.valueField]=s?s:"";i[this.textField]=k?k:"";p.push(i)}}this.data=p},_getValueMaps:function(n){var j={};for(var g=0,i=n.length;g<i;g++){var l=n[g];var k=l[this.valueField];j[k]=l}return j},setValue:function(b){mini.Lookup.superclass.setValue.call(this,b);this._createData()},setText:function(b){mini.Lookup.superclass.setText.call(this,b);this._createData()},__OnGridRowClickChanged:function(o){var i=this._getValueMaps(this.grid.getData());var q=this._getValueMaps(this.grid.getSelecteds());var l=this._getValueMaps(this.data);if(this.multiSelect==false){l={};this.data=[]}var n={};for(var t in l){var s=l[t];if(i[t]){if(q[t]){}else{n[t]=s}}}for(var p=this.data.length-1;p>=0;p--){var s=this.data[p];var t=s[this.valueField];if(n[t]){this.data.removeAt(p)}}for(var t in q){var s=q[t];if(!l[t]){this.data.push(s)}}var r=this.getValueAndText(this.data);this.setValue(r[0]);this.setText(r[1]);this._OnValueChanged()},__OnGridLoad:function(b){this.__OnShowPopup(b)},__OnShowPopup:function(p){var s=String(this.value).split(this.delimiter);var n={};for(var q=0,t=s.length;q<t;q++){var o=s[q];n[o]=1}var i=this.grid.getData();var r=[];for(var q=0,t=i.length;q<t;q++){var l=i[q];var u=l[this.valueField];if(n[u]){r.push(l)}}this.grid.selects(r)},doUpdate:function(){mini.Lookup.superclass.doUpdate.call(this);this._textEl.readOnly=true;this.el.style.cursor="default"},__OnInputKeyDown:function(b){mini.Lookup.superclass.__OnInputKeyDown.call(this,b);switch(b.keyCode){case 46:case 8:break;case 37:break;case 39:break}},__OnMouseUp:function(k){if(this.isReadOnly()){return}var l=mini.getSelectRange(this._textEl);var j=l[0],i=l[1];var g=this._findTextIndex(j)},_findTextIndex:function(k){var p=-1;if(this.text==""){return p}var n=String(this.text).split(this.delimiter);var j=0;for(var o=0,i=n.length;o<i;o++){var l=n[o];if(j<k&&k<=j+l.length){p=o;break}j=j+l.length+1}return p},getAttrs:function(c){var d=mini.Lookup.superclass.getAttrs.call(this,c);mini._ParseString(c,d,["grid","valueField","textField"]);mini._ParseBool(c,d,["multiSelect"]);return d}});mini.regClass(mini.Lookup,"lookup");mini.TextBoxList=function(){mini.TextBoxList.superclass.constructor.call(this);this.data=[];this.doUpdate()};mini.extend(mini.TextBoxList,mini.ValidatorBase,{formField:true,value:"",text:"",valueField:"id",textField:"text",data:"",url:"",delay:150,allowInput:true,editIndex:0,_focusCls:"mini-textboxlist-focus",_itemHoverClass:"mini-textboxlist-item-hover",_itemSelectedClass:"mini-textboxlist-item-selected",_closeHoverClass:"mini-textboxlist-close-hover",textName:"",setTextName:function(b){this.textName=b},getTextName:function(){return this.textName},uiCls:"mini-textboxlist",_create:function(){var f='<table class="mini-textboxlist" cellpadding="0" cellspacing="0"><tr ><td class="mini-textboxlist-border"><ul></ul><a href="#"></a><input type="hidden"/></td></tr></table>';var d=document.createElement("div");d.innerHTML=f;this.el=d.firstChild;var g=this.el.getElementsByTagName("td")[0];this.ulEl=g.firstChild;this._valueEl=g.lastChild;this.focusEl=g.childNodes[1]},destroy:function(b){if(this.isShowPopup){this.hidePopup()}mini.un(document,"mousedown",this.__OnDocMouseDown,this);mini.TextBoxList.superclass.destroy.call(this,b)},_initEvents:function(){mini.TextBoxList.superclass._initEvents.call(this);mini.on(this.el,"mousemove",this.__OnMouseMove,this);mini.on(this.el,"mouseout",this.__OnMouseOut,this);mini.on(this.el,"mousedown",this.__OnMouseDown,this);mini.on(this.el,"click",this.__OnClick,this);mini.on(this.el,"keydown",this.__OnKeyDown,this);mini.on(document,"mousedown",this.__OnDocMouseDown,this)},__OnDocMouseDown:function(b){if(this.isReadOnly()){return}if(this.isShowPopup){if(!mini.isAncestor(this.popup.el,b.target)){this.hidePopup()}}if(this._focused){if(this.within(b)==false){this.select(null,false);this.showInput(false);this.removeCls(this._focusCls);this._focused=false}}},errorIconEl:null,getErrorIconEl:function(){if(!this._errorIconEl){var d=this.el.rows[0];var c=d.insertCell(1);c.style.cssText="width:18px;vertical-align:top;";c.innerHTML='<div class="mini-errorIcon"></div>';this._errorIconEl=c.firstChild}return this._errorIconEl},_RemoveErrorIcon:function(){if(this._errorIconEl){jQuery(this._errorIconEl.parentNode).remove()}this._errorIconEl=null},doLayout:function(){if(this.canLayout()==false){return}mini.TextBoxList.superclass.doLayout.call(this);if(this.isReadOnly()||this.allowInput==false){this._inputEl.readOnly=true}else{this._inputEl.readOnly=false}},doUpdate:function(){if(this._ValueChangeTimer){clearInterval(this._ValueChangeTimer)}if(this._inputEl){mini.un(this._inputEl,"keydown",this.__OnInputKeyDown,this)}var l=[];var s=this.uid;for(var p=0,q=this.data.length;p<q;p++){var r=this.data[p];var i=s+"$text$"+p;var k=mini._getMap(this.textField,r);if(mini.isNull(k)){k=""}l[l.length]='<li id="'+i+'" class="mini-textboxlist-item">';l[l.length]=k;l[l.length]='<span class="mini-textboxlist-close"></span></li>'}var n=s+"$input";l[l.length]='<li id="'+n+'" class="mini-textboxlist-inputLi"><input class="mini-textboxlist-input" type="text" autocomplete="off"></li>';this.ulEl.innerHTML=l.join("");this.editIndex=this.data.length;if(this.editIndex<0){this.editIndex=0}this.inputLi=this.ulEl.lastChild;this._inputEl=this.inputLi.firstChild;mini.on(this._inputEl,"keydown",this.__OnInputKeyDown,this);var o=this;this._inputEl.onkeyup=function(){o._syncInputSize()};o._ValueChangeTimer=null;o._LastInputText=o._inputEl.value;this._inputEl.onfocus=function(){o._ValueChangeTimer=setInterval(function(){if(o._LastInputText!=o._inputEl.value){o._startQuery();o._LastInputText=o._inputEl.value}},10);o.addCls(o._focusCls);o._focused=true;o.fire("focus")};this._inputEl.onblur=function(){clearInterval(o._ValueChangeTimer);o.fire("blur")}},getItemByEvent:function(j){var f=mini.findParent(j.target,"mini-textboxlist-item");if(f){var g=f.id.split("$");var i=g[g.length-1];return this.data[i]}},getItem:function(b){if(typeof b=="number"){return this.data[b]}if(typeof b=="object"){return b}},getItemEl:function(g){var f=this.data.indexOf(g);var d=this.uid+"$text$"+f;return document.getElementById(d)},hoverItem:function(d,g){if(this.isReadOnly()||this.enabled==false){return}this.blurItem();var f=this.getItemEl(d);mini.addClass(f,this._itemHoverClass);if(g&&mini.hasClass(g.target,"mini-textboxlist-close")){mini.addClass(g.target,this._closeHoverClass)}},blurItem:function(){var f=this.data.length;for(var j=0,k=f;j<k;j++){var i=this.data[j];var g=this.getItemEl(i);if(g){mini.removeClass(g,this._itemHoverClass);mini.removeClass(g.lastChild,this._closeHoverClass)}}},showInput:function(f){this.select(null);if(mini.isNumber(f)){this.editIndex=f}else{this.editIndex=this.data.length}if(this.editIndex<0){this.editIndex=0}if(this.editIndex>this.data.length){this.editIndex=this.data.length}var g=this.inputLi;g.style.display="block";if(mini.isNumber(f)&&f<this.data.length){var i=this.data[f];var j=this.getItemEl(i);jQuery(j).before(g)}else{this.ulEl.appendChild(g)}if(f!==false){setTimeout(function(){try{g.firstChild.focus();mini.selectRange(g.firstChild,100)}catch(a){}},10)}else{this.lastInputText="";this._inputEl.value=""}return g},select:function(i){i=this.getItem(i);if(this._selected){var g=this.getItemEl(this._selected);mini.removeClass(g,this._itemSelectedClass)}this._selected=i;if(this._selected){var g=this.getItemEl(this._selected);mini.addClass(g,this._itemSelectedClass)}var j=this;if(this._selected){this.focusEl.focus();var f=this;setTimeout(function(){try{f.focusEl.focus()}catch(a){}},50)}if(this._selected){j.addCls(j._focusCls);j._focused=true}},_doInsertSelectValue:function(){var c=this._listbox.getSelected();var d=this.editIndex;if(c){c=mini.clone(c);this.insertItem(d,c)}},insertItem:function(g,f){this.data.insert(g,f);var i=this.getText();var j=this.getValue();this.setValue(j,false);this.setText(i,false);this._createData();this.doUpdate();this.showInput(g+1);this._OnValueChanged()},removeItem:function(f){if(!f){return}var g=this.getItemEl(f);mini.removeNode(g);this.data.remove(f);var i=this.getText();var j=this.getValue();this.setValue(j,false);this.setText(i,false);this._OnValueChanged()},_createData:function(){var n=(this.text?this.text:"").split(",");var q=(this.value?this.value:"").split(",");if(q[0]==""){q=[]}var j=q.length;this.data.length=j;for(var p=0,i=j;p<i;p++){var k=this.data[p];if(!k){k={};this.data[p]=k}var l=!mini.isNull(n[p])?n[p]:"";var o=!mini.isNull(q[p])?q[p]:"";mini._setMap(this.textField,l,k);mini._setMap(this.valueField,o,k)}this.value=this.getValue();this.text=this.getText()},getInputText:function(){return this._inputEl?this._inputEl.value:""},getText:function(){var i=[];for(var k=0,g=this.data.length;k<g;k++){var j=this.data[k];var f=mini._getMap(this.textField,j);if(mini.isNull(f)){f=""}f=f.replace(",","，");i.push(f)}return i.join(",")},getValue:function(){var i=[];for(var k=0,g=this.data.length;k<g;k++){var j=this.data[k];var f=mini._getMap(this.valueField,j);i.push(f)}return i.join(",")},setName:function(b){if(this.name!=b){this.name=b;this._valueEl.name=b}},setValue:function(b){if(mini.isNull(b)){b=""}if(this.value!=b){this.value=b;this._valueEl.value=b;this._createData();this.doUpdate()}},setText:function(b){if(mini.isNull(b)){b=""}if(this.text!==b){this.text=b;this._createData();this.doUpdate()}},setValueField:function(b){this.valueField=b;this._createData()},getValueField:function(){return this.valueField},setTextField:function(b){this.textField=b;this._createData()},getTextField:function(){return this.textField},setAllowInput:function(b){this.allowInput=b;this.doLayout()},getAllowInput:function(){return this.allowInput},setUrl:function(b){this.url=b},getUrl:function(){return this.url},setPopupHeight:function(b){this.popupHeight=b},getPopupHeight:function(){return this.popupHeight},setPopupMinHeight:function(b){this.popupMinHeight=b},getPopupMinHeight:function(){return this.popupMinHeight},setPopupMaxHeight:function(b){this.popupMaxHeight=b},getPopupMaxHeight:function(){return this.popupMaxHeight},doQuery:function(){this._startQuery(true)},_syncInputSize:function(){if(this.isDisplay()==false){return}var i=this.getInputText();var f=mini.measureText(this._inputEl,i);var j=f.width>20?f.width+4:20;var g=mini.getWidth(this.el,true);if(j>g-15){j=g-15}this._inputEl.style.width=j+"px"},_startQuery:function(d){var c=this;setTimeout(function(){c._syncInputSize()},1);this.showPopup("loading");this._stopQuery();this._loading=true;this.delayTimer=setTimeout(function(){var a=c._inputEl.value;c._doQuery()},this.delay)},ajaxDataType:"text",ajaxContentType:"application/x-www-form-urlencoded; charset=UTF-8",_doQuery:function(){if(this.isDisplay()==false){return}var k=this.getInputText();var q=this;var t=this._listbox.getData();var r={value:this.getValue(),text:this.getText()};r[this.searchField]=k;var s=this.url;var l=typeof s=="function"?s:window[s];if(typeof l=="function"){s=l(this)}if(!s){return}var o="post";if(s){if(s.indexOf(".txt")!=-1||s.indexOf(".json")!=-1){o="get"}}var p={url:s,async:true,params:r,data:r,type:this.ajaxType?this.ajaxType:o,cache:false,cancel:false};this.fire("beforeload",p);if(p.cancel){return}var n=this;mini.copyTo(p,{success:function(g,f,a){delete p.params;var b={text:g,result:null,sender:n,options:p,xhr:a};var d=null;try{mini_doload(b);d=b.result;if(!d){d=mini.decode(g)}}catch(c){if(mini_debugger==true){throw new Error("textboxlist json is error")}}if(mini.isArray(d)){d={data:d}}if(n.dataField){d.data=mini._getMap(n.dataField,d)}if(!d.data){d.data=[]}q._listbox.setData(d.data);q.showPopup();q._listbox._focusItem(0,true);q.fire("load",{data:d.data,result:d});q._loading=false;if(q._selectOnLoad){q.__doSelectValue();q._selectOnLoad=null}},error:function(c,a,b){q.showPopup("error")}});q._ajaxer=mini.ajax(p)},_stopQuery:function(){if(this.delayTimer){clearTimeout(this.delayTimer);this.delayTimer=null}if(this._ajaxer){this._ajaxer.abort()}this._loading=false},within:function(b){if(mini.isAncestor(this.el,b.target)){return true}if(this.showPopup&&this.popup&&this.popup.within(b)){return true}return false},popupLoadingText:"<span class='mini-textboxlist-popup-loading'>Loading...</span>",popupErrorText:"<span class='mini-textboxlist-popup-error'>Error</span>",popupEmptyText:"<span class='mini-textboxlist-popup-noresult'>No Result</span>",isShowPopup:false,popupHeight:"",popupMinHeight:30,popupMaxHeight:150,_createPopup:function(){if(!this.popup){this.popup=new mini.ListBox();this.popup.addCls("mini-textboxlist-popup");this.popup.setStyle("position:absolute;left:0;top:0;");this.popup.showEmpty=true;this.popup.setValueField(this.valueField);this.popup.setTextField(this.textField);this.popup.render(document.body);this.popup.on("itemclick",function(b){this.hidePopup();this._doInsertSelectValue()},this)}this._listbox=this.popup;return this.popup},showPopup:function(l){if(this.isDisplay()==false){return}this.isShowPopup=true;var g=this._createPopup();g.el.style.zIndex=mini.getMaxZIndex();var k=this._listbox;k.emptyText=this.popupEmptyText;if(l=="loading"){k.emptyText=this.popupLoadingText;this._listbox.setData([])}else{if(l=="error"){k.emptyText=this.popupLoadingText;this._listbox.setData([])}}this._listbox.doUpdate();var n=this.getBox();var i=n.x,j=n.y+n.height;this.popup.el.style.display="block";mini.setXY(g.el,-1000,-1000);this.popup.setWidth(n.width);this.popup.setHeight(this.popupHeight);if(this.popup.getHeight()<this.popupMinHeight){this.popup.setHeight(this.popupMinHeight)}if(this.popup.getHeight()>this.popupMaxHeight){this.popup.setHeight(this.popupMaxHeight)}mini.setXY(g.el,i,j)},hidePopup:function(){this.isShowPopup=false;if(this.popup){this.popup.el.style.display="none"}},__OnMouseMove:function(c){if(this.enabled==false){return}var d=this.getItemByEvent(c);if(!d){this.blurItem();return}this.hoverItem(d,c)},__OnMouseOut:function(b){this.blurItem()},__OnClick:function(c){if(this.isReadOnly()||this.enabled==false){return}if(this.enabled==false){return}var d=this.getItemByEvent(c);if(!d){if(mini.findParent(c.target,"mini-textboxlist-input")){}else{this.showInput()}return}this.focusEl.focus();this.select(d);if(c&&mini.hasClass(c.target,"mini-textboxlist-close")){this.removeItem(d)}},__OnKeyDown:function(i){if(this.isReadOnly()||this.allowInput==false){return false}var f=this.data.indexOf(this._selected);var j=this;function g(){var a=j.data[f];j.removeItem(a);a=j.data[f];if(!a){a=j.data[f-1]}j.select(a);if(!a){j.showInput()}}switch(i.keyCode){case 8:i.preventDefault();g();break;case 37:case 38:this.select(null);this.showInput(f);break;case 39:case 40:f+=1;this.select(null);this.showInput(f);break;case 46:g();break}},__doSelectValue:function(){var b=this._listbox.getFocusedItem();if(b){this._listbox.setSelected(b)}this.lastInputText=this.text;this.hidePopup();this._doInsertSelectValue()},__OnInputKeyDown:function(n){this._selectOnLoad=null;if(this.isReadOnly()||this.allowInput==false){return false}n.stopPropagation();if(this.isReadOnly()||this.allowInput==false){return}var p=mini.getSelectRange(this._inputEl);var t=p[0],s=p[1],l=this._inputEl.value.length;var r=t==s&&t==0;var q=t==s&&s==l;if(this.isReadOnly()||this.allowInput==false){n.preventDefault()}if(n.keyCode==9){this.hidePopup();return}if(n.keyCode==16||n.keyCode==17||n.keyCode==18){return}switch(n.keyCode){case 13:if(this.isShowPopup){n.preventDefault();if(this._loading){this._selectOnLoad=true;return}this.__doSelectValue()}break;case 27:n.preventDefault();this.hidePopup();break;case 8:if(r){n.preventDefault()}case 37:if(r){if(this.isShowPopup){this.hidePopup()}else{if(this.editIndex>0){var o=this.editIndex-1;if(o<0){o=0}if(o>=this.data.length){o=this.data.length-1}this.showInput(false);this.select(o)}}}break;case 39:if(q){if(this.isShowPopup){this.hidePopup()}else{if(this.editIndex<=this.data.length-1){var o=this.editIndex;this.showInput(false);this.select(o)}}}break;case 38:n.preventDefault();if(this.isShowPopup){var o=-1;var k=this._listbox.getFocusedItem();if(k){o=this._listbox.indexOf(k)}o--;if(o<0){o=0}this._listbox._focusItem(o,true)}break;case 40:n.preventDefault();if(this.isShowPopup){var o=-1;var k=this._listbox.getFocusedItem();if(k){o=this._listbox.indexOf(k)}o++;if(o<0){o=0}if(o>=this._listbox.getCount()){o=this._listbox.getCount()-1}this._listbox._focusItem(o,true)}else{this._startQuery(true)}break;default:break}},focus:function(){try{this._inputEl.focus()}catch(b){}},blur:function(){try{this._inputEl.blur()}catch(b){}},searchField:"key",setSearchField:function(b){this.searchField=b},getSearchField:function(){return this.searchField},getAttrs:function(d){var f=mini.TextBox.superclass.getAttrs.call(this,d);var g=jQuery(d);mini._ParseString(d,f,["value","text","valueField","textField","url","popupHeight","textName","onfocus","onbeforeload","onload","searchField"]);mini._ParseBool(d,f,["allowInput"]);mini._ParseInt(d,f,["popupMinHeight","popupMaxHeight"]);return f}});mini.regClass(mini.TextBoxList,"textboxlist");mini.AutoComplete=function(){mini.AutoComplete.superclass.constructor.call(this);var b=this;b._ValueChangeTimer=null;this._textEl.onfocus=function(){b._LastInputText=b._textEl.value;b._ValueChangeTimer=setInterval(function(){if(b._LastInputText!=b._textEl.value){b._tryQuery();b._LastInputText=b._textEl.value;if(b._textEl.value==""&&b.value!=""){b.setValue("");b._OnValueChanged()}}},10)};this._textEl.onblur=function(){clearInterval(b._ValueChangeTimer);if(!b.isShowPopup()){if(b._LastInputText!=b._textEl.value){if(b._textEl.value==""&&b.value!=""){b.setValue("");b._OnValueChanged()}}}};this._buttonEl.style.display="none";this._doInputLayout()};mini.extend(mini.AutoComplete,mini.ComboBox,{url:"",allowInput:true,delay:150,searchField:"key",minChars:0,_buttonWidth:0,uiCls:"mini-autocomplete",setUrl:function(b){this.url=b},setValue:function(b){if(mini.isNull(b)){b=""}if(this.value!=b){this.value=b;this._valueEl.value=this.value}},setText:function(b){if(mini.isNull(b)){b=""}if(this.text!=b){this.text=b;this._LastInputText=b}this._textEl.value=this.text},setMinChars:function(b){this.minChars=b},getMinChars:function(){return this.minChars},setSearchField:function(b){this.searchField=b},getSearchField:function(){return this.searchField},popupLoadingText:"<span class='mini-textboxlist-popup-loading'>Loading...</span>",popupErrorText:"<span class='mini-textboxlist-popup-error'>Error</span>",popupEmptyText:"<span class='mini-textboxlist-popup-noresult'>No Result</span>",showPopup:function(d){var f=this.getPopup();var g=this._listbox;g.showEmpty=true;g.emptyText=this.popupEmptyText;if(d=="loading"){g.emptyText=this.popupLoadingText;this._listbox.setData([])}else{if(d=="error"){g.emptyText=this.popupLoadingText;this._listbox.setData([])}}this._listbox.doUpdate();mini.AutoComplete.superclass.showPopup.call(this)},__OnInputKeyDown:function(k){var i={htmlEvent:k};this.fire("keydown",i);if(k.keyCode==8&&(this.isReadOnly()||this.allowInput==false)){return false}if(k.keyCode==9){this.hidePopup();return}if(k.keyCode==16||k.keyCode==17||k.keyCode==18){return}if(this.isReadOnly()){return}switch(k.keyCode){case 27:if(this.isShowPopup()){k.stopPropagation()}this.hidePopup();break;case 13:if(this.isShowPopup()){k.preventDefault();k.stopPropagation();var j=this._listbox.getFocusedIndex();if(j!=-1){var o=this._listbox.getAt(j);var l=this._listbox.getValueAndText([o]);var n=l[0];this.setText(l[1]);this.setValue(n);this._OnValueChanged();this.hidePopup();this.focus()}}else{this.fire("enter",i)}break;case 37:break;case 38:var j=this._listbox.getFocusedIndex();if(j==-1){j=0;if(!this.multiSelect){var o=this._listbox.findItems(this.value)[0];if(o){j=this._listbox.indexOf(o)}}}if(this.isShowPopup()){if(!this.multiSelect){j-=1;if(j<0){j=0}this._listbox._focusItem(j,true)}}break;case 39:break;case 40:var j=this._listbox.getFocusedIndex();if(this.isShowPopup()){if(!this.multiSelect){j+=1;if(j>this._listbox.getCount()-1){j=this._listbox.getCount()-1}this._listbox._focusItem(j,true)}}else{this._tryQuery(this._textEl.value)}break;default:this._tryQuery(this._textEl.value);break}},doQuery:function(){this._tryQuery()},_tryQuery:function(d){var c=this;if(this._queryTimer){clearTimeout(this._queryTimer);this._queryTimer=null}this._queryTimer=setTimeout(function(){var a=c._textEl.value;c._doQuery(a)},this.delay);this.showPopup("loading")},_doQuery:function(r){if(this._ajaxer){this._ajaxer.abort()}var j=this.url;var l="post";if(j){if(j.indexOf(".txt")!=-1||j.indexOf(".json")!=-1){l="get"}}var n={};n[this.searchField]=r;var o={url:j,async:true,params:n,data:n,type:this.ajaxType?this.ajaxType:l,cache:false,cancel:false};this.fire("beforeload",o);var q=this;function k(a,b){q._listbox.setData(a);q.showPopup();q._listbox._focusItem(0,true);q.data=a;q.fire("load",{data:a,result:b})}if(o.cancel){var p=o.result||[];k(p,p);return}mini.copyTo(o,{success:function(a,g,b){delete o.params;var c={text:a,result:null,sender:q,options:o,xhr:b};var f=null;try{mini_doload(c);f=c.result;if(!f){f=mini.decode(a)}}catch(d){if(mini_debugger==true){throw new Error("autocomplete json is error")}}if(mini.isArray(f)){f={data:f}}if(q.dataField){f.data=mini._getMap(q.dataField,f)}if(!f.data){f.data=[]}k(f.data,f)},error:function(c,a,b){q.showPopup("error")}});this._ajaxer=mini.ajax(o)},getAttrs:function(c){var d=mini.AutoComplete.superclass.getAttrs.call(this,c);mini._ParseString(c,d,["searchField"]);return d}});mini.regClass(mini.AutoComplete,"autocomplete");mini.Form=function(b){this.el=mini.byId(b);if(!this.el){throw new Error("form element not null")}mini.Form.superclass.constructor.call(this)};mini.extend(mini.Form,mini.Component,{el:null,getFields:function(){if(!this.el){return[]}var b=mini.findControls(function(a){if(!a.el||a.formField!=true){return false}if(mini.isAncestor(this.el,a.el)){return true}return false},this);return b},getFieldsMap:function(){var g=this.getFields();var i={};for(var k=0,f=g.length;k<f;k++){var j=g[k];if(j.name){i[j.name]=j}}return i},getField:function(b){if(!this.el){return null}return mini.getbyName(b,this.el)},getData:function(q,i){if(mini.isNull(i)){i=true}var l=q?"getFormValue":"getValue";var k=this.getFields();var p={};for(var o=0,s=k.length;o<s;o++){var r=k[o];var n=r[l];if(!n){continue}if(r.name){if(i==true){mini._setMap(r.name,n.call(r),p)}else{p[r.name]=n.call(r)}}if(r.textName&&r.getText){if(i==true){mini._setMap(r.textName,r.getText(),p)}else{p[r.textName]=r.getText()}}}return p},setData:function(p,o,j){if(mini.isNull(j)){j=true}if(typeof p!="object"){p={}}var l=this.getFieldsMap();for(var q in l){var n=l[q];if(!n){continue}if(n.setValue){var i=p[q];if(j==true){i=mini._getMap(q,p)}if(i===undefined&&o===false){continue}if(i===null){i=""}n.setValue(i)}if(n.setText&&n.textName){var k=p[n.textName];if(j==true){k=mini._getMap(n.textName,p)}if(mini.isNull(k)){k=""}n.setText(k)}}},reset:function(){var f=this.getFields();for(var k=0,g=f.length;k<g;k++){var j=f[k];if(!j.setValue){continue}if(j.setText&&j._clearText!==false){var i=j.defaultText;if(mini.isNull(i)){i=""}j.setText(i)}j.setValue(j.defaultValue)}this.setIsValid(true)},clear:function(){var f=this.getFields();for(var j=0,g=f.length;j<g;j++){var i=f[j];if(!i.setValue){continue}if(i.setText&&i._clearText!==false){i.setText("")}i.setValue("")}this.setIsValid(true)},getValidateFields:function(){function n(a){return a.isDisplay(function(b){if(mini.hasClass(b,"mini-tabs-body")){return true}})}var i=[];var l=this.getFields();for(var k=0,g=l.length;k<g;k++){var j=l[k];if(!j.validate||!j.isDisplay){continue}if(n(j)){i.push(j)}}return i},validate:function(k){var n=this.getValidateFields();for(var l=0,g=n.length;l<g;l++){var j=n[l];var i=j.validate();if(i==false&&k===false){break}}return this.isValid()},isValid:function(){var f=this.getValidateFields();for(var j=0,g=f.length;j<g;j++){var i=f[j];if(i.isValid()==false){return false}}return true},setIsValid:function(i){var f=this.getFields();for(var k=0,g=f.length;k<g;k++){var j=f[k];if(!j.setIsValid){continue}j.setIsValid(i)}},getErrorTexts:function(){var g=[];var i=this.getErrors();for(var k=0,f=i.length;k<f;k++){var j=i[k];g.push(j.errorText)}return g},getErrors:function(){var i=[];var f=this.getFields();for(var k=0,g=f.length;k<g;k++){var j=f[k];if(!j.isValid){continue}if(j.isValid()==false){i.push(j)}}return i},mask:function(b){if(typeof b=="string"){b={html:b}}b=b||{};b.el=this.el;if(!b.cls){b.cls=this._maskCls}mini.mask(b)},unmask:function(){mini.unmask(this.el)},_maskCls:"mini-mask-loading",loadingMsg:"数据加载中，请稍后...",loading:function(b){this.mask(b||this.loadingMsg)},__OnValueChanged:function(b){this._changed=true},_changed:false,setChanged:function(j){this._changed=j;var f=this.getFields();for(var k=0,g=f.length;k<g;k++){var i=f[k];i.on("valuechanged",this.__OnValueChanged,this)}},isChanged:function(){return this._changed},setEnabled:function(j){var f=this.getFields();for(var k=0,g=f.length;k<g;k++){var i=f[k];i.setEnabled(j)}}});mini.Fit=function(){mini.Fit.superclass.constructor.call(this)};mini.extend(mini.Fit,mini.Container,{style:"",_clearBorder:false,uiCls:"mini-fit",_create:function(){this.el=document.createElement("div");this.el.className="mini-fit";this._bodyEl=this.el},_initEvents:function(){},isFixedSize:function(){return false},doLayout:function(){if(!this.canLayout()){return}var u=this.el.parentNode;var l=mini.getChildNodes(u);if(u==document.body){this.el.style.height="0px"}var i=mini.getHeight(u,true);for(var w=0,z=l.length;w<z;w++){var A=l[w];var B=A.tagName?A.tagName.toLowerCase():"";if(A==this.el||(B=="style"||B=="script")){continue}var s=mini.getStyle(A,"position");if(s=="absolute"||s=="fixed"){continue}var v=mini.getHeight(A);var x=mini.getMargins(A);i=i-v-x.top-x.bottom}var y=mini.getBorders(this.el);var r=mini.getPaddings(this.el);var x=mini.getMargins(this.el);i=i-x.top-x.bottom;if(jQuery.boxModel){i=i-r.top-r.bottom-y.top-y.bottom}if(i<0){i=0}this.el.style.height=i+"px";try{l=mini.getChildNodes(this.el);for(var w=0,z=l.length;w<z;w++){var A=l[w];mini.layout(A)}}catch(t){}},set_bodyParent:function(f){if(!f){return}var g=this._bodyEl;var i=f;while(i.firstChild){try{g.appendChild(i.firstChild)}catch(j){}}this.doLayout()},getAttrs:function(c){var d=mini.Fit.superclass.getAttrs.call(this,c);d._bodyParent=c;return d}});mini.regClass(mini.Fit,"fit");mini.Panel=function(){this._initButtons();mini.Panel.superclass.constructor.call(this);if(this.url){this.setUrl(this.url)}this._contentEl=this._bodyEl;this._doVisibleEls();this._Resizer=new mini._Resizer(this);this._doTools()};mini.extend(mini.Panel,mini.Container,{width:250,title:"",iconCls:"",iconStyle:"",allowResize:false,url:"",refreshOnExpand:false,maskOnLoad:true,collapseOnTitleClick:false,showCollapseButton:false,showCloseButton:false,closeAction:"display",showHeader:true,showToolbar:false,showFooter:false,headerCls:"",headerStyle:"",bodyCls:"",bodyStyle:"",footerCls:"",footerStyle:"",toolbarCls:"",toolbarStyle:"",minWidth:180,minHeight:100,maxWidth:5000,maxHeight:3000,set:function(k){if(typeof k=="string"){return this}var g=this._allowLayout;this._allowLayout=false;var l=k.toolbar;delete k.toolbar;var j=k.footer;delete k.footer;var i=k.url;delete k.url;var n=k.buttons;delete k.buttons;mini.Panel.superclass.set.call(this,k);if(n){this.setButtons(n)}if(l){this.setToolbar(l)}if(j){this.setFooter(j)}if(i){this.setUrl(i)}this._allowLayout=g;this.doLayout();return this},uiCls:"mini-panel",_create:function(){this.el=document.createElement("div");this.el.className="mini-panel";this.el.tabIndex=0;var c='<div class="mini-panel-border"><div class="mini-panel-header" ><div class="mini-panel-header-inner" ><span class="mini-panel-icon"></span><div class="mini-panel-title" ></div><div class="mini-tools" ></div></div></div><div class="mini-panel-viewport"><div class="mini-panel-toolbar"></div><div class="mini-panel-body" ></div><div class="mini-panel-footer"></div><div class="mini-resizer-trigger"></div></div></div>';this.el.innerHTML=c;this._borderEl=this.el.firstChild;this._headerEl=this._borderEl.firstChild;this._viewportEl=this._borderEl.lastChild;this._toolbarEl=mini.byClass("mini-panel-toolbar",this.el);this._bodyEl=mini.byClass("mini-panel-body",this.el);this._footerEl=mini.byClass("mini-panel-footer",this.el);this._resizeGridEl=mini.byClass("mini-resizer-trigger",this.el);var d=mini.byClass("mini-panel-header-inner",this.el);this._iconEl=mini.byClass("mini-panel-icon",this.el);this._titleEl=mini.byClass("mini-panel-title",this.el);this._toolsEl=mini.byClass("mini-tools",this.el);mini.setStyle(this._bodyEl,this.bodyStyle);this._doTitle()},destroy:function(b){this._doRemoveIFrame();this._iframeEl=null;this._viewportEl=this._borderEl=this._bodyEl=this._footerEl=this._toolbarEl=null;this._toolsEl=this._titleEl=this._iconEl=this._resizeGridEl=null;mini.Panel.superclass.destroy.call(this,b)},_initEvents:function(){mini._BindEvents(function(){mini.on(this.el,"click",this.__OnClick,this)},this)},_doVisibleEls:function(){this._headerEl.style.display=this.showHeader?"":"none";this._toolbarEl.style.display=this.showToolbar?"":"none";this._footerEl.style.display=this.showFooter?"":"none"},_setBodyWidth:true,doLayout:function(){if(!this.canLayout()){return}this._resizeGridEl.style.display=this.allowResize?"":"none";var n=this.isAutoHeight();var k=this.isAutoWidth();var i=this.getWidth(true);var l=i;if(mini.isIE6){mini.setWidth(this._bodyEl,i)}if(!n){var j=this.getViewportHeight();mini.setHeight(this._viewportEl,j);var g=this.getBodyHeight();mini.setHeight(this._bodyEl,g)}else{this._viewportEl.style.height="auto";this._bodyEl.style.height="auto"}mini.layout(this._borderEl);this.fire("layout")},deferLayout:function(c){if(!c){c=10}if(this._layoutTimer){return}var d=this;this._layoutTimer=setTimeout(function(){d._layoutTimer=null;d.doLayout()},c)},_stopLayout:function(){clearTimeout(this._layoutTimer);this._layoutTimer=null},getViewportWidth:function(b){return this.getWidth(true)},getViewportHeight:function(k){var f=this.getHeight(true)-this.getHeaderHeight();if(k){var g=mini.getPaddings(this._viewportEl);var i=mini.getBorders(this._viewportEl);var j=mini.getMargins(this._viewportEl);if(jQuery.boxModel){f=f-g.top-g.bottom-i.top-i.bottom}f=f-j.top-j.bottom}return f},getBodyHeight:function(k){var f=this.getViewportHeight();var f=f-this.getToolbarHeight()-this.getFooterHeight();if(k){var i=mini.getPaddings(this._bodyEl);var g=mini.getBorders(this._bodyEl);var j=mini.getMargins(this._bodyEl);if(jQuery.boxModel){f=f-i.top-i.bottom-g.top-g.bottom}f=f-j.top-j.bottom}if(f<0){f=0}return f},getHeaderHeight:function(){var b=this.showHeader?jQuery(this._headerEl).outerHeight():0;return b},getToolbarHeight:function(){var b=this.showToolbar?jQuery(this._toolbarEl).outerHeight():0;return b},getFooterHeight:function(){var b=this.showFooter?jQuery(this._footerEl).outerHeight():0;return b},setHeaderStyle:function(b){this.headerStyle=b;mini.setStyle(this._headerEl,b);this.doLayout()},getHeaderStyle:function(){return this.headerStyle},setBodyStyle:function(b){this.bodyStyle=b;mini.setStyle(this._bodyEl,b);this.doLayout()},getBodyStyle:function(){return this.bodyStyle},setToolbarStyle:function(b){this.toolbarStyle=b;mini.setStyle(this._toolbarEl,b);this.doLayout()},getToolbarStyle:function(){return this.toolbarStyle},setFooterStyle:function(b){this.footerStyle=b;mini.setStyle(this._footerEl,b);this.doLayout()},getFooterStyle:function(){return this.footerStyle},setHeaderCls:function(b){jQuery(this._headerEl).removeClass(this.headerCls);jQuery(this._headerEl).addClass(b);this.headerCls=b;this.doLayout()},getHeaderCls:function(){return this.headerCls},setBodyCls:function(b){jQuery(this._bodyEl).removeClass(this.bodyCls);jQuery(this._bodyEl).addClass(b);this.bodyCls=b;this.doLayout()},getBodyCls:function(){return this.bodyCls},setToolbarCls:function(b){jQuery(this._toolbarEl).removeClass(this.toolbarCls);jQuery(this._toolbarEl).addClass(b);this.toolbarCls=b;this.doLayout()},getToolbarCls:function(){return this.toolbarCls},setFooterCls:function(b){jQuery(this._footerEl).removeClass(this.footerCls);jQuery(this._footerEl).addClass(b);this.footerCls=b;this.doLayout()},getFooterCls:function(){return this.footerCls},_doTitle:function(){this._titleEl.innerHTML=this.title;this._iconEl.style.display=(this.iconCls||this.iconStyle)?"inline":"none";this._iconEl.className="mini-panel-icon "+this.iconCls;mini.setStyle(this._iconEl,this.iconStyle)},setTitle:function(b){this.title=b;this._doTitle()},getTitle:function(){return this.title},setIconCls:function(b){this.iconCls=b;this._doTitle()},getIconCls:function(){return this.iconCls},setIconStyle:function(b){this.iconStyle=b;this._doTitle()},getIconStyle:function(){return this.iconStyle},_doTools:function(){var i="";for(var j=0,g=this.buttons.length;j<g;j++){var f=this.buttons[j];if(f.html){i+=f.html}else{i+='<span id="'+j+'" class="'+f.cls+" "+(f.enabled?"":"mini-disabled")+'" style="'+f.style+";"+(f.visible?"":"display:none;")+'"></span>'}}this._toolsEl.innerHTML=i},setShowCloseButton:function(c){this.showCloseButton=c;var d=this.getButton("close");if(!d){return}d.visible=c;this._doTools()},getShowCloseButton:function(){return this.showCloseButton},setCloseAction:function(b){this.closeAction=b},getCloseAction:function(){return this.closeAction},setShowCollapseButton:function(c){this.showCollapseButton=c;var d=this.getButton("collapse");if(!d){return}d.visible=c;this._doTools()},getShowCollapseButton:function(){return this.showCollapseButton},setShowHeader:function(b){this.showHeader=b;this._doVisibleEls();this.deferLayout()},getShowHeader:function(){return this.showHeader},setShowToolbar:function(b){this.showToolbar=b;this._doVisibleEls();this.deferLayout()},getShowToolbar:function(){return this.showToolbar},setShowFooter:function(b){this.showFooter=b;this._doVisibleEls();this.deferLayout()},getShowFooter:function(){return this.showFooter},__OnClick:function(d){if(mini.isAncestor(this._headerEl,d.target)){var g=mini.findParent(d.target,"mini-tools");if(g){var f=this.getButton(parseInt(d.target.id));if(f){this._OnButtonClick(f,d)}}else{if(this.collapseOnTitleClick){this.toggle()}}}},_OnButtonClick:function(k,i){var j={button:k,index:this.buttons.indexOf(k),name:k.name.toLowerCase(),htmlEvent:i,cancel:false};this.fire("beforebuttonclick",j);try{if(j.name=="close"&&this.closeAction=="destroy"&&this._iframeEl&&this._iframeEl.contentWindow){var g=true;if(this._iframeEl.contentWindow.CloseWindow){g=this._iframeEl.contentWindow.CloseWindow("close")}else{if(this._iframeEl.contentWindow.CloseOwnerWindow){g=this._iframeEl.contentWindow.CloseOwnerWindow("close")}}if(g===false){j.cancel=true}}}catch(l){}if(j.cancel==true){return j}this.fire("buttonclick",j);if(j.name=="close"){if(this.closeAction=="destroy"){this.__HideAction="close";this.destroy()}else{this.hide()}}if(j.name=="collapse"){this.toggle();if(this.refreshOnExpand&&this.expanded&&this.url){this.reload()}}return j},onButtonClick:function(c,d){this.on("buttonclick",c,d)},_initButtons:function(){this.buttons=[];var c=this.createButton({name:"collapse",cls:"mini-tools-collapse",visible:this.showCollapseButton});this.buttons.push(c);var d=this.createButton({name:"close",cls:"mini-tools-close",visible:this.showCloseButton});this.buttons.push(d)},createButton:function(d){var c=mini.copyTo({name:"",cls:"",style:"",visible:true,enabled:true,html:""},d);return c},setButtons:function(i){if(typeof i=="string"){i=i.split(" ")}if(!mini.isArray(i)){i=[]}var j=[];for(var k=0,g=i.length;k<g;k++){var f=i[k];if(typeof f=="string"){f=f.trim();if(!f){continue}f={name:f,cls:"mini-tools-"+f,html:""}}f=this.createButton(f);j.push(f)}this.buttons=j;this._doTools()},getButtons:function(){return this.buttons},addButton:function(c,d){if(typeof c=="string"){c={iconCls:c}}c=this.createButton(c);if(typeof d!="number"){d=this.buttons.length}this.buttons.insert(d,c);this._doTools()},updateButton:function(d,f){var g=this.getButton(d);if(!g){return}mini.copyTo(g,f);this._doTools()},removeButton:function(d){var c=this.getButton(d);if(!c){return}this.buttons.remove(c);this._doTools()},getButton:function(f){if(typeof f=="number"){return this.buttons[f]}else{for(var i=0,g=this.buttons.length;i<g;i++){var j=this.buttons[i];if(j.name==f){return j}}}},setBody:function(b){__mini_setControls(b,this._bodyEl,this)},set_bodyParent:function(b){},setToolbar:function(b){__mini_setControls(b,this._toolbarEl,this)},setFooter:function(b){__mini_setControls(b,this._footerEl,this)},getHeaderEl:function(){return this._headerEl},getToolbarEl:function(){return this._toolbarEl},getBodyEl:function(){return this._bodyEl},getFooterEl:function(){return this._footerEl},getIFrameEl:function(b){return this._iframeEl},_getMaskWrapEl:function(){return this._bodyEl},_doRemoveIFrame:function(g){if(this._iframeEl){var d=this._iframeEl;d.onload=function(){};jQuery(d).unbind("load");d.src="";try{d.contentWindow.document.write("");d.contentWindow.document.close()}catch(f){}if(d._ondestroy){d._ondestroy()}try{this._iframeEl.parentNode.removeChild(this._iframeEl);this._iframeEl.removeNode(true)}catch(f){}}this._iframeEl=null;if(g===true){mini.removeChilds(this._bodyEl)}},_deferLoadingTime:80,_doLoad:function(){if(!this.url){return}this._doRemoveIFrame(true);var f=new Date();var g=this;this.loadedUrl=this.url;if(this.maskOnLoad){this.loading()}jQuery(this._bodyEl).css("overflow","hidden");var d=mini.createIFrame(this.url,function(a,b){var i=(f-new Date())+g._deferLoadingTime;if(i<0){i=0}setTimeout(function(){g.unmask()},i);try{g._iframeEl.contentWindow.Owner=g.Owner;g._iframeEl.contentWindow.CloseOwnerWindow=function(n){g.__HideAction=n;var o=true;if(g.__onDestroy){o=g.__onDestroy(n)}if(o===false){return false}var l={iframe:g._iframeEl,action:n};g.fire("unload",l);setTimeout(function(){g.destroy()},10)}}catch(c){}if(b){if(g.__onLoad){g.__onLoad()}var c={iframe:g._iframeEl};g.fire("load",c)}});this._bodyEl.appendChild(d);this._iframeEl=d},load:function(f,g,d){this.setUrl(f,g,d)},reload:function(){this.setUrl(this.url)},setUrl:function(f,g,d){this.url=f;this.__onLoad=g;this.__onDestroy=d;if(this.expanded&&f){this._doLoad()}},getUrl:function(){return this.url},setRefreshOnExpand:function(b){this.refreshOnExpand=b},getRefreshOnExpand:function(){return this.refreshOnExpand},setMaskOnLoad:function(b){this.maskOnLoad=b},getMaskOnLoad:function(b){return this.maskOnLoad},setAllowResize:function(b){if(this.allowResize!=b){this.allowResize=b;this.doLayout()}},getAllowResize:function(){return this.allowResize},expanded:true,setExpanded:function(b){if(this.expanded!=b){this.expanded=b;if(this.expanded){this.expand()}else{this.collapse()}}},getExpanded:function(){return this.expanded},toggle:function(){if(this.expanded){this.collapse()}else{this.expand()}},collapse:function(){this.expanded=false;if(this.state!="max"){this._height=this.el.style.height}this.el.style.height="auto";this._viewportEl.style.display="none";mini.addClass(this.el,"mini-panel-collapse");this.doLayout()},expand:function(){this.expanded=true;if(this._height){this.el.style.height=this._height}this._viewportEl.style.display="block";if(this.state!="max"){delete this._height}mini.removeClass(this.el,"mini-panel-collapse");if(this.url&&this.url!=this.loadedUrl){this._doLoad()}this.doLayout()},setCollapseOnTitleClick:function(b){this.collapseOnTitleClick=b;mini.removeClass(this.el,"mini-panel-titleclick");if(b){mini.addClass(this.el,"mini-panel-titleclick")}},getCollapseOnTitleClick:function(){return this.collapseOnTitleClick},getAttrs:function(l){var i=mini.Panel.superclass.getAttrs.call(this,l);mini._ParseString(l,i,["title","iconCls","iconStyle","headerCls","headerStyle","bodyCls","bodyStyle","footerCls","footerStyle","toolbarCls","toolbarStyle","footer","toolbar","url","closeAction","loadingMsg","onbeforebuttonclick","onbuttonclick","onload","buttons"]);mini._ParseBool(l,i,["allowResize","showCloseButton","showHeader","showToolbar","showFooter","showCollapseButton","refreshOnExpand","maskOnLoad","expanded","collapseOnTitleClick"]);var n=mini.getChildNodes(l,true);for(var g=n.length-1;g>=0;g--){var k=n[g];var j=jQuery(k).attr("property");if(!j){continue}j=j.toLowerCase();if(j=="toolbar"){i.toolbar=k}else{if(j=="footer"){i.footer=k}}}i.body=n;return i}});mini.regClass(mini.Panel,"panel");mini.Window=function(){mini.Window.superclass.constructor.call(this);this.addCls("mini-window");this.setVisible(false);this.setAllowDrag(this.allowDrag);this.setAllowResize(this.allowResize)};mini.extend(mini.Window,mini.Panel,{x:0,y:0,state:"restore",_dragCls:"mini-window-drag",_resizeCls:"mini-window-resize",allowDrag:true,showCloseButton:true,showMaxButton:false,showMinButton:false,showCollapseButton:false,showModal:true,minWidth:150,minHeight:80,maxWidth:2000,maxHeight:2000,uiCls:"mini-window",_create:function(){mini.Window.superclass._create.call(this);if(mini.isIE&&mini_useShims){var b="<iframe frameborder='0' style='position: absolute; z-index: -1; width: 100%; height: 100%; top: 0;left:0;scrolling:no;'></iframe>";mini.append(this.el,b)}},_initButtons:function(){this.buttons=[];var i=this.createButton({name:"collapse",cls:"mini-tools-collapse",visible:this.showCollapseButton});this.buttons.push(i);var f=this.createButton({name:"min",cls:"mini-tools-min",visible:this.showMinButton});this.buttons.push(f);var g=this.createButton({name:"max",cls:"mini-tools-max",visible:this.showMaxButton});this.buttons.push(g);var j=this.createButton({name:"close",cls:"mini-tools-close",visible:this.showCloseButton});this.buttons.push(j)},_initEvents:function(){mini.Window.superclass._initEvents.call(this);mini._BindEvents(function(){mini.on(this.el,"mouseover",this.__OnMouseOver,this);mini.on(window,"resize",this.__OnWindowResize,this);mini.on(this.el,"mousedown",this.__OnWindowMouseDown,this)},this)},doLayout:function(){if(!this.canLayout()){return}if(this.state=="max"){var b=this.getParentBox();this.el.style.left="0px";this.el.style.top="0px";mini.setSize(this.el,b.width,b.height)}mini.Window.superclass.doLayout.call(this);if(this.allowDrag){mini.addClass(this.el,this._dragCls)}if(this.state=="max"){this._resizeGridEl.style.display="none";mini.removeClass(this.el,this._dragCls)}this._doModal()},_doModal:function(){if(!this.el){if(this._modalEl){mini.removeNode(this._modalEl)}return}var f=this.showModal&&this.isDisplay()&&this.visible;if(!this._modalEl&&this.showModal==false){if(this._modalEl){mini.removeNode(this._modalEl)}return}if(!this._modalEl){var g="__modal"+this._id;var d="<iframe frameborder='0' style='position: absolute; z-index: -1; width: 100%; height: 100%; top: 0;left:0;scrolling:no;'></iframe>";this._modalEl=mini.append(document.body,'<div id="'+g+'" class="mini-modal" style="display:none">'+d+"</div>")}if(f){this._modalEl.style.display="block";this._modalEl.style.zIndex=mini.getStyle(this.el,"zIndex")-1}else{this._modalEl.style.display="none"}},getParentBox:function(){var d=mini.getViewportBox();var c=this._containerEl||document.body;if(c!=document.body){d=mini.getBox(c)}return d},setShowModal:function(b){this.showModal=b},getShowModal:function(){return this.showModal},setMinWidth:function(b){if(isNaN(b)){return}this.minWidth=b},getMinWidth:function(){return this.minWidth},setMinHeight:function(b){if(isNaN(b)){return}this.minHeight=b},getMinHeight:function(){return this.minHeight},setMaxWidth:function(b){if(isNaN(b)){return}this.maxWidth=b},getMaxWidth:function(){return this.maxWidth},setMaxHeight:function(b){if(isNaN(b)){return}this.maxHeight=b},getMaxHeight:function(){return this.maxHeight},setAllowDrag:function(b){this.allowDrag=b;mini.removeClass(this.el,this._dragCls);if(b){mini.addClass(this.el,this._dragCls)}},getAllowDrag:function(){return this.allowDrag},setShowMaxButton:function(c){this.showMaxButton=c;var d=this.getButton("max");if(!d){return}d.visible=c;this._doTools()},getShowMaxButton:function(){return this.showMaxButton},setShowMinButton:function(c){this.showMinButton=c;var d=this.getButton("min");if(!d){return}d.visible=c;this._doTools()},getShowMinButton:function(){return this.showMinButton},max:function(){this.state="max";this.show();var b=this.getButton("max");if(b){b.cls="mini-tools-restore";this._doTools()}},restore:function(){this.state="restore";this.show(this.x,this.y);var b=this.getButton("max");if(b){b.cls="mini-tools-max";this._doTools()}},showInBody:true,setShowInBody:function(b){this.showInBody=b},getShowInBody:function(){return this.showInBody},containerEl:null,showAtPos:function(f,g,d){this.show(f,g,d)},show:function(j,k,i){this._allowLayout=false;var n=this._containerEl||document.body;if(!this.isRender()||(this.el.parentNode!=n&&this.showInBody)){this.render(n)}this.el.style.zIndex=mini.getMaxZIndex();this._doShow(j,k);this._allowLayout=true;this.setVisible(true);if(this.state!="max"){var o=this.getBox();this.x=o.x;this.y=o.y}try{this.el.focus()}catch(l){}},hide:function(){this.setVisible(false);this._doModal()},getWidth:function(){this._headerEl.style.width="50px";var b=mini.getWidth(this.el);this._headerEl.style.width="auto";return b},getBox:function(){this._headerEl.style.width="50px";this.el.style.display="";var d=mini.getWidth(this.el);this._headerEl.style.width="auto";var c=mini.getBox(this.el);c.width=d;c.right=c.x+d;return c},_measureSize:function(){this.el.style.display="";var b=this.getBox();if(b.width>this.maxWidth){mini.setWidth(this.el,this.maxWidth);b=this.getBox()}if(b.height>this.maxHeight){mini.setHeight(this.el,this.maxHeight);b=this.getBox()}if(b.width<this.minWidth){mini.setWidth(this.el,this.minWidth);b=this.getBox()}if(b.height<this.minHeight){mini.setHeight(this.el,this.minHeight);b=this.getBox()}},_doShow:function(g,i){var f=this.getParentBox();if(this.state=="max"){if(!this._width){var j=this.getBox();this._width=j.width;if(this.expanded){this._height=j.height}this.x=j.x;this.y=j.y}}else{if(mini.isNull(g)){g="center"}if(mini.isNull(i)){i="middle"}this.el.style.position="absolute";this.el.style.left="-2000px";this.el.style.top="-2000px";this.el.style.display="";if(this._width){this.setWidth(this._width);this.setHeight(this._height);delete this._width;delete this._height}else{}this._measureSize();var j=this.getBox();if(g=="left"){g=0}if(g=="center"){g=f.width/2-j.width/2}if(g=="right"){g=f.width-j.width}if(i=="top"){i=0}if(i=="middle"){i=f.y+f.height/2-j.height/2}if(i=="bottom"){i=f.height-j.height}if(g+j.width>f.right){g=f.right-j.width}if(i+j.height>f.bottom){i=f.bottom-j.height}if(g<0){g=0}if(i<0){i=0}this.el.style.display="";mini.setX(this.el,g);mini.setY(this.el,i)}this.doLayout()},_OnButtonClick:function(d,f){var g=mini.Window.superclass._OnButtonClick.call(this,d,f);if(g.cancel==true){return g}if(g.name=="max"){if(this.state=="max"){this.restore()}else{this.max()}}return g},__OnWindowResize:function(b){if(this.state=="max"){this.doLayout()}if(!mini.isIE6){this._doModal()}},enableDragProxy:true,setEnableDragProxy:function(b){this.enableDragProxy=b},getEnableDragProxy:function(b){return this.enableDragProxy},__OnWindowMouseDown:function(j){var k=this;if(j.button!=mini.MouseButton.Left){return}if(this.state!="max"&&this.allowDrag&&mini.isAncestor(this._headerEl,j.target)&&!mini.findParent(j.target,"mini-tools")){var k=this;if(this.el){this.el.style.zIndex=mini.getMaxZIndex()}var l=this.getBox();var g=new mini.Drag({capture:false,onStart:function(){k._maskProxy=mini.append(document.body,'<div class="mini-resizer-mask" style=""></div>');if(k.enableDragProxy){k._dragProxy=mini.append(document.body,'<div class="mini-drag-proxy"></div>');k.el.style.display="none"}else{k._dragProxy=k.el}},onMove:function(b){var o=b.now[0]-b.init[0],a=b.now[1]-b.init[1];o=l.x+o;a=l.y+a;var c=k.getParentBox();var d=o+l.width;var n=a+l.height;if(d>c.width){o=c.width-l.width}if(o<0){o=0}if(a<0){a=0}k.x=o;k.y=a;var f={x:o,y:a,width:l.width,height:l.height};mini.setBox(k._dragProxy,f);this.moved=true},onStop:function(){if(k.el){k.el.style.display="block";if(this.moved){var a=mini.getBox(k._dragProxy);mini.setBox(k.el,a)}}jQuery(k._maskProxy).remove();k._maskProxy=null;if(k.enableDragProxy){jQuery(k._dragProxy).remove()}k._dragProxy=null}});g.start(j);var i=mini.append(document.body,'<div class="mini-resizer-mask"></div>');setTimeout(function(){mini.removeNode(i)},300)}},destroy:function(d){mini.un(window,"resize",this.__OnWindowResize,this);if(this._modalEl){jQuery(this._modalEl).remove();this._modalEl=null}if(this.shadowEl){jQuery(this.shadowEl).remove();this.shadowEl=null}var c="__modal"+this._id;jQuery("[id='"+c+"']").remove();mini.Window.superclass.destroy.call(this,d)},getAttrs:function(c){var d=mini.Window.superclass.getAttrs.call(this,c);mini._ParseString(c,d,["modalStyle"]);mini._ParseBool(c,d,["showModal","showShadow","allowDrag","allowResize","showMaxButton","showMinButton","showInBody","enableDragProxy"]);mini._ParseInt(c,d,["minWidth","minHeight","maxWidth","maxHeight"]);return d},showAtEl:function(D,c){D=mini.byId(D);if(!D){return}if(!this.isRender()||this.el.parentNode!=document.body){this.render(document.body)}var y={xAlign:this.xAlign,yAlign:this.yAlign,xOffset:0,yOffset:0,popupCls:this.popupCls};mini.copyTo(y,c);this._popupEl=D;this.el.style.position="absolute";this.el.style.left="-2000px";this.el.style.top="-2000px";this.el.style.display="";this.doLayout();this._measureSize();var x=mini.getViewportBox();var A=this.getBox();var B=mini.getBox(D);var r=y.xy;var z=y.xAlign,s=y.yAlign;var u=x.width/2-A.width/2,v=0;if(r){u=r[0];v=r[1]}switch(y.xAlign){case"outleft":u=B.x-A.width;break;case"left":u=B.x;break;case"center":u=B.x+B.width/2-A.width/2;break;case"right":u=B.right-A.width;break;case"outright":u=B.right;break;default:break}switch(y.yAlign){case"above":v=B.y-A.height;break;case"top":v=B.y;break;case"middle":v=B.y+B.height/2-A.height/2;break;case"bottom":v=B.bottom-A.height;break;case"below":v=B.bottom;break;default:break}u=parseInt(u);v=parseInt(v);if(y.outYAlign||y.outXAlign){if(y.outYAlign=="above"){if(v+A.height>x.bottom){var w=B.y-x.y;var E=x.bottom-B.bottom;if(w>E){v=B.y-A.height}}}if(y.outXAlign=="outleft"){if(u+A.width>x.right){var C=B.x-x.x;var t=x.right-B.right;if(C>t){u=B.x-A.width}}}if(y.outXAlign=="right"){if(u+A.width>x.right){u=B.right-A.width}}this._Show(u,v)}else{this.showAtPos(u+y.xOffset,v+y.yOffset)}}});mini.regClass(mini.Window,"window");mini.MessageBox={alertTitle:"提醒",confirmTitle:"确认",prompTitle:"输入",prompMessage:"请输入内容：",buttonText:{ok:"确定",cancel:"取消",yes:"是",no:"否"},show:function(J){J=mini.copyTo({width:"auto",height:"auto",showModal:true,timeout:0,minWidth:150,maxWidth:800,minHeight:50,maxHeight:350,showHeader:true,title:"",titleIcon:"",iconCls:"",iconStyle:"",message:"",html:"",spaceStyle:"margin-right:15px",showCloseButton:true,buttons:null,buttonWidth:58,callback:null},J);J.message=String(J.message);var I=J.callback;var D=new mini.Window();D.setBodyStyle("overflow:hidden");D.setShowModal(J.showModal);D.setTitle(J.title||"");D.setIconCls(J.titleIcon);D.setShowHeader(J.showHeader);D.setShowCloseButton(J.showCloseButton);var K=D.uid+"$table",M=D.uid+"$content";var l='<div class="'+J.iconCls+'" style="'+J.iconStyle+'"></div>';var B='<table class="mini-messagebox-table" id="'+K+'" style="" cellspacing="0" cellpadding="0"><tr><td>'+l+'</td><td id="'+M+'" class="mini-messagebox-content-text">'+(J.message||"")+"</td></tr></table>";var L='<div class="mini-messagebox-content"></div><div class="mini-messagebox-buttons"></div>';D._bodyEl.innerHTML=L;var H=D._bodyEl.firstChild;if(J.html){if(typeof J.html=="string"){H.innerHTML=J.html}else{if(mini.isElement(J.html)){H.appendChild(J.html)}}}else{H.innerHTML=B}D._Buttons=[];var i=D._bodyEl.lastChild;if(J.buttons&&J.buttons.length>0){for(var x=0,y=J.buttons.length;x<y;x++){var N=J.buttons[x];var C=mini.MessageBox.buttonText[N];if(!C){C=N}var F=new mini.Button();F.setText(C);F.setWidth(J.buttonWidth);F.render(i);F.action=N;F.on("click",function(a){var b=a.sender;if(I){if(I(b.action)===false){return}}mini.MessageBox.hide(D)});if(x!=y-1){F.setStyle(J.spaceStyle)}D._Buttons.push(F)}}else{i.style.display="none"}D.setMinWidth(J.minWidth);D.setMinHeight(J.minHeight);D.setMaxWidth(J.maxWidth);D.setMaxHeight(J.maxHeight);D.setWidth(J.width);D.setHeight(J.height);D.show(J.x,J.y,{animType:J.animType});var z=D.getWidth();D.setWidth(z);var A=D.getHeight();D.setHeight(A);var E=document.getElementById(K);if(E){E.style.width="100%"}var G=document.getElementById(M);if(G){G.style.width="100%"}var s=D._Buttons[0];if(s){s.focus()}else{D.focus()}D.on("beforebuttonclick",function(a){if(I){I("close")}a.cancel=true;mini.MessageBox.hide(D)});mini.on(D.el,"keydown",function(a){});if(J.timeout){setTimeout(function(){mini.MessageBox.hide(D.uid)},J.timeout)}return D.uid},hide:function(i){if(!i){return}var j=typeof i=="object"?i:mini.getbyUID(i);if(!j){return}for(var k=0,g=j._Buttons.length;k<g;k++){var f=j._Buttons[k];f.destroy()}j._Buttons=null;j.destroy()},alert:function(f,d,g){return mini.MessageBox.show({minWidth:250,title:d||mini.MessageBox.alertTitle,buttons:["ok"],message:f,iconCls:"mini-messagebox-warning",callback:g})},confirm:function(f,d,g){return mini.MessageBox.show({minWidth:250,title:d||mini.MessageBox.confirmTitle,buttons:["ok","cancel"],message:f,iconCls:"mini-messagebox-question",callback:g})},prompt:function(p,n,k,o){var l="prompt$"+new Date().getTime();var q=p||mini.MessageBox.promptMessage;if(o){q=q+'<br/><textarea id="'+l+'" style="width:200px;height:60px;margin-top:3px;"></textarea>'}else{q=q+'<br/><input id="'+l+'" type="text" style="width:200px;margin-top:3px;"/>'}var i=mini.MessageBox.show({title:n||mini.MessageBox.promptTitle,buttons:["ok","cancel"],width:250,html:'<div style="padding:5px;padding-left:10px;">'+q+"</div>",callback:function(a){var b=document.getElementById(l);if(k){return k(a,b.value)}}});var j=document.getElementById(l);j.focus();return i},loading:function(d,c){return mini.MessageBox.show({minHeight:50,title:c,showCloseButton:false,message:d,iconCls:"mini-messagebox-waiting"})},showTips:function(f){var j=jQuery;f=j.extend({content:"",state:"",x:"center",y:"top",offset:[10,10],fixed:true,timeout:2000},f);var g="mini-tips-"+f.state;var k='<div class="mini-tips '+g+'">'+f.content+"</div>";var i=j(k).appendTo(document.body);f.el=i[0];f.timeoutHandler=function(){i.slideUp();setTimeout(function(){i.remove()},2000)};mini.showAt(f);i.hide().slideDown()}};mini.alert=mini.MessageBox.alert;mini.confirm=mini.MessageBox.confirm;mini.prompt=mini.MessageBox.prompt;mini.loading=mini.MessageBox.loading;mini.showMessageBox=mini.MessageBox.show;mini.hideMessageBox=mini.MessageBox.hide;mini.showTips=mini.MessageBox.showTips;mini.Splitter=function(){this._initPanes();mini.Splitter.superclass.constructor.call(this)};mini.extend(mini.Splitter,mini.Control,{width:300,height:180,vertical:false,allowResize:true,pane1:null,pane2:null,showHandleButton:true,handlerStyle:"",handlerCls:"",handlerSize:5,uiCls:"mini-splitter",_create:function(){this.el=document.createElement("div");this.el.className="mini-splitter";this.el.innerHTML='<div class="mini-splitter-border"><div id="1" class="mini-splitter-pane mini-splitter-pane1"></div><div id="2" class="mini-splitter-pane mini-splitter-pane2"></div><div class="mini-splitter-handler"></div></div>';this._borderEl=this.el.firstChild;this._pane1El=this._borderEl.firstChild;this._pane2El=this._borderEl.childNodes[1];this._handlerEl=this._borderEl.lastChild},_initEvents:function(){mini._BindEvents(function(){mini.on(this.el,"click",this.__OnClick,this);mini.on(this.el,"mousedown",this.__OnMouseDown,this)},this)},_initPanes:function(){this.pane1={id:"",index:1,minSize:30,maxSize:3000,size:"",showCollapseButton:false,cls:"",style:"",visible:true,expanded:true};this.pane2=mini.copyTo({},this.pane1);this.pane2.index=2},doUpdate:function(){this.doLayout()},doLayout:function(){if(!this.canLayout()){return}this._handlerEl.style.cursor=this.allowResize?"":"default";mini.removeClass(this.el,"mini-splitter-vertical");if(this.vertical){mini.addClass(this.el,"mini-splitter-vertical")}mini.removeClass(this._pane1El,"mini-splitter-pane1-vertical");mini.removeClass(this._pane2El,"mini-splitter-pane2-vertical");if(this.vertical){mini.addClass(this._pane1El,"mini-splitter-pane1-vertical");mini.addClass(this._pane2El,"mini-splitter-pane2-vertical")}mini.removeClass(this._handlerEl,"mini-splitter-handler-vertical");if(this.vertical){mini.addClass(this._handlerEl,"mini-splitter-handler-vertical")}var B=this.getHeight(true);var J=this.getWidth(true);if(!jQuery.boxModel){var N=mini.getBorders(this._borderEl);B=B+N.top+N.bottom;J=J+N.left+N.right}if(J<0){J=0}if(B<0){B=0}this._borderEl.style.width=J+"px";this._borderEl.style.height=B+"px";var R=this._pane1El,S=this._pane2El;var H=jQuery(R),K=jQuery(S);R.style.display=S.style.display=this._handlerEl.style.display="";var s=this.handlerSize;this.pane1.size=String(this.pane1.size);this.pane2.size=String(this.pane2.size);var z=parseFloat(this.pane1.size),G=parseFloat(this.pane2.size);var C=isNaN(z),M=isNaN(G);var w=!isNaN(z)&&this.pane1.size.indexOf("%")!=-1;var I=!isNaN(G)&&this.pane2.size.indexOf("%")!=-1;var O=!C&&!w;var P=!M&&!I;var E=this.vertical?B-this.handlerSize:J-this.handlerSize;var A=p2Size=0;if(C||M){if(C&&M){A=parseInt(E/2);p2Size=E-A}else{if(O){A=z;p2Size=E-A}else{if(w){A=parseInt(E*z/100);p2Size=E-A}else{if(P){p2Size=G;A=E-p2Size}else{if(I){p2Size=parseInt(E*G/100);A=E-p2Size}}}}}}else{if(w&&P){p2Size=G;A=E-p2Size}else{if(O&&I){A=z;p2Size=E-A}else{var Q=z+G;A=parseInt(E*z/Q);p2Size=E-A}}}if(A>this.pane1.maxSize){A=this.pane1.maxSize;p2Size=E-A}if(p2Size>this.pane2.maxSize){p2Size=this.pane2.maxSize;A=E-p2Size}if(A<this.pane1.minSize){A=this.pane1.minSize;p2Size=E-A}if(p2Size<this.pane2.minSize){p2Size=this.pane2.minSize;A=E-p2Size}if(this.pane1.expanded==false){p2Size=E;A=0;R.style.display="none"}else{if(this.pane2.expanded==false){A=E;p2Size=0;S.style.display="none"}}if(this.pane1.visible==false){p2Size=E+s;A=s=0;R.style.display="none";this._handlerEl.style.display="none"}else{if(this.pane2.visible==false){A=E+s;p2Size=s=0;S.style.display="none";this._handlerEl.style.display="none"}}if(this.vertical){mini.setWidth(R,J);mini.setWidth(S,J);mini.setHeight(R,A);mini.setHeight(S,p2Size);S.style.top=(A+s)+"px";this._handlerEl.style.left="0px";this._handlerEl.style.top=A+"px";mini.setWidth(this._handlerEl,J);mini.setHeight(this._handlerEl,this.handlerSize);R.style.left="0px";S.style.left="0px"}else{mini.setWidth(R,A);mini.setWidth(S,p2Size);mini.setHeight(R,B);mini.setHeight(S,B);S.style.left=(A+s)+"px";this._handlerEl.style.top="0px";this._handlerEl.style.left=A+"px";mini.setWidth(this._handlerEl,this.handlerSize);mini.setHeight(this._handlerEl,B);R.style.top="0px";S.style.top="0px"}var F='<div class="mini-splitter-handler-buttons">';if(!this.pane1.expanded||!this.pane2.expanded){if(!this.pane1.expanded){if(this.pane1.showCollapseButton){F+='<a id="1" class="mini-splitter-pane2-button"></a>'}}else{if(this.pane2.showCollapseButton){F+='<a id="2" class="mini-splitter-pane1-button"></a>'}}}else{if(this.pane1.showCollapseButton){F+='<a id="1" class="mini-splitter-pane1-button"></a>'}if(this.allowResize){if((!this.pane1.showCollapseButton&&!this.pane2.showCollapseButton)){F+='<span class="mini-splitter-resize-button"></span>'}}if(this.pane2.showCollapseButton){F+='<a id="2" class="mini-splitter-pane2-button"></a>'}}F+="</div>";this._handlerEl.innerHTML=F;var D=this._handlerEl.firstChild;D.style.display=this.showHandleButton?"":"none";var L=mini.getBox(D);if(this.vertical){D.style.marginLeft=-L.width/2+"px"}else{D.style.marginTop=-L.height/2+"px"}if(!this.pane1.visible||!this.pane2.visible||!this.pane1.expanded||!this.pane2.expanded){mini.addClass(this._handlerEl,"mini-splitter-nodrag")}else{mini.removeClass(this._handlerEl,"mini-splitter-nodrag")}mini.layout(this._borderEl);this.fire("layout")},getPaneBox:function(d){var c=this.getPaneEl(d);if(!c){return null}return mini.getBox(c)},getPane:function(b){if(b==1){return this.pane1}else{if(b==2){return this.pane2}}return b},setPanes:function(d){if(!mini.isArray(d)){return}for(var f=0;f<2;f++){var g=d[f];this.updatePane(f+1,g)}},setPaneControls:function(g,j){var i=this.getPane(g);if(!i){return}var f=this.getPaneEl(g);__mini_setControls(j,f,this)},getPaneEl:function(b){if(b==1){return this._pane1El}return this._pane2El},updatePane:function(q,i){var k=this.getPane(q);if(!k){return}mini.copyTo(k,i);var n=this.getPaneEl(q);var o=k.body;delete k.body;if(o){if(!mini.isArray(o)){o=[o]}for(var p=0,j=o.length;p<j;p++){mini.append(n,o[p])}}if(k.bodyParent){var l=k.bodyParent;while(l.firstChild){n.appendChild(l.firstChild)}}delete k.bodyParent;n.id=k.id;mini.setStyle(n,k.style);mini.addClass(n,k["class"]);if(k.cls){mini.addClass(n,k.cls)}if(k.controls){var q=k==this.pane1?1:2;this.setPaneControls(q,k.controls);delete k.controls}this.doUpdate()},setShowHandleButton:function(b){this.showHandleButton=b;this.doUpdate()},getShowHandleButton:function(b){return this.showHandleButton},setVertical:function(b){this.vertical=b;this.doUpdate()},getVertical:function(){return this.vertical},expandPane:function(f){var g=this.getPane(f);if(!g){return}g.expanded=true;this.doUpdate();var d={pane:g,paneIndex:this.pane1==g?1:2};this.fire("expand",d)},collapsePane:function(g){var i=this.getPane(g);if(!i){return}i.expanded=false;var f=i==this.pane1?this.pane2:this.pane1;if(f.expanded==false){f.expanded=true;f.visible=true}this.doUpdate();var j={pane:i,paneIndex:this.pane1==i?1:2};this.fire("collapse",j)},togglePane:function(d){var c=this.getPane(d);if(!c){return}if(c.expanded){this.collapsePane(c)}else{this.expandPane(c)}},showPane:function(d){var c=this.getPane(d);if(!c){return}c.visible=true;this.doUpdate()},hidePane:function(f){var g=this.getPane(f);if(!g){return}g.visible=false;var d=g==this.pane1?this.pane2:this.pane1;if(d.visible==false){d.expanded=true;d.visible=true}this.doUpdate()},setAllowResize:function(b){if(this.allowResize!=b){this.allowResize=b;this.doLayout()}},getAllowResize:function(){return this.allowResize},setHandlerSize:function(b){if(this.handlerSize!=b){this.handlerSize=b;this.doLayout()}},getHandlerSize:function(){return this.handlerSize},__OnClick:function(j){var f=j.target;if(!mini.isAncestor(this._handlerEl,f)){return}var g=parseInt(f.id);var i=this.getPane(g);var j={pane:i,paneIndex:g,cancel:false};if(i.expanded){this.fire("beforecollapse",j)}else{this.fire("beforeexpand",j)}if(j.cancel==true){return}if(f.className=="mini-splitter-pane1-button"){this.togglePane(g)}else{if(f.className=="mini-splitter-pane2-button"){this.togglePane(g)}}},_OnButtonClick:function(c,d){this.fire("buttonclick",{pane:c,index:this.pane1==c?1:2,htmlEvent:d})},onButtonClick:function(c,d){this.on("buttonclick",c,d)},__OnMouseDown:function(g){var f=g.target;if(!this.allowResize){return}if(!this.pane1.visible||!this.pane2.visible||!this.pane1.expanded||!this.pane2.expanded){return}if(mini.isAncestor(this._handlerEl,f)){if(f.className=="mini-splitter-pane1-button"||f.className=="mini-splitter-pane2-button"){}else{var d=this._getDrag();d.start(g)}}},_getDrag:function(){if(!this.drag){this.drag=new mini.Drag({capture:true,onStart:mini.createDelegate(this._OnDragStart,this),onMove:mini.createDelegate(this._OnDragMove,this),onStop:mini.createDelegate(this._OnDragStop,this)})}return this.drag},_OnDragStart:function(b){this._maskProxy=mini.append(document.body,'<div class="mini-resizer-mask"></div>');this._dragProxy=mini.append(document.body,'<div class="mini-proxy"></div>');this._dragProxy.style.cursor=this.vertical?"n-resize":"w-resize";this.handlerBox=mini.getBox(this._handlerEl);this.elBox=mini.getBox(this._borderEl,true);mini.setBox(this._dragProxy,this.handlerBox)},_OnDragMove:function(x){if(!this.handlerBox){return}if(!this.elBox){this.elBox=mini.getBox(this._borderEl,true)}var r=this.elBox.width,w=this.elBox.height;var y=this.handlerSize;var o=this.vertical?w-this.handlerSize:r-this.handlerSize;var q=this.pane1.minSize,A=this.pane1.maxSize;var u=this.pane2.minSize,p=this.pane2.maxSize;if(this.vertical==true){var z=x.now[1]-x.init[1];var t=this.handlerBox.y+z;if(t-this.elBox.y>A){t=this.elBox.y+A}if(t+this.handlerBox.height<this.elBox.bottom-p){t=this.elBox.bottom-p-this.handlerBox.height}if(t-this.elBox.y<q){t=this.elBox.y+q}if(t+this.handlerBox.height>this.elBox.bottom-u){t=this.elBox.bottom-u-this.handlerBox.height}mini.setY(this._dragProxy,t)}else{var v=x.now[0]-x.init[0];var s=this.handlerBox.x+v;if(s-this.elBox.x>A){s=this.elBox.x+A}if(s+this.handlerBox.width<this.elBox.right-p){s=this.elBox.right-p-this.handlerBox.width}if(s-this.elBox.x<q){s=this.elBox.x+q}if(s+this.handlerBox.width>this.elBox.right-u){s=this.elBox.right-u-this.handlerBox.width}mini.setX(this._dragProxy,s)}},_OnDragStop:function(A){var v=this.elBox.width,z=this.elBox.height;var F=this.handlerSize;var r=parseFloat(this.pane1.size),t=parseFloat(this.pane2.size);var u=isNaN(r),w=isNaN(t);var x=!isNaN(r)&&this.pane1.size.indexOf("%")!=-1;var y=!isNaN(t)&&this.pane2.size.indexOf("%")!=-1;var G=!u&&!x;var B=!w&&!y;var s=this.vertical?z-this.handlerSize:v-this.handlerSize;var C=mini.getBox(this._dragProxy);var D=C.x-this.elBox.x,E=s-D;if(this.vertical){D=C.y-this.elBox.y;E=s-D}if(u||w){if(u&&w){r=parseFloat(D/s*100).toFixed(1);this.pane1.size=r+"%"}else{if(G){r=D;this.pane1.size=r}else{if(x){r=parseFloat(D/s*100).toFixed(1);this.pane1.size=r+"%"}else{if(B){t=E;this.pane2.size=t}else{if(y){t=parseFloat(E/s*100).toFixed(1);this.pane2.size=t+"%"}}}}}}else{if(x&&B){this.pane2.size=E}else{if(G&&y){this.pane1.size=D}else{this.pane1.size=parseFloat(D/s*100).toFixed(1);this.pane2.size=100-this.pane1.size}}}jQuery(this._dragProxy).remove();jQuery(this._maskProxy).remove();this._maskProxy=null;this._dragProxy=null;this.elBox=this.handlerBox=null;this.doLayout();this.fire("resize")},getAttrs:function(q){var g=mini.Splitter.superclass.getAttrs.call(this,q);mini._ParseString(q,g,["onexpand","oncollapse","onresize"]);mini._ParseBool(q,g,["allowResize","vertical","showHandleButton"]);mini._ParseInt(q,g,["handlerSize"]);var i=[];var s=mini.getChildNodes(q);for(var n=0,o=2;n<o;n++){var p=s[n];var l=jQuery(p);var r={};i.push(r);if(!p){continue}r.style=p.style.cssText;mini._ParseString(p,r,["cls","size","id","class"]);mini._ParseBool(p,r,["visible","expanded","showCollapseButton"]);mini._ParseInt(p,r,["minSize","maxSize","handlerSize"]);r.bodyParent=p}g.panes=i;return g}});mini.regClass(mini.Splitter,"splitter");mini.Layout=function(){this.regions=[];this.regionMap={};mini.Layout.superclass.constructor.call(this)};mini.extend(mini.Layout,mini.Control,{regions:[],splitSize:5,collapseWidth:28,collapseHeight:25,regionWidth:150,regionHeight:80,regionMinWidth:50,regionMinHeight:25,regionMaxWidth:2000,regionMaxHeight:2000,uiCls:"mini-layout",_create:function(){this.el=document.createElement("div");this.el.className="mini-layout";this.el.innerHTML='<div class="mini-layout-border"></div>';this._borderEl=this.el.firstChild;this.doUpdate()},_initEvents:function(){mini._BindEvents(function(){mini.on(this.el,"click",this.__OnClick,this);mini.on(this.el,"mousedown",this.__OnMouseDown,this);mini.on(this.el,"mouseover",this.__OnMouseOver,this);mini.on(this.el,"mouseout",this.__OnMouseOut,this);mini.on(document,"mousedown",this.__OnDocMouseDown,this)},this)},getRegionEl:function(b){var b=this.getRegion(b);if(!b){return null}return b._el},getRegionHeaderEl:function(b){var b=this.getRegion(b);if(!b){return null}return b._header},getRegionBodyEl:function(b){var b=this.getRegion(b);if(!b){return null}return b._body},getRegionSplitEl:function(b){var b=this.getRegion(b);if(!b){return null}return b._split},getRegionProxyEl:function(b){var b=this.getRegion(b);if(!b){return null}return b._proxy},getRegionBox:function(c){var d=this.getRegionEl(c);if(d){return mini.getBox(d)}return null},getRegion:function(b){if(typeof b=="string"){return this.regionMap[b]}return b},_getButton:function(j,g){var k=j.buttons;for(var l=0,i=k.length;l<i;l++){var n=k[l];if(n.name==g){return n}}},_createRegion:function(d){var c=mini.copyTo({region:"",title:"",iconCls:"",iconStyle:"",showCloseButton:false,showCollapseButton:true,buttons:[{name:"close",cls:"mini-tools-close",html:"",visible:false},{name:"collapse",cls:"mini-tools-collapse",html:"",visible:true}],showSplitIcon:false,showSplit:true,showHeader:true,splitSize:this.splitSize,collapseSize:this.collapseWidth,width:this.regionWidth,height:this.regionHeight,minWidth:this.regionMinWidth,minHeight:this.regionMinHeight,maxWidth:this.regionMaxWidth,maxHeight:this.regionMaxHeight,allowResize:true,cls:"",style:"",headerCls:"",headerStyle:"",bodyCls:"",bodyStyle:"",visible:true,expanded:true},d);return c},_CreateRegionEl:function(b){var b=this.getRegion(b);if(!b){return}mini.append(this._borderEl,'<div id="'+b.region+'" class="mini-layout-region"><div class="mini-layout-region-header" style="'+b.headerStyle+'"></div><div class="mini-layout-region-body '+b.bodyCls+'" style="'+b.bodyStyle+'"></div></div>');b._el=this._borderEl.lastChild;b._header=b._el.firstChild;b._body=b._el.lastChild;if(b.cls){mini.addClass(b._el,b.cls)}if(b.style){mini.setStyle(b._el,b.style)}if(b.headerCls){mini.addClass(b._el.firstChild,b.headerCls)}mini.addClass(b._el,"mini-layout-region-"+b.region);if(b.region!="center"){mini.append(this._borderEl,'<div uid="'+this.uid+'" id="'+b.region+'" class="mini-layout-split"><div class="mini-layout-spliticon"></div></div>');b._split=this._borderEl.lastChild;mini.addClass(b._split,"mini-layout-split-"+b.region)}if(b.region!="center"){mini.append(this._borderEl,'<div id="'+b.region+'" class="mini-layout-proxy"></div>');b._proxy=this._borderEl.lastChild;mini.addClass(b._proxy,"mini-layout-proxy-"+b.region)}},setRegionControls:function(g,d){var g=this.getRegion(g);if(!g){return}var f=this.getRegionBodyEl(g);__mini_setControls(d,f,this)},setRegions:function(g){if(!mini.isArray(g)){return}for(var d=0,f=g.length;d<f;d++){this.addRegion(g[d])}},addRegion:function(i,l){var r=i;i=this._createRegion(i);if(!i.region){i.region="center"}i.region=i.region.toLowerCase();if(i.region=="center"&&r&&!r.showHeader){i.showHeader=false}if(i.region=="north"||i.region=="south"){if(!r.collapseSize){i.collapseSize=this.collapseHeight}}this._measureRegion(i);if(typeof l!="number"){l=this.regions.length}var u=this.regionMap[i.region];if(u){return}this.regions.insert(l,i);this.regionMap[i.region]=i;this._CreateRegionEl(i);var s=this.getRegionBodyEl(i);var n=i.body;delete i.body;if(n){if(!mini.isArray(n)){n=[n]}for(var o=0,q=n.length;o<q;o++){mini.append(s,n[o])}}if(i.bodyParent){var t=i.bodyParent;while(t.firstChild){var p=t.firstChild;s.appendChild(p)}}delete i.bodyParent;if(i.controls){this.setRegionControls(i,i.controls);delete i.controls}this.doUpdate()},removeRegion:function(b){var b=this.getRegion(b);if(!b){return}this.regions.remove(b);delete this.regionMap[b.region];jQuery(b._el).remove();jQuery(b._split).remove();jQuery(b._proxy).remove();this.doUpdate()},moveRegion:function(g,f){var g=this.getRegion(g);if(!g){return}var d=this.regions[f];if(!d||d==g){return}this.regions.remove(g);var f=this.region.indexOf(d);this.regions.insert(f,g);this.doUpdate()},_measureRegion:function(c){var d=this._getButton(c,"close");d.visible=c.showCloseButton;var d=this._getButton(c,"collapse");d.visible=c.showCollapseButton;if(c.width<c.minWidth){c.width=mini.minWidth}if(c.width>c.maxWidth){c.width=mini.maxWidth}if(c.height<c.minHeight){c.height=mini.minHeight}if(c.height>c.maxHeight){c.height=mini.maxHeight}},updateRegion:function(c,d){c=this.getRegion(c);if(!c){return}if(d){delete d.region}mini.copyTo(c,d);this._measureRegion(c);this.doUpdate()},expandRegion:function(b){b=this.getRegion(b);if(!b){return}b.expanded=true;this.doUpdate()},collapseRegion:function(b){b=this.getRegion(b);if(!b){return}b.expanded=false;this.doUpdate()},toggleRegion:function(b){b=this.getRegion(b);if(!b){return}if(b.expanded){this.collapseRegion(b)}else{this.expandRegion(b)}},showRegion:function(b){b=this.getRegion(b);if(!b){return}b.visible=true;this.doUpdate()},hideRegion:function(b){b=this.getRegion(b);if(!b){return}b.visible=false;this.doUpdate()},isExpandRegion:function(b){b=this.getRegion(b);if(!b){return null}return b.expanded},isVisibleRegion:function(b){b=this.getRegion(b);if(!b){return null}return b.visible},_tryToggleRegion:function(c){c=this.getRegion(c);var d={region:c,cancel:false};if(c.expanded){this.fire("BeforeCollapse",d);if(d.cancel==false){this.collapseRegion(c)}}else{this.fire("BeforeExpand",d);if(d.cancel==false){this.expandRegion(c)}}},_getProxyElByEvent:function(c){var d=mini.findParent(c.target,"mini-layout-proxy");return d},_getRegionElByEvent:function(c){var d=mini.findParent(c.target,"mini-layout-region");return d},__OnClick:function(l){if(this._inAniming){return}var j=this._getProxyElByEvent(l);if(j){var n=j.id;var o=mini.findParent(l.target,"mini-tools-collapse");if(o){this._tryToggleRegion(n)}else{this._VirtualToggle(n)}}var i=this._getRegionElByEvent(l);if(i&&mini.findParent(l.target,"mini-layout-region-header")){var n=i.id;var o=mini.findParent(l.target,"mini-tools-collapse");if(o){this._tryToggleRegion(n)}var k=mini.findParent(l.target,"mini-tools-close");if(k){this.updateRegion(n,{visible:false})}}if(mini.hasClass(l.target,"mini-layout-spliticon")){var n=l.target.parentNode.id;this._tryToggleRegion(n)}},_OnButtonClick:function(g,d,f){this.fire("buttonclick",{htmlEvent:f,region:g,button:d,index:this.buttons.indexOf(d),name:d.name})},_OnButtonMouseDown:function(g,d,f){this.fire("buttonmousedown",{htmlEvent:f,region:g,button:d,index:this.buttons.indexOf(d),name:d.name})},hoverProxyEl:null,__OnMouseOver:function(c){var d=this._getProxyElByEvent(c);if(d){mini.addClass(d,"mini-layout-proxy-hover");this.hoverProxyEl=d}},__OnMouseOut:function(b){if(this.hoverProxyEl){mini.removeClass(this.hoverProxyEl,"mini-layout-proxy-hover")}this.hoverProxyEl=null},onButtonClick:function(c,d){this.on("buttonclick",c,d)},onButtonMouseDown:function(c,d){this.on("buttonmousedown",c,d)}});mini.copyTo(mini.Layout.prototype,{_createHeader:function(i,k){var j='<div class="mini-tools">';if(k){j+='<span class="mini-tools-collapse"></span>'}else{for(var f=i.buttons.length-1;f>=0;f--){var g=i.buttons[f];j+='<span class="'+g.cls+'" style="';j+=g.style+";"+(g.visible?"":"display:none;")+'">'+g.html+"</span>"}}j+="</div>";j+='<div class="mini-layout-region-icon '+i.iconCls+'" style="'+i.iconStyle+";"+((i.iconStyle||i.iconCls)?"":"display:none;")+'"></div>';j+='<div class="mini-layout-region-title">'+i.title+"</div>";return j},doUpdate:function(){for(var o=0,j=this.regions.length;o<j;o++){var k=this.regions[o];var l=k.region;var n=k._el,p=k._split,i=k._proxy;if(k.cls){mini.addClass(n,k.cls)}if(k.headerCls){mini.addClass(n.firstChild,k.headerCls)}k._header.style.display=k.showHeader?"":"none";k._header.innerHTML=this._createHeader(k);if(k._proxy){k._proxy.innerHTML=this._createHeader(k,true)}if(p){mini.removeClass(p,"mini-layout-split-nodrag");if(k.expanded==false||!k.allowResize){mini.addClass(p,"mini-layout-split-nodrag")}}}this.doLayout()},doLayout:function(){if(!this.canLayout()){return}if(this._inAniming){return}var w=mini.getHeight(this.el,true);var F=mini.getWidth(this.el,true);var G={x:0,y:0,width:F,height:w};mini.setHeight(this._borderEl,w);var N=this.regions.clone();var d=this.getRegion("center");N.remove(d);if(d){N.push(d)}for(var x=0,B=N.length;x<B;x++){var K=N[x];K._Expanded=false;mini.removeClass(K._el,"mini-layout-popup");var J=K.region;var M=K._el,D=K._split,y=K._proxy;if(K.visible==false){M.style.display="none";if(J!="center"){D.style.display=y.style.display="none"}continue}M.style.display="";if(J!="center"){D.style.display=y.style.display=""}var H=G.x,I=G.y,F=G.width,w=G.height;var L=K.width,E=K.height;if(!K.expanded){if(J=="west"||J=="east"){L=K.collapseSize;mini.setWidth(M,K.width)}else{if(J=="north"||J=="south"){E=K.collapseSize;mini.setHeight(M,K.height)}}}switch(J){case"north":w=E;G.y+=E;G.height-=E;break;case"south":w=E;I=G.y+G.height-E;G.height-=E;break;case"west":F=L;G.x+=L;G.width-=L;break;case"east":F=L;H=G.x+G.width-L;G.width-=L;break;case"center":break;default:continue}if(F<0){F=0}if(w<0){w=0}if(J=="west"||J=="east"){mini.setHeight(M,w)}if(J=="north"||J=="south"){mini.setWidth(M,F)}var l="left:"+H+"px;top:"+I+"px;";var i=M;if(!K.expanded){i=y;M.style.top="-100px";M.style.left="-1500px"}else{if(y){y.style.left="-1500px";y.style.top="-100px"}}i.style.left=H+"px";i.style.top=I+"px";mini.setWidth(i,F);mini.setHeight(i,w);var C=jQuery(K._el).height();var O=K.showHeader?jQuery(K._header).outerHeight():0;mini.setHeight(K._body,C-O);if(J=="center"){continue}L=E=K.splitSize;var H=G.x,I=G.y,F=G.width,w=G.height;switch(J){case"north":w=E;G.y+=E;G.height-=E;break;case"south":w=E;I=G.y+G.height-E;G.height-=E;break;case"west":F=L;G.x+=L;G.width-=L;break;case"east":F=L;H=G.x+G.width-L;G.width-=L;break;case"center":break}if(F<0){F=0}if(w<0){w=0}D.style.left=H+"px";D.style.top=I+"px";mini.setWidth(D,F);mini.setHeight(D,w);if(K.showSplit&&K.expanded&&K.allowResize==true){mini.removeClass(D,"mini-layout-split-nodrag")}else{mini.addClass(D,"mini-layout-split-nodrag")}D.firstChild.style.display=K.showSplitIcon?"block":"none";if(K.expanded){mini.removeClass(D.firstChild,"mini-layout-spliticon-collapse")}else{mini.addClass(D.firstChild,"mini-layout-spliticon-collapse")}}mini.layout(this._borderEl);this.fire("layout")},__OnMouseDown:function(i){if(this._inAniming){return}if(mini.findParent(i.target,"mini-layout-split")){var g=jQuery(i.target).attr("uid");if(g!=this.uid){return}var j=this.getRegion(i.target.id);if(j.expanded==false||!j.allowResize||!j.showSplit){return}this.dragRegion=j;var f=this._getDrag();f.start(i)}},_getDrag:function(){if(!this.drag){this.drag=new mini.Drag({capture:true,onStart:mini.createDelegate(this._OnDragStart,this),onMove:mini.createDelegate(this._OnDragMove,this),onStop:mini.createDelegate(this._OnDragStop,this)})}return this.drag},_OnDragStart:function(b){this._maskProxy=mini.append(document.body,'<div class="mini-resizer-mask"></div>');this._dragProxy=mini.append(document.body,'<div class="mini-proxy"></div>');this._dragProxy.style.cursor="n-resize";if(this.dragRegion.region=="west"||this.dragRegion.region=="east"){this._dragProxy.style.cursor="w-resize"}this.splitBox=mini.getBox(this.dragRegion._split);mini.setBox(this._dragProxy,this.splitBox);this.elBox=mini.getBox(this.el,true)},_OnDragMove:function(D){var x=D.now[0]-D.init[0];var K=this.splitBox.x+x;var N=D.now[1]-D.init[1];var M=this.splitBox.y+N;var B=K+this.splitBox.width;var P=M+this.splitBox.height;var R=this.getRegion("west"),O=this.getRegion("east"),F=this.getRegion("north"),I=this.getRegion("south"),A=this.getRegion("center");var y=R&&R.visible?R.width:0;var Q=O&&O.visible?O.width:0;var V=F&&F.visible?F.height:0;var L=I&&I.visible?I.height:0;var G=R&&R.showSplit?mini.getWidth(R._split):0;var J=O&&O.showSplit?mini.getWidth(O._split):0;var S=F&&F.showSplit?mini.getHeight(F._split):0;var E=I&&I.showSplit?mini.getHeight(I._split):0;var T=this.dragRegion,U=T.region;if(U=="west"){var C=this.elBox.width-Q-J-G-A.minWidth;if(K-this.elBox.x>C){K=C+this.elBox.x}if(K-this.elBox.x<T.minWidth){K=T.minWidth+this.elBox.x}if(K-this.elBox.x>T.maxWidth){K=T.maxWidth+this.elBox.x}mini.setX(this._dragProxy,K)}else{if(U=="east"){var C=this.elBox.width-y-G-J-A.minWidth;if(this.elBox.right-(K+this.splitBox.width)>C){K=this.elBox.right-C-this.splitBox.width}if(this.elBox.right-(K+this.splitBox.width)<T.minWidth){K=this.elBox.right-T.minWidth-this.splitBox.width}if(this.elBox.right-(K+this.splitBox.width)>T.maxWidth){K=this.elBox.right-T.maxWidth-this.splitBox.width}mini.setX(this._dragProxy,K)}else{if(U=="north"){var H=this.elBox.height-L-E-S-A.minHeight;if(M-this.elBox.y>H){M=H+this.elBox.y}if(M-this.elBox.y<T.minHeight){M=T.minHeight+this.elBox.y}if(M-this.elBox.y>T.maxHeight){M=T.maxHeight+this.elBox.y}mini.setY(this._dragProxy,M)}else{if(U=="south"){var H=this.elBox.height-V-S-E-A.minHeight;if(this.elBox.bottom-(M+this.splitBox.height)>H){M=this.elBox.bottom-H-this.splitBox.height}if(this.elBox.bottom-(M+this.splitBox.height)<T.minHeight){M=this.elBox.bottom-T.minHeight-this.splitBox.height}if(this.elBox.bottom-(M+this.splitBox.height)>T.maxHeight){M=this.elBox.bottom-T.maxHeight-this.splitBox.height}mini.setY(this._dragProxy,M)}}}}},_OnDragStop:function(l){var k=mini.getBox(this._dragProxy);var j=this.dragRegion,n=j.region;if(n=="west"){var g=k.x-this.elBox.x;this.updateRegion(j,{width:g})}else{if(n=="east"){var g=this.elBox.right-k.right;this.updateRegion(j,{width:g})}else{if(n=="north"){var i=k.y-this.elBox.y;this.updateRegion(j,{height:i})}else{if(n=="south"){var i=this.elBox.bottom-k.bottom;this.updateRegion(j,{height:i})}}}}jQuery(this._dragProxy).remove();this._dragProxy=null;this.elBox=this.handlerBox=null;jQuery(this._maskProxy).remove();this._maskProxy=null},_VirtualToggle:function(b){b=this.getRegion(b);if(b._Expanded===true){this._VirtualCollapse(b)}else{this._VirtualExpand(b)}},_VirtualExpand:function(r){if(this._inAniming){return}this.doLayout();var u=r.region,C=r._el;r._Expanded=true;mini.addClass(C,"mini-layout-popup");var y=mini.getBox(r._proxy);var w=mini.getBox(r._el);var A={};if(u=="east"){var q=y.x;var s=y.y;var x=y.height;mini.setHeight(C,x);mini.setX(C,q);C.style.top=r._proxy.style.top;var z=parseInt(C.style.left);A={left:z-w.width}}else{if(u=="west"){var q=y.right-w.width;var s=y.y;var x=y.height;mini.setHeight(C,x);mini.setX(C,q);C.style.top=r._proxy.style.top;var z=parseInt(C.style.left);A={left:z+w.width}}else{if(u=="north"){var q=y.x;var s=y.bottom-w.height;var p=y.width;mini.setWidth(C,p);mini.setXY(C,q,s);var t=parseInt(C.style.top);A={top:t+w.height}}else{if(u=="south"){var q=y.x;var s=y.y;var p=y.width;mini.setWidth(C,p);mini.setXY(C,q,s);var t=parseInt(C.style.top);A={top:t-w.height}}}}}mini.addClass(r._proxy,"mini-layout-maxZIndex");this._inAniming=true;var v=this;var B=jQuery(C);B.animate(A,250,function(){mini.removeClass(r._proxy,"mini-layout-maxZIndex");v._inAniming=false})},_VirtualCollapse:function(k){if(this._inAniming){return}k._Expanded=false;var l=k.region,s=k._el;var o=mini.getBox(s);var q={};if(l=="east"){var p=parseInt(s.style.left);q={left:p+o.width}}else{if(l=="west"){var p=parseInt(s.style.left);q={left:p-o.width}}else{if(l=="north"){var j=parseInt(s.style.top);q={top:j-o.height}}else{if(l=="south"){var j=parseInt(s.style.top);q={top:j+o.height}}}}}mini.addClass(k._proxy,"mini-layout-maxZIndex");this._inAniming=true;var n=this;var r=jQuery(s);r.animate(q,250,function(){mini.removeClass(k._proxy,"mini-layout-maxZIndex");n._inAniming=false;n.doLayout()})},__OnDocMouseDown:function(i){if(this._inAniming){return}for(var f=0,g=this.regions.length;f<g;f++){var j=this.regions[f];if(!j._Expanded){continue}if(mini.isAncestor(j._el,i.target)||mini.isAncestor(j._proxy,i.target)||i.target.location){}else{this._VirtualCollapse(j)}}},getAttrs:function(s){var i=mini.Layout.superclass.getAttrs.call(this,s);var r=jQuery(s);var l=parseInt(r.attr("splitSize"));if(!isNaN(l)){i.splitSize=l}var o=[];var u=mini.getChildNodes(s);for(var n=0,p=u.length;n<p;n++){var q=u[n];var t={};o.push(t);t.cls=q.className;t.style=q.style.cssText;mini._ParseString(q,t,["region","title","iconCls","iconStyle","cls","headerCls","headerStyle","bodyCls","bodyStyle"]);mini._ParseBool(q,t,["allowResize","visible","showCloseButton","showCollapseButton","showSplit","showHeader","expanded","showSplitIcon"]);mini._ParseInt(q,t,["splitSize","collapseSize","width","height","minWidth","minHeight","maxWidth","maxHeight"]);t.bodyParent=q}i.regions=o;return i}});mini.regClass(mini.Layout,"layout");mini.Box=function(){mini.Box.superclass.constructor.call(this)};mini.extend(mini.Box,mini.Container,{style:"",borderStyle:"",bodyStyle:"",uiCls:"mini-box",_create:function(){this.el=document.createElement("div");this.el.className="mini-box";this.el.innerHTML='<div class="mini-box-border"></div>';this._bodyEl=this._borderEl=this.el.firstChild;this._contentEl=this._bodyEl},_initEvents:function(){},doLayout:function(){if(!this.canLayout()){return}var i=this.isAutoHeight();var k=this.isAutoWidth();var l=mini.getPaddings(this._bodyEl);var n=mini.getMargins(this._bodyEl);if(!i){var o=this.getHeight(true);if(jQuery.boxModel){o=o-l.top-l.bottom}o=o-n.top-n.bottom;if(o<0){o=0}this._bodyEl.style.height=o+"px"}else{this._bodyEl.style.height=""}var j=this.getWidth(true);var p=j;j=j-n.left-n.right;if(jQuery.boxModel){j=j-l.left-l.right}if(j<0){j=0}this._bodyEl.style.width=j+"px";mini.layout(this._borderEl);this.fire("layout")},setBody:function(g){if(!g){return}if(!mini.isArray(g)){g=[g]}for(var d=0,f=g.length;d<f;d++){mini.append(this._bodyEl,g[d])}mini.parse(this._bodyEl);this.doLayout()},set_bodyParent:function(d){if(!d){return}var f=this._bodyEl;var g=d;while(g.firstChild){f.appendChild(g.firstChild)}this.doLayout()},setBodyStyle:function(b){mini.setStyle(this._bodyEl,b);this.doLayout()},getAttrs:function(c){var d=mini.Box.superclass.getAttrs.call(this,c);d._bodyParent=c;mini._ParseString(c,d,["bodyStyle"]);return d}});mini.regClass(mini.Box,"box");mini.Include=function(){mini.Include.superclass.constructor.call(this)};mini.extend(mini.Include,mini.Control,{url:"",uiCls:"mini-include",_create:function(){this.el=document.createElement("div");this.el.className="mini-include"},_initEvents:function(){},doLayout:function(){if(!this.canLayout()){return}var i=this.el.childNodes;if(i){for(var f=0,g=i.length;f<g;f++){var j=i[f];mini.layout(j)}}},setUrl:function(b){this.url=b;mini.update({url:this.url,el:this.el,async:this.async});this.doLayout()},getUrl:function(b){return this.url},getAttrs:function(c){var d=mini.Include.superclass.getAttrs.call(this,c);mini._ParseString(c,d,["url"]);return d}});mini.regClass(mini.Include,"include");mini.Tabs=function(){this._initTabs();mini.Tabs.superclass.constructor.call(this)};mini.extend(mini.Tabs,mini.Control,{activeIndex:-1,tabAlign:"left",tabPosition:"top",showBody:true,showHeader:true,nameField:"name",titleField:"title",urlField:"url",url:"",maskOnLoad:true,plain:true,bodyStyle:"",_tabHoverCls:"mini-tab-hover",_tabActiveCls:"mini-tab-active",set:function(i){if(typeof i=="string"){return this}var j=this._allowLayout;this._allowLayout=false;var g=i.activeIndex;delete i.activeIndex;var f=i.url;delete i.url;mini.Tabs.superclass.set.call(this,i);if(f){this.setUrl(f)}if(mini.isNumber(g)){this.setActiveIndex(g)}this._allowLayout=j;this.doLayout();return this},uiCls:"mini-tabs",_create:function(){this.el=document.createElement("div");this.el.className="mini-tabs";var c='<table class="mini-tabs-table" cellspacing="0" cellpadding="0"><tr style="width:100%;"><td></td><td style="text-align:left;vertical-align:top;width:100%;"><div class="mini-tabs-bodys"></div></td><td></td></tr></table>';this.el.innerHTML=c;this._tableEl=this.el.firstChild;var d=this.el.getElementsByTagName("td");this._td1El=d[0];this._td2El=d[1];this._td3El=d[2];this._bodyEl=this._td2El.firstChild;this._borderEl=this._bodyEl;this.doUpdate()},destroy:function(b){this._tableEl=this._td1El=this._td2El=this._td3El=null;this._bodyEl=this._borderEl=this.headerEl=null;this.tabs=[];mini.Tabs.superclass.destroy.call(this,b)},_doClearElement:function(){mini.removeClass(this._td1El,"mini-tabs-header");mini.removeClass(this._td3El,"mini-tabs-header");this._td1El.innerHTML="";this._td3El.innerHTML="";mini.removeChilds(this._td2El,this._bodyEl)},_initEvents:function(){mini._BindEvents(function(){mini.on(this.el,"mousedown",this.__OnMouseDown,this);mini.on(this.el,"click",this.__OnClick,this);mini.on(this.el,"mouseover",this.__OnMouseOver,this);mini.on(this.el,"mouseout",this.__OnMouseOut,this)},this)},_initTabs:function(){this.tabs=[]},_TabID:1,createTab:function(d){var c=mini.copyTo({_id:this._TabID++,name:"",title:"",newLine:false,iconCls:"",iconStyle:"",headerCls:"",headerStyle:"",bodyCls:"",bodyStyle:"",visible:true,enabled:true,showCloseButton:false,active:false,url:"",loaded:false,refreshOnClick:false},d);if(d){d=mini.copyTo(d,c);c=d}return c},_doLoad:function(){var b=mini._getResult(this.url,null,null,null,null,this.dataField);if(this.dataField&&!mini.isArray(b)){b=mini._getMap(this.dataField,b)}if(!b){b=[]}this.setTabs(b);this.fire("load")},load:function(b){if(typeof b=="string"){this.setUrl(b)}else{this.setTabs(b)}},setUrl:function(b){this.url=b;this._doLoad()},getUrl:function(){return this.url},setNameField:function(b){this.nameField=b},getNameField:function(){return this.nameField},setTitleField:function(b){this.titleField=b},getTitleField:function(){return this.titleField},setUrlField:function(b){this.urlField=b},getUrlField:function(){return this.urlField},setButtons:function(c){this._buttons=mini.byId(c);if(this._buttons){var d=mini.byClass("mini-tabs-buttons",this.el);if(d){d.appendChild(this._buttons);mini.parse(d);this.doLayout()}}},setTabControls:function(d,g){var d=this.getTab(d);if(!d){return}var f=this.getTabBodyEl(d);__mini_setControls(g,f,this)},setTabs:function(j){if(!mini.isArray(j)){return}this.beginUpdate();this.removeAll();for(var f=0,g=j.length;f<g;f++){var i=j[f];i.title=mini._getMap(this.titleField,i);i.url=mini._getMap(this.urlField,i);i.name=mini._getMap(this.nameField,i)}for(var f=0,g=j.length;f<g;f++){this.addTab(j[f])}this.setActiveIndex(0);this.endUpdate()},getTabs:function(){return this.tabs},removeAll:function(p){var j=this.getActiveTab();if(mini.isNull(p)){p=[]}if(!mini.isArray(p)){p=[p]}for(var n=p.length-1;n>=0;n--){var o=this.getTab(p[n]);if(!o){p.removeAt(n)}else{p[n]=o}}var i=this.tabs;for(var n=i.length-1;n>=0;n--){var l=i[n];if(p.indexOf(l)==-1){this.removeTab(l)}}var k=p[0];if(j!=this.getActiveTab()){if(k){this.activeTab(k)}}},addTab:function(q,l){if(typeof q=="string"){q={title:q}}q=this.createTab(q);if(!q.name){q.name=""}if(typeof l!="number"){l=this.tabs.length}this.tabs.insert(l,q);var k=this._createTabBodyId(q);var i='<div id="'+k+'" class="mini-tabs-body '+q.bodyCls+'" style="'+q.bodyStyle+';display:none;"></div>';mini.append(this._bodyEl,i);var r=this.getTabBodyEl(q);var n=q.body;delete q.body;if(n){if(!mini.isArray(n)){n=[n]}for(var o=0,p=n.length;o<p;o++){mini.append(r,n[o])}}if(q.bodyParent){var s=q.bodyParent;while(s.firstChild){if(s.firstChild.nodeType==8){s.removeChild(s.firstChild)}else{r.appendChild(s.firstChild)}}}delete q.bodyParent;if(q.controls){this.setTabControls(q,q.controls);delete q.controls}this.doUpdate();return q},removeTab:function(j){j=this.getTab(j);if(!j||this.tabs.indexOf(j)==-1){return}var g=this.getActiveTab();var k=j==g;var i=this._OnTabDestroy(j);this.tabs.remove(j);this._doRemoveIFrame(j);var l=this.getTabBodyEl(j);if(l){this._bodyEl.removeChild(l)}if(i&&k){for(var n=this.activeIndex;n>=0;n--){var j=this.getTab(n);if(j&&j.enabled&&j.visible){this.activeIndex=n;break}}this.doUpdate();this.setActiveIndex(this.activeIndex);this.fire("activechanged")}else{this.activeIndex=this.tabs.indexOf(g);this.doUpdate()}return j},moveTab:function(g,f){g=this.getTab(g);if(!g){return}var d=this.tabs[f];if(d==g){return}this.tabs.remove(g);var f=this.tabs.indexOf(d);if(f==-1){this.tabs.add(g)}else{this.tabs.insert(f,g)}this.doUpdate()},updateTab:function(c,d){c=this.getTab(c);if(!c){return}mini.copyTo(c,d);this.doUpdate()},_getMaskWrapEl:function(){return this._bodyEl},_doRemoveIFrame:function(l,n){if(l._iframeEl&&l._iframeEl.parentNode){l._iframeEl.onload=function(){};jQuery(l._iframeEl).unbind("load");l._iframeEl.src="";try{iframe.contentWindow.document.write("");iframe.contentWindow.document.close()}catch(p){}if(l._iframeEl._ondestroy){l._iframeEl._ondestroy()}try{l._iframeEl.parentNode.removeChild(l._iframeEl);l._iframeEl.removeNode(true)}catch(p){}}l._iframeEl=null;l.loadedUrl=null;if(n===true){var d=this.getTabBodyEl(l);if(d){var o=mini.getChildNodes(d,true);for(var q=0,i=o.length;q<i;q++){var k=o[q];if(k&&k.parentNode){k.parentNode.removeChild(k)}}}}},_deferLoadingTime:180,_cancelLoadTabs:function(i){var j=this.tabs;for(var k=0,g=j.length;k<g;k++){var f=j[k];if(f!=i){if(f._loading&&f._iframeEl){f._loading=false;this._doRemoveIFrame(f,true)}}}if(i&&i==this.getActiveTab()&&i._loading){}else{this._loading=false;this.unmask()}},_doLoadTab:function(j){if(!j||j!=this.getActiveTab()){return}var g=this.getTabBodyEl(j);if(!g){return}this._cancelLoadTabs();this._doRemoveIFrame(j,true);this._loading=true;j._loading=true;this.unmask();if(this.maskOnLoad){this.loading()}var f=new Date();var i=this;i.isLoading=true;var k=mini.createIFrame(j.url,function(a,b){try{j._iframeEl.contentWindow.Owner=window;j._iframeEl.contentWindow.CloseOwnerWindow=function(l){j.removeAction=l;var n=true;if(j.ondestroy){if(typeof j.ondestroy=="string"){j.ondestroy=window[j.ondestroy]}if(j.ondestroy){n=j.ondestroy.call(this,c)}}if(n===false){return false}setTimeout(function(){i.removeTab(j)},10)}}catch(c){}if(j._loading!=true){return}var d=(f-new Date())+i._deferLoadingTime;j._loading=false;j.loadedUrl=j.url;if(d<0){d=0}setTimeout(function(){i.unmask();i.doLayout();i.isLoading=false},d);if(b){var c={sender:i,tab:j,index:i.tabs.indexOf(j),name:j.name,iframe:j._iframeEl};if(j.onload){if(typeof j.onload=="string"){j.onload=window[j.onload]}if(j.onload){j.onload.call(i,c)}}}if(i.getActiveTab()==j){i.fire("tabload",c)}});setTimeout(function(){if(j._iframeEl==k){g.appendChild(k)}},1);j._iframeEl=k},_OnTabDestroy:function(d){var c={sender:this,tab:d,index:this.tabs.indexOf(d),name:d.name,iframe:d._iframeEl,autoActive:true};this.fire("tabdestroy",c);return c.autoActive},loadTab:function(i,n,j,k){if(!i){return}n=this.getTab(n);if(!n){n=this.getActiveTab()}if(!n){return}var g=this.getTabBodyEl(n);if(g){mini.addClass(g,"mini-tabs-hideOverflow")}n.url=i;delete n.loadedUrl;if(j){n.onload=j}if(k){n.ondestroy=k}var l=this;clearTimeout(this._loadTabTimer);this._loadTabTimer=null;this._loadTabTimer=setTimeout(function(){l._doLoadTab(n)},1)},reloadTab:function(b){b=this.getTab(b);if(!b){b=this.getActiveTab()}if(!b){return}this.loadTab(b.url,b)},getTabRows:function(){var j=[];var i=[];for(var f=0,g=this.tabs.length;f<g;f++){var k=this.tabs[f];if(f!=0&&k.newLine){j.push(i);i=[]}i.push(k)}j.push(i);return j},doUpdate:function(){if(this._allowUpdate===false){return}if(this._buttons&&this._buttons.parentNode){this._buttons.parentNode.removeChild(this._buttons)}mini.removeClass(this.el,"mini-tabs-position-left");mini.removeClass(this.el,"mini-tabs-position-top");mini.removeClass(this.el,"mini-tabs-position-right");mini.removeClass(this.el,"mini-tabs-position-bottom");if(this.tabPosition=="bottom"){mini.addClass(this.el,"mini-tabs-position-bottom");this._doUpdateBottom()}else{if(this.tabPosition=="right"){mini.addClass(this.el,"mini-tabs-position-right");this._doUpdateRight()}else{if(this.tabPosition=="left"){mini.addClass(this.el,"mini-tabs-position-left");this._doUpdateLeft()}else{mini.addClass(this.el,"mini-tabs-position-top");this._doUpdateTop()}}}if(this._buttons){var b=mini.byClass("mini-tabs-buttons",this.el);if(b){b.appendChild(this._buttons);mini.parse(b)}}this.doLayout();this.setActiveIndex(this.activeIndex,false)},_handleIFrameOverflow:function(){var d=this.getTabBodyEl(this.activeIndex);if(d){mini.removeClass(d,"mini-tabs-hideOverflow");var c=mini.getChildNodes(d)[0];if(c&&c.tagName&&c.tagName.toUpperCase()=="IFRAME"){mini.addClass(d,"mini-tabs-hideOverflow")}}},doLayout:function(){if(!this.canLayout()){return}this._headerEl.style.display=this.showHeader?"":"none";this._handleIFrameOverflow();var V=this.isAutoHeight();O=this.getHeight(true);Z=this.getWidth();var Y=O;var L=Z;if(this.showBody){this._bodyEl.style.display=""}else{this._bodyEl.style.display="none"}if(this.plain){mini.addClass(this.el,"mini-tabs-plain")}else{mini.removeClass(this.el,"mini-tabs-plain")}if(!V&&this.showBody){var X=jQuery(this._headerEl).outerHeight();var ah=jQuery(this._headerEl).outerWidth();if(this.tabPosition=="top"){X=jQuery(this._headerEl.parentNode).outerHeight()}if(this.tabPosition=="left"||this.tabPosition=="right"){Z=Z-ah}else{O=O-X}if(jQuery.boxModel){var T=mini.getPaddings(this._bodyEl);var i=mini.getBorders(this._bodyEl);O=O-T.top-T.bottom-i.top-i.bottom;Z=Z-T.left-T.right-i.left-i.right}margin=mini.getMargins(this._bodyEl);O=O-margin.top-margin.bottom;Z=Z-margin.left-margin.right;if(O<0){O=0}if(Z<0){Z=0}this._bodyEl.style.width=Z+"px";this._bodyEl.style.height=O+"px";if(this.tabPosition=="left"||this.tabPosition=="right"){var am=this._headerEl.getElementsByTagName("tr")[0];var U=am.childNodes;var W=U[0].getElementsByTagName("tr");var ag=last=all=0;for(var R=0,aa=W.length;R<aa;R++){var am=W[R];var ab=jQuery(am).outerHeight();all+=ab;if(R==0){ag=ab}if(R==aa-1){last=ab}}switch(this.tabAlign){case"center":var S=parseInt((Y-(all-ag-last))/2);for(var R=0,aa=U.length;R<aa;R++){U[R].firstChild.style.height=Y+"px";var ad=U[R].firstChild;var W=ad.getElementsByTagName("tr");var w=W[0],K=W[W.length-1];w.style.height=S+"px";K.style.height=S+"px"}break;case"right":for(var R=0,aa=U.length;R<aa;R++){var ad=U[R].firstChild;var W=ad.getElementsByTagName("tr");var am=W[0];var Q=Y-(all-ag);if(Q>=0){am.style.height=Q+"px"}}break;case"fit":for(var R=0,aa=U.length;R<aa;R++){U[R].firstChild.style.height=Y+"px"}break;default:for(var R=0,aa=U.length;R<aa;R++){var ad=U[R].firstChild;var W=ad.getElementsByTagName("tr");var am=W[W.length-1];var Q=Y-(all-last);if(Q>=0){am.style.height=Q+"px"}}break}}}else{this._bodyEl.style.width="auto";this._bodyEl.style.height="auto"}var ai=this.getTabBodyEl(this.activeIndex);if(ai){if(!V&&this.showBody){var O=mini.getHeight(this._bodyEl,true);if(jQuery.boxModel){var T=mini.getPaddings(ai);var i=mini.getBorders(ai);O=O-T.top-T.bottom-i.top-i.bottom}ai.style.height=O+"px"}else{ai.style.height="auto"}}switch(this.tabPosition){case"bottom":var ak=this._headerEl.childNodes;for(var R=0,aa=ak.length;R<aa;R++){var ad=ak[R];mini.removeClass(ad,"mini-tabs-header2");if(aa>1&&R!=0){mini.addClass(ad,"mini-tabs-header2")}}break;case"left":var U=this._headerEl.firstChild.rows[0].cells;for(var R=0,aa=U.length;R<aa;R++){var ae=U[R];mini.removeClass(ae,"mini-tabs-header2");if(aa>1&&R==0){mini.addClass(ae,"mini-tabs-header2")}}break;case"right":var U=this._headerEl.firstChild.rows[0].cells;for(var R=0,aa=U.length;R<aa;R++){var ae=U[R];mini.removeClass(ae,"mini-tabs-header2");if(aa>1&&R!=0){mini.addClass(ae,"mini-tabs-header2")}}break;default:var ak=this._headerEl.childNodes;for(var R=0,aa=ak.length;R<aa;R++){var ad=ak[R];mini.removeClass(ad,"mini-tabs-header2");if(aa>1&&R==0){mini.addClass(ad,"mini-tabs-header2")}}break}mini.removeClass(this.el,"mini-tabs-scroll");var ae=mini.byClass("mini-tabs-lastSpace",this.el);var P=mini.byClass("mini-tabs-buttons",this.el);var aj=this._headerEl.parentNode;aj.style.paddingRight="0px";if(this._navEl){this._navEl.style.display="none"}if(P){P.style.display="none"}mini.setWidth(aj,L);if(this.tabPosition=="top"&&this.tabAlign=="left"){this._headerEl.style.width="auto";P.style.display="block";var l=L;var ac=this._headerEl.firstChild.offsetWidth-ae.offsetWidth;var M=P.firstChild?P.offsetWidth:0;if(ac+M>l){this._navEl.style.display="block";this._navEl.style.right=M+"px";var N=this._navEl.offsetWidth;var Z=l-M-N;mini.setWidth(this._headerEl,Z)}}this._scrollToTab(this.activeIndex);this._doScrollButton();mini.layout(this._bodyEl);var af=this;var al=this.getActiveTab();if(al&&al.repaint&&ai){var Z=ai.style.width;ai.style.width="0px";setTimeout(function(){ai.style.width=Z},1)}this.fire("layout")},setTabAlign:function(b){this.tabAlign=b;this.doUpdate()},setTabPosition:function(b){this.tabPosition=b;this.doUpdate()},getTab:function(f){if(typeof f=="object"){return f}if(typeof f=="number"){return this.tabs[f]}else{for(var j=0,g=this.tabs.length;j<g;j++){var i=this.tabs[j];if(i.name==f){return i}}}},getHeaderEl:function(){return this._headerEl},getBodyEl:function(){return this._bodyEl},getTabEl:function(i){var l=this.getTab(i);if(!l){return null}var k=this._createTabId(l);var n=this.el.getElementsByTagName("*");for(var p=0,j=n.length;p<j;p++){var o=n[p];if(o.id==k){return o}}return null},getTabBodyEl:function(i){var l=this.getTab(i);if(!l){return null}var k=this._createTabBodyId(l);var n=this._bodyEl.childNodes;for(var p=0,j=n.length;p<j;p++){var o=n[p];if(o.id==k){return o}}return null},getTabIFrameEl:function(d){var c=this.getTab(d);if(!c){return null}return c._iframeEl},_createTabId:function(b){return this.uid+"$"+b._id},_createTabBodyId:function(b){return this.uid+"$body$"+b._id},_doScrollButton:function(){if(this.tabPosition=="top"){mini.removeClass(this._leftButtonEl,"mini-disabled");mini.removeClass(this._rightButtonEl,"mini-disabled");if(this._headerEl.scrollLeft==0){mini.addClass(this._leftButtonEl,"mini-disabled")}var g=this.getTabEl(this.tabs.length-1);if(g){var f=mini.getBox(g);var d=mini.getBox(this._headerEl);if(f.right<=d.right){mini.addClass(this._rightButtonEl,"mini-disabled")}}}},setActiveIndex:function(t,s){var B=this.getTab(t);var i=this.getTab(this.activeIndex);var E=B!=i;var D=this.getTabBodyEl(this.activeIndex);if(D){D.style.display="none"}if(B){this.activeIndex=this.tabs.indexOf(B)}else{this.activeIndex=-1}var D=this.getTabBodyEl(this.activeIndex);if(D){D.style.display=""}var D=this.getTabEl(i);if(D){mini.removeClass(D,this._tabActiveCls)}var D=this.getTabEl(B);if(D){mini.addClass(D,this._tabActiveCls)}if(D&&E){if(this.tabPosition=="bottom"){var x=mini.findParent(D,"mini-tabs-header");if(x){jQuery(this._headerEl).prepend(x)}}else{if(this.tabPosition=="left"){var y=mini.findParent(D,"mini-tabs-header").parentNode;if(y){y.parentNode.appendChild(y)}}else{if(this.tabPosition=="right"){var y=mini.findParent(D,"mini-tabs-header").parentNode;if(y){jQuery(y.parentNode).prepend(y)}}else{var x=mini.findParent(D,"mini-tabs-header");if(x){this._headerEl.appendChild(x)}}}}var z=this._headerEl.scrollLeft;this.doLayout();var l=this.getTabRows();if(l.length>1){}else{this._scrollToTab(this.activeIndex);this._doScrollButton()}for(var w=0,A=this.tabs.length;w<A;w++){var C=this.getTabEl(this.tabs[w]);if(C){mini.removeClass(C,this._tabHoverCls)}}}var u=this;if(E){var v={tab:B,index:this.tabs.indexOf(B),name:B?B.name:""};setTimeout(function(){u.fire("ActiveChanged",v)},1)}this._cancelLoadTabs(B);if(s!==false){if(B&&B.url&&!B.loadedUrl){var u=this;u.loadTab(B.url,B)}}else{}if(u.canLayout()){try{mini.layoutIFrames(u.el)}catch(v){}}},_scrollToTab:function(g){var j=this._headerEl.scrollLeft;if(this.tabPosition=="top"){this._headerEl.scrollLeft=j;var k=this.getTabEl(g);if(k){var l=this;var i=mini.getBox(k);var n=mini.getBox(l._headerEl);if(i.x<n.x){l._headerEl.scrollLeft-=(n.x-i.x)}else{if(i.right>n.right){l._headerEl.scrollLeft+=(i.right-n.right)}}}}},getActiveIndex:function(){return this.activeIndex},activeTab:function(b){this.setActiveIndex(b)},getActiveTab:function(){return this.getTab(this.activeIndex)},getActiveIndex:function(){return this.activeIndex},_tryActiveTab:function(d){d=this.getTab(d);if(!d){return}var f=this.tabs.indexOf(d);if(this.activeIndex==f){return}var g={tab:d,index:f,name:d.name,cancel:false};this.fire("BeforeActiveChanged",g);if(g.cancel==false){this.activeTab(d)}},setShowHeader:function(b){if(this.showHeader!=b){this.showHeader=b;this.doLayout()}},getShowHeader:function(){return this.showHeader},setShowBody:function(b){if(this.showBody!=b){this.showBody=b;this.doLayout()}},getShowBody:function(){return this.showBody},setBodyStyle:function(b){this.bodyStyle=b;mini.setStyle(this._bodyEl,b);this.doLayout()},getBodyStyle:function(){return this.bodyStyle},setMaskOnLoad:function(b){this.maskOnLoad=b},getMaskOnLoad:function(){return this.maskOnLoad},setPlain:function(b){this.plain=b;this.doLayout()},getPlain:function(){return this.plain},getTabByEvent:function(b){return this._getTabByEvent(b)},_getTabByEvent:function(i){var j=mini.findParent(i.target,"mini-tab");if(!j){return null}var f=j.id.split("$");if(f[0]!=this.uid){return null}var g=parseInt(jQuery(j).attr("index"));return this.getTab(g)},__OnClick:function(g){var f=this._getTabByEvent(g);if(!f){return}if(f.enabled){var d=this;setTimeout(function(){if(mini.findParent(g.target,"mini-tab-close")){d._OnCloseButtonClick(f,g)}else{var a=f.loadedUrl;d._tryActiveTab(f);if(f.refreshOnClick&&f.url==a){d.reloadTab(f)}}},10)}},hoverTab:null,__OnMouseOver:function(d){var f=this._getTabByEvent(d);if(f&&f.enabled){var g=this.getTabEl(f);mini.addClass(g,this._tabHoverCls);this.hoverTab=f}},__OnMouseOut:function(d){if(this.hoverTab){var c=this.getTabEl(this.hoverTab);mini.removeClass(c,this._tabHoverCls)}this.hoverTab=null},__OnMouseDown:function(i){clearInterval(this._scrollTimer);if(this.tabPosition=="top"){var j=this;var f=0,g=10;if(i.target==this._leftButtonEl){this._scrollTimer=setInterval(function(){j._headerEl.scrollLeft-=g;f++;if(f>5){g=18}if(f>10){g=25}j._doScrollButton()},25)}else{if(i.target==this._rightButtonEl){this._scrollTimer=setInterval(function(){j._headerEl.scrollLeft+=g;f++;if(f>5){g=18}if(f>10){g=25}j._doScrollButton()},25)}}mini.on(document,"mouseup",this.__OnDocMouseUp,this)}},__OnDocMouseUp:function(b){clearInterval(this._scrollTimer);this._scrollTimer=null;mini.un(document,"mouseup",this.__OnDocMouseUp,this)},_doUpdateTop:function(){var k=this.tabPosition=="top";var F="";if(k){F+='<div class="mini-tabs-scrollCt">';F+='<div class="mini-tabs-nav"><a class="mini-tabs-leftButton" href="javascript:void(0)" hideFocus onclick="return false"></a><a class="mini-tabs-rightButton" href="javascript:void(0)" hideFocus onclick="return false"></a></div>';F+='<div class="mini-tabs-buttons"></div>'}F+='<div class="mini-tabs-headers">';var G=this.getTabRows();for(var x=0,z=G.length;x<z;x++){var j=G[x];var H="";F+='<table class="mini-tabs-header" cellspacing="0" cellpadding="0"><tr><td class="mini-tabs-space mini-tabs-firstSpace"><div></div></td>';for(var s=0,A=j.length;s<A;s++){var C=j[s];var D=this._createTabId(C);if(!C.visible){continue}var l=this.tabs.indexOf(C);var H=C.headerCls||"";if(C.enabled==false){H+=" mini-disabled"}F+='<td id="'+D+'" index="'+l+'"  class="mini-tab '+H+'" style="'+C.headerStyle+'">';if(C.iconCls||C.iconStyle){F+='<span class="mini-tab-icon '+C.iconCls+'" style="'+C.iconStyle+'"></span>'}F+='<span class="mini-tab-text">'+C.title+"</span>";if(C.showCloseButton){var E="";if(C.enabled){E="onmouseover=\"mini.addClass(this, 'mini-tab-close-hover')\" onmouseout=\"mini.removeClass(this, 'mini-tab-close-hover')\""}F+='<span class="mini-tab-close" '+E+"></span>"}F+="</td>";if(s!=A-1){F+='<td class="mini-tabs-space2"><div></div></td>'}}F+='<td class="mini-tabs-space mini-tabs-lastSpace" ><div></div></td></tr></table>'}if(k){F+="</div>"}F+="</div>";this._doClearElement();mini.prepend(this._td2El,F);var B=this._td2El;this._headerEl=B.firstChild.lastChild;if(k){this._navEl=this._headerEl.parentNode.firstChild;this._leftButtonEl=this._navEl.firstChild;this._rightButtonEl=this._navEl.childNodes[1]}switch(this.tabAlign){case"center":var i=this._headerEl.childNodes;for(var s=0,A=i.length;s<A;s++){var y=i[s];var w=y.getElementsByTagName("td");w[0].style.width="50%";w[w.length-1].style.width="50%"}break;case"right":var i=this._headerEl.childNodes;for(var s=0,A=i.length;s<A;s++){var y=i[s];var w=y.getElementsByTagName("td");w[0].style.width="100%"}break;case"fit":break;default:var i=this._headerEl.childNodes;for(var s=0,A=i.length;s<A;s++){var y=i[s];var w=y.getElementsByTagName("td");w[w.length-1].style.width="100%"}break}},_doUpdateBottom:function(){this._doUpdateTop();var b=this._td2El;mini.append(b,b.firstChild);this._headerEl=b.lastChild},_doUpdateLeft:function(){var i='<table cellspacing="0" cellpadding="0"><tr>';var j=this.getTabRows();for(var s=0,t=j.length;s<t;s++){var l=j[s];var k="";if(t>1&&s!=t-1){k="mini-tabs-header2"}i+='<td class="'+k+'"><table class="mini-tabs-header" cellspacing="0" cellpadding="0">';i+='<tr ><td class="mini-tabs-space mini-tabs-firstSpace" ><div></div></td></tr>';for(var r=0,u=l.length;r<u;r++){var v=l[r];var w=this._createTabId(v);if(!v.visible){continue}var q=this.tabs.indexOf(v);var k=v.headerCls||"";if(v.enabled==false){k+=" mini-disabled"}i+='<tr><td id="'+w+'" index="'+q+'"  class="mini-tab '+k+'" style="'+v.headerStyle+'">';if(v.iconCls||v.iconStyle){i+='<span class="mini-tab-icon '+v.iconCls+'" style="'+v.iconStyle+'"></span>'}i+='<span class="mini-tab-text">'+v.title+"</span>";if(v.showCloseButton){var x="";if(v.enabled){x="onmouseover=\"mini.addClass(this, 'mini-tab-close-hover')\" onmouseout=\"mini.removeClass(this, 'mini-tab-close-hover')\""}i+='<span class="mini-tab-close" '+x+"></span>"}i+="</td></tr>";if(r!=u-1){i+='<tr><td class="mini-tabs-space2"><div></div></td></tr>'}}i+='<tr ><td class="mini-tabs-space mini-tabs-lastSpace" ><div></div></td></tr>';i+="</table></td>"}i+="</tr ></table>";this._doClearElement();mini.addClass(this._td1El,"mini-tabs-header");mini.append(this._td1El,i);this._headerEl=this._td1El},_doUpdateRight:function(){this._doUpdateLeft();mini.removeClass(this._td1El,"mini-tabs-header");mini.removeClass(this._td3El,"mini-tabs-header");mini.append(this._td3El,this._td1El.firstChild);this._headerEl=this._td3El},_OnCloseButtonClick:function(k,i){var j={tab:k,index:this.tabs.indexOf(k),name:k.name.toLowerCase(),htmlEvent:i,cancel:false};this.fire("beforecloseclick",j);if(j.cancel==true){return}try{if(k._iframeEl&&k._iframeEl.contentWindow){var g=true;if(k._iframeEl.contentWindow.CloseWindow){g=k._iframeEl.contentWindow.CloseWindow("close")}else{if(k._iframeEl.contentWindow.CloseOwnerWindow){g=k._iframeEl.contentWindow.CloseOwnerWindow("close")}}if(g===false){j.cancel=true}}}catch(l){}if(j.cancel==true){return}k.removeAction="close";this.removeTab(k);this.fire("closeclick",j)},onBeforeCloseClick:function(c,d){this.on("beforecloseclick",c,d)},onCloseClick:function(c,d){this.on("closeclick",c,d)},onActiveChanged:function(c,d){this.on("activechanged",c,d)},getAttrs:function(el){var attrs=mini.Tabs.superclass.getAttrs.call(this,el);mini._ParseString(el,attrs,["tabAlign","tabPosition","bodyStyle","onactivechanged","onbeforeactivechanged","url","ontabload","ontabdestroy","onbeforecloseclick","oncloseclick","titleField","urlField","nameField","loadingMsg","buttons"]);mini._ParseBool(el,attrs,["allowAnim","showBody","showHeader","maskOnLoad","plain"]);mini._ParseInt(el,attrs,["activeIndex"]);var tabs=[];var nodes=mini.getChildNodes(el);for(var i=0,l=nodes.length;i<l;i++){var node=nodes[i];var o={};tabs.push(o);o.style=node.style.cssText;mini._ParseString(node,o,["name","title","url","cls","iconCls","iconStyle","headerCls","headerStyle","bodyCls","bodyStyle","onload","ondestroy","data-options"]);mini._ParseBool(node,o,["newLine","visible","enabled","showCloseButton","refreshOnClick"]);o.bodyParent=node;var options=o["data-options"];if(options){options=eval("("+options+")");if(options){mini.copyTo(o,options)}}}attrs.tabs=tabs;return attrs}});mini.regClass(mini.Tabs,"tabs");mini.Menu=function(){this.items=[];mini.Menu.superclass.constructor.call(this)};mini.extend(mini.Menu,mini.Control);mini.copyTo(mini.Menu.prototype,mini.Popup_prototype);var mini_Popup_prototype_hide=mini.Popup_prototype.hide;mini.copyTo(mini.Menu.prototype,{height:"auto",width:"auto",minWidth:140,vertical:true,allowSelectItem:false,_selectedItem:null,_itemSelectedCls:"mini-menuitem-selected",textField:"text",resultAsTree:false,idField:"id",parentField:"pid",itemsField:"children",showNavArrow:true,imgPath:"",_clearBorder:false,showAction:"none",hideAction:"outerclick",getbyName:function(f){for(var k=0,g=this.items.length;k<g;k++){var j=this.items[k];if(j.name==f){return j}if(j.menu){var i=j.menu.getbyName(f);if(i){return i}}}return null},set:function(c){if(typeof c=="string"){return this}var d=c.url;delete c.url;if(c.imgPath){this.setImgPath(c.imgPath)}delete c.imgPath;this.ownerItem=c.ownerItem;delete c.ownerItem;mini.Menu.superclass.set.call(this,c);if(d){this.setUrl(d)}return this},uiCls:"mini-menu",_create:function(){this.el=document.createElement("div");this.el.className="mini-menu";this.el.innerHTML='<div class="mini-menu-border"><a class="mini-menu-topArrow" href="#" onclick="return false"></a><div class="mini-menu-inner"></div><a class="mini-menu-bottomArrow" href="#" onclick="return false"></a></div>';this._borderEl=this.el.firstChild;this._topArrowEl=this._borderEl.childNodes[0];this._bottomArrowEl=this._borderEl.childNodes[2];this._innerEl=this._borderEl.childNodes[1];this._innerEl.innerHTML='<div class="mini-menu-float"></div><div class="mini-menu-toolbar"></div><div style="clear:both;"></div>';this._contentEl=this._innerEl.firstChild;this._toolbarEl=this._innerEl.childNodes[1];if(this.isVertical()==false){mini.addClass(this.el,"mini-menu-horizontal")}},destroy:function(b){if(this._topArrowEl){this._topArrowEl.onmousedown=this._bottomArrowEl.onmousedown=null}this._popupEl=this.popupEl=this._borderEl=this._innerEl=this._contentEl=null;this._topArrowEl=this._bottomArrowEl=null;this.owner=null;this.window=null;mini.un(document,"mousedown",this.__OnBodyMouseDown,this);mini.un(window,"resize",this.__OnWindowResize,this);mini.Menu.superclass.destroy.call(this,b)},_disableContextMenu:false,_initEvents:function(){mini._BindEvents(function(){mini.on(document,"mousedown",this.__OnBodyMouseDown,this);mini_onOne(this.el,"mouseover",this.__OnMouseOver,this);mini.on(window,"resize",this.__OnWindowResize,this);if(this._disableContextMenu){mini_onOne(this.el,"contextmenu",function(b){b.preventDefault()},this)}mini_onOne(this._topArrowEl,"mousedown",this.__OnTopMouseDown,this);mini_onOne(this._bottomArrowEl,"mousedown",this.__OnBottomMouseDown,this)},this)},within:function(i){if(mini.isAncestor(this.el,i.target)){return true}for(var f=0,g=this.items.length;f<g;f++){var j=this.items[f];if(j.within(i)){return true}}return false},setVertical:function(b){this.vertical=b;if(!b){mini.addClass(this.el,"mini-menu-horizontal")}else{mini.removeClass(this.el,"mini-menu-horizontal")}},getVertical:function(){return this.vertical},isVertical:function(){return this.vertical},show:function(){this.setVisible(true)},hide:function(){this.hideItems();mini_Popup_prototype_hide.call(this)},hideItems:function(){for(var d=0,f=this.items.length;d<f;d++){var g=this.items[d];g.hideMenu()}},showItemMenu:function(j){for(var f=0,g=this.items.length;f<g;f++){var i=this.items[f];if(i==j){i.showMenu()}else{i.hideMenu()}}},hasShowItemMenu:function(){for(var d=0,f=this.items.length;d<f;d++){var g=this.items[d];if(g&&g.menu&&g.menu.isPopup){return true}}return false},setData:function(b){if(!mini.isArray(b)){b=[]}this.setItems(b)},getData:function(){return this.getItems()},setItems:function(f){if(!mini.isArray(f)){f=[]}this.removeAll();var i=new Date();for(var j=0,g=f.length;j<g;j++){this.addItem(f[j])}},getItems:function(){return this.items},_itemType:"menuitem",addItem:function(b){if(b=="-"||b=="|"||b.type=="separator"){mini.append(this._contentEl,'<span id="'+b.id+'" class="mini-separator"></span>');return}if(!mini.isControl(b)&&!mini.getClass(b.type)){b.type=this._itemType}b.ownerMenu=this;b=mini.getAndCreate(b);this.items.push(b);this._contentEl.appendChild(b.el);b.ownerMenu=this;this.fire("itemschanged")},removeItem:function(b){b=mini.get(b);if(!b){return}this.items.remove(b);this._contentEl.removeChild(b.el);this.fire("itemschanged")},removeItemAt:function(d){var c=this.items[d];this.removeItem(c)},removeAll:function(){var d=this.items.clone();for(var c=d.length-1;c>=0;c--){this.removeItem(d[c])}this._contentEl.innerHTML=""},getGroupItems:function(k){if(!k){return[]}var f=[];for(var j=0,g=this.items.length;j<g;j++){var i=this.items[j];if(i.groupName==k){f.push(i)}}return f},getItem:function(i){if(typeof i=="number"){return this.items[i]}if(typeof i=="string"){for(var f=0,g=this.items.length;f<g;f++){var j=this.items[f];if(j.id==i){return j}}return null}if(i&&this.items.indexOf(i)!=-1){return i}return null},setAllowSelectItem:function(b){this.allowSelectItem=b},getAllowSelectItem:function(){return this.allowSelectItem},setSelectedItem:function(b){b=this.getItem(b);this._OnItemSelect(b)},getSelectedItem:function(b){return this._selectedItem},setShowNavArrow:function(b){this.showNavArrow=b},getShowNavArrow:function(){return this.showNavArrow},setTextField:function(b){this.textField=b},getTextField:function(){return this.textField},setResultAsTree:function(b){this.resultAsTree=b},getResultAsTree:function(){return this.resultAsTree},setIdField:function(b){this.idField=b},getIdField:function(){return this.idField},setParentField:function(b){this.parentField=b},getParentField:function(){return this.parentField},doLayout:function(){if(!this.canLayout()){return}if(!this.isAutoHeight()){var g=mini.getHeight(this.el,true);mini.setHeight(this._borderEl,g);this._topArrowEl.style.display=this._bottomArrowEl.style.display="none";this._contentEl.style.height="auto";if(this.showNavArrow&&this._borderEl.scrollHeight>this._borderEl.clientHeight){this._topArrowEl.style.display=this._bottomArrowEl.style.display="block";g=mini.getHeight(this._borderEl,true);var i=mini.getHeight(this._topArrowEl);var f=mini.getHeight(this._bottomArrowEl);var j=g-i-f;if(j<0){j=0}mini.setHeight(this._contentEl,j);var k=mini.getWidth(this._borderEl,true);mini.setWidth(this._topArrowEl,k);mini.setWidth(this._bottomArrowEl,k)}else{this._contentEl.style.height="auto"}}else{this._borderEl.style.height="auto";this._contentEl.style.height="auto"}},_measureSize:function(){if(this.height=="auto"){this.el.style.height="auto";this._borderEl.style.height="auto";this._contentEl.style.height="auto";this._topArrowEl.style.display=this._bottomArrowEl.style.display="none";var g=mini.getViewportBox();var k=mini.getBox(this.el);this.maxHeight=g.height-25;if(this.ownerItem){var k=mini.getBox(this.ownerItem.el);var j=k.top;var i=g.height-k.bottom;var f=j>i?j:i;f-=10;this.maxHeight=f}}this.el.style.display="";var k=mini.getBox(this.el);if(k.width>this.maxWidth){mini.setWidth(this.el,this.maxWidth);k=mini.getBox(this.el)}if(k.height>this.maxHeight){mini.setHeight(this.el,this.maxHeight);k=mini.getBox(this.el)}if(k.width<this.minWidth){mini.setWidth(this.el,this.minWidth);k=mini.getBox(this.el)}if(k.height<this.minHeight){mini.setHeight(this.el,this.minHeight);k=mini.getBox(this.el)}},url:"",_doLoad:function(){var g=mini._getResult(this.url,null,null,null,null,this.dataField);if(this.dataField&&!mini.isArray(g)){g=mini._getMap(this.dataField,g)}if(!g){g=[]}if(this.resultAsTree==false){g=mini.arrayToTree(g,this.itemsField,this.idField,this.parentField)}var k=mini.treeToArray(g,this.itemsField,this.idField,this.parentField);for(var n=0,i=k.length;n<i;n++){var j=k[n];j.text=mini._getMap(this.textField,j);if(mini.isNull(j.text)){j.text=""}}var l=new Date();this.setItems(g);this.fire("load")},loadList:function(n,p,l){if(!n){return}p=p||this.idField;l=l||this.parentField;for(var o=0,i=n.length;o<i;o++){var k=n[o];k.text=mini._getMap(this.textField,k);if(mini.isNull(k.text)){k.text=""}}var j=mini.arrayToTree(n,this.itemsField,p,l);this.load(j)},load:function(b){if(typeof b=="string"){this.setUrl(b)}else{this.setItems(b)}},setUrl:function(b){this.url=b;this._doLoad()},getUrl:function(){return this.url},hideOnClick:true,setHideOnClick:function(b){this.hideOnClick=b},getHideOnClick:function(){return this.hideOnClick},hideOnClick:true,setImgPath:function(b){this.imgPath=b},getImgPath:function(){return this.imgPath},_OnItemClick:function(d,f){var g={item:d,isLeaf:!d.menu,htmlEvent:f};if(this.hideOnClick){if(this.isPopup){this.hide()}else{this.hideItems()}}if(this.allowSelectItem&&this._selectedItem!=d){this.setSelectedItem(d)}this.fire("itemclick",g);if(this.ownerItem){}},_OnItemSelect:function(d){if(this._selectedItem){this._selectedItem.removeCls(this._itemSelectedCls)}this._selectedItem=d;if(this._selectedItem){this._selectedItem.addCls(this._itemSelectedCls)}var c={item:this._selectedItem,isLeaf:this._selectedItem?!this._selectedItem.menu:false};this.fire("itemselect",c)},onItemClick:function(c,d){this.on("itemclick",c,d)},onItemSelect:function(c,d){this.on("itemselect",c,d)},__OnTopMouseDown:function(b){this._startScrollMove(-20)},__OnBottomMouseDown:function(b){this._startScrollMove(20)},_startScrollMove:function(g){clearInterval(this._scrollTimer);var f=function(){clearInterval(d._scrollTimer);mini.un(document,"mouseup",f)};mini.on(document,"mouseup",f);var d=this;this._scrollTimer=setInterval(function(){d._contentEl.scrollTop+=g},50)},setToolbar:function(b){__mini_setControls(b,this._toolbarEl,this)},parseItems:function(u){var p=[];for(var o=0,q=u.length;o<q;o++){var r=u[o];if(r.className=="separator"){var s={type:"separator",id:r.id,name:r.name};p.add(s);continue}var n=mini.getChildNodes(r);var l=n[0];var i=n[1];var s=new mini.MenuItem();if(!i){mini.applyTo.call(s,r);p.add(s);continue}mini.applyTo.call(s,l);s.render(document.body);var t=new mini.Menu();mini.applyTo.call(t,i);s.setMenu(t);t.render(document.body);p.add(s)}return p.clone()},getAttrs:function(t){var i=mini.Menu.superclass.getAttrs.call(this,t);var s=jQuery(t);mini._ParseString(t,i,["popupEl","popupCls","showAction","hideAction","xAlign","yAlign","modalStyle","onbeforeopen","open","onbeforeclose","onclose","url","onitemclick","onitemselect","textField","idField","parentField","toolbar","imgPath"]);mini._ParseBool(t,i,["resultAsTree","hideOnClick","showNavArrow","showShadow"]);var u=mini.getChildNodes(t);for(var o=u.length-1;o>=0;o--){var r=u[o];var l=jQuery(r).attr("property");if(!l){continue}l=l.toLowerCase();if(l=="toolbar"){i.toolbar=r;r.parentNode.removeChild(r)}}var u=mini.getChildNodes(t);var n=this.parseItems(u);if(n.length>0){i.items=n}var p=s.attr("vertical");if(p){i.vertical=p=="true"?true:false}var q=s.attr("allowSelectItem");if(q){i.allowSelectItem=q=="true"?true:false}return i}});mini.regClass(mini.Menu,"menu");mini.MenuBar=function(){mini.MenuBar.superclass.constructor.call(this)};mini.extend(mini.MenuBar,mini.Menu,{uiCls:"mini-menubar",vertical:false,setVertical:function(b){this.vertical=false}});mini.regClass(mini.MenuBar,"menubar");mini.ContextMenu=function(){mini.ContextMenu.superclass.constructor.call(this)};mini.extend(mini.ContextMenu,mini.Menu,{uiCls:"mini-contextmenu",vertical:true,visible:false,_disableContextMenu:true,setVertical:function(b){this.vertical=true}});mini.regClass(mini.ContextMenu,"contextmenu");mini.MenuItem=function(){mini.MenuItem.superclass.constructor.call(this)};mini.extend(mini.MenuItem,mini.Control,{text:"",iconCls:"",iconStyle:"",iconPosition:"left",img:"",showIcon:true,showAllow:true,checked:false,checkOnClick:false,groupName:"",_hoverCls:"mini-menuitem-hover",_pressedCls:"mini-menuitem-pressed",_checkedCls:"mini-menuitem-checked",_clearBorder:false,menu:null,set:function(b){if(typeof b=="string"){return this}this.ownerMenu=b.ownerMenu;delete b.ownerMenu;mini.MenuItem.superclass.set.call(this,b);return this},uiCls:"mini-menuitem",_create:function(){var b=this.el=document.createElement("div");this.el.className="mini-menuitem";this.el.innerHTML='<div class="mini-menuitem-inner"><div class="mini-menuitem-icon"></div><div class="mini-menuitem-text"></div><div class="mini-menuitem-allow"></div></div>';this._innerEl=this.el.firstChild;this._iconEl=this._innerEl.firstChild;this._textEl=this._innerEl.childNodes[1];this.allowEl=this._innerEl.lastChild},_initEvents:function(){mini._BindEvents(function(){mini_onOne(this.el,"mouseover",this.__OnMouseOver,this)},this)},_inputEventsInited:false,_initInputEvents:function(){if(this._inputEventsInited){return}this._inputEventsInited=true;mini_onOne(this.el,"click",this.__OnClick,this);mini_onOne(this.el,"mouseup",this.__OnMouseUp,this);mini_onOne(this.el,"mouseout",this.__OnMouseOut,this)},destroy:function(b){if(this.el){this.el.onmouseover=null}this.menu=this._innerEl=this._iconEl=this._textEl=this.allowEl=null;mini.MenuItem.superclass.destroy.call(this,b)},within:function(b){if(mini.isAncestor(this.el,b.target)){return true}if(this.menu&&this.menu.within(b)){return true}return false},_getIconImg:function(){return this.img&&this.getTopMenu()?this.getTopMenu().imgPath+this.img:this.img},_doUpdateIcon:function(){var d=this._getIconImg();var f=!!(this.iconStyle||this.iconCls||this.checkOnClick||d);if(this._iconEl){mini.setStyle(this._iconEl,this.iconStyle);mini.addClass(this._iconEl,this.iconCls);if(d&&!this.checked){var g="background-image:url("+d+")";mini.setStyle(this._iconEl,g)}if(this.checked){jQuery(this._iconEl).css({"background-image":""})}this._iconEl.style.display=f?"block":"none"}if(this.iconPosition=="top"){mini.addClass(this.el,"mini-menuitem-icontop")}else{mini.removeClass(this.el,"mini-menuitem-icontop")}},_hasChildMenu:function(){return this.menu&&this.menu.items.length>0},doUpdate:function(){if(this._textEl){this._textEl.innerHTML=this.text}this._doUpdateIcon();if(this.checked){mini.addClass(this.el,this._checkedCls);jQuery(this._iconEl).css({"background-image":""})}else{mini.removeClass(this.el,this._checkedCls)}if(this.allowEl){if(this._hasChildMenu()){this.allowEl.style.display="block"}else{this.allowEl.style.display="none"}}},setText:function(b){this.text=b;if(this._textEl){this._textEl.innerHTML=this.text}},getText:function(){return this.text},setIconCls:function(b){mini.removeClass(this._iconEl,this.iconCls);this.iconCls=b;this._doUpdateIcon()},getIconCls:function(){return this.iconCls},setImg:function(b){this.img=b;this._doUpdateIcon()},getImg:function(){return this.img},setIconStyle:function(b){this.iconStyle=b;this._doUpdateIcon()},getIconStyle:function(){return this.iconStyle},setIconPosition:function(b){this.iconPosition=b;this._doUpdateIcon()},getIconPosition:function(){return this.iconPosition},setCheckOnClick:function(b){this.checkOnClick=b;if(b){mini.addClass(this.el,"mini-menuitem-showcheck")}else{mini.removeClass(this.el,"mini-menuitem-showcheck")}this.doUpdate()},getCheckOnClick:function(){return this.checkOnClick},setChecked:function(b){if(this.checked!=b){this.checked=b;this.doUpdate();this.fire("checkedchanged")}},getChecked:function(){return this.checked},setGroupName:function(b){if(this.groupName!=b){this.groupName=b}},getGroupName:function(){return this.groupName},setChildren:function(b){this.setMenu(b)},setMenu:function(b){if(mini.isArray(b)){b={type:"menu",items:b}}if(this.menu!==b){b.ownerItem=this;this.menu=mini.getAndCreate(b);this.menu.hide();this.menu.ownerItem=this;this.doUpdate();this.menu.on("itemschanged",this.__OnItemsChanged,this)}},getMenu:function(){return this.menu},showMenu:function(){if(this.menu&&this.menu.isDisplay()==false){this.menu.setHideAction("outerclick");var b={xAlign:"outright",yAlign:"top",outXAlign:"outleft",outYAlign:"below",popupCls:"mini-menu-popup"};if(this.ownerMenu&&this.ownerMenu.vertical==false){b.xAlign="left";b.yAlign="below";b.outXAlign=null}this.menu.showAtEl(this.el,b)}},hideMenu:function(){if(this.menu){this.menu.hide()}},hide:function(){this.hideMenu();this.setVisible(false)},__OnItemsChanged:function(b){this.doUpdate()},getTopMenu:function(){if(this.ownerMenu){if(this.ownerMenu.ownerItem){return this.ownerMenu.ownerItem.getTopMenu()}else{return this.ownerMenu}}return null},__OnClick:function(k){if(this.isReadOnly()){return}if(this.checkOnClick){if(this.ownerMenu&&this.groupName){var j=this.ownerMenu.getGroupItems(this.groupName);if(j.length>0){if(this.checked==false){for(var o=0,i=j.length;o<i;o++){var l=j[o];if(l!=this){l.setChecked(false)}}this.setChecked(true)}}else{this.setChecked(!this.checked)}}else{this.setChecked(!this.checked)}}this.fire("click");var n=this.getTopMenu();if(n){n._OnItemClick(this,k)}},__OnMouseUp:function(c){if(this.isReadOnly()){return}if(this.ownerMenu){var d=this;setTimeout(function(){if(d.isDisplay()){d.ownerMenu.showItemMenu(d)}},1)}},__OnMouseOver:function(b){if(this.isReadOnly()){return}this._initInputEvents();mini.addClass(this.el,this._hoverCls);this.el.title=this.text;if(this._textEl.scrollWidth>this._textEl.clientWidth){this.el.title=this.text}else{this.el.title=""}if(this.ownerMenu){if(this.ownerMenu.isVertical()==true){this.ownerMenu.showItemMenu(this)}else{if(this.ownerMenu.hasShowItemMenu()){this.ownerMenu.showItemMenu(this)}}}},__OnMouseOut:function(b){mini.removeClass(this.el,this._hoverCls)},onClick:function(c,d){this.on("click",c,d)},onCheckedChanged:function(c,d){this.on("checkedchanged",c,d)},getAttrs:function(d){var f=mini.MenuItem.superclass.getAttrs.call(this,d);var g=jQuery(d);f.text=d.innerHTML;mini._ParseString(d,f,["text","iconCls","iconStyle","iconPosition","groupName","onclick","oncheckedchanged"]);mini._ParseBool(d,f,["checkOnClick","checked"]);return f}});mini.regClass(mini.MenuItem,"menuitem");mini.Separator=function(){mini.Separator.superclass.constructor.call(this)};mini.extend(mini.Separator,mini.Control,{_clearBorder:false,uiCls:"mini-separator",_create:function(){this.el=document.createElement("span");this.el.className="mini-separator"}});mini.regClass(mini.Separator,"separator");mini.OutlookBar=function(){this._initGroups();mini.OutlookBar.superclass.constructor.call(this)};mini.extend(mini.OutlookBar,mini.Control,{width:180,expandOnLoad:true,activeIndex:-1,autoCollapse:false,groupCls:"",groupStyle:"",groupHeaderCls:"",groupHeaderStyle:"",groupBodyCls:"",groupBodyStyle:"",groupHoverCls:"",groupActiveCls:"",allowAnim:true,set:function(g){if(typeof g=="string"){return this}var d=this._allowLayout;this._allowLayout=false;var f=g.activeIndex;delete g.activeIndex;mini.OutlookBar.superclass.set.call(this,g);if(mini.isNumber(f)){this.setActiveIndex(f)}this._allowLayout=d;this.doLayout();return this},uiCls:"mini-outlookbar",_create:function(){this.el=document.createElement("div");this.el.className="mini-outlookbar";this.el.innerHTML='<div class="mini-outlookbar-border"></div>';this._borderEl=this.el.firstChild},_initEvents:function(){mini._BindEvents(function(){mini.on(this.el,"click",this.__OnClick,this)},this)},_createGroupId:function(b){return this.uid+"$"+b._id},_GroupId:1,_initGroups:function(){this.groups=[]},_createGroupEl:function(n){var t=this._createGroupId(n);var i='<div id="'+t+'" class="mini-outlookbar-group '+n.cls+'" style="'+n.style+'"><div class="mini-outlookbar-groupHeader '+n.headerCls+'" style="'+n.headerStyle+';"></div><div class="mini-outlookbar-groupBody '+n.bodyCls+'" style="'+n.bodyStyle+';"></div></div>';var s=mini.append(this._borderEl,i);var l=s.lastChild;var o=n.body;delete n.body;if(o){if(!mini.isArray(o)){o=[o]}for(var p=0,q=o.length;p<q;p++){var r=o[p];mini.append(l,r)}o.length=0}if(n.bodyParent){var u=n.bodyParent;while(u.firstChild){l.appendChild(u.firstChild)}}delete n.bodyParent;return s},createGroup:function(d){var c=mini.copyTo({_id:this._GroupId++,name:"",title:"",cls:"",style:"",iconCls:"",iconStyle:"",headerCls:"",headerStyle:"",bodyCls:"",bodyStyle:"",visible:true,enabled:true,showCollapseButton:true,expanded:this.expandOnLoad},d);return c},setGroups:function(f){if(!mini.isArray(f)){return}this.removeAll();for(var g=0,d=f.length;g<d;g++){this.addGroup(f[g])}},getGroups:function(){return this.groups},addGroup:function(i,g){if(typeof i=="string"){i={title:i}}i=this.createGroup(i);if(typeof g!="number"){g=this.groups.length}this.groups.insert(g,i);var k=this._createGroupEl(i);i._el=k;var g=this.groups.indexOf(i);var j=this.groups[g+1];if(j){var f=this.getGroupEl(j);jQuery(f).before(k)}this.doUpdate();return i},updateGroup:function(c,d){var c=this.getGroup(c);if(!c){return}mini.copyTo(c,d);this.doUpdate()},removeGroup:function(d){d=this.getGroup(d);if(!d){return}var c=this.getGroupEl(d);if(c){c.parentNode.removeChild(c)}this.groups.remove(d);this.doUpdate()},removeAll:function(){for(var b=this.groups.length-1;b>=0;b--){this.removeGroup(b)}},moveGroup:function(j,g){j=this.getGroup(j);if(!j){return}target=this.getGroup(g);var i=this.getGroupEl(j);this.groups.remove(j);if(target){g=this.groups.indexOf(target);this.groups.insert(g,j);var f=this.getGroupEl(target);jQuery(f).before(i)}else{this.groups.add(j);this._borderEl.appendChild(i)}this.doUpdate()},doUpdate:function(){for(var q=0,j=this.groups.length;q<j;q++){var n=this.groups[q];var k=n._el;var l=k.firstChild;var o=k.lastChild;var i='<div class="mini-outlookbar-icon '+n.iconCls+'" style="'+n.iconStyle+';"></div>';var p='<div class="mini-tools"><span class="mini-tools-collapse" style="'+(n.showCollapseButton?"":"display:none;")+'"></span></div>'+((n.iconStyle||n.iconCls)?i:"")+'<div class="mini-outlookbar-groupTitle">'+n.title+'</div><div style="clear:both;"></div>';l.innerHTML=p;if(n.enabled){mini.removeClass(k,"mini-disabled")}else{mini.addClass(k,"mini-disabled")}mini.addClass(k,n.cls);mini.setStyle(k,n.style);mini.addClass(o,n.bodyCls);mini.setStyle(o,n.bodyStyle);mini.addClass(l,n.headerCls);mini.setStyle(l,n.headerStyle);mini.removeClass(k,"mini-outlookbar-firstGroup");mini.removeClass(k,"mini-outlookbar-lastGroup");if(q==0){mini.addClass(k,"mini-outlookbar-firstGroup")}if(q==j-1){mini.addClass(k,"mini-outlookbar-lastGroup")}}this.doLayout()},doLayout:function(){if(!this.canLayout()){return}if(this._inAniming){return}this._doLayoutInner();for(var r=0,u=this.groups.length;r<u;r++){var i=this.groups[r];var s=i._el;var o=s.lastChild;if(i.expanded){mini.addClass(s,"mini-outlookbar-expand");mini.removeClass(s,"mini-outlookbar-collapse")}else{mini.removeClass(s,"mini-outlookbar-expand");mini.addClass(s,"mini-outlookbar-collapse")}o.style.height="auto";o.style.display=i.expanded?"block":"none";s.style.display=i.visible?"":"none";var n=mini.getWidth(s,true);var p=mini.getPaddings(o);var t=mini.getBorders(o);if(jQuery.boxModel){n=n-p.left-p.right-t.left-t.right}o.style.width=n+"px"}var l=this.isAutoHeight();var q=this.getActiveGroup();if(!l&&this.autoCollapse&&q){var s=this.getGroupEl(this.activeIndex);s.lastChild.style.height=this._getFillGroupBodyHeight()+"px"}else{}mini.layout(this._borderEl)},_doLayoutInner:function(){if(this.isAutoHeight()){this._borderEl.style.height="auto"}else{var c=this.getHeight(true);if(!jQuery.boxModel){var d=mini.getBorders(this._borderEl);c=c+d.top+d.bottom}if(c<0){c=0}this._borderEl.style.height=c+"px"}},_getFillGroupBodyHeight:function(){var w=jQuery(this.el).height();var r=mini.getBorders(this._borderEl);w=w-r.top-r.bottom;var u=this.getActiveGroup();var t=0;for(var x=0,B=this.groups.length;x<B;x++){var i=this.groups[x];var C=this.getGroupEl(i);if(i.visible==false||i==u){continue}var v=C.lastChild.style.display;C.lastChild.style.display="none";var s=jQuery(C).outerHeight();C.lastChild.style.display=v;var z=mini.getMargins(C);s=s+z.top+z.bottom;t+=s}w=w-t;var y=this.getGroupEl(this.activeIndex);if(!y){return 0}w=w-jQuery(y.firstChild).outerHeight();if(jQuery.boxModel){var l=mini.getPaddings(y.lastChild);var A=mini.getBorders(y.lastChild);w=w-l.top-l.bottom-A.top-A.bottom}var l=mini.getPaddings(y);var A=mini.getBorders(y);var z=mini.getMargins(y);w=w-z.top-z.bottom;w=w-l.top-l.bottom-A.top-A.bottom;if(w<0){w=0}return w},getGroup:function(f){if(typeof f=="object"){return f}if(typeof f=="number"){return this.groups[f]}else{for(var j=0,g=this.groups.length;j<g;j++){var i=this.groups[j];if(i.name==f){return i}}}},_getGroupById:function(i){for(var f=0,g=this.groups.length;f<g;f++){var j=this.groups[f];if(j._id==i){return j}}},getGroupEl:function(d){var c=this.getGroup(d);if(!c){return null}return c._el},getGroupBodyEl:function(d){var c=this.getGroupEl(d);if(c){return c.lastChild}return null},setAutoCollapse:function(b){this.autoCollapse=b},getAutoCollapse:function(){return this.autoCollapse},setExpandOnLoad:function(b){this.expandOnLoad=b},getExpandOnLoad:function(){return this.expandOnLoad},setActiveIndex:function(k){var n=this.activeIndex;var j=this.getGroup(k);var i=this.getGroup(this.activeIndex);var g=j!=i;if(j){this.activeIndex=this.groups.indexOf(j)}else{this.activeIndex=-1}var j=this.getGroup(this.activeIndex);if(j){var l=this.allowAnim;this.allowAnim=false;this.expandGroup(j);this.allowAnim=l}if(this.activeIndex==-1&&n!=-1){this.collapseGroup(n)}},getActiveIndex:function(){return this.activeIndex},getActiveGroup:function(){return this.getGroup(this.activeIndex)},showGroup:function(b){b=this.getGroup(b);if(!b||b.visible==true){return}b.visible=true;this.doUpdate()},hideGroup:function(b){b=this.getGroup(b);if(!b||b.visible==false){return}b.visible=false;this.doUpdate()},toggleGroup:function(b){b=this.getGroup(b);if(!b){return}if(b.expanded){this.collapseGroup(b)}else{this.expandGroup(b)}},collapseGroup:function(l){l=this.getGroup(l);if(!l){return}var o=l.expanded;var r=0;if(this.autoCollapse&&!this.isAutoHeight()){r=this._getFillGroupBodyHeight()}var v=false;l.expanded=false;var p=this.groups.indexOf(l);if(p==this.activeIndex){this.activeIndex=-1;v=true}var u=this.getGroupBodyEl(l);if(this.allowAnim&&o){this._inAniming=true;u.style.display="block";u.style.height="auto";if(this.autoCollapse&&!this.isAutoHeight()){u.style.height=r+"px"}var s={height:"1px"};mini.addClass(u,"mini-outlookbar-overflow");var q=this;var t=jQuery(u);t.animate(s,180,function(){q._inAniming=false;mini.removeClass(u,"mini-outlookbar-overflow");q.doLayout()})}else{this.doLayout()}var n={group:l,index:this.groups.indexOf(l),name:l.name};this.fire("Collapse",n);if(v){this.fire("activechanged")}},expandGroup:function(g){g=this.getGroup(g);if(!g){return}var l=g.expanded;g.expanded=true;this.activeIndex=this.groups.indexOf(g);fire=true;if(this.autoCollapse){for(var w=0,x=this.groups.length;w<x;w++){var u=this.groups[w];if(u.expanded&&u!=g){this.collapseGroup(u)}}}var B=this.getGroupBodyEl(g);if(this.allowAnim&&l==false){this._inAniming=true;B.style.display="block";if(this.autoCollapse&&!this.isAutoHeight()){var s=this._getFillGroupBodyHeight();B.style.height=(s)+"px"}else{B.style.height="auto"}var v=mini.getHeight(B);B.style.height="1px";var z={height:v+"px"};var y=B.style.overflow;B.style.overflow="hidden";mini.addClass(B,"mini-outlookbar-overflow");var t=this;var A=jQuery(B);A.animate(z,180,function(){B.style.overflow=y;mini.removeClass(B,"mini-outlookbar-overflow");t._inAniming=false;t.doLayout()})}else{this.doLayout()}var i={group:g,index:this.groups.indexOf(g),name:g.name};this.fire("Expand",i);if(fire){this.fire("activechanged")}},_tryToggleGroup:function(c){c=this.getGroup(c);if(c.enabled==false){return}var d={group:c,groupIndex:this.groups.indexOf(c),groupName:c.name,cancel:false};if(c.expanded){this.fire("BeforeCollapse",d);if(d.cancel==false){this.collapseGroup(c)}}else{this.fire("BeforeExpand",d);if(d.cancel==false){this.expandGroup(c)}}},_getGroupByEvent:function(j){var f=mini.findParent(j.target,"mini-outlookbar-group");if(!f){return null}var g=f.id.split("$");var i=g[g.length-1];return this._getGroupById(i)},__OnClick:function(g){if(this._inAniming){return}var d=mini.findParent(g.target,"mini-outlookbar-groupHeader");if(!d){return}var f=this._getGroupByEvent(g);if(!f){return}this._tryToggleGroup(f)},parseGroups:function(n){var i=[];for(var l=0,g=n.length;l<g;l++){var k=n[l];var j={};i.push(j);j.style=k.style.cssText;mini._ParseString(k,j,["name","title","cls","iconCls","iconStyle","headerCls","headerStyle","bodyCls","bodyStyle"]);mini._ParseBool(k,j,["visible","enabled","showCollapseButton","expanded"]);j.bodyParent=k}return i},getAttrs:function(g){var d=mini.OutlookBar.superclass.getAttrs.call(this,g);mini._ParseString(g,d,["onactivechanged","oncollapse","onexpand"]);mini._ParseBool(g,d,["autoCollapse","allowAnim","expandOnLoad"]);mini._ParseInt(g,d,["activeIndex"]);var f=mini.getChildNodes(g);d.groups=this.parseGroups(f);return d}});mini.regClass(mini.OutlookBar,"outlookbar");mini.OutlookMenu=function(){mini.OutlookMenu.superclass.constructor.call(this);this.data=[]};mini.extend(mini.OutlookMenu,mini.OutlookBar,{url:"",textField:"text",iconField:"iconCls",urlField:"url",resultAsTree:false,itemsField:"children",idField:"id",parentField:"pid",style:"width:100%;height:100%;",set:function(g){if(typeof g=="string"){return this}var d=g.url;delete g.url;var f=g.activeIndex;delete g.activeIndex;if(mini.isNumber(f)){this.activeIndex=f}mini.OutlookMenu.superclass.set.call(this,g);if(d){this.setUrl(d)}if(mini.isNumber(f)){this.setActiveIndex(f)}return this},uiCls:"mini-outlookmenu",destroy:function(b){this._destroyTrees();mini.OutlookMenu.superclass.destroy.call(this,b)},_destroyTrees:function(){if(this._menus){var j=this._menus.clone();for(var f=0,g=j.length;f<g;f++){var i=j[f];i.destroy()}this._menus.length=0}},_doParseFields:function(j){for(var f=0,g=j.length;f<g;f++){var i=j[f];i.text=i[this.textField];i.url=i[this.urlField];i.iconCls=i[this.iconField]}},_doLoad:function(){var f=[];try{f=mini._getResult(this.url,null,null,null,null,this.dataField)}catch(d){if(mini_debugger==true){alert("outlooktree json is error.")}}if(this.dataField&&!mini.isArray(f)){f=mini._getMap(this.dataField,f)}if(!f){f=[]}if(this.resultAsTree==false){f=mini.arrayToTree(f,this.itemsField,this.idField,this.parentField)}var g=mini.treeToArray(f,this.itemsField,this.idField,this.parentField);this._doParseFields(g);this.createNavBarMenu(f);this.fire("load")},loadList:function(j,f,i){f=f||this.idField;i=i||this.parentField;this._doParseFields(j);var g=mini.arrayToTree(j,this.nodesField,f,i);this.load(g)},load:function(c){if(typeof c=="string"){this.setUrl(c)}else{var d=mini.treeToArray(c,this.itemsField,this.idField,this.parentField);this._doParseFields(d);this.createNavBarMenu(c)}},setData:function(b){this.load(b)},setUrl:function(b){this.url=b;this._doLoad()},getUrl:function(){return this.url},setTextField:function(b){this.textField=b},getTextField:function(){return this.textField},setIconField:function(b){this.iconField=b},getIconField:function(){return this.iconField},setUrlField:function(b){this.urlField=b},getUrlField:function(){return this.urlField},setResultAsTree:function(b){this.resultAsTree=b},getResultAsTree:function(){return this.resultAsTree},setNodesField:function(b){this.nodesField=b},getNodesField:function(){return this.nodesField},setIdField:function(b){this.idField=b},getIdField:function(){return this.idField},setParentField:function(b){this.parentField=b},getParentField:function(){return this.parentField},_selected:null,getSelected:function(){return this._selected},selectNode:function(d){d=this.getNode(d);if(!d){if(this._selected){var c=this._getOwnerMenu(this._selected);if(c){c.setSelectedItem(null)}}return}var c=this._getOwnerMenu(d);if(!c){return}this.expandGroup(c._ownerGroup);setTimeout(function(){try{c.setSelectedItem(d)}catch(a){}},100)},findNodes:function(k,i){var t=[];i=i||this;for(var o=0,r=this._menus.length;o<r;o++){var l=this._menus[o].getItems();var s=[];for(var p=0,q=l.length;p<q;p++){var j=l[p];if(k&&k.call(i,j)===true){s.push(j)}}t.addRange(s)}return t},getNode:function(k){for(var f=0,g=this._menus.length;f<g;f++){var j=this._menus[f];var i=j.getItem(k);if(i){return i}}return null},getList:function(){var j=[];for(var k=0,g=this._menus.length;k<g;k++){var i=this._menus[k];var f=i.getItems();j.addRange(f)}return j},_getOwnerMenu:function(k){if(!k){return}for(var f=0,g=this._menus.length;f<g;f++){var j=this._menus[f];var i=j.getItem(k);if(i){return j}}},getAttrs:function(c){var d=mini.OutlookMenu.superclass.getAttrs.call(this,c);d.text=c.innerHTML;mini._ParseString(c,d,["url","textField","urlField","idField","parentField","itemsField","iconField","onitemclick","onitemselect","ondrawnode","imgPath"]);mini._ParseBool(c,d,["resultAsTree"]);return d},imgPath:"",setImgPath:function(b){this.imgPath=b},getImgPath:function(){return this.imgPath},autoCollapse:true,activeIndex:0,createNavBarMenu:function(i){this._destroyTrees();if(!mini.isArray(i)){i=[]}this.data=i;var j=[];for(var p=0,q=this.data.length;p<q;p++){var k=this.data[p];var n={};n.title=k.text;n.iconCls=k.iconCls;j.push(n);n._children=k[this.itemsField]}this.setGroups(j);this.setActiveIndex(this.activeIndex);this._menus=[];for(var p=0,q=this.groups.length;p<q;p++){var n=this.groups[p];var o=this.getGroupBodyEl(n);var l=new mini.Menu();l._ownerGroup=n;l.set({expanded:false,imgPath:this.imgPath,showNavArrow:false,style:"width:100%;height:100%;border:0;background:none",borderStyle:"border:0",allowSelectItem:true,items:n._children});l.render(o);l.on("itemclick",this.__OnItemClick,this);l.on("itemselect",this.__OnItemSelect,this);this._onDrawNodes(l.getItems());this._menus.push(l);delete n._children}},_onDrawNodes:function(g){if(!g){return}for(var l=0,i=g.length;l<i;l++){var k=g[l];var j={node:k,img:k.img,nodeHtml:""};this.fire("drawnode",j);if(j.img!=k.img&&k.setImg){k.setImg(j.img)}if(j.nodeHtml!=""){k.setText(j.nodeHtml)}}},__OnItemClick:function(c){var d={item:c.item,htmlEvent:c.htmlEvent};this.fire("itemclick",d)},__OnItemSelect:function(k){if(!k.item){return}for(var g=0,i=this._menus.length;g<i;g++){var j=this._menus[g];if(j!=k.sender){j.setSelectedItem(null)}}var l={item:k.item,htmlEvent:k.htmlEvent};this._selected=k.item;this.fire("itemselect",l)}});mini.regClass(mini.OutlookMenu,"outlookmenu");mini.OutlookTree=function(){mini.OutlookTree.superclass.constructor.call(this);this.data=[]};mini.extend(mini.OutlookTree,mini.OutlookBar,{url:"",textField:"text",iconField:"iconCls",urlField:"url",resultAsTree:false,nodesField:"children",idField:"id",parentField:"pid",style:"width:100%;height:100%;",set:function(g){if(typeof g=="string"){return this}var d=g.url;delete g.url;var f=g.activeIndex;delete g.activeIndex;mini.OutlookTree.superclass.set.call(this,g);if(d){this.setUrl(d)}if(mini.isNumber(f)){this.setActiveIndex(f)}return this},uiCls:"mini-outlooktree",destroy:function(b){this._destroyTrees(b);mini.OutlookTree.superclass.destroy.call(this,b)},_destroyTrees:function(j){if(this._trees){var k=this._trees.clone();for(var f=0,g=k.length;f<g;f++){var i=k[f];i.destroy(j)}this._trees.length=0}},_doParseFields:function(j){for(var f=0,g=j.length;f<g;f++){var i=j[f];i.text=i[this.textField];i.url=i[this.urlField];i.iconCls=i[this.iconField]}},_doLoad:function(){var f=[];try{f=mini._getResult(this.url,null,null,null,null,this.dataField)}catch(d){if(mini_debugger==true){alert("outlooktree json is error.")}}if(this.dataField&&!mini.isArray(f)){f=mini._getMap(this.dataField,f)}if(!f){f=[]}if(this.resultAsTree==false){f=mini.arrayToTree(f,this.nodesField,this.idField,this.parentField)}var g=mini.treeToArray(f,this.nodesField,this.idField,this.parentField);this._doParseFields(g);this.createNavBarTree(f);this.fire("load")},loadList:function(j,f,i){f=f||this.idField;i=i||this.parentField;this._doParseFields(j);var g=mini.arrayToTree(j,this.nodesField,f,i);this.load(g)},load:function(c){if(typeof c=="string"){this.setUrl(c)}else{var d=mini.treeToArray(c,this.itemsField,this.idField,this.parentField);this._doParseFields(d);this.createNavBarTree(c)}},setData:function(b){this.load(b)},getData:function(){return this.data},setUrl:function(b){this.url=b;this._doLoad()},getUrl:function(){return this.url},setTextField:function(b){this.textField=b},getTextField:function(){return this.textField},setIconField:function(b){this.iconField=b},getIconField:function(){return this.iconField},setUrlField:function(b){this.urlField=b},getUrlField:function(){return this.urlField},setResultAsTree:function(b){this.resultAsTree=b},getResultAsTree:function(){return this.resultAsTree},setNodesField:function(b){this.nodesField=b},getNodesField:function(){return this.nodesField},setIdField:function(b){this.idField=b},getIdField:function(){return this.idField},setParentField:function(b){this.parentField=b},getParentField:function(){return this.parentField},_selected:null,getSelected:function(){return this._selected},isSelectedNode:function(c){c=this.getNode(c);if(!c){return false}var d=this._getOwnerTree(c);if(!d){return false}return d.isSelectedNode(c)},selectNode:function(c){c=this.getNode(c);if(!c){return}var d=this._getOwnerTree(c);d.selectNode(c)},expandPath:function(c){c=this.getNode(c);if(!c){return}var d=this._getOwnerTree(c);d.expandPath(c);this.expandGroup(d._ownerGroup)},findNodes:function(l,n){var p=[];n=n||this;for(var o=0,i=this._trees.length;o<i;o++){var j=this._trees[o];var k=j.findNodes(l,n);p.addRange(k)}return p},getNode:function(j){for(var k=0,f=this._trees.length;k<f;k++){var g=this._trees[k];var i=g.getNode(j);if(i){return i}}return null},getList:function(){var i=[];for(var j=0,f=this._trees.length;j<f;j++){var g=this._trees[j];var k=g.getList();i.addRange(k)}return i},_getOwnerTree:function(i){if(!i){return}for(var j=0,f=this._trees.length;j<f;j++){var g=this._trees[j];if(g.getby_id(i._id)){return g}}},expandOnLoad:false,setExpandOnLoad:function(b){this.expandOnLoad=b},getExpandOnLoad:function(){return this.expandOnLoad},showArrow:false,setShowArrow:function(b){this.showArrow=b},getShowArrow:function(){return this.showArrow},_handlerTree:function(c){c.tree=c.sender;c.sender=this;var d="node"+c.type;if(c.type.indexOf("before")==0){d="beforenode"+c.type.replace("before","")}this.fire(d,c)},getAttrs:function(d){var f=mini.OutlookTree.superclass.getAttrs.call(this,d);f.text=d.innerHTML;mini._ParseString(d,f,["url","textField","urlField","idField","parentField","nodesField","iconField","onnodeclick","onnodeselect","onnodemousedown","ondrawnode","expandOnLoad","imgPath","onbeforenodeexpand","onnodeexpand","onbeforenodecollapse","onnodecollapse"]);mini._ParseBool(d,f,["resultAsTree","showArrow"]);if(f.expandOnLoad){var g=parseInt(f.expandOnLoad);if(mini.isNumber(g)){f.expandOnLoad=g}else{f.expandOnLoad=f.expandOnLoad=="true"?true:false}}return f},imgPath:"",setImgPath:function(b){this.imgPath=b},getImgPath:function(){return this.imgPath},autoCollapse:true,activeIndex:0,createNavBarTree:function(i){this._destroyTrees();var n=this;if(!mini.isArray(i)){i=[]}this.data=i;var j=[];for(var p=0,q=this.data.length;p<q;p++){var k=this.data[p];var l={};l.title=k.text;l.iconCls=k.iconCls;j.push(l);l._children=k[this.nodesField]}this.setGroups(j);this.setActiveIndex(this.activeIndex);this._trees=[];for(var p=0,q=this.groups.length;p<q;p++){var l=this.groups[p];var o=this.getGroupBodyEl(l);var i=new mini.Tree();i.set({showArrow:this.showArrow,imgPath:this.imgPath,idField:this.idField,parentField:this.parentField,textField:this.textField,expandOnLoad:this.expandOnLoad,showTreeIcon:true,style:"width:100%;height:100%;border:0;background:none",data:l._children,onbeforeload:function(a){a.url=n.url}});i.render(o);i.on("nodeclick",this.__OnNodeClick,this);i.on("nodeselect",this.__OnNodeSelect,this);i.on("nodemousedown",this.__OnNodeMouseDown,this);i.on("drawnode",this.__OnDrawNode,this);i.on("beforeexpand",this._handlerTree,this);i.on("beforecollapse",this._handlerTree,this);i.on("expand",this._handlerTree,this);i.on("collapse",this._handlerTree,this);this._trees.push(i);delete l._children;i._ownerGroup=l}},__OnNodeMouseDown:function(c){var d={node:c.node,isLeaf:c.sender.isLeaf(c.node),htmlEvent:c.htmlEvent};this.fire("nodemousedown",d)},__OnNodeClick:function(c){var d={node:c.node,isLeaf:c.sender.isLeaf(c.node),htmlEvent:c.htmlEvent};this.fire("nodeclick",d)},__OnNodeSelect:function(j){if(!j.node){return}for(var l=0,g=this._trees.length;l<g;l++){var i=this._trees[l];if(i!=j.sender){i.selectNode(null)}}var k={node:j.node,isLeaf:j.sender.isLeaf(j.node),htmlEvent:j.htmlEvent};this._selected=j.node;this.fire("nodeselect",k)},__OnDrawNode:function(b){this.fire("drawnode",b)}});mini.regClass(mini.OutlookTree,"outlooktree");mini.NavBar=function(){mini.NavBar.superclass.constructor.call(this)};mini.extend(mini.NavBar,mini.OutlookBar,{uiCls:"mini-navbar"});mini.regClass(mini.NavBar,"navbar");mini.NavBarMenu=function(){mini.NavBarMenu.superclass.constructor.call(this)};mini.extend(mini.NavBarMenu,mini.OutlookMenu,{uiCls:"mini-navbarmenu"});mini.regClass(mini.NavBarMenu,"navbarmenu");mini.NavBarTree=function(){mini.NavBarTree.superclass.constructor.call(this)};mini.extend(mini.NavBarTree,mini.OutlookTree,{uiCls:"mini-navbartree"});mini.regClass(mini.NavBarTree,"navbartree");mini.ToolBar=function(){mini.ToolBar.superclass.constructor.call(this)};mini.extend(mini.ToolBar,mini.Container,{_clearBorder:false,style:"",uiCls:"mini-toolbar",_create:function(){this.el=document.createElement("div");this.el.className="mini-toolbar"},_initEvents:function(){},doLayout:function(){if(!this.canLayout()){return}var d=mini.getChildNodes(this.el,true);for(var g=0,f=d.length;g<f;g++){mini.layout(d[g])}},set_bodyParent:function(b){if(!b){return}this.el=b;this.doLayout()},getAttrs:function(el){var attrs={};mini._ParseString(el,attrs,["id","borderStyle","data-options"]);this.el=el;this.el.uid=this.uid;this.addCls(this.uiCls);var options=attrs["data-options"];if(options){options=eval("("+options+")");if(options){mini.copyTo(attrs,options)}}return attrs}});mini.regClass(mini.ToolBar,"toolbar");mini.Pager=function(){mini.Pager.superclass.constructor.call(this)};mini.extend(mini.Pager,mini.Control,{pageIndex:0,pageSize:10,totalCount:0,totalPage:0,showPageIndex:true,showPageSize:true,showTotalCount:true,showPageInfo:true,showReloadButton:true,_clearBorder:false,showButtonText:false,showButtonIcon:true,firstText:"首页",prevText:"上一页",nextText:"下一页",lastText:"尾页",pageInfoText:"每页 {0} 条, 共 {1} 条",sizeList:[10,20,50,100],set:function(c){if(typeof c=="string"){return this}var d=c.pageIndex;delete c.pageIndex;mini.Pager.superclass.set.call(this,c);if(!mini.isNull(d)){this.setPageIndex(d)}return this},uiCls:"mini-pager",_create:function(){this.el=document.createElement("div");this.el.className="mini-pager";var c='<div class="mini-pager-left"><table cellspacing="0" cellpadding="0" border="0"><tr><td></td><td></td></tr></table></div><div class="mini-pager-right"></div>';this.el.innerHTML=c;this._leftEl=this.el.childNodes[0];this._rightEl=this.el.childNodes[1];var d=this._leftEl.getElementsByTagName("td");this._barEl=d[0];this._barEl2=d[1];this.sizeEl=mini.append(this._barEl,'<span class="mini-pager-size"></span>');this.sizeCombo=new mini.ComboBox();this.sizeCombo.setName("pagesize");this.sizeCombo.setWidth(this.pageSizeWidth);this.sizeCombo.render(this.sizeEl);mini.append(this.sizeEl,'<span class="separator"></span>');this.firstButton=new mini.Button();this.firstButton.render(this._barEl);this.prevButton=new mini.Button();this.prevButton.render(this._barEl);this.indexEl=document.createElement("span");this.indexEl.className="mini-pager-index";this.indexEl.innerHTML='<input id="" type="text" class="mini-pager-num"/><span class="mini-pager-pages">/ 0</span>';this._barEl.appendChild(this.indexEl);this.numInput=this.indexEl.firstChild;this.pagesLabel=this.indexEl.lastChild;this.nextButton=new mini.Button();this.nextButton.render(this._barEl);this.lastButton=new mini.Button();this.lastButton.render(this._barEl);mini.append(this._barEl,'<span class="separator"></span>');this.reloadButton=new mini.Button();this.reloadButton.render(this._barEl);this.firstButton.setPlain(true);this.prevButton.setPlain(true);this.nextButton.setPlain(true);this.lastButton.setPlain(true);this.reloadButton.setPlain(true);this.buttonsEl=mini.append(this._barEl2,'<div class="mini-page-buttons"></div>');this.update()},setButtons:function(b){__mini_setControls(b,this.buttonsEl,this)},getButtonsEl:function(){return this.buttonsEl},destroy:function(b){if(this.pageSelect){mini.clearEvent(this.pageSelect);this.pageSelect=null}if(this.numInput){mini.clearEvent(this.numInput);this.numInput=null}this.sizeEl=null;this._leftEl=null;mini.Pager.superclass.destroy.call(this,b)},_initEvents:function(){mini.Pager.superclass._initEvents.call(this);this.firstButton.on("click",function(a){this._OnPageChanged(0)},this);this.prevButton.on("click",function(a){this._OnPageChanged(this.pageIndex-1)},this);this.nextButton.on("click",function(a){this._OnPageChanged(this.pageIndex+1)},this);this.lastButton.on("click",function(a){this._OnPageChanged(this.totalPage)},this);this.reloadButton.on("click",function(a){this._OnPageChanged()},this);function d(){if(c){return}c=true;var a=parseInt(this.numInput.value);if(isNaN(a)){this.update()}else{this._OnPageChanged(a-1)}setTimeout(function(){c=false},100)}var c=false;mini.on(this.numInput,"change",function(a){d.call(this)},this);mini.on(this.numInput,"keydown",function(a){if(a.keyCode==13){d.call(this);a.stopPropagation()}},this);this.sizeCombo.on("valuechanged",this.__OnPageSelectChanged,this)},doLayout:function(){if(!this.canLayout()){return}mini.layout(this._leftEl);mini.layout(this._rightEl)},setPageIndex:function(b){if(isNaN(b)){return}this.pageIndex=b;this.update()},getPageIndex:function(){return this.pageIndex},setPageSize:function(b){if(isNaN(b)){return}this.pageSize=b;this.update()},getPageSize:function(){return this.pageSize},setTotalCount:function(b){b=parseInt(b);if(isNaN(b)){return}this.totalCount=b;this.update()},getTotalCount:function(){return this.totalCount},setSizeList:function(b){if(!mini.isArray(b)){return}this.sizeList=b;this.update()},getSizeList:function(){return this.sizeList},pageSizeWidth:50,setPageSizeWidth:function(b){b=parseInt(b);if(isNaN(b)){return}if(this.pageSizeWidth!=b){this.pageSizeWidth=b;this.sizeCombo.setWidth(b)}},getPageSizeWidth:function(){return this.pageSizeWidth},setShowPageSize:function(b){this.showPageSize=b;this.update()},getShowPageSize:function(){return this.showPageSize},setShowPageIndex:function(b){this.showPageIndex=b;this.update()},getShowPageIndex:function(){return this.showPageIndex},setShowTotalCount:function(b){this.showTotalCount=b;this.update()},getShowTotalCount:function(){return this.showTotalCount},setShowPageInfo:function(b){this.showPageInfo=b;this.update()},getShowPageInfo:function(){return this.showPageInfo},setShowReloadButton:function(b){this.showReloadButton=b;this.update()},getShowReloadButton:function(){return this.showReloadButton},getTotalPage:function(){return this.totalPage},update:function(x,i,t){if(mini.isNumber(x)){this.pageIndex=parseInt(x)}if(mini.isNumber(i)){this.pageSize=parseInt(i)}if(mini.isNumber(t)){this.totalCount=parseInt(t)}this.totalPage=parseInt(this.totalCount/this.pageSize)+1;if((this.totalPage-1)*this.pageSize==this.totalCount){this.totalPage-=1}if(this.totalCount==0){this.totalPage=0}if(this.pageIndex>this.totalPage-1){this.pageIndex=this.totalPage-1}if(this.pageIndex<=0){this.pageIndex=0}if(this.totalPage<=0){this.totalPage=0}this.firstButton.enable();this.prevButton.enable();this.nextButton.enable();this.lastButton.enable();if(this.pageIndex==0){this.firstButton.disable();this.prevButton.disable()}if(this.pageIndex>=this.totalPage-1){this.nextButton.disable();this.lastButton.disable()}this.numInput.value=this.pageIndex>-1?this.pageIndex+1:0;this.pagesLabel.innerHTML="/ "+this.totalPage;var s=this.sizeList.clone();if(s.indexOf(this.pageSize)==-1){s.push(this.pageSize);s=s.sort(function(a,b){return a>b})}var l=[];for(var A=0,B=s.length;A<B;A++){var y=s[A];var z={};z.text=y;z.id=y;l.push(z)}this.sizeCombo.setData(l);this.sizeCombo.setValue(this.pageSize);var w=this.firstText,u=this.prevText,q=this.nextText,v=this.lastText;if(this.showButtonText==false){w=u=q=v=""}this.firstButton.setText(w);this.prevButton.setText(u);this.nextButton.setText(q);this.lastButton.setText(v);var w=this.firstText,u=this.prevText,q=this.nextText,v=this.lastText;if(this.showButtonText==true){w=u=q=v=""}this.firstButton.setTooltip(w);this.prevButton.setTooltip(u);this.nextButton.setTooltip(q);this.lastButton.setTooltip(v);this.firstButton.setIconCls(this.showButtonIcon?"mini-pager-first":"");this.prevButton.setIconCls(this.showButtonIcon?"mini-pager-prev":"");this.nextButton.setIconCls(this.showButtonIcon?"mini-pager-next":"");this.lastButton.setIconCls(this.showButtonIcon?"mini-pager-last":"");this.reloadButton.setIconCls(this.showButtonIcon?"mini-pager-reload":"");this.reloadButton.setVisible(this.showReloadButton);var r=this.reloadButton.el.previousSibling;if(r){r.style.display=this.showReloadButton?"":"none"}this._rightEl.innerHTML=String.format(this.pageInfoText,this.pageSize,this.totalCount);this.indexEl.style.display=this.showPageIndex?"":"none";this.sizeEl.style.display=this.showPageSize?"":"none";this._rightEl.style.display=this.showPageInfo?"":"none"},__OnPageSelectChanged:function(c){var d=parseInt(this.sizeCombo.getValue());this._OnPageChanged(0,d)},_OnPageChanged:function(f,d){var g={pageIndex:mini.isNumber(f)?f:this.pageIndex,pageSize:mini.isNumber(d)?d:this.pageSize,cancel:false};if(g.pageIndex>this.totalPage-1){g.pageIndex=this.totalPage-1}if(g.pageIndex<0){g.pageIndex=0}this.fire("beforepagechanged",g);if(g.cancel==true){return}this.fire("pagechanged",g);this.update(g.pageIndex,g.pageSize)},onPageChanged:function(c,d){this.on("pagechanged",c,d)},getAttrs:function(el){var attrs=mini.Pager.superclass.getAttrs.call(this,el);mini._ParseString(el,attrs,["onpagechanged","sizeList","onbeforepagechanged","buttons"]);mini._ParseBool(el,attrs,["showPageIndex","showPageSize","showTotalCount","showPageInfo","showReloadButton"]);mini._ParseInt(el,attrs,["pageIndex","pageSize","totalCount","pageSizeWidth"]);if(typeof attrs.sizeList=="string"){attrs.sizeList=eval(attrs.sizeList)}if(attrs.buttons){attrs.buttons=mini.byId(attrs.buttons)}return attrs}});mini.regClass(mini.Pager,"pager");mini.DataBinding=function(){this._bindFields=[];this._bindForms=[];mini.DataBinding.superclass.constructor.call(this)};mini.extend(mini.DataBinding,mini.Component,{bindField:function(l,i,n,k,g){l=mini.get(l);i=mini.get(i);if(!l||!i||!n){return}var j={control:l,source:i,field:n,convert:g,mode:k};this._bindFields.push(j);i.on("currentchanged",this.__OnCurrentChanged,this);l.on("valuechanged",this.__OnValueChanged,this)},bindForm:function(p,o,k,l){p=mini.byId(p);o=mini.get(o);if(!p||!o){return}var p=new mini.Form(p);var i=p.getFields();for(var q=0,j=i.length;q<j;q++){var n=i[q];this.bindField(n,o,n.getName(),k,l)}},__OnCurrentChanged:function(p){if(this._doSetting){return}this._doSetting=true;this._currentRecord=p.record;var u=p.sender;var q=p.record;for(var r=0,t=this._bindFields.length;r<t;r++){var o=this._bindFields[r];if(o.source!=u){continue}var s=o.control;var l=o.field;if(s.setValue){if(q){var i=q[l];s.setValue(i)}else{s.setValue("")}}if(s.setText&&s.textName){if(q){s.setText(q[s.textName])}else{s.setText("")}}}var n=this;setTimeout(function(){n._doSetting=false},10)},__OnValueChanged:function(p){if(this._doSetting){return}this._doSetting=true;var r=p.sender;var i=r.getValue();for(var q=0,t=this._bindFields.length;q<t;q++){var n=this._bindFields[q];if(n.control!=r||n.mode===false){continue}var u=n.source;var o=this._currentRecord;if(!o){continue}var s={};s[n.field]=i;if(r.getText&&r.textName){s[r.textName]=r.getText()}u.updateRow(o,s)}var l=this;setTimeout(function(){l._doSetting=false},10)}});mini.regClass(mini.DataBinding,"databinding");mini.DataSet=function(){this._sources={};this._data={};this._links=[];this._originals={};mini.DataSet.superclass.constructor.call(this)};mini.extend(mini.DataSet,mini.Component,{add:function(d,c){if(!d||!c){return}this._sources[d]=c;this._data[d]=[];c._set_autoCreateNewID(true);c._set_originalIdField(c.getIdField());c._set_clearOriginals(false);c.on("addrow",this.__OnRowChanged,this);c.on("updaterow",this.__OnRowChanged,this);c.on("deleterow",this.__OnRowChanged,this);c.on("removerow",this.__OnRowChanged,this);c.on("preload",this.__OnDataPreLoad,this);c.on("selectionchanged",this.__OnDataSelectionChanged,this)},addLink:function(f,g,i){if(!f||!g||!i){return}if(!this._sources[f]||!this._sources[g]){return}var j={parentName:f,childName:g,parentField:i};this._links.push(j)},clearData:function(){this._data={};this._originals={};for(var b in this._sources){this._data=[]}},getData:function(){return this._data},_getNameByListControl:function(c){for(var f in this._sources){var g=this._sources[f];if(g==c){return f}}},_getRecord:function(o,i,p){var l=this._data[o];if(!l){return false}for(var n=0,j=l.length;n<j;n++){var k=l[n];if(k[p]==i[p]){return k}}return null},__OnRowChanged:function(l){var p=l.type;var j=l.record;var q=this._getNameByListControl(l.sender);var r=this._getRecord(q,j,l.sender.getIdField());var o=this._data[q];if(r){var o=this._data[q];o.remove(r)}if(p=="removerow"&&j._state=="added"){}else{o.push(j)}this._originals[q]=l.sender._get_originals();if(j._state=="added"){var k=this._getParentSource(l.sender);if(k){var n=k.getSelected();if(n){j._parentId=n[k.getIdField()]}else{o.remove(j)}}}},__OnDataPreLoad:function(w){var E=w.sender;var D=this._getNameByListControl(E);var C=w.sender.getIdField();var G=this._data[D];var t={};for(var z=0,A=G.length;z<A;z++){var i=G[z];t[i[C]]=i}var y=this._originals[D];if(y){E._set_originals(y)}var F=w.data||[];for(var z=0,A=F.length;z<A;z++){var i=F[z];var B=t[i[C]];if(B){delete B._uid;mini.copyTo(i,B)}}var u=this._getParentSource(E);if(E.getPageIndex&&E.getPageIndex()==0){var v=[];for(var z=0,A=G.length;z<A;z++){var i=G[z];if(i._state=="added"){if(u){var x=u.getSelected();if(x&&x[u.getIdField()]==i._parentId){v.push(i)}}else{v.push(i)}}}v.reverse();F.insertRange(0,v)}var l=[];for(var z=F.length-1;z>=0;z--){var i=F[z];var B=t[i[C]];if(B&&B._state=="removed"){F.removeAt(z);l.push(B)}}},_getParentSource:function(i){var f=this._getNameByListControl(i);for(var k=0,g=this._links.length;k<g;k++){var j=this._links[k];if(j.childName==f){return this._sources[j.parentName]}}},_getLinks:function(j){var n=this._getNameByListControl(j);var g=[];for(var l=0,i=this._links.length;l<i;l++){var k=this._links[l];if(k.parentName==n){g.push(k)}}return g},__OnDataSelectionChanged:function(o){var s=o.sender;var p=s.getSelected();var i=this._getLinks(s);for(var q=0,r=i.length;q<r;q++){var l=i[q];var t=this._sources[l.childName];if(p){var n={};n[l.parentField]=p[s.getIdField()];t.load(n)}else{t.loadData([])}}}});mini.regClass(mini.DataSet,"dataset");if(typeof mini_doload=="undefined"){mini_doload=function(b){}}mini.DataSource=function(){mini.DataSource.superclass.constructor.call(this);this._init()};mini.extend(mini.DataSource,mini.Component,{idField:"id",textField:"text",_originalIdField:"_id",_clearOriginals:true,_autoCreateNewID:false,_init:function(){this.source=[];this.dataview=[];this.visibleRows=null;this._ids={};this._removeds=[];if(this._clearOriginals){this._originals={}}this._errors={};this._selected=null;this._selecteds=[];this._idSelecteds={};this.__changeCount=0},getSource:function(){return this.source},getList:function(){return this.source.clone()},getDataView:function(){return this.dataview.clone()},getVisibleRows:function(){if(!this.visibleRows){this.visibleRows=this.getDataView().clone()}return this.visibleRows},setData:function(b){this.loadData(b)},loadData:function(b){if(!mini.isArray(b)){b=[]}this._init();this._doLoadData(b);this._dataChanged();this.fire("loaddata");return true},_doLoadData:function(j){this.source=j;this.dataview=j;var k=this.source,l=this._ids;for(var n=0,g=k.length;n<g;n++){var i=k[n];i._id=mini.DataSource.RecordId++;l[i._id]=i;i._uid=i._id}},clearData:function(){this._init();this._dataChanged();this.fire("cleardata")},clear:function(){this.clearData()},updateRecord:function(j,k,n){if(mini.isNull(j)){return}var o=mini._getMap,p=mini._setMap;this.fire("beforeupdate",{record:j});if(typeof k=="string"){var i=o(k,j);if(mini.isEquals(i,n)){return false}this.beginChange();p(k,n,j);this._setModified(j,k,i);this.endChange()}else{this.beginChange();for(var l in k){var i=o(l,j);var n=k[l];if(mini.isEquals(i,n)){continue}p(l,n,j);this._setModified(j,l,i)}this.endChange()}this.fire("update",{record:j})},deleteRecord:function(b){this._setDeleted(b);this._dataChanged();this.fire("delete",{record:b})},getby_id:function(b){b=typeof b=="object"?b._id:b;return this._ids[b]},getbyId:function(k){var o=typeof k;if(o=="number"){return this.getAt(k)}if(typeof k=="object"){if(this.getby_id(k)){return k}k=k[this.idField]}var n=this.getList();k=String(k);for(var p=0,j=n.length;p<j;p++){var l=n[p];var i=!mini.isNull(l[this.idField])?String(l[this.idField]):null;if(i==k){return l}}return null},getsByIds:function(j){if(mini.isNull(j)){j=""}j=String(j);var g=[];var l=String(j).split(",");for(var n=0,i=l.length;n<i;n++){var k=this.getbyId(l[n]);if(k){g.push(k)}}return g},getRecord:function(b){return this.getRow(b)},getRow:function(d){var c=typeof d;if(c=="string"){return this.getbyId(d)}else{if(c=="number"){return this.getAt(d)}else{if(c=="object"){return d}}}},delimiter:",",getValueAndText:function(n,o){if(mini.isNull(n)){n=[]}o=o||this.delimiter;if(typeof n=="string"||typeof n=="number"){n=this.getsByIds(n)}else{if(!mini.isArray(n)){n=[n]}}var p=[];var k=[];for(var l=0,i=n.length;l<i;l++){var j=n[l];if(j){p.push(this.getItemValue(j));k.push(this.getItemText(j))}}return[p.join(o),k.join(o)]},getItemValue:function(c){if(!c){return""}var d=mini._getMap(this.idField,c);return mini.isNull(d)?"":String(d)},getItemText:function(c){if(!c){return""}var d=mini._getMap(this.textField,c);return mini.isNull(d)?"":String(d)},isModified:function(f,g){var d=this._originals[f[this._originalIdField]];if(!d){return false}if(mini.isNull(g)){return false}return d.hasOwnProperty(g)},hasRecord:function(b){return !!this.getby_id(b)},findRecords:function(l,n){var p=typeof l=="function";var o=l;var i=n||this;var s=this.source;var u=[];for(var r=0,t=s.length;r<t;r++){var v=s[r];if(p){var q=o.call(i,v);if(q==true){u[u.length]=v}if(q===1){break}}else{if(v[l]==n){u[u.length]=v}}}return u},findRecord:function(g,d){var f=this.findRecords(g,d);return f[0]},each:function(d,f){var g=this.getDataView().clone();f=f||this;mini.forEach(g,d,f)},getCount:function(){return this.getDataView().length},setIdField:function(b){this.idField=b},setTextField:function(b){this.textField=b},__changeCount:0,beginChange:function(){this.__changeCount++},endChange:function(b){this.__changeCount--;if(this.__changeCount<0){this.__changeCount=0}if((b!==false&&this.__changeCount==0)||b==true){this.__changeCount=0;this._dataChanged()}},_dataChanged:function(){this.visibleRows=null;if(this.__changeCount==0){this.fire("datachanged")}},_setAdded:function(b){b._id=mini.DataSource.RecordId++;if(this._autoCreateNewID&&!b[this.idField]){b[this.idField]=UUID()}b._uid=b._id;b._state="added";this._ids[b._id]=b;delete this._originals[b[this._originalIdField]]},_setModified:function(g,i,f){if(g._state!="added"&&g._state!="deleted"&&g._state!="removed"){g._state="modified";var j=this._getOriginal(g);if(!j.hasOwnProperty(i)){j[i]=f}}},_setDeleted:function(b){if(b._state!="added"&&b._state!="deleted"&&b._state!="removed"){b._state="deleted"}},_setRemoved:function(b){delete this._ids[b._id];if(b._state!="added"&&b._state!="removed"){b._state="removed";delete this._originals[b[this._originalIdField]];this._removeds.push(b)}},_getOriginal:function(f){var d=f[this._originalIdField];var g=this._originals[d];if(!g){g=this._originals[d]={}}return g},_selected:null,_selecteds:[],_idSelecteds:null,multiSelect:false,isSelected:function(b){if(!b){return false}if(typeof b!="string"){b=b._id}return !!this._idSelecteds[b]},setSelected:function(d){d=this.getby_id(d);var c=this.getSelected();if(c!=d){this._selected=d;if(d){this.select(d)}else{this.deselect(this.getSelected())}this._OnCurrentChanged(d)}},getSelected:function(){if(this.isSelected(this._selected)){return this._selected}return this._selecteds[0]},setCurrent:function(b){this.setSelected(b)},getCurrent:function(){return this.getSelected()},getSelecteds:function(){return this._selecteds.clone()},select:function(d,c){if(mini.isNull(d)){return}this.selects([d],c)},deselect:function(d,c){if(mini.isNull(d)){return}this.deselects([d],c)},selectAll:function(b){this.selects(this.getList())},deselectAll:function(b){this.deselects(this.getList())},_fireSelect:function(f,d){var g={record:f,cancel:false};this.fire(d,g);return !g.cancel},selects:function(n,k){if(!mini.isArray(n)){return}n=n.clone();if(this.multiSelect==false){this.deselects(this.getSelecteds());if(n.length>0){n.length=1}this._selecteds=[];this._idSelecteds={}}var j=[];for(var l=0,g=n.length;l<g;l++){var i=this.getbyId(n[l]);if(!i){continue}if(!this.isSelected(i)){if(k!==false){if(!this._fireSelect(i,"beforeselect")){continue}}this._selecteds.push(i);this._idSelecteds[i._id]=i;j.push(i);if(k!==false){this.fire("select",{record:i})}}}this._OnSelectionChanged(n,true,j,k)},deselects:function(p,n){if(!mini.isArray(p)){return}p=p.clone();var k=[];for(var o=p.length-1;o>=0;o--){var i=this.getbyId(p[o]);if(!i){continue}if(this.isSelected(i)){if(n!==false){if(!this._fireSelect(i,"beforedeselect")){continue}}delete this._idSelecteds[i._id];k.push(i)}}this._selecteds=[];var j=this._idSelecteds;for(var o in j){var l=j[o];if(l._id){this._selecteds.push(l)}}for(var o=p.length-1;o>=0;o--){var i=this.getbyId(p[o]);if(!i){continue}if(n!==false){this.fire("deselect",{record:i})}}this._OnSelectionChanged(p,false,k,n)},_OnSelectionChanged:function(i,j,k,o){var l={fireEvent:o,records:i,select:j,selected:this.getSelected(),selecteds:this.getSelecteds(),_records:k};this.fire("SelectionChanged",l);var n=this._current;var p=this.getCurrent();if(n!=p){this._current=p;this._OnCurrentChanged(p)}},_OnCurrentChanged:function(d){if(this._currentTimer){clearTimeout(this._currentTimer)}var c=this;this._currentTimer=setTimeout(function(){c._currentTimer=null;var a={record:d};c.fire("CurrentChanged",a)},30)},_checkSelecteds:function(){for(var d=this._selecteds.length-1;d>=0;d--){var f=this._selecteds[d];var g=this.getby_id(f._id);if(!g){this._selecteds.removeAt(d);delete this._idSelecteds[f._id]}}if(this._selected&&this.getby_id(this._selected._id)==null){this._selected=null}},setMultiSelect:function(b){if(this.multiSelect!=b){this.multiSelect=b;if(b==false){}}},getMultiSelect:function(){return this.multiSelect},selectPrev:function(){var d=this.getSelected();if(!d){d=this.getAt(0)}else{var c=this.indexOf(d);d=this.getAt(c-1)}if(d){this.deselectAll();this.select(d);this.setCurrent(d)}},selectNext:function(){var d=this.getSelected();if(!d){d=this.getAt(0)}else{var c=this.indexOf(d);d=this.getAt(c+1)}if(d){this.deselectAll();this.select(d);this.setCurrent(d)}},selectFirst:function(){var b=this.getAt(0);if(b){this.deselectAll();this.select(b);this.setCurrent(b)}},selectLast:function(){var c=this.getVisibleRows();var d=this.getAt(c.length-1);if(d){this.deselectAll();this.select(d);this.setCurrent(d)}},getSelectedsId:function(d){var f=this.getSelecteds();var g=this.getValueAndText(f,d);return g[0]},getSelectedsText:function(d){var f=this.getSelecteds();var g=this.getValueAndText(f,d);return g[1]},_filterInfo:null,_sortInfo:null,filter:function(c,d){if(typeof c!="function"){return}d=d||this;this._filterInfo=[c,d];this._doFilter();this._doSort();this._dataChanged();this.fire("filter")},clearFilter:function(){if(!this._filterInfo){return}this._filterInfo=null;this._doFilter();this._doSort();this._dataChanged();this.fire("filter")},sort:function(g,d,f){if(typeof g!="function"){return}d=d||this;this._sortInfo=[g,d,f];this._doSort();this._dataChanged();this.fire("sort")},clearSort:function(){this._sortInfo=null;this.sortField=this.sortOrder="";this._doFilter();this._dataChanged();if(this.sortMode=="server"){var b=this.getLoadParams();b.sortField="";b.sortOrder="";this.load(b)}else{}this.fire("filter")},_doClientSortField:function(f,j,g){var i=this._getSortFnByField(f,g);if(!i){return}this.sortField=f;this.sortOrder=j;var k=j=="desc";this.sort(i,this,k)},_getSortFnByField:function(k,j){if(!k){return null}var f=null;var g=mini.sortTypes[j];if(!g){g=mini.sortTypes.string}function i(o,q){var p=mini._getMap(k,o),n=mini._getMap(k,q);var c=mini.isNull(p)||p==="";var d=mini.isNull(n)||n==="";if(c){return -1}if(d){return 1}var a=g(p);var b=g(n);if(a>b){return 1}else{if(a==b){return 0}else{return -1}}}f=i;return f},ajaxOptions:null,autoLoad:false,url:"",pageSize:10,pageIndex:0,totalCount:0,totalPage:0,sortField:"",sortOrder:"",loadParams:null,getLoadParams:function(){return this.loadParams||{}},sortMode:"server",pageIndexField:"pageIndex",pageSizeField:"pageSize",sortFieldField:"sortField",sortOrderField:"sortOrder",totalField:"total",dataField:"data",startField:"",limitField:"",errorField:"error",errorMsgField:"errorMsg",stackTraceField:"stackTrace",load:function(i,j,f,g){if(typeof i=="string"){this.setUrl(i);return}if(this._loadTimer){clearTimeout(this._loadTimer)}this.loadParams=i||{};if(!mini.isNumber(this.loadParams.pageIndex)){this.loadParams.pageIndex=0}if(this._xhr){this._xhr.abort()}if(this.ajaxAsync){var k=this;this._loadTimer=setTimeout(function(){k._doLoadAjax(k.loadParams,j,f,g);k._loadTimer=null},1)}else{this._doLoadAjax(this.loadParams,j,f,g)}},reload:function(g,d,f){this.load(this.loadParams,g,d,f)},gotoPage:function(f,d){var g=this.loadParams||{};if(mini.isNumber(f)){g.pageIndex=f}if(mini.isNumber(d)){g.pageSize=d}this.load(g)},sortBy:function(f,d){this.sortField=f;this.sortOrder=d=="asc"?"asc":"desc";if(this.sortMode=="server"){var g=this.getLoadParams();g.sortField=f;g.sortOrder=d;g.pageIndex=this.pageIndex;this.load(g)}else{}},setSortField:function(d){this.sortField=d;if(this.sortMode=="server"){var c=this.getLoadParams();c.sortField=d}},setSortOrder:function(d){this.sortOrder=d;if(this.sortMode=="server"){var c=this.getLoadParams();c.sortOrder=d}},checkSelectOnLoad:true,selectOnLoad:false,ajaxData:null,ajaxAsync:true,ajaxType:"",_doLoadAjax:function(w,o,s,z,r){w=w||{};if(mini.isNull(w.pageIndex)){w.pageIndex=this.pageIndex}if(mini.isNull(w.pageSize)){w.pageSize=this.pageSize}if(w.sortField){this.sortField=w.sortField}if(w.sortOrder){this.sortOrder=w.sortOrder}w.sortField=this.sortField;w.sortOrder=this.sortOrder;this.loadParams=w;var A=this._evalUrl();var p=this._evalType(A);var u=mini._evalAjaxData(this.ajaxData,this);jQuery.extend(true,w,u);var t={url:A,async:this.ajaxAsync,type:p,data:w,params:w,cache:false,cancel:false};jQuery.extend(true,t,this.ajaxOptions);this._OnBeforeLoad(t);if(t.cancel==true){w.pageIndex=this.getPageIndex();w.pageSize=this.getPageSize();return}if(t.data!=t.params&&t.params!=w){t.data=t.params}if(t.url!=A&&t.type==p){t.type=this._evalType(t.url)}var y={};y[this.pageIndexField]=w.pageIndex;y[this.pageSizeField]=w.pageSize;if(w.sortField){y[this.sortFieldField]=w.sortField}if(w.sortOrder){y[this.sortOrderField]=w.sortOrder}if(this.startField&&this.limitField){y[this.startField]=w.pageIndex*w.pageSize;y[this.limitField]=w.pageSize}jQuery.extend(true,w,y);jQuery.extend(true,t.data,y);if(this.sortMode=="client"){w[this.sortFieldField]="";w[this.sortOrderField]=""}var v=this.getSelected();this._selectedValue=v?v[this.idField]:null;if(mini.isNumber(this._selectedValue)){this._selectedValue=String(this._selectedValue)}var q=this;q._resultObject=null;var x=t.async;mini.copyTo(t,{success:function(g,a,f){if(!g||g=="null"){g="{ tatal: 0, data: [] }"}delete t.params;var n={text:g,result:null,sender:q,options:t,xhr:f};var d=null;try{mini_doload(n);d=n.result;if(!d){d=mini.decode(g)}}catch(j){if(mini_debugger==true){alert(A+"\n json is error.")}}if(d&&!mini.isArray(d)){d.total=parseInt(mini._getMap(q.totalField,d));d.data=mini._getMap(q.dataField,d)}else{if(d==null){d={};d.data=[];d.total=0}else{if(mini.isArray(d)){var c={};c.data=d;c.total=d.length;d=c}}}if(!d.data){d.data=[]}if(!d.total){d.total=0}q._resultObject=d;if(!mini.isArray(d.data)){d.data=[d.data]}var j={xhr:f,text:g,textStatus:a,result:d,total:d.total,data:d.data.clone(),pageIndex:w[q.pageIndexField],pageSize:w[q.pageSizeField]};var i=mini._getMap(q.errorField,d);var l=mini._getMap(q.errorMsgField,d);var k=mini._getMap(q.stackTraceField,d);if(mini.isNumber(i)&&i!=0||i===false){j.textStatus="servererror";j.errorCode=i;j.stackTrace=k||"";j.errorMsg=l||"";if(mini_debugger==true){alert(A+"\n"+j.textStatus+"\n"+j.errorMsg+"\n"+j.stackTrace)}q.fire("loaderror",j);if(s){s.call(q,j)}}else{if(r){r(j)}else{q.pageIndex=j.pageIndex;q.pageSize=j.pageSize;q.setTotalCount(j.total);q._OnPreLoad(j);q.setData(j.data);if(q._selectedValue&&q.checkSelectOnLoad){var b=q.getbyId(q._selectedValue);if(b){q.select(b)}}if(q.getSelected()==null&&q.selectOnLoad&&q.getDataView().length>0){q.select(0)}q.fire("load",j);if(o){if(x){setTimeout(function(){o.call(q,j)},20)}else{o.call(q,j)}}}}},error:function(c,a,d){if(a=="abort"){return}var b={xhr:c,text:c.responseText,textStatus:a};b.errorMsg=c.responseText;b.errorCode=c.status;if(mini_debugger==true){alert(A+"\n"+b.errorCode+"\n"+b.errorMsg)}q.fire("loaderror",b);if(s){s.call(q,b)}},complete:function(c,b){var a={xhr:c,text:c.responseText,textStatus:b};q.fire("loadcomplete",a);if(z){z.call(q,a)}q._xhr=null}});if(this._xhr){}this._xhr=mini.ajax(t)},_OnBeforeLoad:function(b){this.fire("beforeload",b)},_OnPreLoad:function(b){this.fire("preload",b)},_evalUrl:function(){var url=this.url;if(typeof url=="function"){url=url()}else{try{url=eval(url)}catch(ex){url=this.url}if(!url){url=this.url}}return url},_evalType:function(d){var c=this.ajaxType;if(!c){c="post";if(d){if(d.indexOf(".txt")!=-1||d.indexOf(".json")!=-1){c="get"}}else{c="get"}}return c},setSortMode:function(b){this.sortMode=b},getSortMode:function(){return this.sortMode},setAjaxOptions:function(b){this.ajaxOptions=b},getAjaxOptions:function(){return this.ajaxOptions},setAutoLoad:function(b){this.autoLoad=b},getAutoLoad:function(){return this.autoLoad},setUrl:function(b){this.url=b;if(this.autoLoad){this.load()}},getUrl:function(){return this.url},setPageIndex:function(b){this.pageIndex=b;this.fire("pageinfochanged")},getPageIndex:function(){return this.pageIndex},setPageSize:function(b){this.pageSize=b;this.fire("pageinfochanged")},getPageSize:function(){return this.pageSize},setTotalCount:function(b){this.totalCount=parseInt(b);this.fire("pageinfochanged")},getTotalCount:function(){return this.totalCount},getTotalPage:function(){return this.totalPage},setCheckSelectOnLoad:function(b){this.checkSelectOnLoad=b},getCheckSelectOnLoad:function(){return this.checkSelectOnLoad},setSelectOnLoad:function(b){this.selectOnLoad=b},getSelectOnLoad:function(){return this.selectOnLoad}});mini.DataSource.RecordId=1;mini.DataTable=function(){mini.DataTable.superclass.constructor.call(this)};mini.extend(mini.DataTable,mini.DataSource,{_init:function(){mini.DataTable.superclass._init.call(this);this._filterInfo=null;this._sortInfo=null},add:function(b){return this.insert(this.source.length,b)},addRange:function(b){this.insertRange(this.source.length,b)},insert:function(n,i){if(!i){return null}var k={index:n,record:i};this.fire("beforeadd",k);if(!mini.isNumber(n)){var o=this.getRecord(n);if(o){n=this.indexOf(o)}else{n=this.getDataView().length}}var l=this.dataview[n];if(l){this.dataview.insert(n,i)}else{this.dataview.add(i)}if(this.dataview!=this.source){if(l){var j=this.source.indexOf(l);this.source.insert(j,i)}else{this.source.add(i)}}this._setAdded(i);this._dataChanged();this.fire("add",k)},insertRange:function(j,k){if(!mini.isArray(k)){return}this.beginChange();k=k.clone();for(var i=0,f=k.length;i<f;i++){var g=k[i];this.insert(j+i,g)}this.endChange()},remove:function(f,g){var d=this.indexOf(f);return this.removeAt(d,g)},removeAt:function(l,n){var i=this.getAt(l);if(!i){return null}var k={record:i};this.fire("beforeremove",k);var o=this.isSelected(i);this.source.removeAt(l);if(this.dataview!==this.source){this.dataview.removeAt(l)}this._setRemoved(i);this._checkSelecteds();this._dataChanged();this.fire("remove",k);if(o&&n){var j=this.getAt(l);if(!j){j=this.getAt(l-1)}this.deselectAll();this.select(j)}},removeRange:function(f,k){if(!mini.isArray(f)){return}this.beginChange();f=f.clone();for(var j=0,g=f.length;j<g;j++){var i=f[j];this.remove(i,k)}this.endChange()},move:function(t,i){if(!t||!mini.isNumber(i)){return}if(i<0){return}if(mini.isArray(t)){this.beginChange();var v=t,x=this.getAt(i);var r=this;mini.sort(v,function(a,b){return r.indexOf(a)>r.indexOf(b)},this);for(var u=0,w=v.length;u<w;u++){var y=v[u];var s=this.indexOf(x);this.move(y,s)}this.endChange();return}var p={index:i,record:t};this.fire("beforemove",p);var q=this.dataview[i];this.dataview.remove(t);var l=this.dataview.indexOf(q);if(l!=-1){i=l}if(q){this.dataview.insert(i,t)}else{this.dataview.add(t)}if(this.dataview!=this.source){this.source.remove(t);var l=this.source.indexOf(q);if(l!=-1){i=l}if(q){this.source.insert(i,t)}else{this.source.add(t)}}this._dataChanged();this.fire("move",p)},indexOf:function(b){return this.getVisibleRows().indexOf(b)},getAt:function(b){return this.getVisibleRows()[b]},getRange:function(k,i){if(k>i){var n=k;k=i;i=n}var p=[];for(var o=k,j=i;o<=j;o++){var l=this.dataview[o];p.push(l)}return p},selectRange:function(g,f){if(!mini.isNumber(g)){g=this.indexOf(g)}if(!mini.isNumber(f)){f=this.indexOf(f)}if(mini.isNull(g)||mini.isNull(f)){return}var d=this.getRange(g,f);this.selects(d)},toArray:function(){return this.source.clone()},isChanged:function(){return this.getChanges().length>0},getChanges:function(w,s){var p=[];if(w=="removed"||w==null){p.addRange(this._removeds.clone())}for(var u=0,v=this.source.length;u<v;u++){var t=this.source[u];if(!t._state){continue}if(t._state==w||w==null){p[p.length]=t}}var i=p;if(s){for(var u=0,v=i.length;u<v;u++){var l=i[u];if(l._state=="modified"){var o={};o._state=l._state;o[this.idField]=l[this.idField];for(var q in l){var r=this.isModified(l,q);if(r){o[q]=l[q]}}i[u]=o}}}var x=this;mini.sort(p,function(a,b){var c=x.indexOf(a);var d=x.indexOf(b);if(c>d){return 1}if(c<d){return -1}return 0});return p},accept:function(){this.beginChange();for(var g=0,d=this.source.length;g<d;g++){var f=this.source[g];this.acceptRecord(f)}this._removeds=[];this._originals={};this.endChange()},reject:function(){this.beginChange();for(var g=0,d=this.source.length;g<d;g++){var f=this.source[g];this.rejectRecord(f)}this._removeds=[];this._originals={};this.endChange()},acceptRecord:function(b){if(!b._state){return}delete this._originals[b[this._originalIdField]];if(b._state=="deleted"){this.remove(b)}else{delete b._state;delete this._originals[b[this._originalIdField]];this._dataChanged()}this.fire("update",{record:b})},rejectRecord:function(d){if(!d._state){return}if(d._state=="added"){this.remove(d)}else{if(d._state=="modified"||d._state=="deleted"){var c=this._getOriginal(d);mini.copyTo(d,c);delete d._state;delete this._originals[d[this._originalIdField]];this._dataChanged();this.fire("update",{record:d})}}},_doFilter:function(){if(!this._filterInfo){this.dataview=this.source;return}var o=this._filterInfo[0],p=this._filterInfo[1];var i=[];var l=this.source;for(var q=0,j=l.length;q<j;q++){var n=l[q];var k=o.call(p,n,q,this);if(k!==false){i.push(n)}}this.dataview=i},_doSort:function(){if(!this._sortInfo){return}var i=this._sortInfo[0],j=this._sortInfo[1],g=this._sortInfo[2];var f=this.getDataView().clone();mini.sort(f,i,j);if(g){f.reverse()}this.dataview=f}});mini.regClass(mini.DataTable,"datatable");mini.DataTree=function(){mini.DataTree.superclass.constructor.call(this)};mini.extend(mini.DataTree,mini.DataSource,{isTree:true,expandOnLoad:false,idField:"id",parentField:"pid",nodesField:"children",checkedField:"checked",resultAsTree:true,dataField:"",checkModel:"cascade",autoCheckParent:false,onlyLeafCheckable:false,setExpandOnLoad:function(b){this.expandOnLoad=b},getExpandOnLoad:function(){return this.expandOnLoad},setParentField:function(b){this.parentField=b},setNodesField:function(c){if(this.nodesField!=c){var d=this.root[this.nodesField];this.nodesField=c;this._doLoadData(d)}},setResultAsTree:function(b){this.resultAsTree=b},setCheckRecursive:function(b){this.checkModel=b?"cascade":"multiple"},getCheckRecursive:function(){return this.checkModel=="cascade"},setShowFolderCheckBox:function(b){this.onlyLeafCheckable=!b},getShowFolderCheckBox:function(){return !this.onlyLeafCheckable},_doExpandOnLoad:function(g){var i=this.nodesField;var j=this.expandOnLoad;function f(l,a){for(var d=0,n=l.length;d<n;d++){var c=l[d];if(mini.isNull(c.expanded)){if(j===true||(mini.isNumber(j)&&a<=j)){c.expanded=true}else{c.expanded=false}}else{}var b=c[i];if(b){f(b,a+1)}}}f(g,0)},_OnBeforeLoad:function(c){var d=this._loadingNode||this.root;c.node=d;if(this._isNodeLoading()){c.async=true;c.isRoot=c.node==this.root;if(!c.isRoot){c.data[this.idField]=this.getItemValue(c.node)}}this.fire("beforeload",c)},_OnPreLoad:function(b){if(this.resultAsTree==false){b.data=mini.arrayToTree(b.data,this.nodesField,this.idField,this.parentField)}this.fire("preload",b)},_init:function(){mini.DataTree.superclass._init.call(this);this.root={_id:-1,_level:-1};this.source=this.root[this.nodesField]=[];this.viewNodes=null;this.dataview=null;this.visibleRows=null;this._ids[this.root._id]=this.root},_doLoadData:function(o){o=o||[];this._doExpandOnLoad(o);this.source=this.root[this.nodesField]=o;this.viewNodes=null;this.dataview=null;this.visibleRows=null;var r=mini.treeToArray(o,this.nodesField);var s=this._ids;s[this.root._id]=this.root;for(var n=0,p=r.length;n<p;n++){var q=r[n];q._id=mini.DataSource.RecordId++;s[q._id]=q;q._uid=q._id}var i=this.checkedField;var r=mini.treeToArray(o,this.nodesField,"_id","_pid",this.root._id);for(var n=0,p=r.length;n<p;n++){var q=r[n];var l=this.getParentNode(q);q._pid=l._id;q._level=l._level+1;delete q._state;q.checked=q[i];if(q.checked){q.checked=q.checked!="false"}if(this.isLeafNode(q)==false){var k=q[this.nodesField];if(k&&k.length>0){}}}this._doUpdateLoadedCheckedNodes()},_setAdded:function(c){var d=this.getParentNode(c);c._id=mini.DataSource.RecordId++;if(this._autoCreateNewID&&!c[this.idField]){c[this.idField]=UUID()}c._uid=c._id;c._pid=d._id;if(d[this.idField]){c[this.parentField]=d[this.idField]}c._level=d._level+1;c._state="added";this._ids[c._id]=c;delete this._originals[c[this._originalIdField]]},_createNodes:function(c){var d=c[this.nodesField];if(!d){d=c[this.nodesField]=[]}if(this.viewNodes&&!this.viewNodes[c._id]){this.viewNodes[c._id]=[]}return d},addNode:function(c,d){if(!c){return}return this.insertNode(c,-1,d)},addNodes:function(n,i,j){if(!mini.isArray(n)){return}if(mini.isNull(j)){j="add"}for(var l=0,g=n.length;l<g;l++){var k=n[l];this.insertNode(k,j,i)}},insertNodes:function(l,k,i){if(!mini.isNumber(k)){return}if(!mini.isArray(l)){return}if(!i){i=this.root}this.beginChange();var n=this._createNodes(i);if(k<0||k>n.length){k=n.length}l=l.clone();for(var j=0,g=l.length;j<g;j++){this.insertNode(l[j],k+j,i)}this.endChange();return l},removeNode:function(g){var f=this.getParentNode(g);if(!f){return}var d=this.indexOfNode(g);return this.removeNodeAt(d,f)},removeNodes:function(d){if(!mini.isArray(d)){return}this.beginChange();d=d.clone();for(var g=0,f=d.length;g<f;g++){this.removeNode(d[g])}this.endChange()},moveNodes:function(i,k,l){if(!i||i.length==0||!k||!l){return}this.beginChange();var n=this;mini.sort(i,function(a,b){return n.indexOf(a)>n.indexOf(b)},this);for(var p=0,j=i.length;p<j;p++){var o=i[p];this.moveNode(o,k,l);if(p!=0){k=o;l="after"}}this.endChange()},moveNode:function(v,p,u){if(!v||!p||mini.isNull(u)){return}if(this.viewNodes){var s=p;var r=u;if(r=="before"){s=this.getParentNode(p);r=this.indexOfNode(p)}else{if(r=="after"){s=this.getParentNode(p);r=this.indexOfNode(p)+1}else{if(r=="add"||r=="append"){if(!s[this.nodesField]){s[this.nodesField]=[]}r=s[this.nodesField].length}else{if(!mini.isNumber(r)){return}}}}if(this.isAncestor(v,s)){return false}var n=this.getChildNodes(s);if(r<0||r>n.length){r=n.length}var o={};n.insert(r,o);var l=this.getParentNode(v);var t=this.getChildNodes(l);t.remove(v);r=n.indexOf(o);n[r]=v}var s=p;var r=u;var n=this._createNodes(s);if(r=="before"){s=this.getParentNode(p);n=this._createNodes(s);r=n.indexOf(p)}else{if(r=="after"){s=this.getParentNode(p);n=this._createNodes(s);r=n.indexOf(p)+1}else{if(r=="add"||r=="append"){r=n.length}else{if(!mini.isNumber(r)){return}}}}if(this.isAncestor(v,s)){return false}if(r<0||r>n.length){r=n.length}var o={};n.insert(r,o);var l=this.getParentNode(v);l[this.nodesField].remove(v);r=n.indexOf(o);n[r]=v;this._updateParentAndLevel(v,s);this._dataChanged();var q={parentNode:s,index:r,node:v};this.fire("movenode",q)},insertNode:function(p,q,j){if(!p){return}if(!j){j=this.root;q="add"}if(!mini.isNumber(q)){switch(q){case"before":q=this.indexOfNode(j);j=this.getParentNode(j);this.insertNode(p,q,j);break;case"after":q=this.indexOfNode(j);j=this.getParentNode(j);this.insertNode(p,q+1,j);break;case"append":case"add":this.addNode(p,j);break;default:break}return}var k=this._createNodes(j);var r=this.getChildNodes(j);if(q<0){q=r.length}r.insert(q,p);q=r.indexOf(p);if(this.viewNodes){var l=r[q-1];if(l){var n=k.indexOf(l);k.insert(n+1,p)}else{k.insert(0,p)}}p._pid=j._id;this._setAdded(p);this.cascadeChild(p,function(a,c,b){a._pid=b._id;this._setAdded(a)},this);this._dataChanged();var o={parentNode:j,index:q,node:p};this.fire("addnode",o);return p},removeNodeAt:function(n,i){if(!i){i=this.root}var o=this.getChildNodes(i);var l=o[n];if(!l){return null}o.removeAt(n);if(this.viewNodes){var j=i[this.nodesField];j.remove(l)}this._setRemoved(l);this.cascadeChild(l,function(a,c,b){this._setRemoved(a)},this);this._checkSelecteds();this._dataChanged();var k={parentNode:i,index:n,node:l};this.fire("removenode",k);return l},bubbleParent:function(i,j,f){f=f||this;if(i){j.call(this,i)}var g=this.getParentNode(i);if(g&&g!=this.root){this.bubbleParent(g,j,f)}},cascadeChild:function(k,l,n){if(!l){return}if(!k){k=this.root}var c=k[this.nodesField];if(c){c=c.clone();for(var o=0,i=c.length;o<i;o++){var j=c[o];if(l.call(n||this,j,o,k)===false){return}this.cascadeChild(j,l,n)}}},eachChild:function(n,o,p){if(!o||!n){return}var i=n[this.nodesField];if(i){var l=i.clone();for(var q=0,j=l.length;q<j;q++){var k=l[q];if(o.call(p||this,k,q,n)===false){break}}}},collapse:function(d,f){d=this.getNode(d);if(!d){return}this.beginChange();d.expanded=false;if(f){this.eachChild(d,function(a){if(a[this.nodesField]!=null){this.collapse(a,f)}},this)}this.endChange();var g={node:d};this.fire("collapse",g)},expand:function(d,f){d=this.getNode(d);if(!d){return}this.beginChange();d.expanded=true;if(f){this.eachChild(d,function(a){if(a[this.nodesField]!=null){this.expand(a,f)}},this)}this.endChange();var g={node:d};this.fire("expand",g)},toggle:function(b){if(this.isExpandedNode(b)){this.collapse(b)}else{this.expand(b)}},expandNode:function(b){this.expand(b)},collapseNode:function(b){this.collapse(b)},collapseAll:function(){this.collapse(this.root,true)},expandAll:function(){this.expand(this.root,true)},collapseLevel:function(c,d){this.beginChange();this.each(function(a){var b=this.getLevel(a);if(c==b){this.collapse(a,d)}},this);this.endChange()},expandLevel:function(c,d){this.beginChange();this.each(function(a){var b=this.getLevel(a);if(c==b){this.expand(a,d)}},this);this.endChange()},expandPath:function(i){i=this.getNode(i);if(!i){return}var f=this.getAncestors(i);for(var j=0,g=f.length;j<g;j++){this.expandNode(f[j])}},collapsePath:function(i){i=this.getNode(i);if(!i){return}var f=this.getAncestors(i);for(var j=0,g=f.length;j<g;j++){this.collapseNode(f[j])}},isAncestor:function(g,i){if(g==i){return true}if(!g||!i){return false}if(g==this.getRootNode()){return true}var k=this.getAncestors(i);for(var j=0,f=k.length;j<f;j++){if(k[j]==g){return true}}return false},getAncestors:function(g){var d=[];while(1){var f=this.getParentNode(g);if(!f||f==this.root){break}d[d.length]=f;g=f}d.reverse();return d},getNode:function(b){return this.getRecord(b)},getRootNode:function(){return this.root},getParentNode:function(b){if(!b){return null}return this.getby_id(b._pid)},getAllChildNodes:function(b){return this.getChildNodes(b,true)},getChildNodes:function(r,k,i){r=this.getNode(r);if(!r){r=this.getRootNode()}var s=r[this.nodesField];if(this.viewNodes&&i!==false){s=this.viewNodes[r._id]}if(k===true&&s){var l=[];for(var p=0,q=s.length;p<q;p++){var n=s[p];l[l.length]=n;var o=this.getChildNodes(n,k,i);if(o&&o.length>0){l.addRange(o)}}s=l}return s||[]},getChildNodeAt:function(d,g){var f=this.getChildNodes(g);if(f){return f[d]}return null},hasChildNodes:function(c){var d=this.getChildNodes(c);return d.length>0},getLevel:function(b){return b._level},_is_true:function(b){return b===true||b===1||b==="Y"||b==="y"},_is_false:function(b){return b===false||b===0||b==="N"||b==="n"},leafField:"isLeaf",isLeafNode:function(b){return this.isLeaf(b)},isLeaf:function(g){if(!g){return false}var d=g[this.leafField];if(!g||this._is_false(d)){return false}var f=this.getChildNodes(g,false,false);if(f.length>0){return false}return true},hasChildren:function(c){var d=this.getChildNodes(c);return !!(d&&d.length>0)},isFirstNode:function(c){if(c==this.root){return true}var d=this.getParentNode(c);if(!d){return false}return this.getFirstNode(d)==c},isLastNode:function(c){if(c==this.root){return true}var d=this.getParentNode(c);if(!d){return false}return this.getLastNode(d)==c},isCheckedNode:function(b){return b.checked===true},isExpandedNode:function(b){return b.expanded==true||b.expanded==1||mini.isNull(b.expanded)},isEnabledNode:function(b){return b.enabled!==false},isVisibleNode:function(d){if(d.visible==false){return false}var c=this._ids[d._pid];if(!c||c==this.root){return true}if(c.expanded===false){return false}return this.isVisibleNode(c)},getNextNode:function(g){var f=this.getby_id(g._pid);if(!f){return null}var d=this.indexOfNode(g);return this.getChildNodes(f)[d+1]},getPrevNode:function(g){var f=this.getby_id(g._pid);if(!f){return null}var d=this.indexOfNode(g);return this.getChildNodes(f)[d-1]},getFirstNode:function(b){return this.getChildNodes(b)[0]},getLastNode:function(d){var c=this.getChildNodes(d);return c[c.length-1]},indexOfNode:function(c){var d=this.getby_id(c._pid);if(d){return this.getChildNodes(d).indexOf(c)}return -1},indexOfList:function(b){return this.getList().indexOf(b)},getAt:function(b){return this.getVisibleRows()[b]},indexOf:function(b){return this.getVisibleRows().indexOf(b)},getRange:function(k,i){if(k>i){var o=k;k=i;i=o}var n=this.getChildNodes(this.root,true);var q=[];for(var p=k,j=i;p<=j;p++){var l=n[p];if(l){q.push(l)}}return q},selectRange:function(i,g){var j=this.getChildNodes(this.root,true);if(!mini.isNumber(i)){i=j.indexOf(i)}if(!mini.isNumber(g)){g=j.indexOf(g)}if(mini.isNull(i)||mini.isNull(g)){return}var f=this.getRange(i,g);this.selects(f)},findRecords:function(l,n){var s=this.toArray();var p=typeof l=="function";var o=l;var i=n||this;var u=[];for(var r=0,t=s.length;r<t;r++){var v=s[r];if(p){var q=o.call(i,v);if(q==true){u[u.length]=v}if(q===1){break}}else{if(v[l]==n){u[u.length]=v}}}return u},_dataChangedCount:0,_dataChanged:function(){this._dataChangedCount++;this.dataview=null;this.visibleRows=null;if(this.__changeCount==0){this.fire("datachanged")}},_createDataView:function(){var b=this.getChildNodes(this.root,true);return b},_createVisibleRows:function(){var i=this.getChildNodes(this.root,true);var f=[];for(var k=0,g=i.length;k<g;k++){var j=i[k];if(this.isVisibleNode(j)){f[f.length]=j}}return f},getList:function(){return mini.treeToList(this.source,this.nodesField)},getDataView:function(){if(!this.dataview){this.dataview=this._createDataView()}return this.dataview.clone()},getVisibleRows:function(){if(!this.visibleRows){this.visibleRows=this._createVisibleRows()}return this.visibleRows},_doFilter:function(){if(!this._filterInfo){this.viewNodes=null;return}var j=this._filterInfo[0],k=this._filterInfo[1];var g=this.viewNodes={},i=this.nodesField;function f(l){var s=l[i];if(!s){return false}var r=l._id;var b=g[r]=[];for(var c=0,d=s.length;c<d;c++){var t=s[c];var q=f(t);var a=j.call(k,t,c,this);if(a===true||q){b.push(t)}}return b.length>0}f(this.root)},_doSort:function(){if(!this._filterInfo&&!this._sortInfo){this.viewNodes=null;return}if(!this._sortInfo){return}var n=this._sortInfo[0],o=this._sortInfo[1],i=this._sortInfo[2];var k=this.nodesField;if(!this.viewNodes){var j=this.viewNodes={};j[this.root._id]=this.root[k].clone();this.cascadeChild(this.root,function(b,c,a){var d=b[k];if(d){j[b._id]=d.clone()}})}var l=this;function p(f){var c=l.getChildNodes(f);mini.sort(c,n,o);if(i){c.reverse()}for(var b=0,d=c.length;b<d;b++){var a=c[b];p(a)}}p(this.root)},toArray:function(){if(!this._array||this._dataChangedCount!=this._dataChangedCount2){this._dataChangedCount2=this._dataChangedCount;this._array=this.getChildNodes(this.root,true,false)}return this._array},toTree:function(){return this.root[this.nodesField]},isChanged:function(){return this.getChanges().length>0},getChanges:function(u,r){var o=[];if(u=="removed"||u==null){o.addRange(this._removeds.clone())}this.cascadeChild(this.root,function(b,a,c){if(b._state==null||b._state==""){return}if(b._state==u||u==null){o[o.length]=b}},this);var i=o;if(r){for(var s=0,t=i.length;s<t;s++){var l=i[s];if(l._state=="modified"){var n={};n[this.idField]=l[this.idField];for(var p in l){var q=this.isModified(l,p);if(q){n[p]=l[p]}}i[s]=n}}}return o},accept:function(b){b=b||this.root;this.beginChange();this.cascadeChild(this.root,function(a){this.acceptRecord(a)},this);this._removeds=[];this._originals={};this.endChange()},reject:function(b){this.beginChange();this.cascadeChild(this.root,function(a){this.rejectRecord(a)},this);this._removeds=[];this._originals={};this.endChange()},acceptRecord:function(b){if(!b._state){return}delete this._originals[b[this._originalIdField]];if(b._state=="deleted"){this.removeNode(b)}else{delete b._state;delete this._originals[b[this._originalIdField]];this._dataChanged();this.fire("update",{record:b})}},rejectRecord:function(d){if(!d._state){return}if(d._state=="added"){this.removeNode(d)}else{if(d._state=="modified"||d._state=="deleted"){var c=this._getOriginal(d);mini.copyTo(d,c);delete d._state;delete this._originals[d[this._originalIdField]];this._dataChanged();this.fire("update",{record:d})}}},upGrade:function(r){var o=this.getParentNode(r);if(o==this.root||r==this.root){return false}var q=o[this.nodesField];var l=q.indexOf(r);var k=r[this.nodesField]?r[this.nodesField].length:0;for(var n=q.length-1;n>=l;n--){var s=q[n];q.removeAt(n);if(s!=r){if(!r[this.nodesField]){r[this.nodesField]=[]}r[this.nodesField].insert(k,s)}}var p=this.getParentNode(o);var i=p[this.nodesField];var l=i.indexOf(o);i.insert(l+1,r);this._updateParentAndLevel(r,p);this._doFilter();this._dataChanged()},downGrade:function(i){if(this.isFirstNode(i)){return false}var j=this.getParentNode(i);var k=j[this.nodesField];var f=k.indexOf(i);var g=k[f-1];k.removeAt(f);if(!g[this.nodesField]){g[this.nodesField]=[]}g[this.nodesField].add(i);this._updateParentAndLevel(i,g);this._doFilter();this._dataChanged()},_updateParentAndLevel:function(g,f){var d=this;g._pid=f._id;g._level=f._level+1;g[d.parentField]=f[d.idField];this.cascadeChild(g,function(a,c,b){a._pid=b._id;a._level=b._level+1;a[d.parentField]=b[d.idField]},this);this._setModified(g)},setCheckModel:function(b){this.checkModel=b},getCheckModel:function(){return this.checkModel},setOnlyLeafCheckable:function(b){this.onlyLeafCheckable=b},getOnlyLeafCheckable:function(){return this.onlyLeafCheckable},setAutoCheckParent:function(b){this.autoCheckParent=b},getAutoCheckParent:function(){return this.autoCheckParent},_doUpdateLoadedCheckedNodes:function(){var f=this.getAllChildNodes(this.root);for(var j=0,g=f.length;j<g;j++){var i=f[j];if(i.checked==true){if(this.autoCheckParent==false||!this.hasChildNodes(i)){this._doUpdateNodeCheckState(i)}}}},_doUpdateNodeCheckState:function(z){if(!z){return}var r=this.isChecked(z);if(this.checkModel=="cascade"||this.autoCheckParent){this.cascadeChild(z,function(a){this.doCheckNodes(a,r)},this);if(!this.autoCheckParent){var q=this.getAncestors(z);q.reverse();for(var w=0,y=q.length;w<y;w++){var v=q[w];var l=this.getChildNodes(v);var i=true;for(var p=0,s=l.length;p<s;p++){var t=l[p];if(!this.isCheckedNode(t)){i=false}}if(i){this.doCheckNodes(v,true)}else{this.doCheckNodes(v,false)}this.fire("checkchanged",{nodes:[v],_nodes:[v]})}}}var u=this;function x(f){var c=u.getChildNodes(f);for(var b=0,d=c.length;b<d;b++){var a=c[b];if(u.isCheckedNode(a)){return true}}return false}if(this.autoCheckParent){var q=this.getAncestors(z);q.reverse();for(var w=0,y=q.length;w<y;w++){var v=q[w];v.checked=x(v);this.fire("checkchanged",{nodes:[v],_nodes:[v]})}}},doCheckNodes:function(i,l,j){if(!i){return}if(typeof i=="string"){i=i.split(",")}if(!mini.isArray(i)){i=[i]}i=i.clone();var k=[];l=l!==false;if(j===true){if(this.checkModel=="single"){this.uncheckAllNodes()}}for(var p=i.length-1;p>=0;p--){var n=this.getRecord(i[p]);if(!n||(l&&n.checked===true)||(!l&&n.checked!==true)){if(n){if(j===true){this._doUpdateNodeCheckState(n)}if(!l&&!this.isLeaf(n)){k.push(n)}}continue}n.checked=l;k.push(n);if(j===true){this._doUpdateNodeCheckState(n)}}var o=this;setTimeout(function(){o.fire("checkchanged",{nodes:i,_nodes:k,checked:l})},1)},checkNode:function(c,d){this.doCheckNodes([c],true,d!==false)},uncheckNode:function(c,d){this.doCheckNodes([c],false,d!==false)},checkNodes:function(c,d){if(!mini.isArray(c)){c=[]}this.doCheckNodes(c,true,d!==false)},uncheckNodes:function(c,d){if(!mini.isArray(c)){c=[]}this.doCheckNodes(c,false,d!==false)},checkAllNodes:function(){var b=this.getList();this.doCheckNodes(b,true,false)},uncheckAllNodes:function(){var b=this.getList();this.doCheckNodes(b,false,false)},getCheckedNodes:function(g){if(g===false){g="leaf"}var f=[];var d={};this.cascadeChild(this.root,function(a){if(a.checked==true){var i=this.isLeafNode(a);if(g===true){if(!d[a._id]){d[a._id]=a;f.push(a)}var k=this.getAncestors(a);for(var c=0,l=k.length;c<l;c++){var b=k[c];if(!d[b._id]){d[b._id]=b;f.push(b)}}}else{if(g==="parent"){if(!i){if(!d[a._id]){d[a._id]=a;f.push(a)}}}else{if(g==="leaf"){if(i){if(!d[a._id]){d[a._id]=a;f.push(a)}}}else{if(!d[a._id]){d[a._id]=a;f.push(a)}}}}}},this);return f},getCheckedNodesId:function(i,f){var g=this.getCheckedNodes(i);var j=this.getValueAndText(g,f);return j[0]},getCheckedNodesText:function(i,f){var g=this.getCheckedNodes(i);var j=this.getValueAndText(g,f);return j[1]},isChecked:function(b){b=this.getRecord(b);if(!b){return null}return b.checked===true||b.checked===1},getCheckState:function(i){i=this.getRecord(i);if(!i){return null}if(i.checked===true){return"checked"}if(!i[this.nodesField]){return"unchecked"}var j=this.getChildNodes(i,true);for(var f=0,g=j.length;f<g;f++){var i=j[f];if(i.checked===true){return"indeterminate"}}return"unchecked"},getUnCheckableNodes:function(){var b=[];this.cascadeChild(this.root,function(d){var a=this.getCheckable(d);if(a==false){b.push(d)}},this);return b},setCheckable:function(f,g){if(!f){return}if(!mini.isArray(f)){f=[f]}f=f.clone();g=!!g;for(var j=f.length-1;j>=0;j--){var i=this.getRecord(f[j]);if(!i){continue}i.checkable=checked}},getCheckable:function(b){b=this.getRecord(b);if(!b){return false}if(b.checkable===true){return true}if(b.checkable===false){return false}return this.isLeafNode(b)?true:!this.onlyLeafCheckable},showNodeCheckbox:function(c,d){},reload:function(g,d,f){this._loadingNode=null;this.load(this.loadParams,g,d,f)},_isNodeLoading:function(){return !!this._loadingNode},loadNode:function(l,i){this._loadingNode=l;var j={node:l};this.fire("beforeloadnode",j);var k=new Date();var g=this;g._doLoadAjax(g.loadParams,null,null,null,function(a){var b=new Date()-k;if(b<60){b=60-b}setTimeout(function(){a.node=l;g._OnPreLoad(a);a.node=g._loadingNode;g._loadingNode=null;var c=l[g.nodesField];g.removeNodes(c);var d=a.data;if(d&&d.length>0){g.addNodes(d,l);if(i!==false){g.expand(l,true)}else{g.collapse(l,true)}}else{delete l[g.leafField];g.expand(l,true)}g.fire("loadnode",a);g.fire("load",a)},b)},true)}});mini.regClass(mini.DataTree,"datatree");mini._DataTableApplys={idField:"id",textField:"text",setAjaxData:function(b){this._dataSource.ajaxData=b},getby_id:function(b){return this._dataSource.getby_id(b)},getValueAndText:function(c,d){return this._dataSource.getValueAndText(c,d)},setIdField:function(b){this._dataSource.setIdField(b);this.idField=b},getIdField:function(){return this._dataSource.idField},setTextField:function(b){this._dataSource.setTextField(b);this.textField=b},getTextField:function(){return this._dataSource.textField},clearData:function(){this._dataSource.clearData()},loadData:function(b){this._dataSource.loadData(b)},setData:function(b){this._dataSource.loadData(b)},getData:function(){return this._dataSource.getSource().clone()},getList:function(){return this._dataSource.getList()},getDataView:function(){return this._dataSource.getDataView()},getVisibleRows:function(){if(this._useEmptyView){return[]}return this._dataSource.getVisibleRows()},toArray:function(){return this._dataSource.toArray()},getRecord:function(b){return this._dataSource.getRecord(b)},getRow:function(b){return this._dataSource.getRow(b)},getRange:function(c,d){if(mini.isNull(c)||mini.isNull(d)){return}return this._dataSource.getRange(c,d)},getAt:function(b){return this._dataSource.getAt(b)},indexOf:function(b){return this._dataSource.indexOf(b)},getRowByUID:function(b){return this._dataSource.getby_id(b)},getRowById:function(b){return this._dataSource.getbyId(b)},clearRows:function(){this._dataSource.clearData()},updateRow:function(f,g,d){this._dataSource.updateRecord(f,g,d)},addRow:function(d,c){return this._dataSource.insert(c,d)},removeRow:function(d,c){return this._dataSource.remove(d,c)},removeRows:function(d,c){return this._dataSource.removeRange(d,c)},removeRowAt:function(c,d){return this._dataSource.removeAt(c,d)},moveRow:function(c,d){this._dataSource.move(c,d)},addRows:function(d,c){return this._dataSource.insertRange(c,d)},findRows:function(c,d){return this._dataSource.findRecords(c,d)},findRow:function(c,d){return this._dataSource.findRecord(c,d)},multiSelect:false,setMultiSelect:function(b){this._dataSource.setMultiSelect(b);this.multiSelect=b},getMultiSelect:function(){return this._dataSource.getMultiSelect()},setCurrent:function(b){this._dataSource.setCurrent(b)},getCurrent:function(){return this._dataSource.getCurrent()},isSelected:function(b){return this._dataSource.isSelected(b)},setSelected:function(b){this._dataSource.setSelected(b)},getSelected:function(){return this._dataSource.getSelected()},getSelecteds:function(){return this._dataSource.getSelecteds()},select:function(d,c){this._dataSource.select(d,c)},selects:function(d,c){this._dataSource.selects(d,c)},deselect:function(d,c){this._dataSource.deselect(d,c)},deselects:function(d,c){this._dataSource.deselects(d,c)},selectAll:function(b){this._dataSource.selectAll(b)},deselectAll:function(b){this._dataSource.deselectAll(b)},clearSelect:function(b){this.deselectAll(b)},selectPrev:function(){this._dataSource.selectPrev()},selectNext:function(){this._dataSource.selectNext()},selectFirst:function(){this._dataSource.selectFirst()},selectLast:function(){this._dataSource.selectLast()},selectRange:function(c,d){this._dataSource.selectRange(c,d)},filter:function(c,d){this._dataSource.filter(c,d)},clearFilter:function(){this._dataSource.clearFilter()},sort:function(c,d){this._dataSource.sort(c,d)},clearSort:function(){this._dataSource.clearSort()},findItems:function(b,c,a){return this._dataSource.findRecords(a,c,a)},getResultObject:function(){return this._dataSource._resultObject||{}},isChanged:function(){return this._dataSource.isChanged()},getChanges:function(c,d){return this._dataSource.getChanges(c,d)},accept:function(){this._dataSource.accept()},reject:function(){this._dataSource.reject()},acceptRecord:function(b){this._dataSource.acceptRecord(b)},rejectRecord:function(b){this._dataSource.rejectRecord(b)}};mini._DataTreeApplys={addRow:null,removeRow:null,removeRows:null,removeRowAt:null,moveRow:null,setExpandOnLoad:function(b){this._dataSource.setExpandOnLoad(b)},getExpandOnLoad:function(){return this._dataSource.getExpandOnLoad()},isSelectedNode:function(b){b=this.getNode(b);return this.getSelectedNode()===b},selectNode:function(c,d){if(c){this._dataSource.select(c,d)}else{this._dataSource.deselect(this.getSelectedNode(),d)}},getSelectedNode:function(){return this.getSelected()},getSelectedNodes:function(){return this.getSelecteds()},updateNode:function(f,g,d){this._dataSource.updateRecord(f,g,d)},addNode:function(d,g,f){return this._dataSource.insertNode(d,g,f)},removeNodeAt:function(c,d){return this._dataSource.removeNodeAt(c,d);this._changed=true},removeNode:function(b){return this._dataSource.removeNode(b)},moveNode:function(f,d,g){this._dataSource.moveNode(f,d,g)},addNodes:function(d,f,g){return this._dataSource.addNodes(d,f,g)},insertNodes:function(d,g,f){return this._dataSource.insertNodes(g,d,f)},moveNodes:function(f,g,d){this._dataSource.moveNodes(f,g,d)},removeNodes:function(b){return this._dataSource.removeNodes(b)},expandOnLoad:false,checkRecursive:true,autoCheckParent:false,showFolderCheckBox:true,idField:"id",textField:"text",parentField:"pid",nodesField:"children",checkedField:"checked",leafField:"isLeaf",resultAsTree:true,setShowFolderCheckBox:function(b){this._dataSource.setShowFolderCheckBox(b);if(this.doUpdate){this.doUpdate()}this.showFolderCheckBox=b},getShowFolderCheckBox:function(){return this._dataSource.getShowFolderCheckBox()},setCheckRecursive:function(b){this._dataSource.setCheckRecursive(b);this.checkRecursive=b},getCheckRecursive:function(){return this._dataSource.getCheckRecursive()},setResultAsTree:function(b){this._dataSource.setResultAsTree(b)},getResultAsTree:function(b){return this._dataSource.resultAsTree},setParentField:function(b){this._dataSource.setParentField(b);this.parentField=b},getParentField:function(){return this._dataSource.parentField},setLeafField:function(b){this._dataSource.leafField=b;this.leafField=b},getLeafField:function(){return this._dataSource.leafField},setNodesField:function(b){this._dataSource.setNodesField(b);this.nodesField=b},getNodesField:function(){return this._dataSource.nodesField},setCheckedField:function(b){this._dataSource.checkedField=b;this.checkedField=b},getCheckedField:function(){return this.checkedField},findNodes:function(c,d){return this._dataSource.findRecords(c,d)},getLevel:function(b){return this._dataSource.getLevel(b)},isVisibleNode:function(b){return this._dataSource.isVisibleNode(b)},isEnabledNode:function(b){return this._dataSource.isEnabledNode(b)},isExpandedNode:function(b){return this._dataSource.isExpandedNode(b)},isCheckedNode:function(b){return this._dataSource.isCheckedNode(b)},isLeaf:function(b){return this._dataSource.isLeafNode(b)},hasChildren:function(b){return this._dataSource.hasChildren(b)},isAncestor:function(c,d){return this._dataSource.isAncestor(c,d)},getNode:function(b){return this._dataSource.getRecord(b)},getRootNode:function(){return this._dataSource.getRootNode()},getParentNode:function(b){return this._dataSource.getParentNode.apply(this._dataSource,arguments)},getAncestors:function(b){return this._dataSource.getAncestors(b)},getAllChildNodes:function(b){return this._dataSource.getAllChildNodes.apply(this._dataSource,arguments)},getChildNodes:function(c,d){return this._dataSource.getChildNodes.apply(this._dataSource,arguments)},getChildNodeAt:function(d,c){return this._dataSource.getChildNodeAt.apply(this._dataSource,arguments)},indexOfNode:function(b){return this._dataSource.indexOfNode.apply(this._dataSource,arguments)},hasChildNodes:function(b){return this._dataSource.hasChildNodes.apply(this._dataSource,arguments)},isFirstNode:function(b){return this._dataSource.isFirstNode.apply(this._dataSource,arguments)},isLastNode:function(b){return this._dataSource.isLastNode.apply(this._dataSource,arguments)},getNextNode:function(b){return this._dataSource.getNextNode.apply(this._dataSource,arguments)},getPrevNode:function(b){return this._dataSource.getPrevNode.apply(this._dataSource,arguments)},getFirstNode:function(b){return this._dataSource.getFirstNode.apply(this._dataSource,arguments)},getLastNode:function(b){return this._dataSource.getLastNode.apply(this._dataSource,arguments)},toggleNode:function(b){this._dataSource.toggle(b)},collapseNode:function(c,d){this._dataSource.collapse(c,d)},expandNode:function(c,d){this._dataSource.expand(c,d)},collapseAll:function(){this.useAnimation=false;this._dataSource.collapseAll();this.useAnimation=true},expandAll:function(){this.useAnimation=false;this._dataSource.expandAll();this.useAnimation=true},expandLevel:function(b){this.useAnimation=false;this._dataSource.expandLevel(b);this.useAnimation=true},collapseLevel:function(b){this.useAnimation=false;this._dataSource.collapseLevel(b);this.useAnimation=true},expandPath:function(b){this.useAnimation=false;this._dataSource.expandPath(b);this.useAnimation=true},collapsePath:function(b){this.useAnimation=false;this._dataSource.collapsePath(b);this.useAnimation=true},loadNode:function(c,d){this._dataSource.loadNode(c,d)},setCheckModel:function(b){this._dataSource.setCheckModel(b)},getCheckModel:function(){return this._dataSource.getCheckModel()},setOnlyLeafCheckable:function(b){this._dataSource.setOnlyLeafCheckable(b)},getOnlyLeafCheckable:function(){return this._dataSource.getOnlyLeafCheckable()},setAutoCheckParent:function(b){this._dataSource.setAutoCheckParent(b)},getAutoCheckParent:function(){return this._dataSource.getAutoCheckParent()},checkNode:function(c,d){this._dataSource.checkNode(c,d)},uncheckNode:function(c,d){this._dataSource.uncheckNode(c,d)},checkNodes:function(c,d){this._dataSource.checkNodes(c,d)},uncheckNodes:function(c,d){this._dataSource.uncheckNodes(c,d)},checkAllNodes:function(){this._dataSource.checkAllNodes()},uncheckAllNodes:function(){this._dataSource.uncheckAllNodes()},getCheckedNodes:function(){return this._dataSource.getCheckedNodes.apply(this._dataSource,arguments)},getCheckedNodesId:function(){return this._dataSource.getCheckedNodesId.apply(this._dataSource,arguments)},getCheckedNodesText:function(){return this._dataSource.getCheckedNodesText.apply(this._dataSource,arguments)},getNodesByValue:function(j){if(mini.isNull(j)){j=""}j=String(j);var g=[];var l=String(j).split(",");for(var n=0,i=l.length;n<i;n++){var k=this.getNode(l[n]);if(k){g.push(k)}}return g},isChecked:function(b){return this._dataSource.isChecked.apply(this._dataSource,arguments)},getCheckState:function(b){return this._dataSource.getCheckState.apply(this._dataSource,arguments)},setCheckable:function(c,d){this._dataSource.setCheckable.apply(this._dataSource,arguments)},getCheckable:function(b){return this._dataSource.getCheckable.apply(this._dataSource,arguments)},bubbleParent:function(g,d,f){this._dataSource.bubbleParent.apply(this._dataSource,arguments)},cascadeChild:function(g,d,f){this._dataSource.cascadeChild.apply(this._dataSource,arguments)},eachChild:function(g,d,f){this._dataSource.eachChild.apply(this._dataSource,arguments)}};mini.ColumnModel=function(b){this.owner=b;mini.ColumnModel.superclass.constructor.call(this);this._init()};mini.ColumnModel_ColumnID=1;mini.extend(mini.ColumnModel,mini.Component,{_defaultColumnWidth:100,_init:function(){this.columns=[];this._columnsRow=[];this._visibleColumnsRow=[];this._bottomColumns=[];this._visibleColumns=[];this._idColumns={};this._nameColumns={};this._fieldColumns={}},getColumns:function(){return this.columns},getAllColumns:function(){var f=[];for(var g in this._idColumns){var d=this._idColumns[g];f.push(d)}return f},getColumnsRow:function(){return this._columnsRow},getVisibleColumnsRow:function(){return this._visibleColumnsRow},getBottomColumns:function(){return this._bottomColumns},getVisibleColumns:function(){return this._visibleColumns},_getBottomColumnsByColumn:function(k){k=this.getColumn(k);var n=this._bottomColumns;var l=[];for(var c=0,i=n.length;c<i;c++){var j=n[c];if(this.isAncestorColumn(k,j)){l.push(j)}}return l},_getVisibleColumnsByColumn:function(k){k=this.getColumn(k);var n=this._visibleColumns;var l=[];for(var c=0,i=n.length;c<i;c++){var j=n[c];if(this.isAncestorColumn(k,j)){l.push(j)}}return l},setColumns:function(b){if(!mini.isArray(b)){b=[]}this._init();this.columns=b;this._columnsChanged()},_columnsChanged:function(){this._updateColumnsView();this.fire("columnschanged")},_updateColumnsView:function(){this._maxColumnLevel=0;var level=0;function init(column,index,parentColumn){if(column.type){if(!mini.isNull(column.header)&&typeof column.header!=="function"){if(column.header.trim()==""){delete column.header}}var col=mini._getColumn(column.type);if(col){var _column=mini.copyTo({},column);mini.copyTo(column,col);mini.copyTo(column,_column)}}if(!column._id){column._id=mini.ColumnModel_ColumnID++}column._pid=parentColumn==this?-1:parentColumn._id;this._idColumns[column._id]=column;if(column.name){this._nameColumns[column.name]=column}column._level=level;level+=1;this.eachColumns(column,init,this);level-=1;if(column._level>this._maxColumnLevel){this._maxColumnLevel=column._level}var width=parseInt(column.width);if(mini.isNumber(width)&&String(width)==column.width){column.width=width+"px"}if(mini.isNull(column.width)){column.width=this._defaultColumnWidth+"px"}column.visible=column.visible!==false;column.allowResize=column.allowResize!==false;column.allowMove=column.allowMove!==false;column.allowSort=column.allowSort===true;column.allowDrag=!!column.allowDrag;column.readOnly=!!column.readOnly;column.autoEscape=!!column.autoEscape;column.enabled=column.enabled!==false;column.vtype=column.vtype||"";if(typeof column.filter=="string"){column.filter=eval("("+column.filter+")")}if(column.filter&&!column.filter.el){column.filter=mini.create(column.filter)}if(typeof column.init=="function"&&column.inited!=true){column.init(this.owner)}column.inited=true;column._gridUID=this.owner.uid;column._rowIdField=this.owner._rowIdField}this.eachColumns(this,init,this);this._createColumnsRow();var index=0;var view=this._visibleColumns=[];var bottoms=this._bottomColumns=[];this.cascadeColumns(this,function(column){if(!column.columns||column.columns.length==0){bottoms.push(column);if(this.isVisibleColumn(column)){view.push(column);column._index=index++}}},this);this._fieldColumns={};var columns=this.getAllColumns();for(var i=0,l=columns.length;i<l;i++){var column=columns[i];if(column.field&&!this._fieldColumns[column.field]){this._fieldColumns[column.field]=column}}this._createFrozenColSpan()},_frozenStartColumn:-1,_frozenEndColumn:-1,isFrozen:function(){return this._frozenStartColumn>=0&&this._frozenEndColumn>=this._frozenStartColumn},isFrozenColumn:function(c){if(!this.isFrozen()){return false}c=this.getColumn(c);if(!c){return false}var d=this.getVisibleColumns().indexOf(c);return this._frozenStartColumn<=d&&d<=this._frozenEndColumn},frozen:function(d,g){d=this.getColumn(d);g=this.getColumn(g);var f=this.getVisibleColumns();this._frozenStartColumn=f.indexOf(d);this._frozenEndColumn=f.indexOf(g);if(d&&g){this._columnsChanged()}},unFrozen:function(){this._frozenStartColumn=-1;this._frozenEndColumn=-1;this._columnsChanged()},setFrozenStartColumn:function(b){this.frozen(b,this._frozenEndColumn)},setFrozenEndColumn:function(b){this.frozen(this._frozenStartColumn,b)},getFrozenColumns:function(){var j=[],i=this.isFrozen();for(var f=0,g=this._visibleColumns.length;f<g;f++){if(i&&this._frozenStartColumn<=f&&f<=this._frozenEndColumn){j.push(this._visibleColumns[f])}}return j},getUnFrozenColumns:function(){var j=[],i=this.isFrozen();for(var f=0,g=this._visibleColumns.length;f<g;f++){if((i&&f>this._frozenEndColumn)||!i){j.push(this._visibleColumns[f])}}return j},getFrozenColumnsRow:function(){return this.isFrozen()?this._columnsRow1:[]},getUnFrozenColumnsRow:function(){return this.isFrozen()?this._columnsRow2:this.getVisibleColumnsRow()},_createFrozenColSpan:function(){var H=this;var F=this.getVisibleColumns();var D=this._frozenStartColumn,x=this._frozenEndColumn;function G(n,d){var o=H.isBottomColumn(n)?[n]:H._getVisibleColumnsByColumn(n);for(var b=0,g=o.length;b<g;b++){var a=o[b];var f=F.indexOf(a);if(d==0&&f<D){return true}if(d==1&&D<=f&&f<=x){return true}if(d==2&&f>x){return true}}return false}function C(b,d){var g=mini.treeToList(b.columns,"columns");var n=0;for(var o=0,f=g.length;o<f;o++){var a=g[o];if(H.isVisibleColumn(a)==false||G(a,d)==false){continue}if(!a.columns||a.columns.length==0){n+=1}}return n}var k=mini.treeToList(this.columns,"columns");for(var l=0,z=k.length;l<z;l++){var A=k[l];delete A.colspan0;delete A.colspan1;delete A.colspan2;delete A.viewIndex0;delete A.viewIndex1;delete A.viewIndex2;if(this.isFrozen()){if(A.columns&&A.columns.length>0){A.colspan1=C(A,1);A.colspan2=C(A,2);A.colspan0=C(A,0)}else{A.colspan1=1;A.colspan2=1;A.colspan0=1}if(G(A,0)){A["viewIndex"+0]=true}if(G(A,1)){A["viewIndex"+1]=true}if(G(A,2)){A["viewIndex"+2]=true}}}var E=this._getMaxColumnLevel();this._columnsRow1=[];this._columnsRow2=[];for(var l=0,z=this._visibleColumnsRow.length;l<z;l++){var B=this._visibleColumnsRow[l];var c=[];var j=[];this._columnsRow1.push(c);this._columnsRow2.push(j);for(var w=0,y=B.length;w<y;w++){var i=B[w];if(i.viewIndex1){c.push(i)}if(i.viewIndex2){j.push(i)}}}},_createColumnsRow:function(){var i=this._getMaxColumnLevel();var l=[];var v=[];for(var r=0,s=i;r<=s;r++){l.push([]);v.push([])}var o=this;function u(d){var g=mini.treeToList(d.columns,"columns");var b=0;for(var c=0,f=g.length;c<f;c++){var a=g[c];if(o.isVisibleColumn(a)==false){continue}if(!a.columns||a.columns.length==0){b+=1}}return b}var p=mini.treeToList(this.columns,"columns");for(var r=0,s=p.length;r<s;r++){var t=p[r];var n=l[t._level];var q=v[t._level];delete t.rowspan;delete t.colspan;if(t.columns&&t.columns.length>0){t.colspan=u(t)}if((!t.columns||t.columns.length==0)&&t._level<i){t.rowspan=i-t._level+1}n.push(t);if(this.isVisibleColumn(t)){q.push(t)}}this._columnsRow=l;this._visibleColumnsRow=v},_getMaxColumnLevel:function(){return this._maxColumnLevel},cascadeColumns:function(k,l,n){if(!l){return}var c=k.columns;if(c){c=c.clone();for(var o=0,i=c.length;o<i;o++){var j=c[o];if(l.call(n||this,j,o,k)===false){return}this.cascadeColumns(j,l,n)}}},eachColumns:function(n,o,p){var q=n.columns;if(q){var l=q.clone();for(var i=0,j=l.length;i<j;i++){var k=l[i];if(o.call(p,k,i,n)===false){break}}}},getColumn:function(d){var c=typeof d;if(c=="number"){return this._bottomColumns[d]}else{if(c=="object"){return d}else{return this._nameColumns[d]}}},getColumnByField:function(b){if(!b){return null}return this._fieldColumns[b]},_getColumnById:function(b){return this._idColumns[b]},_getDataTypeByField:function(k){var j="string";var n=this.getBottomColumns();for(var g=0,i=n.length;g<i;g++){var l=n[g];if(l.field==k){if(l.dataType){j=l.dataType.toLowerCase()}break}}return j},getParentColumn:function(c){c=this.getColumn(c);var d=c._pid;if(d==-1){return this}return this._idColumns[d]},getAncestorColumns:function(g){var d=[g];while(1){var f=this.getParentColumn(g);if(!f||f==this){break}d[d.length]=f;g=f}d.reverse();return d},isAncestorColumn:function(g,i){if(g==i){return true}if(!g||!i){return false}var k=this.getAncestorColumns(i);for(var j=0,f=k.length;j<f;j++){if(k[j]==g){return true}}return false},isVisibleColumn:function(l){l=this.getColumn(l);if(l.visible==false){return false}var n=this.getAncestorColumns(l);for(var o=0,j=n.length;o<j;o++){if(n[o].visible==false){return false}}var i=l.columns;if(i){var p=true;for(var o=0,j=i.length;o<j;o++){var k=i[o];if(this.isVisibleColumn(k)){p=false;break}}if(p){return false}}return true},isBottomColumn:function(b){b=this.getColumn(b);return !(b.columns&&b.columns.length>0)},updateColumn:function(c,d){c=this.getColumn(c);if(!c){return}mini.copyTo(c,d);this._columnsChanged()},moveColumn:function(l,n,k){l=this.getColumn(l);n=this.getColumn(n);if(!l||!n||!k||l==n){return}if(this.isAncestorColumn(l,n)){return}var i=this.getParentColumn(l);if(i){i.columns.remove(l)}var j=n;var g=k;if(g=="before"){j=this.getParentColumn(n);g=j.columns.indexOf(n)}else{if(g=="after"){j=this.getParentColumn(n);g=j.columns.indexOf(n)+1}else{if(g=="add"||g=="append"){if(!j.columns){j.columns=[]}g=j.columns.length}else{if(!mini.isNumber(g)){return}}}}j.columns.insert(g,l);this._columnsChanged()},addColumn:function(b){if(!b){return}delete b._id;this._columnsChanged()},removeColumn:function(){this._columnsChanged()}});mini.GridView=function(){this._createTime=new Date();this._createColumnModel();this._bindColumnModel();this.data=[];this._createSource();this._bindSource();this._initData();mini.GridView.superclass.constructor.call(this);this._doUpdateFilterRow();this._doUpdateSummaryRow();this.doUpdate()};mini.extend(mini.GridView,mini.Panel,{_displayStyle:"block",_rowIdField:"_id",width:"100%",showColumns:true,showFilterRow:false,showSummaryRow:false,showPager:false,allowCellWrap:false,allowHeaderWrap:false,showModified:true,showNewRow:true,showEmptyText:false,emptyText:"No data returned.",showHGridLines:true,showVGridLines:true,allowAlternating:false,_alternatingCls:"mini-grid-row-alt",_rowCls:"mini-grid-row",_cellCls:"mini-grid-cell",_headerCellCls:"mini-grid-headerCell",_rowSelectedCls:"mini-grid-row-selected",_rowHoverCls:"mini-grid-row-hover",_cellSelectedCls:"mini-grid-cell-selected",defaultRowHeight:21,fixedRowHeight:false,isFixedRowHeight:function(){return this.fixedRowHeight},fitColumns:true,isFitColumns:function(){return this.fitColumns},uiCls:"mini-gridview",_create:function(){mini.GridView.superclass._create.call(this);var j=this.el;mini.addClass(j,"mini-grid");mini.addClass(this._borderEl,"mini-grid-border");mini.addClass(this._viewportEl,"mini-grid-viewport");var i='<div class="mini-grid-pager"></div>';var k='<div class="mini-grid-filterRow"><div class="mini-grid-filterRow-view"></div><div class="mini-grid-scrollHeaderCell"></div></div>';var g='<div class="mini-grid-summaryRow"><div class="mini-grid-summaryRow-view"></div><div class="mini-grid-scrollHeaderCell"></div></div>';var n='<div class="mini-grid-columns"><div class="mini-grid-columns-view"></div><div class="mini-grid-scrollHeaderCell"></div></div>';this._columnsEl=mini.after(this._toolbarEl,n);this._filterEl=mini.after(this._columnsEl,k);this._rowsEl=this._bodyEl;mini.addClass(this._rowsEl,"mini-grid-rows");this._summaryEl=mini.after(this._rowsEl,g);this._bottomPagerEl=mini.after(this._summaryEl,i);this._columnsViewEl=this._columnsEl.childNodes[0];this._topRightCellEl=this._columnsEl.childNodes[1];this._rowsViewEl=mini.append(this._rowsEl,'<div class="mini-grid-rows-view"><div class="mini-grid-rows-content"></div></div>');this._rowsViewContentEl=this._rowsViewEl.firstChild;this._filterViewEl=this._filterEl.childNodes[0];this._summaryViewEl=this._summaryEl.childNodes[0];var l='<a href="#" class="mini-grid-focus" style="position:absolute;left:0px;top:0px;width:0px;height:0px;outline:none;" hideFocus onclick="return false" ></a>';this._focusEl=mini.append(this._borderEl,l)},destroy:function(j){if(this._dataSource){this._dataSource.destroy();this._dataSource=null}if(this._columnModel){this._columnModel.destroy();this._columnModel=null}if(this._pagers){var i=this._pagers.clone();for(var f=0,g=i.length;f<g;f++){i[f].destroy(j)}this._pagers=null}if(this._viewportEl){mini.clearEvent(this._viewportEl)}if(this._rowsViewEl){mini.clearEvent(this._rowsViewEl)}this._columnsEl=this._rowsEl=this._filterEl=this._summaryEl=this._bottomPagerEl=null;this._columnsViewEl=this._topRightCellEl=this._rowsViewEl=this._rowsViewContentEl=null;this._filterViewEl=this._summaryViewEl=this._focusEl=null;this._viewportEl=null;mini.GridView.superclass.destroy.call(this,j)},_initEvents:function(){mini.GridView.superclass._initEvents.call(this);mini.on(this._rowsViewEl,"scroll",this.__OnRowViewScroll,this)},_sizeChanged:function(){mini.GridView.superclass._sizeChanged.call(this)},_setBodyWidth:false,doLayout:function(){var n=this;if(!this.canLayout()){return}mini.GridView.superclass.doLayout.call(this);this._stopLayout();var q=this.isAutoHeight();var k=this._columnsViewEl.firstChild;var i=this._rowsViewContentEl.firstChild;var l=this._filterViewEl.firstChild;var j=this._summaryViewEl.firstChild;function o(a){if(this.isFitColumns()){i.style.width="100%";if(mini.isSafari||mini.isChrome||mini.isIE6){a.style.width=i.offsetWidth+"px"}else{if(this._rowsViewEl.scrollHeight>this._rowsViewEl.clientHeight+1){a.style.width="100%";a.parentNode.style.width="auto";a.parentNode.style.paddingRight="17px";if(mini.isIE8){mini.removeClass(this._rowsViewEl,"mini-grid-hidden-y")}}else{a.style.width="100%";a.parentNode.style.width="auto";a.parentNode.style.paddingRight="0px";if(mini.isIE8){mini.addClass(this._rowsViewEl,"mini-grid-hidden-y")}}}}else{i.style.width="0px";a.style.width="0px";if(mini.isSafari||mini.isChrome||mini.isIE6){}else{a.parentNode.style.width="100%";a.parentNode.style.paddingRight="0px"}}}o.call(this,k);o.call(this,l);o.call(this,j);this._syncScroll();var p=this;setTimeout(function(){mini.layout(p._filterEl);mini.layout(p._summaryEl)},10);if(mini.isIE10){setTimeout(function(){if(p.isFitColumns()){k.style.width="auto";k.offsetWidth;k.style.width="100%"}else{k.style.width="0px"}},0);mini.repaint(i)}},setBody:function(){},_createTopRowHTML:function(p){var l="";if(mini.isIE){if(mini.isIE6||mini.isIE7||!mini.boxModel){l+='<tr style="display:none;height:0px;">'}else{l+='<tr style="height:0px;">'}}else{l+='<tr style="height:0px;">'}for(var i=0,j=p.length;i<j;i++){var n=p[i];var o=n.width;var k=n._id;l+='<td id="'+k+'" style="padding:0;border:0;margin:0;height:0px;';if(n.width){l+="width:"+n.width}l+='" ></td>'}l+='<td style="width:0px;"></td>';l+="</tr>";return l},_createColumnsHTML:function(F,H,i){var i=i?i:this.getVisibleColumns();var j=['<table class="mini-grid-table" cellspacing="0" cellpadding="0" border="0">'];j.push(this._createTopRowHTML(i));var k=this.getSortField();var C=this.getSortOrder();for(var w=0,y=F.length;w<y;w++){var z=F[w];j[j.length]="<tr>";for(var v=0,A=z.length;v<A;v++){var B=z[v];var l=this._createHeaderText(B,H);var E=this._createHeaderCellId(B,H);var x="";if(k&&k==B.field){x=C=="asc"?"mini-grid-asc":"mini-grid-desc"}var G="";if(this.allowHeaderWrap==false){G=" mini-grid-headerCell-nowrap "}j[j.length]='<td id="';j[j.length]=E;j[j.length]='" class="mini-grid-headerCell '+x+" "+(B.headerCls||"")+" ";var D=!(B.columns&&B.columns.length>0);if(D){j[j.length]=" mini-grid-bottomCell "}if(v==A-1){j[j.length]=" mini-grid-rightCell "}j[j.length]='" style="';if(B.headerStyle){j[j.length]=B.headerStyle+";"}if(B.headerAlign){j[j.length]="text-align:"+B.headerAlign+";"}j[j.length]='" ';if(B.rowspan){j[j.length]='rowspan="'+B.rowspan+'" '}this._createColumnColSpan(B,j,H);j[j.length]='><div class="mini-grid-headerCell-outer"><div class="mini-grid-headerCell-inner '+G+'">';j[j.length]=l;if(x){j[j.length]='<span class="mini-grid-sortIcon"></span>'}j[j.length]='</div><div id="'+B._id+'" class="mini-grid-column-splitter"></div>';j[j.length]="</div></td>"}if(this.isFrozen()&&H==1){j[j.length]='<td class="mini-grid-headerCell" style="width:0;"><div class="mini-grid-headerCell-inner" style="';j[j.length]='">0</div></td>'}j[j.length]="</tr>"}j.push("</table>");return j.join("")},_createHeaderText:function(d,f){var g=d.header;if(typeof g=="function"){g=g.call(this,d)}if(mini.isNull(g)||g===""){g="&nbsp;"}return g},_createColumnColSpan:function(d,g,f){if(d.colspan){g[g.length]='colspan="'+d.colspan+'" '}},doUpdateColumns:function(){var i=this._columnsViewEl.scrollLeft;var j=this.getVisibleColumnsRow();var g=this._createColumnsHTML(j,2);var f='<div class="mini-grid-topRightCell"></div>';g+=f;this._columnsViewEl.innerHTML=g;this._columnsViewEl.scrollLeft=i},doUpdate:function(){if(this.canUpdate()==false){return}var n=this;var k=this._isCreating();var g=new Date();this._doUpdateSummaryRow();var i=this;var l=this.getScrollLeft();function j(){if(!i.el){return}i.doUpdateColumns();i.doUpdateRows();i.doLayout();i._doUpdateTimer=null}i.doUpdateColumns();if(k){this._useEmptyView=true}if(this._rowsViewContentEl&&this._rowsViewContentEl.firstChild){this._rowsViewContentEl.removeChild(this._rowsViewContentEl.firstChild)}if(this._rowsLockContentEl&&this._rowsLockContentEl.firstChild){this._rowsLockContentEl.removeChild(this._rowsLockContentEl.firstChild)}i.doUpdateRows();if(l>0&&i.isVirtualScroll()){i.setScrollLeft(l)}if(k){this._useEmptyView=false}i.doLayout();if(k&&!this._doUpdateTimer){this._doUpdateTimer=setTimeout(j,15)}this.unmask();if(n._fireUpdateTimer){clearTimeout(n._fireUpdateTimer);n._fireUpdateTimer=null}n._fireUpdateTimer=setTimeout(function(){n._fireUpdateTimer=null;n.fire("update")},100)},_isCreating:function(){return(new Date()-this._createTime)<1000},deferUpdate:function(c){if(!c){c=5}if(this._updateTimer||this._doUpdateTimer){return}var d=this;this._updateTimer=setTimeout(function(){d._updateTimer=null;d.doUpdate()},c)},_pushUpdateCallback:function(j,f,g){var i=0;if(this._doUpdateTimer||this._updateTimer){i=20}if(i==0){j.apply(f,g)}else{setTimeout(function(){j.apply(f,g)},i)}},_updateCount:0,beginUpdate:function(){this._updateCount++},endUpdate:function(b){this._updateCount--;if(this._updateCount==0||b===true){this._updateCount=0;this.doUpdate()}},canUpdate:function(){return this._updateCount==0},setDefaultRowHeight:function(b){this.defaultRowHeight=b},getDefaultRowHeight:function(){return this.defaultRowHeight},_getRowHeight:function(d){var c=this.defaultRowHeight;if(d._height){c=parseInt(d._height);if(isNaN(parseInt(d._height))){c=rowHeight}}c-=4;c-=1;return c},_createGroupingHTML:function(B,I){var C=this.getGroupingView();var F=this._showGroupSummary;var w=this.isFrozen();var k=0;var v=this;function x(c,b){u.push('<table class="mini-grid-table" cellspacing="0" cellpadding="0" border="0">');if(B.length>0){u.push(v._createTopRowHTML(B));for(var d=0,f=c.length;d<f;d++){var a=c[d];v._createRowHTML(a,k++,B,I,u)}}if(F){}u.push("</table>")}var u=['<table class="mini-grid-table" cellspacing="0" cellpadding="0" border="0">'];u.push(this._createTopRowHTML(B));for(var z=0,A=C.length;z<A;z++){if(I==1&&!this.isFrozen()){continue}var j=C[z];var D=this._createRowGroupId(j,I);var E=this._createRowGroupRowsId(j,I);var y=this._OnDrawGroup(j);var H=j.expanded?"":" mini-grid-group-collapse ";u[u.length]='<tr id="';u[u.length]=D;u[u.length]='" class="mini-grid-groupRow';u[u.length]=H;u[u.length]='"><td class="mini-grid-groupCell" colspan="';u[u.length]=B.length;u[u.length]='"><div class="mini-grid-groupHeader">';if(!w||(w&&I==1)){u[u.length]='<div class="mini-grid-group-ecicon"></div>';u[u.length]='<div class="mini-grid-groupTitle">'+y.cellHtml+"</div>"}else{u[u.length]="&nbsp;"}u[u.length]="</div></td></tr>";var G=j.expanded?"":"display:none";u[u.length]='<tr class="mini-grid-groupRows-tr" style="';u[u.length]='"><td class="mini-grid-groupRows-td" colspan="';u[u.length]=B.length;u[u.length]='"><div id="';u[u.length]=E;u[u.length]='" class="mini-grid-groupRows" style="';u[u.length]=G;u[u.length]='">';x(j.rows,j);u[u.length]="</div></td></tr>"}u.push("</table>");return u.join("")},_isFastCreating:function(){var b=this.getVisibleRows();if(b.length>50){return this._isCreating()||this.getScrollTop()<50*this._defaultRowHeight}return false},isShowRowDetail:function(b){return false},isCellValid:function(d,c){return true},_createRowHTML:function(P,G,R,J,U){var K=!U;if(!U){U=[]}var Q="";var C=this.isFixedRowHeight();if(C){Q=this._getRowHeight(P)}var M=-1;var E=" ";var N=-1;var l=" ";U[U.length]='<tr class="mini-grid-row ';if(P._state=="added"&&this.showNewRow){U[U.length]="mini-grid-newRow "}if(this.isShowRowDetail(P)){U[U.length]="mini-grid-expandRow "}if(this.allowAlternating&&G%2==1){U[U.length]=this._alternatingCls;U[U.length]=" "}var I=this._dataSource.isSelected(P);if(I){U[U.length]=this._rowSelectedCls;U[U.length]=" "}M=U.length;U[U.length]=E;U[U.length]='" style="';N=U.length;U[U.length]=l;if(P.visible===false){U[U.length]=";display:none;"}U[U.length]='" id="';U[U.length]=this._createRowId(P,J);U[U.length]='">';var H=this._currentCell;for(var B=0,D=R.length;B<D;B++){var O=R[B];var i=this._createCellId(P,O);var S="";var s=this._OnDrawCell(P,O,G,O._index);if(s.cellHtml===null||s.cellHtml===undefined||s.cellHtml===""){s.cellHtml="&nbsp;"}U[U.length]="<td ";if(s.rowSpan){U[U.length]='rowspan="'+s.rowSpan+'"'}if(s.colSpan){U[U.length]='colspan="'+s.colSpan+'"'}U[U.length]=' id="';U[U.length]=i;U[U.length]='" class="mini-grid-cell ';if(!this.isCellValid(P,O)){U[U.length]=" mini-grid-cell-error "}if(B==D-1){U[U.length]=" mini-grid-rightCell "}if(s.cellCls){U[U.length]=" "+s.cellCls+" "}if(S){U[U.length]=S}if(H&&H[0]==P&&H[1]==O){U[U.length]=" ";U[U.length]=this._cellSelectedCls}U[U.length]='" style="';if(s.showHGridLines==false){U[U.length]="border-bottom:0;"}if(s.showVGridLines==false){U[U.length]="border-right:0;"}if(!s.visible){U[U.length]="display:none;"}if(O.align){U[U.length]="text-align:";U[U.length]=O.align;U[U.length]=";"}if(s.cellStyle){U[U.length]=s.cellStyle}U[U.length]='">';U[U.length]='<div class="mini-grid-cell-inner ';if(!s.allowCellWrap){U[U.length]=" mini-grid-cell-nowrap "}if(s.cellInnerCls){U[U.length]=s.cellInnerCls}var T=O.field?this._dataSource.isModified(P,O.field):false;if(T&&this.showModified){U[U.length]=" mini-grid-cell-dirty"}U[U.length]='" style="';if(C){U[U.length]="height:";U[U.length]=Q;U[U.length]="px;";U[U.length]="line-height:";U[U.length]=Q;U[U.length]="px;"}if(s.cellInnerStyle){U[U.length]=s.cellInnerStyle}U[U.length]='">';U[U.length]=s.cellHtml;U[U.length]="</div>";U[U.length]="</td>";if(s.rowCls){E=s.rowCls}if(s.rowStyle){l=s.rowStyle}}if(this.isFrozen()&&J==1){U[U.length]='<td class="mini-grid-cell" style="width:0;';if(this.showHGridLines==false){U[U.length]="border-bottom:0;"}U[U.length]='"><div class="mini-grid-cell-inner" style="';if(C){U[U.length]="height:";U[U.length]=Q;U[U.length]="px;"}U[U.length]='">0</div></td>'}U[M]=E;U[N]=l;U[U.length]="</tr>";if(K){var F=U.join("");var L=/(<script(.*)<\/script(\s*)>)/i;F=F.replace(L,"");return F}},_createRowsHTML:function(y,j,v,q){v=v||this.getVisibleRows();var r=['<table class="mini-grid-table mini-grid-rowstable" cellspacing="0" cellpadding="0" border="0">'];r.push(this._createTopRowHTML(y));var p=this.uid+"$emptytext"+j;if(j==2){var z=(this.showEmptyText&&v.length==0)?"":"display:none;";r.push('<tr id="'+p+'" style="'+z+'"><td class="mini-grid-emptyText" colspan="'+y.length+'">'+this.emptyText+"</td></tr>")}var k=0;if(v.length>0){var t=v[0];k=this.getVisibleRows().indexOf(t)}for(var w=0,x=v.length;w<x;w++){var s=k+w;var u=v[w];this._createRowHTML(u,s,y,j,r)}if(q){r.push(q)}r.push("</table>");return r.join("")},doUpdateRows:function(){var g=this.getVisibleRows();var d=this.getVisibleColumns();if(this.isGrouping()){var f=this._createGroupingHTML(d,2);this._rowsViewContentEl.innerHTML=f}else{var f=this._createRowsHTML(d,2,g);this._rowsViewContentEl.innerHTML=f}},_createFilterRowHTML:function(p,i){var k=['<table class="mini-grid-table" cellspacing="0" cellpadding="0" border="0">'];k.push(this._createTopRowHTML(p));k[k.length]="<tr>";for(var q=0,j=p.length;q<j;q++){var n=p[q];var l=this._createFilterCellId(n);k[k.length]='<td id="';k[k.length]=l;k[k.length]='" class="mini-grid-filterCell" style="';k[k.length]='">&nbsp;</td>'}k[k.length]='</tr></table><div class="mini-grid-scrollHeaderCell"></div>';var o=k.join("");return o},_doRenderFilters:function(){var j=this.getVisibleColumns();for(var k=0,g=j.length;k<g;k++){var i=j[k];if(i.filter){var f=this.getFilterCellEl(i);if(f){f.innerHTML="";i.filter.render(f)}}}},_doUpdateFilterRow:function(){if(this._filterViewEl.firstChild){this._filterViewEl.removeChild(this._filterViewEl.firstChild)}var g=this.isFrozen();var d=this.getVisibleColumns();var f=this._createFilterRowHTML(d,2);this._filterViewEl.innerHTML=f;this._doRenderFilters()},_createSummaryRowHTML:function(r,l){var t=this.getDataView();var n=['<table class="mini-grid-table" cellspacing="0" cellpadding="0" border="0">'];n.push(this._createTopRowHTML(r));n[n.length]="<tr>";for(var p=0,q=r.length;p<q;p++){var s=r[p];var u=this._createSummaryCellId(s);var o=this._OnDrawSummaryCell(t,s);n[n.length]='<td id="';n[n.length]=u;n[n.length]='" class="mini-grid-summaryCell '+o.cellCls+'" style="'+o.cellStyle+";";n[n.length]='">';n[n.length]=o.cellHtml;n[n.length]="</td>"}n[n.length]='</tr></table><div class="mini-grid-scrollHeaderCell"></div>';var i=n.join("");return i},_doUpdateSummaryRow:function(){var c=this.getVisibleColumns();var d=this._createSummaryRowHTML(c,2);this._summaryViewEl.innerHTML=d},_doSortByField:function(d,g){if(!d){return null}var f=this._columnModel._getDataTypeByField(d);this._dataSource._doClientSortField(d,g,f)},_expandGroupOnLoad:true,_GroupID:1,_groupField:"",_groupDir:"",groupBy:function(c,d){if(!c){return}this._groupField=c;if(typeof d=="string"){d=d.toLowerCase()}this._groupDir=d;this._createGroupingView();this.deferUpdate()},clearGroup:function(){this._groupField="";this._groupDir="";this._groupDataView=null;this.deferUpdate()},setGroupField:function(b){this.groupBy(b)},setGroupDir:function(b){this._groupDir=field;this.groupBy(this._groupField,b)},isGrouping:function(){return this._groupField!=""},getGroupingView:function(){return this._groupDataView},_createGroupingView:function(){if(this.isGrouping()==false){return}this._groupDataView=null;var n=this._groupField,s=this._groupDir;this._doSortByField(n,s);var q=this.getVisibleRows();var t=[];var o={};for(var p=0,r=q.length;p<r;p++){var u=q[p];var i=u[n];var v=mini.isDate(i)?i.getTime():i;var l=o[v];if(!l){l=o[v]={};l.field=n,l.dir=s;l.value=i;l.rows=[];t.push(l);l.id="g"+this._GroupID++;l.expanded=this._expandGroupOnLoad}l.rows.push(u)}this._groupDataView=t},_OnDrawGroup:function(c){var d={group:c,rows:c.rows,field:c.field,dir:c.dir,value:c.value,cellHtml:c.field+" ("+c.rows.length+" Items)"};this.fire("drawgroup",d);return d},getRowGroup:function(c){var d=typeof c;if(d=="number"){return this.getGroupingView()[c]}if(d=="string"){return this._getRowGroupById(c)}return c},_getRowGroupByEvent:function(j){var g=mini.findParent(j.target,"mini-grid-groupRow");if(g){var f=g.id.split("$");if(f[0]!=this._id){return null}var i=f[f.length-1];return this._getRowGroupById(i)}return null},_getRowGroupById:function(i){var g=this.getGroupingView();for(var k=0,f=g.length;k<f;k++){var j=g[k];if(j.id==i){return j}}return null},_createRowGroupId:function(c,d){return this._id+"$group"+d+"$"+c.id},_createRowGroupRowsId:function(c,d){return this._id+"$grouprows"+d+"$"+c.id},_createRowId:function(d,f){var g=this._id+"$row"+f+"$"+d._id;return g},_createHeaderCellId:function(d,f){var g=this._id+"$headerCell"+f+"$"+d._id;return g},_createCellId:function(d,f){var g=d._id+"$cell$"+f._id;return g},_createFilterCellId:function(b){return this._id+"$filter$"+b._id},_createSummaryCellId:function(b){return this._id+"$summary$"+b._id},getFilterCellEl:function(b){b=this.getColumn(b);if(!b){return null}return document.getElementById(this._createFilterCellId(b))},getSummaryCellEl:function(b){b=this.getColumn(b);if(!b){return null}return document.getElementById(this._createSummaryCellId(b))},_doVisibleEls:function(){mini.GridView.superclass._doVisibleEls.call(this);this._columnsEl.style.display=this.showColumns?"block":"none";this._filterEl.style.display=this.showFilterRow?"block":"none";this._summaryEl.style.display=this.showSummaryRow?"block":"none";this._bottomPagerEl.style.display=this.showPager?"block":"none"},setShowColumns:function(b){this.showColumns=b;this._doVisibleEls();this.deferLayout()},setShowFilterRow:function(b){this.showFilterRow=b;this._doVisibleEls();this.deferLayout()},setShowSummaryRow:function(b){this.showSummaryRow=b;this._doVisibleEls();this.deferLayout()},setShowPager:function(b){this.showPager=b;this._doVisibleEls();this.deferLayout()},setFitColumns:function(b){this.fitColumns=b;mini.removeClass(this.el,"mini-grid-fixwidth");if(this.fitColumns==false){mini.addClass(this.el,"mini-grid-fixwidth")}this.deferLayout()},getBodyHeight:function(c){var d=mini.GridView.superclass.getBodyHeight.call(this,c);d=d-this.getColumnsHeight()-this.getFilterHeight()-this.getSummaryHeight()-this.getPagerHeight();return d},getColumnsHeight:function(){if(!this.showColumns){return 0}var b=mini.getHeight(this._columnsEl);return b},getFilterHeight:function(){return this.showFilterRow?mini.getHeight(this._filterEl):0},getSummaryHeight:function(){return this.showSummaryRow?mini.getHeight(this._summaryEl):0},getPagerHeight:function(){return this.showPager?mini.getHeight(this._bottomPagerEl):0},getGridViewBox:function(g){var d=mini.getBox(this._columnsEl);var f=mini.getBox(this._bodyEl);d.height=f.bottom-d.top;d.bottom=d.top+d.height;return d},getSortField:function(b){return this._dataSource.sortField},getSortOrder:function(b){return this._dataSource.sortOrder},_createSource:function(){this._dataSource=new mini.DataTable()},_bindSource:function(){var b=this._dataSource;b.on("loaddata",this.__OnSourceLoadData,this);b.on("cleardata",this.__OnSourceClearData,this)},__OnSourceLoadData:function(b){this._initData();this.doUpdate()},__OnSourceClearData:function(b){this._initData();this.doUpdate()},_initData:function(){},isFrozen:function(){var c=this._columnModel._frozenStartColumn,d=this._columnModel._frozenEndColumn;return this._columnModel.isFrozen()},_createColumnModel:function(){this._columnModel=new mini.ColumnModel(this)},_bindColumnModel:function(){this._columnModel.on("columnschanged",this.__OnColumnsChanged,this)},__OnColumnsChanged:function(b){this.columns=this._columnModel.columns;this._doUpdateFilterRow();this._doUpdateSummaryRow();this.doUpdate();this.fire("columnschanged")},setColumns:function(b){this._columnModel.setColumns(b);this.columns=this._columnModel.columns},getColumns:function(){return this._columnModel.getColumns()},getBottomColumns:function(){return this._columnModel.getBottomColumns()},getVisibleColumnsRow:function(){var b=this._columnModel.getVisibleColumnsRow().clone();return b},getVisibleColumns:function(){var b=this._columnModel.getVisibleColumns().clone();return b},getFrozenColumns:function(){var b=this._columnModel.getFrozenColumns().clone();return b},getUnFrozenColumns:function(){var b=this._columnModel.getUnFrozenColumns().clone();return b},getColumn:function(b){return this._columnModel.getColumn(b)},updateColumn:function(c,d){this._columnModel.updateColumn(c,d)},showColumns:function(j){for(var f=0,g=j.length;f<g;f++){var i=this.getColumn(j[f]);if(!i){continue}i.visible=true}this._columnModel._columnsChanged()},hideColumns:function(j){for(var f=0,g=j.length;f<g;f++){var i=this.getColumn(j[f]);if(!i){continue}i.visible=false}this._columnModel._columnsChanged()},showColumn:function(b){this.updateColumn(b,{visible:true})},hideColumn:function(b){this.updateColumn(b,{visible:false})},moveColumn:function(d,f,g){this._columnModel.moveColumn(d,f,g)},removeColumn:function(c){c=this.getColumn(c);if(!c){return}var d=this.getParentColumn(c);if(c&&d){d.columns.remove(c);this._columnModel._columnsChanged()}return c},setDefaultColumnWidth:function(b){this._columnModel._defaultColumnWidth=b},getDefaultColumnWidth:function(){return this._columnModel._defaultColumnWidth},setColumnWidth:function(c,d){this.updateColumn(c,{width:d})},getColumnWidth:function(d){var c=this.getColumnBox(d);return c.width},getParentColumn:function(b){return this._columnModel.getParentColumn(b)},getMaxColumnLevel:function(){return this._columnModel._getMaxColumnLevel()},_isCellVisible:function(c,d){return true},_createDrawCellEvent:function(i,o,k,p){var n=mini._getMap(o.field,i);var l={sender:this,rowIndex:k,columnIndex:p,record:i,row:i,column:o,field:o.field,value:n,cellHtml:n,rowCls:"",rowStyle:null,cellCls:o.cellCls||"",cellStyle:o.cellStyle||"",allowCellWrap:this.allowCellWrap,showHGridLines:this.showHGridLines,showVGridLines:this.showVGridLines,cellInnerCls:"",cellInnnerStyle:"",autoEscape:o.autoEscape};l.visible=this._isCellVisible(k,p);if(l.visible==true&&this._mergedCellMaps){var j=this._mergedCellMaps[k+":"+p];if(j){l.rowSpan=j.rowSpan;l.colSpan=j.colSpan}}return l},_OnDrawCell:function(k,q,l,r){var n=this._createDrawCellEvent(k,q,l,r);var o=n.value;if(q.dateFormat){if(mini.isDate(n.value)){n.cellHtml=mini.formatDate(o,q.dateFormat)}else{n.cellHtml=o}}if(q.dataType=="float"){var o=parseFloat(n.value);if(!isNaN(o)){decimalPlaces=parseInt(q.decimalPlaces);if(isNaN(decimalPlaces)){decimalPlaces=2}n.cellHtml=o.toFixed(decimalPlaces)}}if(q.dataType=="currency"){n.cellHtml=mini.formatCurrency(n.value,q.currencyUnit)}if(q.displayField){n.cellHtml=mini._getMap(q.displayField,k)}if(n.autoEscape==true){n.cellHtml=mini.htmlEncode(n.cellHtml)}var p=q.renderer;if(p){var j=typeof p=="function"?p:mini._getFunctoin(p);if(j){n.cellHtml=j.call(q,n)}}this.fire("drawcell",n);if(n.cellHtml&&!!n.cellHtml.unshift&&n.cellHtml.length==0){n.cellHtml="&nbsp;"}if(n.cellHtml===null||n.cellHtml===undefined||n.cellHtml===""){n.cellHtml="&nbsp;"}return n},_OnDrawSummaryCell:function(j,o){var k={result:this.getResultObject(),sender:this,data:j,column:o,field:o.field,value:"",cellHtml:"",cellCls:o.cellCls||"",cellStyle:o.cellStyle||"",allowCellWrap:this.allowCellWrap};if(o.summaryType){var i=mini.summaryTypes[o.summaryType];if(i){k.value=i(j,o.field)}}var l=k.value;k.cellHtml=k.value;if(k.value&&parseInt(k.value)!=k.value&&k.value.toFixed){decimalPlaces=parseInt(o.decimalPlaces);if(isNaN(decimalPlaces)){decimalPlaces=2}k.cellHtml=parseFloat(k.value.toFixed(decimalPlaces))}if(o.dateFormat){if(mini.isDate(k.value)){k.cellHtml=mini.formatDate(l,o.dateFormat)}else{k.cellHtml=l}}if(o.dataType=="currency"){k.cellHtml=mini.formatCurrency(k.cellHtml,o.currencyUnit)}var n=o.summaryRenderer;if(n){i=typeof n=="function"?n:window[n];if(i){k.cellHtml=i.call(o,k)}}o.summaryValue=k.value;this.fire("drawsummarycell",k);if(k.cellHtml===null||k.cellHtml===undefined||k.cellHtml===""){k.cellHtml="&nbsp;"}return k},getScrollTop:function(){return this._rowsViewEl.scrollTop},setScrollTop:function(b){this._rowsViewEl.scrollTop=b},getScrollLeft:function(){return this._rowsViewEl.scrollLeft},setScrollLeft:function(b){this._rowsViewEl.scrollLeft=b},_syncScroll:function(){var b=this._rowsViewEl.scrollLeft;this._filterViewEl.scrollLeft=b;this._summaryViewEl.scrollLeft=b;this._columnsViewEl.scrollLeft=b},__OnRowViewScroll:function(b){this._syncScroll()},_pagers:[],_createPagers:function(){this._pagers=[];var b=new mini.Pager();this._setBottomPager(b)},_setBottomPager:function(b){b=mini.create(b);if(!b){return}if(this._bottomPager){this.unbindPager(this._bottomPager);this._bottomPagerEl.removeChild(this._bottomPager.el)}this._bottomPager=b;b.render(this._bottomPagerEl);this.bindPager(b)},bindPager:function(b){this._pagers.add(b)},unbindPager:function(b){this._pagers.remove(b)},setShowEmptyText:function(b){this.showEmptyText=b;if(this.data.length==0){this.deferUpdate()}},getShowEmptyText:function(){return this.showEmptyText},setEmptyText:function(b){this.emptyText=b},getEmptyText:function(){return this.emptyText},setShowModified:function(b){this.showModified=b},getShowModified:function(){return this.showModified},setShowNewRow:function(b){this.showNewRow=b},getShowNewRow:function(){return this.showNewRow},setAllowCellWrap:function(b){this.allowCellWrap=b},getAllowCellWrap:function(){return this.allowCellWrap},setAllowHeaderWrap:function(b){this.allowHeaderWrap=b},getAllowHeaderWrap:function(){return this.allowHeaderWrap},setShowHGridLines:function(b){if(this.showHGridLines!=b){this.showHGridLines=b;this.deferUpdate()}},getShowHGridLines:function(){return this.showHGridLines},setShowVGridLines:function(b){if(this.showVGridLines!=b){this.showVGridLines=b;this.deferUpdate()}},getShowVGridLines:function(){return this.showVGridLines}});mini.copyTo(mini.GridView.prototype,mini._DataTableApplys);mini.regClass(mini.GridView,"gridview");mini.FrozenGridView=function(){mini.FrozenGridView.superclass.constructor.call(this)};mini.extend(mini.FrozenGridView,mini.GridView,{isFixedRowHeight:function(){return this.fixedRowHeight},frozenPosition:"left",isRightFrozen:function(){return this.frozenPosition=="right"},_create:function(){mini.FrozenGridView.superclass._create.call(this);var k=this.el;var f='<div class="mini-grid-columns-lock"></div>';var i='<div class="mini-grid-rows-lock"><div class="mini-grid-rows-content"></div></div>';this._columnsLockEl=mini.before(this._columnsViewEl,f);this._rowsLockEl=mini.before(this._rowsViewEl,i);this._rowsLockContentEl=this._rowsLockEl.firstChild;var j='<div class="mini-grid-filterRow-lock"></div>';this._filterLockEl=mini.before(this._filterViewEl,j);var g='<div class="mini-grid-summaryRow-lock"></div>';this._summaryLockEl=mini.before(this._summaryViewEl,g)},_initEvents:function(){mini.FrozenGridView.superclass._initEvents.call(this);mini.on(this._rowsEl,"mousewheel",this.__OnMouseWheel,this)},_createHeaderText:function(d,f){var g=d.header;if(typeof g=="function"){g=g.call(this,d)}if(mini.isNull(g)||g===""){g="&nbsp;"}if(this.isFrozen()&&f==2){if(d.viewIndex1){g="&nbsp;"}}return g},_createColumnColSpan:function(f,i,g){if(this.isFrozen()){var j=f["colspan"+g];if(j){i[i.length]='colspan="'+j+'" '}}else{if(f.colspan){i[i.length]='colspan="'+f.colspan+'" '}}},doUpdateColumns:function(){var p=this._columnsViewEl.scrollLeft;var k=this.isFrozen()?this.getFrozenColumnsRow():[];var n=this.isFrozen()?this.getUnFrozenColumnsRow():this.getVisibleColumnsRow();var r=this.isFrozen()?this.getFrozenColumns():[];var q=this.isFrozen()?this.getUnFrozenColumns():this.getVisibleColumns();var l=this._createColumnsHTML(k,1,r);var o=this._createColumnsHTML(n,2,q);var j='<div class="mini-grid-topRightCell"></div>';l+=j;o+=j;this._columnsLockEl.innerHTML=l;this._columnsViewEl.innerHTML=o;var s=this._columnsLockEl.firstChild;s.style.width="0px";this._columnsViewEl.scrollLeft=p},doUpdateRows:function(){var l=this.getVisibleRows();var j=this.getFrozenColumns();var k=this.getUnFrozenColumns();if(this.isGrouping()){var g=this._createGroupingHTML(j,1);var i=this._createGroupingHTML(k,2);this._rowsLockContentEl.innerHTML=g;this._rowsViewContentEl.innerHTML=i}else{var g=this._createRowsHTML(j,1,this.isFrozen()?l:[]);var i=this._createRowsHTML(k,2,l);this._rowsLockContentEl.innerHTML=g;this._rowsViewContentEl.innerHTML=i}var n=this._rowsLockContentEl.firstChild;n.style.width="0px"},_doUpdateFilterRow:function(){if(this._filterLockEl.firstChild){this._filterLockEl.removeChild(this._filterLockEl.firstChild)}if(this._filterViewEl.firstChild){this._filterViewEl.removeChild(this._filterViewEl.firstChild)}var i=this.getFrozenColumns();var j=this.getUnFrozenColumns();var f=this._createFilterRowHTML(i,1);var g=this._createFilterRowHTML(j,2);this._filterLockEl.innerHTML=f;this._filterViewEl.innerHTML=g;this._doRenderFilters()},_doUpdateSummaryRow:function(){var i=this.getFrozenColumns();var j=this.getUnFrozenColumns();var f=this._createSummaryRowHTML(i,1);var g=this._createSummaryRowHTML(j,2);this._summaryLockEl.innerHTML=f;this._summaryViewEl.innerHTML=g},_syncRowsHeightTimer:null,_syncRowsHeight:function(){var d=this;function c(){var o=document;var r=d.getDataView();for(var q=0,s=r.length;q<s;q++){var a=r[q];var b=d._getRowEl(a,1);var i=d._getRowEl(a,2);if(!b||!i){continue}b.style.height=i.style.height="auto";var l=b.offsetHeight;var p=i.offsetHeight;if(l<p){l=p}b.style.height=i.style.height=l+"px"}d._syncRowsHeightTimer=null}if(this.isFrozen()&&this.isFixedRowHeight()==false){if(this._syncRowsHeightTimer){clearTimeout(this._syncRowsHeightTimer)}this._syncRowsHeightTimer=setTimeout(c,2)}},_syncColumnHeight:function(){var j=this._columnsLockEl,g=this._columnsViewEl;j.style.height=g.style.height="auto";if(this.isFrozen()){var i=j.offsetHeight;var f=g.offsetHeight;i=i>f?i:f;j.style.height=g.style.height=i+"px"}var j=this._summaryLockEl,g=this._summaryViewEl;j.style.height=g.style.height="auto";if(this.isFrozen()){var i=j.offsetHeight;var f=g.offsetHeight;i=i>f?i:f;j.style.height=g.style.height=i+"px"}},_layoutColumns:function(){function z(a){return a.offsetHeight}function D(b){var c=[];for(var d=0,f=b.cells.length;d<f;d++){var a=b.cells[d];if(a.style.width=="0px"){continue}c.push(a)}return c}function t(b){var c=D(b);for(var d=0,f=c.length;d<f;d++){var a=c[d];a.style.height="auto"}}function u(){r.style.height=r.style.height="auto";for(var c=0,d=r.rows.length;c<d;c++){var a=r.rows[c];var b=s.rows[c];t(a);t(b)}}function y(c,b){var d=0;var g=D(c);for(var f=0,k=g.length;f<k;f++){var n=g[f];var j=parseInt(n.rowSpan)>1;if(j&&b){continue}var a=n.offsetHeight;if(a>d){d=a}}return d}if(!this.isFrozen()){return}var r=this._columnsLockEl.firstChild,s=this._columnsViewEl.firstChild;function C(c,k){var d=y(k,true);var f=D(c);for(var g=0,j=f.length;g<j;g++){var a=f[g];var b=parseInt(a.rowSpan)>1;if(b){}else{mini.setHeight(a,d)}}}function v(c,k){var d=y(k);var f=D(c);for(var g=0,j=f.length;g<j;g++){var a=f[g];var b=parseInt(a.rowSpan)>1;if(b){mini.setHeight(a,d)}else{}}}u();for(var A=0,B=r.rows.length;A<B;A++){var i=r.rows[A];var l=s.rows[A];var w=y(i),x=y(l);if(w==x){}else{if(w<x){C(i,l);v(i,l)}else{if(w>x){C(l,i);v(l,i)}}}}var w=z(r),x=z(s);if(w<x){mini.setHeight(r,x)}else{if(w>x){mini.setHeight(s,w)}}},doLayout:function(){if(this.canLayout()==false){return}this._doLayoutScroll=false;var p=this.isAutoHeight();var n=this.isFrozen();var j=this.getViewportWidth(true);var i=this.getLockedWidth();var o=j-i;this._doEmptyText();var k=this.isRightFrozen()?"marginRight":"marginLeft";var l=this.isRightFrozen()?"right":"left";if(n){this._filterViewEl.style[k]=i+"px";this._summaryViewEl.style[k]=i+"px";this._columnsViewEl.style[k]=i+"px";this._rowsViewEl.style[k]=i+"px";if(mini.isSafari||mini.isChrome||mini.isIE6){this._filterViewEl.style.width=o+"px";this._summaryViewEl.style.width=o+"px";this._columnsViewEl.style.width=o+"px"}else{this._filterViewEl.style.width="auto";this._summaryViewEl.style.width="auto";this._columnsViewEl.style.width="auto"}if(mini.isSafari||mini.isChrome||mini.isIE6){this._rowsViewEl.style.width=o+"px"}mini.setWidth(this._filterLockEl,i);mini.setWidth(this._summaryLockEl,i);mini.setWidth(this._columnsLockEl,i);mini.setWidth(this._rowsLockEl,i);this._filterLockEl.style[l]="0px";this._summaryLockEl.style[l]="0px";this._columnsLockEl.style[l]="0px";this._rowsLockEl.style[l]="0px"}else{this._doClearFrozen()}this._layoutColumns();this._syncColumnHeight();mini.FrozenGridView.superclass.doLayout.call(this);if(n){if(mini.isChrome||mini.isIE6){this._layoutColumns();this._syncColumnHeight();mini.FrozenGridView.superclass.doLayout.call(this)}}if(p){this._rowsLockEl.style.height="auto"}else{this._rowsLockEl.style.height="100%"}this._syncRowsHeight()},_doEmptyText:function(){},_getRowEl:function(j,g){j=this.getRecord(j);var i=this._createRowId(j,g);var f=document.getElementById(i);return f},_doClearFrozen:function(){var c=this.isRightFrozen()?"marginRight":"marginLeft";var d=this.isRightFrozen()?"right":"left";this._filterLockEl.style.left="-10px";this._summaryLockEl.style.left="-10px";this._columnsLockEl.style.left="-10px";this._rowsLockEl.style.left="-10px";this._filterLockEl.style.width="0px";this._summaryLockEl.style.width="0px";this._columnsLockEl.style.width="0px";this._rowsLockEl.style.width="0px";this._filterViewEl.style.marginLeft="0px";this._summaryViewEl.style.marginLeft="0px";this._columnsViewEl.style.marginLeft="0px";this._rowsViewEl.style.marginLeft="0px";this._filterViewEl.style.width="auto";this._summaryViewEl.style.width="auto";this._columnsViewEl.style.width="auto";this._rowsViewEl.style.width="auto";if(mini.isSafari||mini.isChrome||mini.isIE6){this._filterViewEl.style.width="100%";this._summaryViewEl.style.width="100%";this._columnsViewEl.style.width="100%";this._rowsViewEl.style.width="100%"}},frozenColumns:function(d,c){this.frozen(d,c)},unFrozenColumns:function(){this.unFrozen()},frozen:function(d,c){this._doClearFrozen();this._columnModel.frozen(d,c)},unFrozen:function(){this._doClearFrozen();this._columnModel.unFrozen()},setFrozenStartColumn:function(b){this._columnModel.setFrozenStartColumn(b)},setFrozenEndColumn:function(b){return this._columnModel.setFrozenEndColumn(b)},getFrozenStartColumn:function(b){return this._columnModel._frozenStartColumn},getFrozenEndColumn:function(b){return this._columnModel._frozenEndColumn},getFrozenColumnsRow:function(){return this._columnModel.getFrozenColumnsRow()},getUnFrozenColumnsRow:function(){return this._columnModel.getUnFrozenColumnsRow()},getLockedWidth:function(){if(!this.isFrozen()){return 0}var c=this._columnsLockEl.firstChild.firstChild;var d=c?c.offsetWidth:0;return d},_canDeferSyncScroll:function(){return this.isFrozen()},_syncScroll:function(){var g=this._rowsViewEl.scrollLeft;this._filterViewEl.scrollLeft=g;this._summaryViewEl.scrollLeft=g;this._columnsViewEl.scrollLeft=g;var f=this;var d=f._rowsViewEl.scrollTop;f._rowsLockEl.scrollTop=d;if(this._canDeferSyncScroll()){setTimeout(function(){f._rowsViewEl.scrollTop=f._rowsLockEl.scrollTop},50)}},__OnMouseWheel:function(g){var d=this.getScrollTop()-g.wheelDelta;var f=this.getScrollTop();this.setScrollTop(d);if(f!=this.getScrollTop()){g.preventDefault()}}});mini.regClass(mini.FrozenGridView,"FrozenGridView");mini.ScrollGridView=function(){mini.ScrollGridView.superclass.constructor.call(this)};mini.extend(mini.ScrollGridView,mini.FrozenGridView,{virtualScroll:true,virtualRows:25,defaultRowHeight:23,_canDeferSyncScroll:function(){return this.isFrozen()&&!this.isVirtualScroll()},setVirtualScroll:function(b){this.virtualScroll=b;this.doUpdate()},getVirtualScroll:function(b){return this.virtualScroll},isFixedRowHeight:function(){return this.fixedRowHeight||this.isVirtualScroll()},isVirtualScroll:function(){if(this.virtualScroll){return this.isAutoHeight()==false&&this.isGrouping()==false}return false},_getScrollView:function(){var b=this.getVisibleRows();return b},_getScrollViewCount:function(){return this._getScrollView().length},_getScrollRowHeight:function(f,g){if(g&&g._height){var d=parseInt(g._height);if(!isNaN(d)){return d}}return this.defaultRowHeight},_getRangeHeight:function(k,i){var j=0;var n=this._getScrollView();for(var p=k;p<i;p++){var l=n[p];var o=this._getScrollRowHeight(p,l);j+=o}return j},_getIndexByScrollTop:function(n){var k=0;var o=this._getScrollView();var p=this._getScrollViewCount();for(var r=0,i=p;r<i;r++){var l=o[r];var q=this._getScrollRowHeight(r,l);k+=q;if(k>=n){return r}}return p},__getScrollViewRange:function(g,f){var d=this._getScrollView();return d.getRange(g,f)},_getViewRegion:function(){var s=this._getScrollView();if(this.isVirtualScroll()==false){var l={top:0,bottom:0,rows:s,start:0,end:0};return l}var A=this.defaultRowHeight;var z=this._getViewNowRegion();var x=this.getScrollTop();var i=this._vscrollEl.offsetHeight;var r=this._getScrollViewCount();var y=z.start,u=z.end;for(var t=0,v=r;t<v;t+=this.virtualRows){var w=t+this.virtualRows;if(t<=y&&y<w){y=t}if(t<u&&u<=w){u=w}}if(u>r){u=r}if(u==0){u=this.virtualRows}var q=this._getRangeHeight(0,y);var B=this._getRangeHeight(u,this._getScrollViewCount());var s=this.__getScrollViewRange(y,u);var l={top:q,bottom:B,rows:s,start:y,end:u,viewStart:y,viewEnd:u};l.viewTop=this._getRangeHeight(0,l.viewStart);l.viewBottom=this._getRangeHeight(l.viewEnd,this._getScrollViewCount());return l},_getViewNowRegion:function(){var o=this.defaultRowHeight;var l=this.getScrollTop();var k=this._vscrollEl.offsetHeight;var i=this._getIndexByScrollTop(l);var j=this._getIndexByScrollTop(l+k+30);var p=this._getScrollViewCount();if(j>p){j=p}var n={start:i,end:j};return n},_canVirtualUpdate:function(){if(!this._viewRegion){return true}var b=this._getViewNowRegion();if(this._viewRegion.start<=b.start&&b.end<=this._viewRegion.end){return false}return true},__OnColumnsChanged:function(c){var d=this;this.columns=this._columnModel.columns;this._doUpdateFilterRow();this._doUpdateSummaryRow();if(this.getVisibleRows().length==0){this.doUpdate()}else{this.deferUpdate()}if(this.isVirtualScroll()){this.__OnVScroll()}this.fire("columnschanged")},doLayout:function(){if(this.canLayout()==false){return}mini.ScrollGridView.superclass.doLayout.call(this);this._layoutScroll()},_createRowsHTML:function(w,j,t,p,z,q){var x=this.isVirtualScroll();if(!x){return mini.ScrollGridView.superclass._createRowsHTML.apply(this,arguments)}var k=x?this._getViewRegion():null;var r=['<table class="mini-grid-table" cellspacing="0" cellpadding="0" border="0">'];r.push(this._createTopRowHTML(w));if(this.isVirtualScroll()){var y=p==0?"display:none;":"";r.push('<tr class="mini-grid-virtualscroll-top" style="padding:0;border:0;'+y+'"><td colspan="'+w.length+'" style="height:'+p+"px;padding:0;border:0;"+y+'"></td></tr>')}if(j==1&&this.isFrozen()==false){}else{for(var u=0,v=t.length;u<v;u++){var s=t[u];this._createRowHTML(s,q,w,j,r);q++}}if(this.isVirtualScroll()){r.push('<tr class="mini-grid-virtualscroll-bottom" style="padding:0;border:0;"><td colspan="'+w.length+'" style="height:'+z+'px;padding:0;border:0;"></td></tr>')}r.push("</table>");return r.join("")},doUpdateRows:function(){if(this.isVirtualScroll()==false){mini.ScrollGridView.superclass.doUpdateRows.call(this);return}var n=this._getViewRegion();this._viewRegion=n;var p=this.getFrozenColumns();var q=this.getUnFrozenColumns();var o=n.viewStart;var v=n.start;var u=n.viewEnd;if(this._scrollPaging){var s=this.getPageIndex()*this.getPageSize();o-=s;v-=s;u-=s}var l=new Date();var r=this._createRowsHTML(p,1,n.rows,n.viewTop,n.viewBottom,o);var t=this._createRowsHTML(q,2,n.rows,n.viewTop,n.viewBottom,o);this._rowsLockContentEl.innerHTML=r;this._rowsViewContentEl.innerHTML=t;var w=this.getScrollTop();if(this._rowsViewEl.scrollTop!=w){this._rowsViewEl.scrollTop=w}},_create:function(){mini.ScrollGridView.superclass._create.call(this);this._vscrollEl=mini.append(this._rowsEl,'<div class="mini-grid-vscroll"><div class="mini-grid-vscroll-content"></div></div>');this._vscrollContentEl=this._vscrollEl.firstChild},_initEvents:function(){mini.ScrollGridView.superclass._initEvents.call(this);var b=this;mini.on(this._vscrollEl,"scroll",this.__OnVScroll,this);mini._onScrollDownUp(this._vscrollEl,function(a){b._VScrollMouseDown=true},function(a){b._VScrollMouseDown=false})},_layoutScroll:function(){var i=this.isVirtualScroll();if(i){var f=this.getScrollHeight();var j=f>this._rowsViewEl.offsetHeight;if(i&&j){this._vscrollEl.style.display="block";this._vscrollContentEl.style.height=f+"px"}else{this._vscrollEl.style.display="none"}if(this._rowsViewEl.scrollWidth>this._rowsViewEl.clientWidth+1){var g=this.getBodyHeight(true)-18;if(g<0){g=0}this._vscrollEl.style.height=g+"px"}else{this._vscrollEl.style.height="100%"}}else{this._vscrollEl.style.display="none"}},getScrollHeight:function(){var b=this.getVisibleRows();return this._getRangeHeight(0,b.length)},setScrollTop:function(b){if(this.isVirtualScroll()){this._vscrollEl.scrollTop=b}else{this._rowsViewEl.scrollTop=b}},getScrollTop:function(){if(this.isVirtualScroll()){return this._vscrollEl.scrollTop}else{return this._rowsViewEl.scrollTop}},__OnVScroll:function(d){var g=this.isVirtualScroll();if(g){this._scrollTop=this._vscrollEl.scrollTop;var f=this;setTimeout(function(){f._rowsViewEl.scrollTop=f._scrollTop;f.__scrollTimer=null},8);if(this._scrollTopTimer){clearTimeout(this._scrollTopTimer)}this._scrollTopTimer=setTimeout(function(){f._scrollTopTimer=null;f._tryUpdateScroll();f._rowsViewEl.scrollTop=f._scrollTop},80)}},__OnMouseWheel:function(j){var g=j.wheelDelta?j:j.originalEvent;var i=g.wheelDelta||-g.detail*24;var k=this.getScrollTop()-i;var l=this.getScrollTop();this.setScrollTop(k);if(l!=this.getScrollTop()||this.isVirtualScroll()){j.preventDefault()}},_tryUpdateScroll:function(){var g=this._canVirtualUpdate();if(g){if(this._scrollPaging){var d=this;this.reload(null,null,function(a){})}else{var f=new Date();this.doUpdateRows()}}else{}}});mini.regClass(mini.ScrollGridView,"ScrollGridView");mini._onScrollDownUp=function(k,l,j){function i(a){if(mini.isFirefox){mini.on(document,"mouseup",g)}else{mini.on(document,"mousemove",n)}l(a)}function n(a){mini.un(document,"mousemove",n);j(a)}function g(a){mini.un(document,"mouseup",g);j(a)}mini.on(k,"mousedown",i)};mini._Grid_Select=function(b){this.owner=b,el=b.el;b.on("rowmousemove",this.__OnRowMouseMove,this);mini.on(b._viewportEl,"mouseout",this.__OnMouseOut,this);mini.on(b._viewportEl,"mousewheel",this.__OnMouseWheel,this);b.on("cellmousedown",this.__OnCellMouseDown,this);b.on("cellclick",this.__OnGridCellClick,this);b.on("celldblclick",this.__OnGridCellClick,this);mini.on(b.el,"keydown",this.__OnGridKeyDown,this)};mini._Grid_Select.prototype={__OnGridKeyDown:function(s){var B=this.owner;var z=mini.findParent(s.target,"mini-grid-detailRow");var C=z?mini.isAncestor(B.el,z):false;if(mini.isAncestor(B._filterEl,s.target)||mini.isAncestor(B._summaryEl,s.target)||mini.isAncestor(B._toolbarEl,s.target)||mini.isAncestor(B._footerEl,s.target)||(mini.findParent(s.target,"mini-grid-detailRow")&&C)||mini.findParent(s.target,"mini-grid-rowEdit")||mini.findParent(s.target,"mini-tree-editinput")){return}var q=B.getCurrentCell();if(s.shiftKey||s.ctrlKey||s.altKey){return}if(s.keyCode==37||s.keyCode==38||s.keyCode==39||s.keyCode==40){s.preventDefault()}var w=B.getVisibleColumns();function y(a){return B.getVisibleRows()[a]}function p(a){return B.getVisibleRows().indexOf(a)}function A(){return B.getVisibleRows().length}var x=q?q[1]:null,v=q?q[0]:null;if(!q){v=B.getCurrent()}var t=w.indexOf(x);var r=p(v);var u=A();switch(s.keyCode){case 9:if(B.allowCellEdit&&B.editOnTabKey){s.preventDefault();B._beginEditNextCell(s.shiftKey==false,true);return}break;case 27:break;case 13:if(B.allowCellEdit&&B.editNextOnEnterKey){if(B.isEditingCell(q)||!x.editor){B._beginEditNextCell(s.shiftKey==false);return}}if(B.allowCellEdit&&q&&!x.readOnly){B.beginEditCell()}break;case 37:if(x){if(t>0){t-=1}}else{t=0}break;case 38:if(v){if(r>0){r-=1}}else{r=0}if(r!=0&&B.isVirtualScroll()){if(B._viewRegion.start>r){return}}break;case 39:if(x){if(t<w.length-1){t+=1}}else{t=0}break;case 40:if(v){if(r<u-1){r+=1}}else{r=0}if(B.isVirtualScroll()){if(B._viewRegion.end<r){return;B.setScrollTop(B.getScrollTop()+B.defaultRowHeight)}}break;default:return;break}x=w[t];v=y(r);if(x&&v&&B.allowCellSelect){var q=[v,x];B.setCurrentCell(q);B.scrollIntoView(v,x)}if(!B.onlyCheckSelection){if(v&&B.allowRowSelect){B.deselectAll();B.setCurrent(v);if(v){B.scrollIntoView(v)}}}},__OnMouseWheel:function(c){var d=this.owner;if(d.allowCellEdit){d.commitEdit()}},__OnGridCellClick:function(i){var f=this.owner;if(f.allowCellEdit==false){return}if(f.cellEditAction!=i.type){return}var g=i.record,j=i.column;if(!j.readOnly&&!f.isReadOnly()){if(i.htmlEvent.shiftKey||i.htmlEvent.ctrlKey){}else{f.beginEditCell()}}},__OnCellMouseDown:function(c){var d=this;d.__doSelect(c)},__OnRowMouseMove:function(g){var d=this.owner;var f=g.record;if(!d.enabled||d.enableHotTrack==false){return}d.focusRow(f)},__OnMouseOut:function(b){if(this.owner.allowHotTrackOut){this.owner.focusRow(null)}},__doSelect:function(k){var i=k.record,n=k.column;var o=this.owner;if(i.enabled===false){return}if(o.allowCellSelect){var j=[i,n];o.setCurrentCell(j)}if(o.onlyCheckSelection&&!n._multiRowSelect){return}if(o.allowRowSelect){var p={record:i,selected:i,cancel:false};if(i){o.fire("beforerowselect",p)}if(p.cancel){return}if(o.getMultiSelect()){o.el.onselectstart=function(){};if(k.htmlEvent.shiftKey){o.el.onselectstart=function(){return false};try{k.htmlEvent.preventDefault()}catch(p){}var l=o.getCurrent();if(l){o.deselectAll();o.selectRange(l,i);o.setCurrent(l)}else{o.select(i);o.setCurrent(i)}}else{o.el.onselectstart=function(){};if(k.htmlEvent.ctrlKey){o.el.onselectstart=function(){return false};try{k.htmlEvent.preventDefault()}catch(p){}}if(k.column._multiRowSelect===true||k.htmlEvent.ctrlKey||o.allowUnselect){if(o.isSelected(i)){o.deselect(i)}else{o.select(i);o.setCurrent(i)}}else{if(o.isSelected(i)){}else{o.deselectAll();o.select(i);o.setCurrent(i)}}}}else{if(!o.isSelected(i)){o.deselectAll();o.select(i)}else{if(k.htmlEvent.ctrlKey||o.allowUnselect){o.deselectAll()}}}}}};mini._Grid_RowGroup=function(b){this.owner=b,el=b.el;mini.on(b._bodyEl,"click",this.__OnClick,this)};mini._Grid_RowGroup.prototype={__OnClick:function(g){var f=this.owner;var d=f._getRowGroupByEvent(g);if(d){f.toggleRowGroup(d)}}};mini._Grid_ColumnsMenu=function(b){this.owner=b;this.menu=this.createMenu();mini.on(b.el,"contextmenu",this.__OnContextMenu,this);b.on("destroy",this.__OnGridDestroy,this)};mini._Grid_ColumnsMenu.prototype={__OnGridDestroy:function(b){if(this.menu){this.menu.destroy()}this.menu=null},createMenu:function(){var b=mini.create({type:"menu",hideOnClick:false});b.on("itemclick",this.__OnItemClick,this);return b},updateMenu:function(){var o=this.owner,k=this.menu;var p=o.getBottomColumns();var i=[];for(var q=0,j=p.length;q<j;q++){var n=p[q];if(n.hideable){continue}var l={};l.checked=n.visible;l.checkOnClick=true;l.text=o._createHeaderText(n);if(l.text=="&nbsp;"){if(n.type=="indexcolumn"){l.text="序号"}if(n.type=="checkcolumn"){l.text="选择"}}i.push(l);l.enabled=n.enabled;l._column=n}k.setItems(i)},__OnContextMenu:function(c){var d=this.owner;if(d.showColumnsMenu==false){return}if(mini.isAncestor(d._columnsEl,c.target)==false){return}this.updateMenu();this.menu.showAtPos(c.pageX,c.pageY);return false},__OnItemClick:function(q){var y=this.owner,x=this.menu;var u=y.getBottomColumns();var p=x.getItems();var i=q.item,v=i._column;var t=0;for(var r=0,w=p.length;r<w;r++){var s=p[r];if(s.getChecked()){t++}}if(t<1){i.setChecked(true)}var l=i.getChecked();if(l){y.showColumn(v)}else{y.hideColumn(v)}}};mini._Grid_CellToolTip=function(b){this.owner=b;mini.on(this.owner.el,"mousemove",this.__OnGridMouseMove,this)};mini._Grid_CellToolTip.prototype={__OnGridMouseMove:function(k){var n=this.owner;if(mini.hasClass(k.target,"mini-grid-headerCell-inner")){var i=k.target;if(i.scrollWidth>i.clientWidth){var l=i.innerText||i.textContent||"";i.title=l.trim()}else{i.title=""}return}var j=n._getCellByEvent(k);var i=n._getCellEl(j[0],j[1]);var o=n.getCellError(j[0],j[1]);if(i){if(o){setTimeout(function(){i.title=o.errorText},10);return}setTimeout(function(){var a=i;if(i.firstChild){if(mini.hasClass(i.firstChild,"mini-grid-cell-inner")){a=i.firstChild}if(mini.hasClass(i.firstChild,"mini-tree-nodetitle")){a=i.firstChild}}if(a.scrollWidth>a.clientWidth){var b=a.innerText||a.textContent||"";i.title=b.trim()}else{i.title=""}},10)}}};mini._Grid_Sorter=function(b){this.owner=b;this.owner.on("headercellclick",this.__OnGridHeaderCellClick,this);mini.on(b._headerEl,"mousemove",this.__OnGridHeaderMouseMove,this);mini.on(b._headerEl,"mouseout",this.__OnGridHeaderMouseOut,this)};mini._Grid_Sorter.prototype={__OnGridHeaderMouseOut:function(b){if(this._focusedColumnEl){mini.removeClass(this._focusedColumnEl,"mini-grid-headerCell-hover")}},__OnGridHeaderMouseMove:function(c){var d=mini.findParent(c.target,"mini-grid-headerCell");if(d){mini.addClass(d,"mini-grid-headerCell-hover");this._focusedColumnEl=d}},__OnGridHeaderCellClick:function(i){var g=this.owner;if(!mini.hasClass(i.htmlEvent.target,"mini-grid-column-splitter")){if(g.allowSortColumn&&g.isEditing()==false){var j=i.column;if(!j.columns||j.columns.length==0){if(j.field&&j.allowSort!==false){var f="asc";if(g.getSortField()==j.field){f=g.getSortOrder()=="asc"?"desc":"asc"}g.sortBy(j.field,f)}}}}}};mini._Grid_ColumnMove=function(b){this.owner=b;mini.on(this.owner.el,"mousedown",this.__onGridMouseDown,this)};mini._Grid_ColumnMove.prototype={__onGridMouseDown:function(i){var f=this.owner;if(f.isEditing()){return}if(mini.hasClass(i.target,"mini-grid-column-splitter")){return}if(i.button==mini.MouseButton.Right){return}var g=mini.findParent(i.target,f._headerCellCls);if(g){this._remove();var j=f._getColumnByEvent(i);if(f.allowMoveColumn&&j&&j.allowMove){this.dragColumn=j;this._columnEl=g;this.getDrag().start(i)}}},getDrag:function(){if(!this.drag){this.drag=new mini.Drag({capture:false,onStart:mini.createDelegate(this._OnDragStart,this),onMove:mini.createDelegate(this._OnDragMove,this),onStop:mini.createDelegate(this._OnDragStop,this)})}return this.drag},_OnDragStart:function(d){function g(b){var a=b.header;if(typeof a=="function"){a=a.call(f,b)}if(mini.isNull(a)||a===""){a="&nbsp;"}return a}var f=this.owner;this._dragProxy=mini.append(document.body,'<div class="mini-grid-columnproxy"></div>');this._dragProxy.innerHTML='<div class="mini-grid-columnproxy-inner" style="height:26px;">'+g(this.dragColumn)+"</div>";mini.setXY(this._dragProxy,d.now[0]+15,d.now[1]+18);mini.addClass(this._dragProxy,"mini-grid-no");this.moveTop=mini.append(document.body,'<div class="mini-grid-movetop"></div>');this.moveBottom=mini.append(document.body,'<div class="mini-grid-movebottom"></div>')},_OnDragMove:function(p){var s=this.owner;var o=p.now[0];mini.setXY(this._dragProxy,o+15,p.now[1]+18);this.targetColumn=this.insertAction=null;var j=mini.findParent(p.event.target,s._headerCellCls);if(j){var r=s._getColumnByEvent(p.event);if(r&&r!=this.dragColumn){var k=s.getParentColumn(this.dragColumn);var n=s.getParentColumn(r);if(k==n){this.targetColumn=r;this.insertAction="before";var l=s.getColumnBox(this.targetColumn);if(o>l.x+l.width/2){this.insertAction="after"}}}}if(this.targetColumn){mini.addClass(this._dragProxy,"mini-grid-ok");mini.removeClass(this._dragProxy,"mini-grid-no");var q=s.getColumnBox(this.targetColumn);this.moveTop.style.display="block";this.moveBottom.style.display="block";if(this.insertAction=="before"){mini.setXY(this.moveTop,q.x-4,q.y-9);mini.setXY(this.moveBottom,q.x-4,q.bottom)}else{mini.setXY(this.moveTop,q.right-4,q.y-9);mini.setXY(this.moveBottom,q.right-4,q.bottom)}}else{mini.removeClass(this._dragProxy,"mini-grid-ok");mini.addClass(this._dragProxy,"mini-grid-no");this.moveTop.style.display="none";this.moveBottom.style.display="none"}},_remove:function(){var b=this.owner;mini.removeNode(this._dragProxy);mini.removeNode(this.moveTop);mini.removeNode(this.moveBottom);this._dragProxy=this.moveTop=this.moveBottom=this.dragColumn=this.targetColumn=null},_OnDragStop:function(c){var d=this.owner;d.moveColumn(this.dragColumn,this.targetColumn,this.insertAction);this._remove()}};mini._Grid_ColumnSplitter=function(b){this.owner=b;mini.on(b.el,"mousedown",this.__OnMouseDown,this)};mini._Grid_ColumnSplitter.prototype={__OnMouseDown:function(i){var f=this.owner;var g=i.target;if(mini.hasClass(g,"mini-grid-column-splitter")){var j=f._getColumnById(g.id);if(f.isEditing()){return}if(f.allowResizeColumn&&j&&j.allowResize){this.splitterColumn=j;this.getDrag().start(i)}}},getDrag:function(){if(!this.drag){this.drag=new mini.Drag({capture:true,onStart:mini.createDelegate(this._OnDragStart,this),onMove:mini.createDelegate(this._OnDragMove,this),onStop:mini.createDelegate(this._OnDragStop,this)})}return this.drag},_OnDragStart:function(j){var f=this.owner;var g=f.getColumnBox(this.splitterColumn);this.columnBox=g;this._dragProxy=mini.append(document.body,'<div class="mini-grid-proxy"></div>');var i=f.getGridViewBox();i.x=g.x;i.width=g.width;i.right=g.right;mini.setBox(this._dragProxy,i)},_OnDragMove:function(j){var g=this.owner;var i=mini.copyTo({},this.columnBox);var f=i.width+(j.now[0]-j.init[0]);if(f<g.columnMinWidth){f=g.columnMinWidth}if(f>g.columnMaxWidth){f=g.columnMaxWidth}mini.setWidth(this._dragProxy,f)},_OnDragStop:function(n){var s=this.owner;var o=mini.getBox(this._dragProxy);var l=this;var k=s.allowSortColumn;s.allowSortColumn=false;setTimeout(function(){jQuery(l._dragProxy).remove();l._dragProxy=null;s.allowSortColumn=k},10);var p=this.splitterColumn;var q=parseInt(p.width);if(q+"%"!=p.width){var r=s.getColumnWidth(p);var j=parseInt(q/r*o.width);if(j<s.columnMinWidth){j=s.columnMinWidth}s.setColumnWidth(p,j)}}};mini._Grid_DragDrop=function(b){this.owner=b;this.owner.on("CellMouseDown",this.__OnGridCellMouseDown,this)};mini._Grid_DragDrop.prototype={__OnGridCellMouseDown:function(j){if(j.htmlEvent.button==mini.MouseButton.Right){return}var l=this.owner;if(l._dragging){return}this.dropObj=l;if(mini.findParent(j.htmlEvent.target,"mini-tree-editinput")){return}if(l.isReadOnly()||l.isAllowDrag(j.record,j.column)==false){return}var g=l._OnDragStart(j.record,j.column);if(g.cancel){return}this.dragText=g.dragText;var i=j.record;this.isTree=!!l.isTree;this.beginRecord=i;var k=this._getDrag();k.start(j.htmlEvent)},_OnDragStart:function(g){var d=this.owner;d._dragging=true;var f=this.beginRecord;this.dragData=d._getDragData();if(this.dragData.indexOf(f)==-1){this.dragData.push(f)}this.feedbackEl=mini.append(document.body,'<div class="mini-feedback"></div>');this.feedbackEl.innerHTML=this.dragText;this.lastFeedbackClass="";this.enableHotTrack=d.getEnableHotTrack();d.setEnableHotTrack(false)},_getDropTargetObj:function(d){var c=mini.findParent(d.target,"mini-grid",500);if(c){return mini.get(c)}},_OnDragMove:function(l){var n=this.owner;var k=this._getDropTargetObj(l.event);this.dropObj=k;var i=l.now[0],j=l.now[1];mini.setXY(this.feedbackEl,i+15,j+18);if(k&&k.allowDrop){this.isTree=k.isTree;var g=k._getRecordByEvent(l.event);this.dropRecord=g;if(g){if(this.isTree){this.dragAction=this.getFeedback(g,j,3)}else{this.dragAction=this.getFeedback(g,j,2)}}else{this.dragAction="no"}}else{this.dragAction="no"}if(k&&k.allowDrop&&!g&&k.getData().length==0){this.dragAction="add"}this.lastFeedbackClass="mini-feedback-"+this.dragAction;this.feedbackEl.className="mini-feedback "+this.lastFeedbackClass;if(this.dragAction=="no"){g=null}this.setRowFeedback(g,this.dragAction)},_OnDragStop:function(l){var C=this.owner;var E=this.dropObj;C._dragging=false;mini.removeNode(this.feedbackEl);C.setEnableHotTrack(this.enableHotTrack);this.feedbackEl=null;this.setRowFeedback(null);if(this.isTree){var A=[];for(var u=0,y=this.dragData.length;u<y;u++){var j=this.dragData[u];var D=false;for(var v=0,w=this.dragData.length;v<w;v++){var z=this.dragData[v];if(z!=j){D=C.isAncestor(z,j);if(D){break}}}if(!D){A.push(j)}}this.dragData=A}if(this.dragAction=="add"&&!this.dropRecord){this.dropRecord=E.getRootNode?E.getRootNode():{__root:true}}if(this.dropRecord&&E&&this.dragAction!="no"){var i=C._OnDragDrop(this.dragData,this.dropRecord,this.dragAction);if(!i.cancel){var A=i.dragNodes,B=i.targetNode,x=i.action;if(E.isTree){if(C==E){E.moveNodes(A,B,x)}else{C.removeNodes(A);E.addNodes(A,B,x)}}else{var k=E.indexOf(B);if(x=="after"){k+=1}if(C==E){E.moveRow(A,k)}else{C.removeRows(A);if(this.dragAction=="add"){E.addRows(A)}else{E.addRows(A,k)}}}var i={dragNode:i.dragNodes[0],dropNode:i.targetNode,dragAction:i.action,dragNodes:i.dragNodes,targetNode:i.targetNode};E.fire("drop",i)}}this.dropRecord=null;this.dragData=null},setRowFeedback:function(p,q){var o=this.owner;var l=this.dropObj;if(this.lastAddDomRow&&l){l.removeRowCls(this.lastAddDomRow,"mini-tree-feedback-add")}if(p==null||this.dragAction=="add"){mini.removeNode(this.feedbackLine);this.feedbackLine=null}this.lastRowFeedback=p;if(p!=null){if(q=="before"||q=="after"){if(!this.feedbackLine){this.feedbackLine=mini.append(document.body,"<div class='mini-feedback-line'></div>")}this.feedbackLine.style.display="block";var i=l.getRowBox(p);var j=i.x,k=i.y-1;if(q=="after"){k+=i.height}mini.setXY(this.feedbackLine,j,k);var n=l.getBox(true);mini.setWidth(this.feedbackLine,n.width)}else{l.addRowCls(p,"mini-tree-feedback-add");this.lastAddDomRow=p}}},getFeedback:function(l,w,t){var E=this.owner;var v=this.dropObj;var u=v.getRowBox(l);var z=u.height;var i=w-u.y;var F=null;if(this.dragData.indexOf(l)!=-1){return"no"}var A=false;if(t==3){A=v.isLeaf(l);for(var B=0,C=this.dragData.length;B<C;B++){var y=this.dragData[B];var D=v.isAncestor(y,l);if(D){F="no";break}}}if(F==null){if(t==2){if(i>z/2){F="after"}else{F="before"}}else{if(A&&v.allowLeafDropIn===false){if(i>z/2){F="after"}else{F="before"}}else{if(i>(z/3)*2){F="after"}else{if(z/3<=i&&i<=(z/3*2)){F="add"}else{F="before"}}}}}var x=v._OnGiveFeedback(F,this.dragData,l,E);return x.effect},_getDrag:function(){if(!this.drag){this.drag=new mini.Drag({onStart:mini.createDelegate(this._OnDragStart,this),onMove:mini.createDelegate(this._OnDragMove,this),onStop:mini.createDelegate(this._OnDragStop,this)})}return this.drag}};mini._Grid_Events=function(b){this.owner=b,el=b.el;mini.on(el,"click",this.__OnClick,this);mini.on(el,"dblclick",this.__OnDblClick,this);mini.on(el,"mousedown",this.__OnMouseDown,this);mini.on(el,"mouseup",this.__OnMouseUp,this);mini.on(el,"mousemove",this.__OnMouseMove,this);mini.on(el,"mouseover",this.__OnMouseOver,this);mini.on(el,"mouseout",this.__OnMouseOut,this);mini.on(el,"keydown",this.__OnKeyDown,this);mini.on(el,"keyup",this.__OnKeyUp,this);mini.on(el,"contextmenu",this.__OnContextMenu,this);b.on("rowmousemove",this.__OnRowMouseMove,this)};mini._Grid_Events.prototype={_row:null,__OnRowMouseMove:function(d){var f=this.owner;var g=d.record;if(this._row!=g){d.record=g;d.row=g;f.fire("rowmouseenter",d)}this._row=g},__OnClick:function(b){this._fireEvent(b,"Click")},__OnDblClick:function(b){this._fireEvent(b,"Dblclick")},__OnMouseDown:function(c){var d=this.owner;if(mini.findParent(c.target,"mini-tree-editinput")){return}this._fireEvent(c,"MouseDown");setTimeout(function(){var a=mini.findParent(c.target,"mini-grid-detailRow");if(mini.isAncestor(d.el,a)){return}d._tryFocus(c)},30)},__OnMouseUp:function(c){if(mini.findParent(c.target,"mini-tree-editinput")){return}var d=this.owner;if(mini.isAncestor(d.el,c.target)){this._fireEvent(c,"MouseUp")}},__OnMouseMove:function(b){this._fireEvent(b,"MouseMove")},__OnMouseOver:function(b){this._fireEvent(b,"MouseOver")},__OnMouseOut:function(b){this._fireEvent(b,"MouseOut")},__OnKeyDown:function(b){this._fireEvent(b,"KeyDown")},__OnKeyUp:function(b){this._fireEvent(b,"KeyUp")},__OnContextMenu:function(b){this._fireEvent(b,"ContextMenu")},_fireEvent:function(n,s){var t=this.owner;var k=t._getCellByEvent(n);var p=k[0],q=k[1];if(p){var o={record:p,row:p,htmlEvent:n};var l=t["_OnRow"+s];if(l){l.call(t,o)}else{t.fire("row"+s,o)}}if(q){var o={column:q,field:q.field,htmlEvent:n};var l=t["_OnColumn"+s];if(l){l.call(t,o)}else{t.fire("column"+s,o)}}if(p&&q){var o={sender:t,record:p,row:p,column:q,field:q.field,htmlEvent:n};var l=t["_OnCell"+s];if(l){l.call(t,o)}else{t.fire("cell"+s,o)}if(q["onCell"+s]){q["onCell"+s].call(q,o)}}if(!p&&q&&mini.findParent(n.target,"mini-grid-headerCell")){var o={column:q,htmlEvent:n};var l=t["_OnHeaderCell"+s];if(l){l.call(t,o)}else{var r="onheadercell"+s.toLowerCase();if(q[r]){o.sender=t;q[r](o)}t.fire("headercell"+s,o)}}}};mini.DataGrid=function(b){mini.DataGrid.superclass.constructor.call(this,b);this._Events=new mini._Grid_Events(this);this._Select=new mini._Grid_Select(this);this._DragDrop=new mini._Grid_DragDrop(this);this._RowGroup=new mini._Grid_RowGroup(this);this._Splitter=new mini._Grid_ColumnSplitter(this);this._ColumnMove=new mini._Grid_ColumnMove(this);this._Sorter=new mini._Grid_Sorter(this);this._CellToolTip=new mini._Grid_CellToolTip(this);this._ColumnsMenu=new mini._Grid_ColumnsMenu(this);this._createPagers()};mini.extend(mini.DataGrid,mini.ScrollGridView,{uiCls:"mini-datagrid",selectOnLoad:false,showHeader:false,showPager:true,onlyCheckSelection:false,_$onlyCheckSelection:true,allowUnselect:false,allowRowSelect:true,allowCellSelect:false,allowCellEdit:false,cellEditAction:"cellclick",allowCellValid:false,allowResizeColumn:true,allowSortColumn:true,allowMoveColumn:true,showColumnsMenu:false,virtualScroll:false,enableHotTrack:true,allowHotTrackOut:true,showLoading:true,columnMinWidth:8,set:function(k){if(typeof k=="string"){return this}var l=k.value;delete k.value;var i=k.url;delete k.url;var n=k.data;delete k.data;var g=k.columns;delete k.columns;var j=k.defaultColumnWidth;delete k.defaultColumnWidth;if(j){this.setDefaultColumnWidth(j)}if(!mini.isNull(g)){this.setColumns(g)}mini.DataGrid.superclass.set.call(this,k);if(!mini.isNull(n)){this.setData(n)}if(!mini.isNull(i)){this.setUrl(i)}if(!mini.isNull(l)){this.setValue(l)}return this},doUpdate:function(){this._destroyEditors();mini.DataGrid.superclass.doUpdate.apply(this,arguments)},_destroyEditors:function(){var f=mini.getChildControls(this);var j=[];for(var k=0,g=f.length;k<g;k++){var i=f[k];if(i.el&&mini.findParent(i.el,this._rowCls)){j.push(i);i.destroy()}}},_OnDrawCell:function(){var b=mini.DataGrid.superclass._OnDrawCell.apply(this,arguments);return b},_bindSource:function(){var b=this._dataSource;b.on("beforeload",this.__OnSourceBeforeLoad,this);b.on("preload",this.__OnSourcePreLoad,this);b.on("load",this.__OnSourceLoadSuccess,this);b.on("loaderror",this.__OnSourceLoadError,this);b.on("loaddata",this.__OnSourceLoadData,this);b.on("cleardata",this.__OnSourceClearData,this);b.on("sort",this.__OnSourceSort,this);b.on("filter",this.__OnSourceFilter,this);b.on("pageinfochanged",this.__OnPageInfoChanged,this);b.on("selectionchanged",this.__OnSelectionChanged,this);b.on("currentchanged",function(a){this.fire("currentchanged",a)},this);b.on("add",this.__OnSourceAdd,this);b.on("update",this.__OnSourceUpdate,this);b.on("remove",this.__OnSourceRemove,this);b.on("move",this.__OnSourceMove,this);b.on("beforeadd",function(a){this.fire("beforeaddrow",a)},this);b.on("beforeupdate",function(a){this.fire("beforeupdaterow",a)},this);b.on("beforeremove",function(a){this.fire("beforeremoverow",a)},this);b.on("beforemove",function(a){this.fire("beforemoverow",a)},this);b.on("beforeselect",function(a){this.fire("beforeselect",a)},this);b.on("beforedeselect",function(a){this.fire("beforedeselect",a)},this);b.on("select",function(a){this.fire("select",a)},this);b.on("deselect",function(a){this.fire("deselect",a)},this)},_getMaskWrapEl:function(){return this.el},_initData:function(){this.data=this._dataSource.getSource();this.pageIndex=this.getPageIndex();this.pageSize=this.getPageSize();this.totalCount=this.getTotalCount();this.totalPage=this.getTotalPage();this.sortField=this.getSortField();this.sortOrder=this.getSortOrder();this.url=this.getUrl();this._mergedCellMaps={};this._mergedCells={};this._cellErrors=[];this._cellMapErrors={};if(this.isGrouping()){this.groupBy(this._groupField,this._groupDir);if(this.collapseGroupOnLoad){this.collapseGroups()}}},__OnSourceBeforeLoad:function(b){this.fire("beforeload",b);if(b.cancel==true){return}if(this.showLoading){this.loading()}},__OnSourcePreLoad:function(b){this.fire("preload",b)},__OnSourceLoadSuccess:function(b){this.fire("load",b);this.unmask()},__OnSourceLoadError:function(b){this.fire("loaderror",b);this.unmask()},__OnSourceSort:function(b){this.deferUpdate();this.fire("sort",b)},__OnSourceFilter:function(b){this.deferUpdate();this.fire("filter",b)},__OnSourceAdd:function(b){this._doAddRowEl(b.record);this._doUpdateSummaryRow();this.fire("addrow",b)},__OnSourceUpdate:function(b){this._doUpdateRowEl(b.record);this._doUpdateSummaryRow();this.fire("updaterow",b)},__OnSourceRemove:function(b){this._doRemoveRowEl(b.record);this._doUpdateSummaryRow();this.fire("removerow",b);if(this.isVirtualScroll()){this.deferUpdate()}},__OnSourceMove:function(b){this._doMoveRowEl(b.record,b.index);this._doUpdateSummaryRow();this.fire("moverow",b)},__OnSelectionChanged:function(g){if(g.fireEvent!==false){if(g.select){this.fire("rowselect",g)}else{this.fire("rowdeselect",g)}}var d=this;if(this._selectionTimer){clearTimeout(this._selectionTimer);this._selectionTimer=null}this._selectionTimer=setTimeout(function(){d._selectionTimer=null;if(g.fireEvent!==false){d.fire("SelectionChanged",g)}},1);var f=new Date();this._doRowSelect(g._records,g.select)},__OnPageInfoChanged:function(b){this._updatePagesInfo()},_updatePagesInfo:function(){var j=this.getPageIndex();var o=this.getPageSize();var p=this.getTotalCount();var k=this.getTotalPage();var n=this._pagers;for(var l=0,q=n.length;l<q;l++){var i=n[l];i.update(j,o,p);this._dataSource.totalPage=i.totalPage}},setPagerButtons:function(b){this._bottomPager.setButtons(b)},setPager:function(c){if(typeof c=="string"){var d=mini.byId(c);if(!d){return}mini.parse(c);c=mini.get(c)}if(c){this.bindPager(c)}},bindPager:function(b){if(!b){return}this.unbindPager(b);this._pagers.add(b);b.on("beforepagechanged",this.__OnPageChanged,this)},unbindPager:function(b){if(!b){return}this._pagers.remove(b);b.un("pagechanged",this.__OnPageChanged,this)},__OnPageChanged:function(b){b.cancel=true;this.gotoPage(b.pageIndex,b.pageSize)},_canUpdateRowEl:true,_doUpdateRowEl:function(l){var j=this.getFrozenColumns();var n=this.getUnFrozenColumns();var k=this.indexOf(l);var g=this._createRowHTML(l,k,n,2);var i=this._getRowEl(l,2);if(!i){return}jQuery(i).before(g);if(i){i.parentNode.removeChild(i)}if(this.isFrozen()){var g=this._createRowHTML(l,k,j,1);var i=this._getRowEl(l,1);jQuery(i).before(g);i.parentNode.removeChild(i)}this.deferLayout()},_doAddRowEl:function(j){var p=this.getFrozenColumns();var q=this.getUnFrozenColumns();var l=this._rowsLockContentEl.firstChild;var o=this._rowsViewContentEl.firstChild;var n=this.indexOf(j);var k=this.getAt(n+1);function r(f,b,a,c){var g=this._createRowHTML(f,n,a,b);if(k){var d=this._getRowEl(k,b);jQuery(d).before(g)}else{mini.append(c,g)}}r.call(this,j,2,q,o);if(this.isFrozen()){r.call(this,j,1,p,l)}this.deferLayout();var s=jQuery(".mini-grid-emptyText",this._bodyEl)[0];if(s){s.style.display="none";s.parentNode.style.display="none"}},_doRemoveRowEl:function(k){var i=this._getRowEl(k,1);var l=this._getRowEl(k,2);if(i){i.parentNode.removeChild(i)}if(l){l.parentNode.removeChild(l)}if(!l){return}var n=this._getRowDetailEl(k,1);var j=this._getRowDetailEl(k,2);if(n){n.parentNode.removeChild(n)}if(j){j.parentNode.removeChild(j)}this.deferLayout();if(this.showEmptyText&&this.getVisibleRows().length==0){var g=jQuery(".mini-grid-emptyText",this._bodyEl)[0];if(g){g.style.display="";g.parentNode.style.display=""}}},_doMoveRowEl:function(c,d){this._doRemoveRowEl(c);this._doAddRowEl(c)},_getRowGroupEl:function(j,g){if(g==1&&!this.isFrozen()){return null}var i=this._createRowGroupId(j,g);var f=mini.byId(i,this.el);return f},_getRowGroupRowsEl:function(j,g){if(g==1&&!this.isFrozen()){return null}var i=this._createRowGroupRowsId(j,g);var f=mini.byId(i,this.el);return f},_getRowEl:function(j,g){if(g==1&&!this.isFrozen()){return null}j=this.getRecord(j);var i=this._createRowId(j,g);var f=mini.byId(i,this.el);return f},_getHeaderCellEl:function(j,g){if(g==1&&!this.isFrozen()){return null}j=this.getColumn(j);var i=this._createHeaderCellId(j,g);var f=mini.byId(i,this.el);return f},_getCellEl:function(j,f){j=this.getRecord(j);f=this.getColumn(f);if(!j||!f){return null}var i=this._createCellId(j,f);var g=mini.byId(i,this.el);return g},getRecordByEvent:function(b){return this._getRecordByEvent(b)},_getRecordByEvent:function(i){var f=mini.findParent(i.target,this._rowCls);if(!f){return null}var j=f.id.split("$");var g=j[j.length-1];return this._getRowByID(g)},getColumnByEvent:function(b){if(!b){return null}return this._getColumnByEvent(b)},_getColumnByEvent:function(j){var g=mini.findParent(j.target,this._cellCls);if(!g){g=mini.findParent(j.target,this._headerCellCls)}if(g){var f=g.id.split("$");var i=f[f.length-1];return this._getColumnById(i)}return null},_getCellByEvent:function(g){var f=this._getRecordByEvent(g);var d=this._getColumnByEvent(g);return[f,d]},_getRowByID:function(b){return this._dataSource.getby_id(b)},_getColumnById:function(b){return this._columnModel._getColumnById(b)},addRowCls:function(i,g){var j=this._getRowEl(i,1);var f=this._getRowEl(i,2);if(j){mini.addClass(j,g)}if(f){mini.addClass(f,g)}},removeRowCls:function(i,g){var j=this._getRowEl(i,1);var f=this._getRowEl(i,2);if(j){mini.removeClass(j,g)}if(f){mini.removeClass(f,g)}},getCellBox:function(g,d){g=this.getRow(g);d=this.getColumn(d);if(!g||!d){return null}var f=this._getCellEl(g,d);if(!f){return null}return mini.getBox(f)},getColumnBox:function(f){var i=this._createHeaderCellId(f,2);var g=document.getElementById(i);if(!g){i=this._createHeaderCellId(f,1);g=document.getElementById(i)}if(g){var j=mini.getBox(g);j.x-=1;j.left=j.x;j.right=j.x+j.width;return j}},getRowBox:function(i){var f=this._getRowEl(i,1);var j=this._getRowEl(i,2);if(!j){return null}var k=mini.getBox(j);if(f){var g=mini.getBox(f);k.x=k.left=g.left;k.width=k.right-k.x}return k},_doRowSelect:function(j,i){var k=new Date();for(var l=0,n=j.length;l<n;l++){var g=j[l];if(i){this.addRowCls(g,this._rowSelectedCls)}else{this.removeRowCls(g,this._rowSelectedCls)}}},_tryFocus:function(g){try{var d=g.target.tagName.toLowerCase();if(d=="input"||d=="textarea"||d=="select"){return}if(mini.hasClass(g.target,"mini-placeholder-label")){return}if(mini.findParent(g.target,"mini-grid-rows-content")){mini.setXY(this._focusEl,g.pageX,g.pageY);this.focus()}}catch(f){}},focus:function(){try{var n=this;var j=this.getCurrentCell();if(j){var o=this.getCellBox(j[0],j[1]);mini.setX(this._focusEl,o.x)}var k=this.getCurrent();if(k){var p=this._getRowEl(k,2);if(p){var i=mini.getBox(p);mini.setY(n._focusEl,i.top);if(mini.isIE||mini.isIE11){n._focusEl.focus()}else{n.el.focus()}}}else{if(mini.isIE||mini.isIE11){n._focusEl.focus()}else{n.el.focus()}}}catch(l){}},focusRow:function(b){if(this._focusRow==b){return}if(this._focusRow){this.removeRowCls(this._focusRow,this._rowHoverCls)}this._focusRow=b;if(b){this.addRowCls(b,this._rowHoverCls)}},scrollIntoView:function(l,q){l=this.getRow(l);if(!l){return}try{if(q){if(this._columnModel.isFrozenColumn(q)){q=null}}if(q){var k=this._getCellEl(l,q);mini.scrollIntoView(k,this._rowsViewEl,true)}else{if(this.isVirtualScroll()){var o=this._getViewRegion();var r=this.indexOf(l);if(o.start<=r&&r<=o.end){}else{var n=this._getRangeHeight(0,r);this.setScrollTop(n)}}else{var j=this._getRowEl(l,2);mini.scrollIntoView(j,this._rowsViewEl,false)}}}catch(p){}},setShowLoading:function(b){this.showLoading=b},getShowLoading:function(){return this.showLoading},setEnableHotTrack:function(b){this.enableHotTrack=b},getEnableHotTrack:function(){return this.enableHotTrack},setAllowHotTrackOut:function(b){this.allowHotTrackOut=b},getAllowHotTrackOut:function(){return this.allowHotTrackOut},setOnlyCheckSelection:function(b){this.onlyCheckSelection=b},getOnlyCheckSelection:function(){return this.onlyCheckSelection},setAllowUnselect:function(b){this.allowUnselect=b},getAllowUnselect:function(){return this.allowUnselect},setAllowRowSelect:function(b){this.allowRowSelect=b},getAllowRowSelect:function(){return this.allowRowSelect},setAllowCellSelect:function(b){this.allowCellSelect=b},getAllowCellSelect:function(){return this.allowCellSelect},setAllowCellEdit:function(b){this.allowCellEdit=b},getAllowCellEdit:function(){return this.allowCellEdit},setCellEditAction:function(b){this.cellEditAction=b},getCellEditAction:function(){return this.cellEditAction},setAllowCellValid:function(b){this.allowCellValid=b},getAllowCellValid:function(){return this.allowCellValid},setAllowResizeColumn:function(b){this.allowResizeColumn=b;mini.removeClass(this.el,"mini-grid-resizeColumns-no");if(!b){mini.addClass(this.el,"mini-grid-resizeColumns-no")}},getAllowResizeColumn:function(){return this.allowResizeColumn},setAllowSortColumn:function(b){this.allowSortColumn=b},getAllowSortColumn:function(){return this.allowSortColumn},setAllowMoveColumn:function(b){this.allowMoveColumn=b},getAllowMoveColumn:function(){return this.allowMoveColumn},setShowColumnsMenu:function(b){this.showColumnsMenu=b},getShowColumnsMenu:function(){return this.showColumnsMenu},setEditNextRowCell:function(b){this.editNextRowCell=b},getEditNextRowCell:function(){return this.editNextRowCell},setEditNextOnEnterKey:function(b){this.editNextOnEnterKey=b},getEditNextOnEnterKey:function(){return this.editNextOnEnterKey},setEditOnTabKey:function(b){this.editOnTabKey=b},getEditOnTabKey:function(){return this.editOnTabKey},setCreateOnEnter:function(b){this.createOnEnter=b},getCreateOnEnter:function(){return this.createOnEnter},_currentCell:null,_doCurrentCell:function(g){if(this._currentCell){var f=this._currentCell[0],i=this._currentCell[1];var j=this._getCellEl(f,i);if(j){if(g){mini.addClass(j,this._cellSelectedCls)}else{mini.removeClass(j,this._cellSelectedCls)}}}},setCurrentCell:function(g){if(this._currentCell!=g){this._doCurrentCell(false);this._currentCell=g;if(g){var i=this.getRow(g[0]);var f=this.getColumn(g[1]);if(i&&f){this._currentCell=[i,f]}else{this._currentCell=null}}this._doCurrentCell(true);if(g){var j=this._getAnchorCell(g[0],g[1]);if(!j){if(this.isFrozen()){this.scrollIntoView(g[0])}else{this.scrollIntoView(g[0],g[1])}}}this.fire("currentcellchanged")}},getCurrentCell:function(){var b=this._currentCell;if(b){if(this.indexOf(b[0])==-1){this._currentCell=null;b=null}}return b},_editingCell:null,isEditingCell:function(b){return this._editingCell&&this._editingCell[0]==b[0]&&this._editingCell[1]==b[1]},beginEditCell:function(g,f){function d(a,b){a=this.getRow(a);b=this.getColumn(b);var i=[a,b];if(a&&b){this.setCurrentCell(i)}var i=this.getCurrentCell();if(this._editingCell&&i){if(this._editingCell[0]==i[0]&&this._editingCell[1]==i[1]){return}}if(this._editingCell){this.commitEdit()}if(i){var a=i[0],b=i[1];var c=this._OnCellBeginEdit(a,b,this.getCellEditor(b));if(c!==false){this.scrollIntoView(a,b);this._editingCell=i;this._OnCellShowingEdit(a,b)}}}this._pushUpdateCallback(d,this,[g,f])},cancelEdit:function(){if(this.allowCellEdit){if(this._editingCell){this._OnCellEndEdit()}}else{if(this.isEditing()){this._allowLayout=false;var j=this.getDataView();for(var f=0,g=j.length;f<g;f++){var i=j[f];if(i._editing==true){this.cancelEditRow(f)}}this._allowLayout=true;this.doLayout()}}},commitEdit:function(){if(this.allowCellEdit){if(this._editingCell){this._OnCellCommitEdit(this._editingCell[0],this._editingCell[1]);this._OnCellEndEdit()}}else{if(this.isEditing()){this._allowLayout=false;var j=this.getDataView();for(var f=0,g=j.length;f<g;f++){var i=j[f];if(i._editing==true){this.commitEditRow(f)}}this._allowLayout=true;this.doLayout()}}},getCellEditor:function(f,j){f=this.getColumn(f);if(!f){return}if(this.allowCellEdit){var g=f.__editor;if(!g){g=mini.getAndCreate(f.editor)}if(g&&g!=f.editor){f.editor=g}return g}else{j=this.getRow(j);f=this.getColumn(f);if(!j){j=this.getEditingRow()}if(!j||!f){return null}var i=this.uid+"$"+j._uid+"$"+f._id+"$editor";return mini.get(i)}},_OnCellBeginEdit:function(j,q,r){var p=mini._getMap(q.field,j);var n={sender:this,rowIndex:this.indexOf(j),row:j,record:j,column:q,field:q.field,editor:r,value:p,cancel:false};this.fire("cellbeginedit",n);if(!mini.isNull(q.defaultValue)&&(mini.isNull(n.value)||n.value==="")){var k=q.defaultValue;var o=mini.clone({d:k});n.value=o.d}var r=n.editor;p=n.value;if(n.cancel){return false}if(!r){return false}if(mini.isNull(p)){p=""}if(r.setValue){r.setValue(p)}r.ownerRowID=j._uid;if(q.displayField&&r.setText){var l=mini._getMap(q.displayField,j);if(!mini.isNull(q.defaultText)&&(mini.isNull(l)||l==="")){var o=mini.clone({d:q.defaultText});l=o.d}r.setText(l)}if(this.allowCellEdit){this._editingControl=n.editor}return true},_OnCellCommitEdit:function(p,q,k,o){var n={sender:this,rowIndex:this.indexOf(p),record:p,row:p,column:q,field:q.field,editor:o?o:this.getCellEditor(q),value:mini.isNull(k)?"":k,text:"",cancel:false};if(n.editor&&n.editor.getValue){try{n.editor.blur()}catch(l){}n.value=n.editor.getValue()}if(n.editor&&n.editor.getText){n.text=n.editor.getText()}var t=mini._getMap(q.field,p),s=n.value;n.oldValue=t;if(mini.isEquals(t,s)){return n}this.fire("cellcommitedit",n);if(n.cancel==false){if(this.allowCellEdit){var r={};r[q.field]=n.value;if(q.displayField){r[q.displayField]=n.text}this.updateRow(p,r)}}return n},_OnCellEndEdit:function(j,n){if(!this._editingCell&&!j){return}if(!j){j=this._editingCell[0]}if(!n){n=this._editingCell[1]}var l={sender:this,rowIndex:this.indexOf(j),record:j,row:j,column:n,field:n.field,editor:this._editingControl,value:j[n.field]};this.fire("cellendedit",l);if(this.allowCellEdit&&l.editor){var o=l.editor;if(o&&o.setIsValid){o.setIsValid(true)}if(this._editWrap){this._editWrap.style.display="none"}var k=this._editWrap.childNodes;for(var i=k.length-1;i>=0;i--){var p=k[i];this._editWrap.removeChild(p)}if(o&&o.hidePopup){o.hidePopup()}if(o&&o.setValue){o.setValue("")}this._editingControl=null;this._editingCell=null;if(this.allowCellValid){this.validateCell(j,n)}}},_OnCellShowingEdit:function(q,s){if(!this._editingControl){return false}var l=this.getCellBox(q,s);var r=document.body.scrollWidth;if(l.right>r){l.width=r-l.left;if(l.width<10){l.width=10}l.right=l.left+l.width}var o={sender:this,rowIndex:this.indexOf(q),record:q,row:q,column:s,field:s.field,cellBox:l,editor:this._editingControl};this.fire("cellshowingedit",o);var p=o.editor;if(p&&p.setIsValid){p.setIsValid(true)}var n=this._getEditWrap(l);this._editWrap.style.zIndex=mini.getMaxZIndex();if(p.render){p.render(this._editWrap);setTimeout(function(){p.focus();if(p.selectText){p.selectText()}},50);if(p.setVisible){p.setVisible(true)}}else{if(p.el){this._editWrap.appendChild(p.el);setTimeout(function(){try{p.el.focus()}catch(a){}},50)}}if(p.setWidth){var t=l.width;if(t<20){t=20}p.setWidth(t)}if(p.setHeight&&p.type=="textarea"){var k=l.height-1;if(p.minHeight&&k<p.minHeight){k=p.minHeight}p.setHeight(k)}if(p.setWidth){var t=l.width-1;if(p.minWidth&&t<p.minWidth){t=p.minWidth}p.setWidth(t)}mini.on(document,"mousedown",this.__OnBodyMouseDown,this);if(s.autoShowPopup&&p.showPopup){p.showPopup()}},__OnBodyMouseDown:function(j){if(this._editingControl){var i=this._getCellByEvent(j);if(this._editingCell&&i){if(this._editingCell[0]==i.record&&this._editingCell[1]==i.column){return false}}var g=false;if(this._editingControl.within){g=this._editingControl.within(j)}else{g=mini.isAncestor(this._editWrap,j.target)}if(g==false){var k=this;if(mini.isAncestor(this._bodyEl,j.target)==false){setTimeout(function(){k.commitEdit()},1)}else{var l=k._editingCell;setTimeout(function(){var a=k._editingCell;if(l==a){k.commitEdit()}},70)}mini.un(document,"mousedown",this.__OnBodyMouseDown,this)}}},_getEditWrap:function(c){if(!this._editWrap){this._editWrap=mini.append(document.body,'<div class="mini-grid-editwrap" style="position:absolute;"></div>');mini.on(this._editWrap,"keydown",this.___OnEditControlKeyDown,this)}this._editWrap.style.zIndex=1000000000;this._editWrap.style.display="block";mini.setXY(this._editWrap,c.x,c.y);mini.setWidth(this._editWrap,c.width);var d=document.body.scrollWidth;if(c.x>d){mini.setX(this._editWrap,-1000)}return this._editWrap},___OnEditControlKeyDown:function(g){var d=this._editingControl;if(g.keyCode==13&&d&&d.type=="textarea"){return}if(g.keyCode==13){var f=this._editingCell;if(f&&f[1]&&f[1].enterCommit===false){return}this.commitEdit();this.focus();if(this.editNextOnEnterKey){this.fire("celleditenter",{record:f[0]});this._beginEditNextCell(g.shiftKey==false)}else{}}else{if(g.keyCode==27){this.cancelEdit();this.focus()}else{if(g.keyCode==9){this.commitEdit();if(this.editOnTabKey){g.preventDefault();this.commitEdit();this._beginEditNextCell(g.shiftKey==false,true)}else{}}}}},editNextRowCell:false,editNextOnEnterKey:false,editOnTabKey:true,createOnEnter:false,_beginEditNextCell:function(t,x){var z=this;var n=this.getCurrentCell();if(!n){return}this.focus();var u=z.getVisibleColumns();var v=n?n[1]:null,s=n?n[0]:null;function w(a){return z.getVisibleRows()[a]}function o(a){return z.getVisibleRows().indexOf(a)}function y(){return z.getVisibleRows().length}var q=u.indexOf(v);var p=o(s);var r=y();if(t===false){q-=1;v=u[q];if(!v){v=u[u.length-1];s=w(p-1);if(!s){return}}}else{if(this.editNextRowCell&&!x){if(p+1<r){s=w(p+1)}}else{q+=1;v=u[q];if(!v){v=u[0];s=z.getAt(p+1);if(!s){if(this.createOnEnter){s={};this.addRow(s)}else{return}}}}}var n=[s,v];z.setCurrentCell(n);if(!z.onlyCheckSelection){if(z.getCurrent()!=s){z.deselectAll();z.setCurrent(s)}}z.scrollIntoView(s,v);z.beginEditCell()},getEditorOwnerRow:function(c){var d=c.ownerRowID;return this.getRowByUID(d)},beginEditRow:function(row){if(this.allowCellEdit){return}function beginEdit(row){var sss=new Date();row=this.getRow(row);if(!row){return}var rowEl=this._getRowEl(row,2);if(!rowEl){return}row._editing=true;this._doUpdateRowEl(row);var rowEl=this._getRowEl(row,2);mini.addClass(rowEl,"mini-grid-rowEdit");var columns=this.getVisibleColumns();for(var i=0,l=columns.length;i<l;i++){var column=columns[i];var value=row[column.field];var cellEl=this._getCellEl(row,column);if(!cellEl){continue}if(typeof column.editor=="string"){column.editor=eval("("+column.editor+")")}var editorConfig=mini.copyTo({},column.editor);editorConfig.id=this.uid+"$"+row._uid+"$"+column._id+"$editor";var editor=mini.create(editorConfig);if(this._OnCellBeginEdit(row,column,editor)){if(editor){mini.addClass(cellEl,"mini-grid-cellEdit");cellEl.innerHTML="";cellEl.appendChild(editor.el);mini.addClass(editor.el,"mini-grid-editor")}}}this.doLayout()}this._pushUpdateCallback(beginEdit,this,[row])},cancelEditRow:function(i){if(this.allowCellEdit){return}i=this.getRow(i);if(!i||!i._editing){return}delete i._editing;var p=this._getRowEl(i);var q=this.getVisibleColumns();for(var n=0,o=q.length;n<o;n++){var r=q[n];var u=this._createCellId(i,q[n]);var t=document.getElementById(u);var s=t.firstChild;var l=mini.get(s);if(!l){continue}l.destroy()}this._doUpdateRowEl(i);this.doLayout()},commitEditRow:function(c){if(this.allowCellEdit){return}c=this.getRow(c);if(!c||!c._editing){return}var d=this.getEditRowData(c,false,false);this._canUpdateRowEl=false;this.updateRow(c,d);this._canUpdateRowEl=true;this.cancelEditRow(c)},isEditing:function(){var j=this.getDataView();for(var f=0,g=j.length;f<g;f++){var i=j[f];if(i._editing==true){return true}}return false},isEditingRow:function(b){b=this.getRow(b);if(!b){return false}return !!b._editing},isNewRow:function(b){return b._state=="added"},getEditingRows:function(){var j=[];var k=this.getDataView();for(var f=0,g=k.length;f<g;f++){var i=k[f];if(i._editing==true){j.push(i)}}return j},getEditingRow:function(){var b=this.getEditingRows();return b[0]},getEditData:function(n){var k=[];var k=this.getDataView();for(var g=0,i=k.length;g<i;g++){var j=k[g];if(j._editing==true){var l=this.getEditRowData(g,n);l._index=g;k.push(l)}}return k},getEditRowData:function(E,J,w){E=this.getRow(E);if(!E||!E._editing){return null}var F=this.getIdField();var x=this.getParentField?this.getParentField():null;var D={};var K=this.getVisibleColumns();for(var o=0,y=K.length;o<y;o++){var I=K[o];var i=this._createCellId(E,K[o]);var B=document.getElementById(i);var l=null;if(I.type=="checkboxcolumn"||I.type=="radiobuttoncolumn"){var C=I.getCheckBoxEl(E,I);var z=C.checked?I.trueValue:I.falseValue;l=this._OnCellCommitEdit(E,I,z)}else{var G=B.firstChild;var H=mini.get(G);if(!H){continue}l=this._OnCellCommitEdit(E,I,null,H)}if(w!==false){mini._setMap(I.field,l.value,D);if(I.displayField){mini._setMap(I.displayField,l.text,D)}}else{D[I.field]=l.value;if(I.displayField){D[I.displayField]=l.text}}}D[F]=E[F];if(x){D[x]=E[x]}if(J){var A=mini.copyTo({},E);D=mini.copyTo(A,D)}return D},collapseGroups:function(){if(!this.isGrouping()){return}this._allowLayout=false;var g=this.getGroupingView();for(var j=0,f=g.length;j<f;j++){var i=g[j];this.collapseRowGroup(i)}this._allowLayout=true;this.doLayout()},expandGroups:function(){if(!this.isGrouping()){return}this._allowLayout=false;var g=this.getGroupingView();for(var j=0,f=g.length;j<f;j++){var i=g[j];this.expandRowGroup(i)}this._allowLayout=true;this.doLayout()},toggleRowGroup:function(b){if(b.expanded){this.collapseRowGroup(b)}else{this.expandRowGroup(b)}},collapseRowGroup:function(j){j=this.getRowGroup(j);if(!j){return}j.expanded=false;var f=this._getRowGroupEl(j,1);var k=this._getRowGroupRowsEl(j,1);var g=this._getRowGroupEl(j,2);var i=this._getRowGroupRowsEl(j,2);if(k){k.style.display="none"}if(i){i.style.display="none"}if(f){mini.addClass(f,"mini-grid-group-collapse")}if(g){mini.addClass(g,"mini-grid-group-collapse")}this.doLayout()},expandRowGroup:function(j){j=this.getRowGroup(j);if(!j){return}j.expanded=true;var f=this._getRowGroupEl(j,1);var k=this._getRowGroupRowsEl(j,1);var g=this._getRowGroupEl(j,2);var i=this._getRowGroupRowsEl(j,2);if(k){k.style.display=""}if(i){i.style.display=""}if(f){mini.removeClass(f,"mini-grid-group-collapse")}if(g){mini.removeClass(g,"mini-grid-group-collapse")}this.doLayout()},showAllRowDetail:function(){this._allowLayout=false;var j=this.getDataView();for(var f=0,g=j.length;f<g;f++){var i=j[f];this.showRowDetail(i)}this._allowLayout=true;this.doLayout()},hideAllRowDetail:function(){this._allowLayout=false;var j=this.getDataView();for(var f=0,g=j.length;f<g;f++){var i=j[f];this.hideRowDetail(i)}this._allowLayout=true;this.doLayout()},isShowRowDetail:function(b){b=this.getRow(b);if(!b){return false}return !!b._showDetail},toggleRowDetail:function(b){b=this.getRow(b);if(!b){return}if(grid.isShowRowDetail(b)){grid.hideRowDetail(b)}else{grid.showRowDetail(b)}},showRowDetail:function(j){j=this.getRow(j);if(!j||j._showDetail==true){return}j._showDetail=true;var f=this._getRowDetailEl(j,1,true);var i=this._getRowDetailEl(j,2,true);if(f){f.style.display=""}if(i){i.style.display=""}var g=this._getRowEl(j,1);var k=this._getRowEl(j,2);if(g){mini.addClass(g,"mini-grid-expandRow")}if(k){mini.addClass(k,"mini-grid-expandRow")}this.fire("showrowdetail",{record:j});this.doLayout()},hideRowDetail:function(j){j=this.getRow(j);if(!j||j._showDetail!==true){return}j._showDetail=false;var f=this._getRowDetailEl(j,1);var i=this._getRowDetailEl(j,2);if(f){f.style.display="none"}if(i){i.style.display="none"}var g=this._getRowEl(j,1);var k=this._getRowEl(j,2);if(g){mini.removeClass(g,"mini-grid-expandRow")}if(k){mini.removeClass(k,"mini-grid-expandRow")}this.fire("hiderowdetail",{record:j});this.doLayout()},_getRowDetailEl:function(j,g,k){j=this.getRow(j);if(!j){return null}var i=this._createRowDetailId(j,g);var f=document.getElementById(i);if(!f&&k===true){f=this._createRowDetail(j,g)}return f},_createRowDetail:function(o,j){var k=this.getFrozenColumns();var p=this.getUnFrozenColumns();var l=k.length;if(j==2){l=p.length}var q=this._getRowEl(o,j);if(!q){return null}var n=this._createRowDetailId(o,j);var i='<tr id="'+n+'" class="mini-grid-detailRow"><td class="mini-grid-detailCell" colspan="'+l+'"></td></tr>';jQuery(q).after(i);return document.getElementById(n)},_createRowDetailId:function(c,d){return this._id+"$detail"+d+"$"+c._id},getRowDetailCellEl:function(g,f){if(!f){f=2}var d=this._getRowDetailEl(g,f);if(d){return d.cells[0]}},autoHideRowDetail:true,setAutoHideRowDetail:function(b){this.autoHideRowDetail=b},getAutoHideRowDetail:function(){return this.autoHideRowDetail},mergeColumns:function(r){if(r&&mini.isArray(r)==false){r=[r]}var u=this;var t=u.getVisibleColumns();if(!r){r=t}var p=u.getDataView();p.push({});var n=[];for(var o=0,q=r.length;o<q;o++){var s=r[o];s=u.getColumn(s);if(!s){continue}var i=l(s);n.addRange(i)}function l(g){if(!g.field){return}var k=[];var a=-1,b=1,c=t.indexOf(g);var x=null;for(var d=0,f=p.length;d<f;d++){var j=p[d];var z=mini._getMap(g.field,j);if(a==-1||!mini.isEquals(z,x)){if(b>1){var y={rowIndex:a,columnIndex:c,rowSpan:b,colSpan:1};k.push(y)}a=d;b=1;x=z}else{b++}}return k}u.mergeCells(n)},mergeCells:function(n){if(!mini.isArray(n)){return}this._mergedCells=n;var k=this._mergedCellMaps={};function j(a,c,b,d,w){for(var f=a,v=a+b;f<v;f++){for(var t=c,u=c+d;t<u;t++){if(f==a&&t==c){k[f+":"+t]=w}else{k[f+":"+t]=true}}}}var n=this._mergedCells;if(n){for(var l=0,g=n.length;l<g;l++){var i=n[l];if(!i.rowSpan){i.rowSpan=1}if(!i.colSpan){i.colSpan=1}j(i.rowIndex,i.columnIndex,i.rowSpan,i.colSpan,i)}}this.deferUpdate()},margeCells:function(b){this.mergeCells(b)},_isCellVisible:function(g,d){if(!this._mergedCellMaps){return true}var f=this._mergedCellMaps[g+":"+d];return !(f===true)},_getAnchorCell:function(j,f){if(!this._mergedCellMaps){return null}var i=this.indexOf(j),g=this.getBottomColumns().indexOf(f);return this._mergedCellMaps[i+":"+g]},_getCellEls:function(k,q,l,r){var i=[];if(!mini.isNumber(k)){return[]}if(!mini.isNumber(q)){return[]}var w=this.getVisibleColumns();var t=this.getDataView();for(var s=k,x=k+l;s<x;s++){for(var u=q,v=q+r;u<v;u++){var j=this._getCellEl(s,u);if(j){i.push(j)}}}return i},_getDragData:function(){var c=this.getSelecteds().clone();var d=this;mini.sort(c,function(g,i){var a=d.indexOf(g);var b=d.indexOf(i);if(a>b){return 1}if(a<b){return -1}return 0},this);return c},_getDragText:function(b){return"Records "+b.length},allowDrag:false,allowDrop:false,allowLeafDropIn:false,setAllowLeafDropIn:function(b){this.allowLeafDropIn=b},getAllowLeafDropIn:function(){return this.allowLeafDropIn},setAllowDrag:function(b){this.allowDrag=b},getAllowDrag:function(){return this.allowDrag},setAllowDrop:function(b){this.allowDrop=b},getAllowDrop:function(){return this.allowDrop},isAllowDrag:function(c,d){if(this.isReadOnly()||this.enabled==false){return false}if(!this.allowDrag||!d.allowDrag){return false}if(c.allowDrag===false){return false}return true},_OnDragStart:function(d,f){var g={node:d,nodes:this._getDragData(),column:f,cancel:false};g.record=g.node;g.records=g.nodes;g.dragText=this._getDragText(g.nodes);this.fire("dragstart",g);return g},_OnGiveFeedback:function(l,g,i,j){var k={};k.from=j;k.effect=l;k.nodes=g;k.node=k.nodes[0];k.targetNode=i;k.dragNodes=g;k.dragNode=k.dragNodes[0];k.dropNode=k.targetNode;k.dragAction=k.action;this.fire("givefeedback",k);return k},_OnDragDrop:function(j,f,g){j=j.clone();var i={dragNodes:j,targetNode:f,action:g,cancel:false};i.dragNode=i.dragNodes[0];i.dropNode=i.targetNode;i.dragAction=i.action;this.fire("beforedrop",i);this.fire("dragdrop",i);return i},moveUp:function(g){if(!mini.isArray(g)){return}var j=this;g=g.sort(function(c,d){var a=j.indexOf(c);var b=j.indexOf(d);if(a>b){return 1}return -1});for(var l=0,i=g.length;l<i;l++){var k=g[l];var n=this.indexOf(k);this.moveRow(k,n-1)}},moveDown:function(g){if(!mini.isArray(g)){return}var j=this;g=g.sort(function(c,d){var a=j.indexOf(c);var b=j.indexOf(d);if(a>b){return 1}return -1});g.reverse();for(var l=0,i=g.length;l<i;l++){var k=g[l];var n=this.indexOf(k);this.moveRow(k,n+2)}},pageSize:20,pageIndex:0,totalCount:0,totalPage:0,sortField:"",sortOrder:"",url:"",setAjaxAsync:function(b){this._dataSource.ajaxAsync=b;this.ajaxAsync=b},getAjaxAsync:function(){return this._dataSource.ajaxAsync},setAjaxMethod:function(b){this._dataSource.ajaxMethod=b;this.ajaxMethod=b},getAjaxMethod:function(){return this._dataSource.ajaxMethod},setAjaxType:function(b){this._dataSource.ajaxType=b;this.ajaxType=b},getAjaxType:function(){return this._dataSource.ajaxType},setAjaxOptions:function(b){this._dataSource.setAjaxOptions(b)},getAjaxOptions:function(){return this._dataSource.getAjaxOptions()},setAutoLoad:function(b){this._dataSource.setAutoLoad(b)},getAutoLoad:function(){return this._dataSource.getAutoLoad()},setUrl:function(b){this._dataSource.setUrl(b);this.url=b},getUrl:function(){return this._dataSource.getUrl()},load:function(i,j,f,g){this._dataSource.load(i,j,f,g)},reload:function(g,d,f){this.accept();this._dataSource.reload(g,d,f)},gotoPage:function(d,c){this._dataSource.gotoPage(d,c)},sortBy:function(d,g){if(!d){return null}if(this._dataSource.sortMode=="server"){this._dataSource.sortBy(d,g)}else{var f=this._columnModel._getDataTypeByField(d);this._dataSource._doClientSortField(d,g,f)}},setCheckSelectOnLoad:function(b){this._dataSource.setCheckSelectOnLoad(b);this.checkSelectOnLoad=b},getCheckSelectOnLoad:function(){return this._dataSource.getCheckSelectOnLoad()},setSelectOnLoad:function(b){this._dataSource.setSelectOnLoad(b);this.selectOnLoad=b},getSelectOnLoad:function(){return this._dataSource.getSelectOnLoad()},setSortMode:function(b){this._dataSource.setSortMode(b);this.sortMode=b},getSortMode:function(){return this._dataSource.getSortMode()},setPageIndex:function(b){this._dataSource.setPageIndex(b);this.pageIndex=b},getPageIndex:function(){return this._dataSource.getPageIndex()},setPageSize:function(b){this._dataSource.setPageSize(b);this._virtualRows=b;this.pageSize=b},getPageSize:function(){return this._dataSource.getPageSize()},setTotalCount:function(b){this._dataSource.setTotalCount(b);this.totalCount=b},getTotalCount:function(){return this._dataSource.getTotalCount()},getTotalPage:function(){return this._dataSource.getTotalPage()},setSortField:function(b){this._dataSource.setSortField(b);this.sortField=b},getSortField:function(){return this._dataSource.sortField},setSortOrder:function(b){this._dataSource.setSortOrder(b);this.sortOrder=b},getSortOrder:function(){return this._dataSource.sortOrder},setPageIndexField:function(b){this._dataSource.pageIndexField=b;this.pageIndexField=b},getPageIndexField:function(){return this._dataSource.pageIndexField},setPageSizeField:function(b){this._dataSource.pageSizeField=b;this.pageSizeField=b},getPageSizeField:function(){return this._dataSource.pageSizeField},setStartField:function(b){this._dataSource.startField=b;this.startField=b},getStartField:function(){return this._dataSource.startField},setLimitField:function(b){this._dataSource.limitField=b;this.limitField=b},getLimitField:function(){return this._dataSource.limitField},setSortFieldField:function(b){this._dataSource.sortFieldField=b;this.sortFieldField=b},getSortFieldField:function(){return this._dataSource.sortFieldField},setSortOrderField:function(b){this._dataSource.sortOrderField=b;this.sortOrderField=b},getSortOrderField:function(){return this._dataSource.sortOrderField},setTotalField:function(b){this._dataSource.totalField=b;this.totalField=b},getTotalField:function(){return this._dataSource.totalField},setDataField:function(b){this._dataSource.dataField=b;this.dataField=b},getDataField:function(){return this._dataSource.dataField},setErrorField:function(b){this._dataSource.errorField=b;this.errorField=b},getErrorField:function(){return this._dataSource.errorField},setErrorMsgField:function(b){this._dataSource.errorMsgField=b;this.errorMsgField=b},getErrorMsgField:function(){return this._dataSource.errorMsgField},setStackTraceField:function(b){this._dataSource.stackTraceField=b;this.stackTraceField=b},getStackTraceField:function(){return this._dataSource.stackTraceField},setShowReloadButton:function(b){this._bottomPager.setShowReloadButton(b)},getShowReloadButton:function(){return this._bottomPager.getShowReloadButton()},setShowPageInfo:function(b){this._bottomPager.setShowPageInfo(b)},getShowPageInfo:function(){return this._bottomPager.getShowPageInfo()},setSizeList:function(b){if(!mini.isArray(b)){return}this._bottomPager.setSizeList(b)},getSizeList:function(){return this._bottomPager.getSizeList()},setShowPageSize:function(b){this._bottomPager.setShowPageSize(b)},getShowPageSize:function(){return this._bottomPager.getShowPageSize()},setShowPageIndex:function(b){this.showPageIndex=b;this._bottomPager.setShowPageIndex(b)},getShowPageIndex:function(){return this._bottomPager.getShowPageIndex()},setShowTotalCount:function(b){this._bottomPager.setShowTotalCount(b)},getShowTotalCount:function(){return this._bottomPager.getShowTotalCount()},setPagerStyle:function(b){this.pagerStyle=b;mini.setStyle(this._bottomPager.el,b)},setPagerCls:function(b){this.pagerCls=b;mini.addClass(this._bottomPager.el,b)},_beforeOpenContentMenu:function(g,d){var f=mini.isAncestor(this._bodyEl,d.htmlEvent.target);if(f){g.fire("BeforeOpen",d)}else{d.cancel=true}},__OnHtmlContextMenu:function(d){var f={popupEl:this.el,htmlEvent:d,cancel:false};if(mini.isAncestor(this._columnsEl,d.target)){if(this.headerContextMenu){this.headerContextMenu.fire("BeforeOpen",f);if(f.cancel==true){return}this.headerContextMenu.fire("opening",f);if(f.cancel==true){return}this.headerContextMenu.showAtPos(d.pageX,d.pageY);this.headerContextMenu.fire("Open",f)}}else{var g=mini.findParent(d.target,"mini-grid-detailRow");if(g&&mini.isAncestor(this.el,g)){return}if(this.contextMenu){this._beforeOpenContentMenu(this.contextMenu,f);if(f.cancel==true){return}this.contextMenu.fire("opening",f);if(f.cancel==true){return}this.contextMenu.showAtPos(d.pageX,d.pageY);this.contextMenu.fire("Open",f)}}return false},headerContextMenu:null,setHeaderContextMenu:function(c){var d=this._getContextMenu(c);if(!d){return}if(this.headerContextMenu!==d){this.headerContextMenu=d;this.headerContextMenu.owner=this;mini.on(this.el,"contextmenu",this.__OnHtmlContextMenu,this)}},getHeaderContextMenu:function(){return this.headerContextMenu},_get_originals:function(){return this._dataSource._originals},_set_originals:function(b){this._dataSource._originals=b},_set_clearOriginals:function(b){this._dataSource._clearOriginals=b},_set_originalIdField:function(b){this._dataSource._originalIdField=b},_set_autoCreateNewID:function(b){this._dataSource._autoCreateNewID=b},getAttrs:function(el){var attrs=mini.DataGrid.superclass.getAttrs.call(this,el);var cs=mini.getChildNodes(el);for(var i=0,l=cs.length;i<l;i++){var node=cs[i];var property=jQuery(node).attr("property");if(!property){continue}property=property.toLowerCase();if(property=="columns"){attrs.columns=mini._ParseColumns(node);mini.removeNode(node)}else{if(property=="data"){attrs.data=node.innerHTML;mini.removeNode(node)}}}mini._ParseString(el,attrs,["oncelleditenter","onselect","ondeselect","onbeforeselect","onbeforedeselect","url","sizeList","bodyCls","bodyStyle","footerCls","footerStyle","pagerCls","pagerStyle","onheadercellclick","onheadercellmousedown","onheadercellcontextmenu","onrowdblclick","onrowclick","onrowmousedown","onrowcontextmenu","onrowmouseenter","onrowmouseleave","oncellclick","oncellmousedown","oncellcontextmenu","oncelldblclick","onbeforeload","onpreload","onloaderror","onload","onupdate","ondrawcell","oncellbeginedit","onselectionchanged","ondrawgroup","onbeforeshowrowdetail","onbeforehiderowdetail","onshowrowdetail","onhiderowdetail","idField","valueField","pager","oncellcommitedit","oncellendedit","headerContextMenu","loadingMsg","emptyText","cellEditAction","sortMode","oncellvalidation","onsort","ondrawsummarycell","ondrawgroupsummarycell","onresize","oncolumnschanged","ajaxMethod","ajaxOptions","onaddrow","onupdaterow","onremoverow","onmoverow","onbeforeaddrow","onbeforeupdaterow","onbeforeremoverow","onbeforemoverow","pageIndexField","pageSizeField","sortFieldField","sortOrderField","startField","limitField","totalField","dataField","sortField","sortOrder","stackTraceField","errorField","errorMsgField","pagerButtons"]);mini._ParseBool(el,attrs,["showColumns","showFilterRow","showSummaryRow","showPager","showFooter","showHGridLines","showVGridLines","allowSortColumn","allowMoveColumn","allowResizeColumn","fitColumns","showLoading","multiSelect","allowAlternating","resultAsData","allowRowSelect","allowUnselect","onlyCheckSelection","allowHotTrackOut","enableHotTrack","showPageIndex","showPageSize","showTotalCount","checkSelectOnLoad","allowResize","autoLoad","autoHideRowDetail","allowCellSelect","allowCellEdit","allowCellWrap","allowHeaderWrap","selectOnLoad","virtualScroll","collapseGroupOnLoad","showGroupSummary","showEmptyText","allowCellValid","showModified","showColumnsMenu","showPageInfo","showReloadButton","showNewRow","editNextOnEnterKey","createOnEnter","ajaxAsync","allowDrag","allowDrop","allowLeafDropIn","editNextRowCell"]);mini._ParseInt(el,attrs,["frozenStartColumn","frozenEndColumn","pageIndex","pageSize","defaultRowHeight","defaultColumnWidth"]);if(typeof attrs.ajaxOptions=="string"){attrs.ajaxOptions=eval("("+attrs.ajaxOptions+")")}if(typeof attrs.sizeList=="string"){attrs.sizeList=eval("("+attrs.sizeList+")")}if(!attrs.idField&&attrs.valueField){attrs.idField=attrs.valueField}if(attrs.pagerButtons){attrs.pagerButtons=mini.byId(attrs.pagerButtons)}return attrs}});mini.regClass(mini.DataGrid,"datagrid");mini_DataGrid_CellValidator_Prototype={getCellErrors:function(){var k=this._cellErrors.clone();var o=this.getDataView();for(var q=0,j=k.length;q<j;q++){var i=k[q];var n=i.record;var p=i.column;if(o.indexOf(n)==-1){var l=n[this._rowIdField]+"$"+p._id;delete this._cellMapErrors[l];this._cellErrors.remove(i)}}return this._cellErrors},getCellError:function(d,f){d=this.getNode?this.getNode(d):this.getRow(d);f=this.getColumn(f);if(!d||!f){return}var g=d[this._rowIdField]+"$"+f._id;return this._cellMapErrors?this._cellMapErrors[g]:null},isValid:function(){return this.getCellErrors().length==0},isCellValid:function(f,d){if(!this._cellMapErrors){return true}var g=f[this._rowIdField]+"$"+d._id;return !this._cellMapErrors[g]},validate:function(j){j=j||this.getDataView();if(!mini.isArray(j)){j=[]}for(var f=0,g=j.length;f<g;f++){var i=j[f];this.validateRow(i)}},validateRow:function(i){var k=this.getBottomColumns();for(var f=0,g=k.length;f<g;f++){var j=k[f];this.validateCell(i,j)}},validateCell:function(i,v){i=this.getNode?this.getNode(i):this.getRow(i);v=this.getColumn(v);if(!i||!v||v.visible==false){return}var o=mini._getMap(v.field,i);var s={record:i,row:i,node:i,column:v,field:v.field,value:o,isValid:true,errorText:""};if(v.vtype){mini._ValidateVType(v.vtype,s.value,s,v)}if(s.isValid==true&&v.unique&&v.field){var r={};var u=this.data,q=v.field;for(var t=0,w=u.length;t<w;t++){var y=u[t];var l=y[q];if(mini.isNull(l)||l===""){}else{var x=r[l];if(x&&y==i){s.isValid=false;s.errorText=mini._getErrorText(v,"uniqueErrorText");this.setCellIsValid(x,v,s.isValid,s.errorText);break}r[l]=y}}}this.fire("cellvalidation",s);this.setCellIsValid(i,v,s.isValid,s.errorText)},setIsValid:function(j){if(j){var i=this._cellErrors.clone();for(var k=0,g=i.length;k<g;k++){var f=i[k];this.setCellIsValid(f.record,f.column,true)}}},_removeRowError:function(l){var o=this.getColumns();for(var p=0,j=o.length;p<j;p++){var n=o[p];var k=l[this._rowIdField]+"$"+n._id;var i=this._cellMapErrors[k];if(i){delete this._cellMapErrors[k];this._cellErrors.remove(i)}}},setCellIsValid:function(l,o,n,j){l=this.getRow(l);o=this.getColumn(o);if(!l||!o){return}var k=l[this._rowIdField]+"$"+o._id;var i=this._getCellEl(l,o);var p=this._cellMapErrors[k];delete this._cellMapErrors[k];this._cellErrors.remove(p);if(n===true){if(i&&p){mini.removeClass(i,"mini-grid-cell-error")}}else{p={record:l,column:o,isValid:n,errorText:j};this._cellMapErrors[k]=p;this._cellErrors.add(p);if(i){mini.addClass(i,"mini-grid-cell-error")}}}};mini.copyTo(mini.DataGrid.prototype,mini_DataGrid_CellValidator_Prototype);mini.TreeGrid=function(){mini.TreeGrid.superclass.constructor.call(this);mini.addClass(this.el,"mini-tree");this.setAjaxAsync(false);this.setAutoLoad(true);if(this.showTreeLines==true){mini.addClass(this.el,"mini-tree-treeLine")}this._AsyncLoader=new mini._Tree_AsyncLoader(this);this._Expander=new mini._Tree_Expander(this)};mini.copyTo(mini.TreeGrid.prototype,mini._DataTreeApplys);mini.extend(mini.TreeGrid,mini.DataGrid,{isTree:true,uiCls:"mini-treegrid",showPager:false,showNewRow:false,showCheckBox:false,showRadioButton:false,showTreeIcon:true,showExpandButtons:true,showTreeLines:false,showArrow:false,expandOnDblClick:true,expandOnNodeClick:false,loadOnExpand:true,_checkBoxType:"checkbox",iconField:"iconCls",_treeColumn:null,leafIconCls:"mini-tree-leaf",folderIconCls:"mini-tree-folder",fixedRowHeight:false,_checkBoxCls:"mini-tree-checkbox",_expandNodeCls:"mini-tree-expand",_collapseNodeCls:"mini-tree-collapse",_eciconCls:"mini-tree-node-ecicon",_inNodeCls:"mini-tree-nodeshow",indexOf:function(b){return this._dataSource.indexOfList(b)},_getDragText:function(b){return"Nodes "+b.length},_initEvents:function(){mini.TreeGrid.superclass._initEvents.call(this);this.on("nodedblclick",this.__OnNodeDblClick,this);this.on("nodeclick",this.__OnNodeClick,this);this.on("cellclick",function(b){b.node=b.record;b.isLeaf=this.isLeaf(b.node);this.fire("nodeclick",b)},this);this.on("cellmousedown",function(b){b.node=b.record;b.isLeaf=this.isLeaf(b.node);this.fire("nodemousedown",b)},this);this.on("celldblclick",function(b){b.node=b.record;b.isLeaf=this.isLeaf(b.node);this.fire("nodedblclick",b)},this);this.on("beforerowselect",function(b){b.node=b.selected;b.isLeaf=this.isLeaf(b.node);this.fire("beforenodeselect",b)},this);this.on("rowselect",function(b){b.node=b.selected;b.isLeaf=this.isLeaf(b.node);this.fire("nodeselect",b)},this)},setValue:function(i,f){if(mini.isNull(i)){i=""}i=String(i);if(this.getValue()!=i){var g=this.getCheckedNodes();this.uncheckNodes(g);this.value=i;if(this.showCheckBox){var j=String(i).split(",");this._dataSource.doCheckNodes(j,true,f!==false)}else{this.selectNode(i,false)}}},getValue:function(b){if(this.showCheckBox){if(b===false){b="leaf"}return this._dataSource.getCheckedNodesId(b)}else{return this._dataSource.getSelectedsId()}},getText:function(){var n=[];if(this.showCheckBox){n=this.getCheckedNodes()}else{var k=this.getSelectedNode();if(k){n.push(k)}}var j=[],g=this.getTextField();for(var l=0,i=n.length;l<i;l++){var k=n[l];j.push(k[g])}return j.join(",")},isGrouping:function(){return false},_createSource:function(){this._dataSource=new mini.DataTree()},_bindSource:function(){mini.TreeGrid.superclass._bindSource.call(this);var b=this._dataSource;b.on("expand",this.__OnTreeExpand,this);b.on("collapse",this.__OnTreeCollapse,this);b.on("checkchanged",this.__OnCheckChanged,this);b.on("addnode",this.__OnSourceAddNode,this);b.on("removenode",this.__OnSourceRemoveNode,this);b.on("movenode",this.__OnSourceMoveNode,this);b.on("beforeloadnode",this.__OnBeforeLoadNode,this);b.on("loadnode",this.__OnLoadNode,this)},__OnBeforeLoadNode:function(b){this.__showLoading=this.showLoading;this.showLoading=false;this.addNodeCls(b.node,"mini-tree-loading");this.fire("beforeloadnode",b)},__OnLoadNode:function(b){this.showLoading=this.__showLoading;this.removeNodeCls(b.node,"mini-tree-loading");this.fire("loadnode",b)},_virtualUpdate:function(){var b=this;if(b._updateNodeTimer){clearTimeout(b._updateNodeTimer);b._updateNodeTimer=null}b._updateNodeTimer=setTimeout(function(){b._updateNodeTimer=null;b.doUpdateRows();b.deferLayout(50)},5)},__OnSourceAddNode:function(c){var d=new Date();if(this.isVirtualScroll()==true){this._virtualUpdate()}else{this._doAddNodeEl(c.node)}this.fire("addnode",c)},__OnSourceRemoveNode:function(g){if(this.isVirtualScroll()==true){this._virtualUpdate()}else{this._doRemoveNodeEl(g.node);var f=this.getParentNode(g.node);var d=this.getChildNodes(f);if(d.length==0){this._doUpdateTreeNodeEl(f)}}this.fire("removenode",g)},__OnSourceMoveNode:function(b){this._doMoveNodeEl(b.node);this.fire("movenode",b)},_doAddNodeEl:function(p){var k=this.getFrozenColumns();var n=this.getUnFrozenColumns();var j=this.getParentNode(p);var l=this.indexOf(p);var i=false;function o(a,c,d){var b=this._createRowHTML(a,l,c,d);var f=this.indexOfNode(a)+1;var r=this.getChildNodeAt(f,j);if(r){var q=this._getNodeEl(r,d);jQuery(q).before(b)}else{var g=this._getNodesEl(j,d);if(g){mini.append(g.firstChild,b)}else{i=true}}}o.call(this,p,n,2);o.call(this,p,k,1);if(i){this._doUpdateTreeNodeEl(j)}},_doRemoveNodeEl:function(g){this._doRemoveRowEl(g);var f=this._getNodesEl(g,1);var d=this._getNodesEl(g,2);if(f){f.parentNode.removeChild(f)}if(d){d.parentNode.removeChild(d)}},_doMoveNodeEl:function(c){this._doRemoveNodeEl(c);var d=this.getParentNode(c);this._doUpdateTreeNodeEl(d)},_doUpdateNodeTitle:function(b){this._doUpdateTreeNodeEl(b,false)},_doUpdateTreeNodeEl:function(B,A){A=A!==false;var C=this.getRootNode();if(C==B){this.doUpdate();return}if(!this.isVisibleNode(B)){return}var u=B;var F=this.getFrozenColumns();var D=this.getUnFrozenColumns();var w=this._createNodeHTML(B,F,1,null,A);var y=this._createNodeHTML(B,D,2,null,A);var r=this._getNodeEl(B,1);var t=this._getNodeEl(B,2);var v=this._getNodesTr(B,1);var x=this._getNodesTr(B,2);var q=this._getRowDetailEl(B,1);var s=this._getRowDetailEl(B,2);var z=mini.createElements(w);var B=z[0];var E=z[1];if(r){mini.before(r,B);if(A){if(q){mini.after(q,E)}else{mini.before(r,E)}}mini.removeNode(r);if(A){mini.removeNode(v)}}var z=mini.createElements(y);var B=z[0];var E=z[1];if(t){mini.before(t,B);if(A){if(s){mini.after(s,E)}else{mini.before(t,E)}}mini.removeNode(t);if(A){mini.removeNode(x)}}if(B.checked!=true&&!this.isLeaf(B)){this._doCheckNodeEl(u)}},addNodeCls:function(c,d){this.addRowCls(c,d)},removeNodeCls:function(c,d){this.removeRowCls(c,d)},doUpdate:function(){mini.TreeGrid.superclass.doUpdate.apply(this,arguments)},setData:function(b){if(!b){b=[]}this._dataSource.setData(b)},loadList:function(j,f,i){f=f||this.getIdField();i=i||this.getParentField();var g=mini.listToTree(j,this.getNodesField(),f,i);this.setData(g)},_createDrawCellEvent:function(i,l,j,g){var k=mini.TreeGrid.superclass._createDrawCellEvent.call(this,i,l,j,g);k.node=k.record;k.isLeaf=this.isLeaf(k.node);if(this._treeColumn&&this._treeColumn==l.name){k.isTreeCell=true;k.img=i[this.imgField];k.iconCls=this._getNodeIcon(i);k.nodeCls="";k.nodeStyle="";k.nodeHtml="";k.showTreeIcon=this.showTreeIcon;k.checkBoxType=this._checkBoxType;k.showCheckBox=this.showCheckBox;k.showRadioButton=this.showRadioButton;if(k.showCheckBox&&!k.isLeaf){k.showCheckBox=this.showFolderCheckBox}if(k.showRadioButton&&!k.isLeaf){k.showRadioButton=this.showFolderCheckBox}k.checkable=this.getCheckable(k.node)}return k},_OnDrawCell:function(i,l,j,g){var k=mini.TreeGrid.superclass._OnDrawCell.call(this,i,l,j,g);if(this._treeColumn&&this._treeColumn==l.name){this.fire("drawnode",k);if(k.nodeStyle){k.cellStyle=k.nodeStyle}if(k.nodeCls){k.cellCls=k.nodeCls}if(k.nodeHtml){k.cellHtml=k.nodeHtml}this._createTreeColumn(k)}return k},_isViewFirstNode:function(d){if(this._viewNodes){var g=this.getParentNode(d);var f=this._getViewChildNodes(g);return f[0]===d}else{return this.isFirstNode(d)}},_isViewLastNode:function(d){if(this._viewNodes){var g=this.getParentNode(d);var f=this._getViewChildNodes(g);return f[f.length-1]===d}else{return this.isLastNode(d)}},_isInViewLastNode:function(k,i){if(this._viewNodes){var j=null;var n=this.getAncestors(k);for(var l=0,o=n.length;l<o;l++){var a=n[l];if(this.getLevel(a)==i){j=a}}if(!j||j==this.root){return false}return this._isViewLastNode(j)}else{return this.isInLastNode(k,i)}},isInLastNode:function(k,i){var j=null;var n=this.getAncestors(k);for(var l=0,o=n.length;l<o;l++){var a=n[l];if(this.getLevel(a)==i){j=a}}if(!j||j==this.root){return false}return this.isLastNode(j)},_createNodeTitle:function(A,N,x){var K=!N;if(!N){N=[]}var w=this.isLeaf(A);var O=this.getLevel(A);var M=x.nodeCls;if(!w){M=this.isExpandedNode(A)?this._expandNodeCls:this._collapseNodeCls}if(A.enabled===false){M+=" mini-disabled"}if(!w){M+=" mini-tree-parentNode"}var L=this.getChildNodes(A);var z=L&&L.length>0;N[N.length]='<div class="mini-tree-nodetitle '+M+'" style="'+x.nodeStyle+'">';var I=this.getParentNode(A);var E=0;for(var y=E;y<=O;y++){if(y==O){continue}if(w){if(y>O-1){continue}}var G="";if(this._isInViewLastNode(A,y)){G="background:none"}N[N.length]='<span class="mini-tree-indent " style="'+G+'"></span>'}var F="";if(this._isViewFirstNode(A)&&O==0){F="mini-tree-node-ecicon-first"}else{if(this._isViewLastNode(A)){F="mini-tree-node-ecicon-last"}}if(this._isViewFirstNode(A)&&this._isViewLastNode(A)){F="mini-tree-node-ecicon-last";if(I==this.root){F="mini-tree-node-ecicon-firstLast"}}if(!w){N[N.length]='<a class="'+this._eciconCls+" "+F+'" style="'+(this.showExpandButtons?"":"display:none")+'" href="javascript:void(0);" onclick="return false;" hidefocus></a>'}else{N[N.length]='<span class="'+this._eciconCls+" "+F+'" style="'+(this.showExpandButtons?"":"display:none")+'"></span>'}N[N.length]='<span class="mini-tree-nodeshow">';if(x.showTreeIcon){if(x.img){var i=this.imgPath+x.img;N[N.length]='<span class="mini-tree-icon" style="background-image:url('+i+');"></span>'}else{N[N.length]='<span class="'+x.iconCls+' mini-tree-icon"></span>'}}if(x.showRadioButton&&!x.showCheckBox){N[N.length]='<span class="mini-tree-radio" ></span>'}if(x.showCheckBox){var C=this._createCheckNodeId(A);var J=this.isCheckedNode(A);var H=x.enabled===false?"disabled":"";if(x.enabled!==false){H=x.checkable===false?"disabled":""}N[N.length]='<input type="checkbox" id="'+C+'" class="'+this._checkBoxCls+'" hidefocus '+(J?"checked":"")+" "+(H)+' onclick="return false;"/>'}N[N.length]='<span class="mini-tree-nodetext">';if(this._editingNode==A){var B=this._id+"$edit$"+A._id;var D=x.value;N[N.length]='<input id="'+B+'" type="text" class="mini-tree-editinput" value="'+D+'"/>'}else{N[N.length]=x.cellHtml}N[N.length]="</span>";N[N.length]="</span>";N[N.length]="</div>";if(K){return N.join("")}},_createTreeColumn:function(j){var k=j.record,l=j.column;j.headerCls+=" mini-tree-treecolumn";j.cellCls+=" mini-tree-treecell";j.cellStyle+=";padding:0;";var i=this.isLeaf(k);j.cellHtml=this._createNodeTitle(k,null,j);if(k.checked!=true&&!i){var g=this.getCheckState(k);if(g=="indeterminate"){this._renderCheckState(k)}}},_createCheckNodeId:function(b){return this._id+"$checkbox$"+b._id},_renderCheckState:function(c){if(!this._renderCheckStateNodes){this._renderCheckStateNodes=[]}this._renderCheckStateNodes.push(c);if(this._renderCheckStateTimer){return}var d=this;this._renderCheckStateTimer=setTimeout(function(){d._renderCheckStateTimer=null;var b=d._renderCheckStateNodes;d._renderCheckStateNodes=null;for(var a=0,f=b.length;a<f;a++){d._doCheckNodeEl(b[a])}},1)},_createNodeHTML:function(x,v,n,q,w){var r=!q;if(!q){q=[]}var z=this._dataSource;var p=z.getDataView().indexOf(x);this._createRowHTML(x,p,v,n,q);if(w!==false){var s=z.getChildNodes(x);var t=this.isVisibleNode(x);if(s&&s.length>0){var u=this.isExpandedNode(x);if(u==true){var y=(u&&t)?"":"display:none";var o=this._createNodesId(x,n);q[q.length]='<tr class="mini-tree-nodes-tr" style="';if(mini.isIE){q[q.length]=y}q[q.length]='" ><td class="mini-tree-nodes-td" colspan="';q[q.length]=v.length;q[q.length]='" >';q[q.length]='<div class="mini-tree-nodes" id="';q[q.length]=o;q[q.length]='" style="';q[q.length]=y;q[q.length]='">';this._createNodesHTML(s,v,n,q);q[q.length]="</div>";q[q.length]="</td></tr>"}}}if(r){return q.join("")}},_createNodesHTML:function(q,n,o,k){if(!q){return""}var j=!k;if(!k){k=[]}k.push('<table class="mini-grid-table" cellspacing="0" cellpadding="0" border="0">');k.push(this._createTopRowHTML(n));if(n.length>0){for(var p=0,i=q.length;p<i;p++){var l=q[p];this._createNodeHTML(l,n,o,k)}}k.push("</table>");if(j){return k.join("")}},_createRowsHTML:function(o,p){if(this.isVirtualScroll()){return mini.TreeGrid.superclass._createRowsHTML.apply(this,arguments)}var l=this._dataSource,n=this;var k=[];var q=[];var i=l.getRootNode();if(this._useEmptyView!==true){q=l.getChildNodes(i)}var j=p==2?this._rowsViewEl.firstChild:this._rowsLockEl.firstChild;j.id=this._createNodesId(i,p);this._createNodesHTML(q,o,p,k);return k.join("")},_createNodesId:function(d,f){var g=this._id+"$nodes"+f+"$"+d._id;return g},_getNodeEl:function(c,d){return this._getRowEl(c,d)},_getNodesEl:function(d,f){d=this.getNode(d);var g=this._createNodesId(d,f);return document.getElementById(g)},_getNodesTr:function(g,f){var d=this._getNodesEl(g,f);if(d){return d.parentNode.parentNode}},setTreeColumn:function(b){this._treeColumn=b;this.deferUpdate()},getTreeColumn:function(){return this._treeColumn},setShowTreeIcon:function(b){this.showTreeIcon=b;this.deferUpdate()},getShowTreeIcon:function(){return this.showTreeIcon},setShowCheckBox:function(b){this.showCheckBox=b;this.deferUpdate()},getShowCheckBox:function(){return this.showCheckBox},setShowRadioButton:function(b){this.showRadioButton=b;this.deferUpdate()},getShowRadioButton:function(){return this.showRadioButton},setCheckBoxType:function(b){this._checkBoxType=b;this._doUpdateCheckState()},getCheckBoxType:function(){return this._checkBoxType},setIconsField:function(b){this._iconsField=b},getIconsField:function(){return this._iconsField},_getNodeIcon:function(c){var d=c[this.iconField];if(!d){if(this.isLeaf(c)){d=this.leafIconCls}else{d=this.folderIconCls}}return d},_getCheckBoxEl:function(d){if(this.isVisibleNode(d)==false){return null}var c=this._id+"$checkbox$"+d._id;return mini.byId(c,this.el)},useAnimation:true,_updateNodeTimer:null,_doExpandCollapseNode:function(l){var n=this;if(n._updateNodeTimer){clearTimeout(n._updateNodeTimer);n._updateNodeTimer=null}var o=new Date();if(this.isVirtualScroll()==true){n._updateNodeTimer=setTimeout(function(){n._updateNodeTimer=null;n.doUpdateRows();n.deferLayout(50)},5);return}function p(){this._doUpdateTreeNodeEl(l);this.deferLayout(20)}if(false||mini.isIE6||!this.useAnimation){p.call(this)}else{var j=this.isExpandedNode(l);function k(q,c,r){var f=this._getNodesEl(q,c);if(f){var b=mini.getHeight(f);f.style.overflow="hidden";f.style.height="0px";var d={height:b+"px"};var a=this;a._inAniming=true;var g=jQuery(f);g.animate(d,250,function(){f.style.height="auto";a._inAniming=false;a.doLayout();mini.repaint(f)})}else{}}function i(q,c,r){var f=this._getNodesEl(q,c);if(f){var b=mini.getHeight(f);var d={height:0+"px"};var a=this;a._inAniming=true;var g=jQuery(f);g.animate(d,180,function(){f.style.height="auto";a._inAniming=false;if(r){r.call(a)}a.doLayout();mini.repaint(f)})}else{if(r){r.call(this)}}}var n=this;if(j){p.call(this);k.call(this,l,2);k.call(this,l,1)}else{i.call(this,l,2,p);i.call(this,l,1)}}},__OnTreeCollapse:function(b){this._doExpandCollapseNode(b.node)},__OnTreeExpand:function(b){this._doExpandCollapseNode(b.node)},_doCheckNodeEl:function(i){var f=this._getCheckBoxEl(i);if(f){var g=this.getCheckModel();f.checked=i.checked;f.indeterminate=false;if(g=="cascade"){var j=this.getCheckState(i);if(j=="indeterminate"){f.indeterminate=true}else{f.indeterminate=false}}}},__OnCheckChanged:function(j){for(var g=0,i=j._nodes.length;g<i;g++){var k=j._nodes[g];this._doCheckNodeEl(k)}if(this._checkChangedTimer){clearTimeout(this._checkChangedTimer);this._checkChangedTimer=null}var l=this;this._checkChangedTimer=setTimeout(function(){l._checkChangedTimer=null;l.fire("checkchanged")},1)},_tryToggleCheckNode:function(j){var g=this.getCheckable(j);if(g==false){return}var f=this.isCheckedNode(j);var i={node:j,cancel:false,checked:f,isLeaf:this.isLeaf(j)};this.fire("beforenodecheck",i);if(i.cancel){return}this._dataSource.doCheckNodes(j,!f,true);this.fire("nodecheck",i)},_tryToggleNode:function(f){var g=this.isExpandedNode(f);var d={node:f,cancel:false};if(g){this.fire("beforecollapse",d);if(d.cancel==true){return}this.collapseNode(f);d.type="collapse";this.fire("collapse",d)}else{this.fire("beforeexpand",d);if(d.cancel==true){return}this.expandNode(f);d.type="expand";this.fire("expand",d)}},_OnCellMouseDown:function(b){if(mini.findParent(b.htmlEvent.target,this._eciconCls)){}else{if(mini.findParent(b.htmlEvent.target,"mini-tree-checkbox")){}else{this.fire("cellmousedown",b)}}},_OnCellClick:function(b){if(mini.findParent(b.htmlEvent.target,this._eciconCls)){return}if(mini.findParent(b.htmlEvent.target,"mini-tree-checkbox")){this._tryToggleCheckNode(b.record)}else{this.fire("cellclick",b)}},__OnNodeDblClick:function(b){},__OnNodeClick:function(b){},setIconField:function(b){this.iconField=b},getIconField:function(){return this.iconField},setAllowSelect:function(b){this.setAllowRowSelect(b)},getAllowSelect:function(){return this.getAllowRowSelect()},setShowExpandButtons:function(b){if(this.showExpandButtons!=b){this.showExpandButtons=b;this.doUpdate()}},getShowExpandButtons:function(){return this.showExpandButtons},setShowTreeLines:function(b){this.showTreeLines=b;if(b==true){mini.addClass(this.el,"mini-tree-treeLine")}else{mini.removeClass(this.el,"mini-tree-treeLine")}},getShowTreeLines:function(){return this.showTreeLines},setShowArrow:function(b){this.showArrow=b;if(b==true){mini.addClass(this.el,"mini-tree-showArrows")}else{mini.removeClass(this.el,"mini-tree-showArrows")}},getShowArrow:function(){return this.showArrow},setLeafIcon:function(b){this.leafIcon=b},getLeafIcon:function(){return this.leafIcon},setFolderIcon:function(b){this.folderIcon=b},getFolderIcon:function(){return this.folderIcon},getExpandOnDblClick:function(){return this.expandOnDblClick},setExpandOnNodeClick:function(b){this.expandOnNodeClick=b;if(b){mini.addClass(this.el,"mini-tree-nodeclick")}else{mini.removeClass(this.el,"mini-tree-nodeclick")}},getExpandOnNodeClick:function(){return this.expandOnNodeClick},setLoadOnExpand:function(b){this.loadOnExpand=b},getLoadOnExpand:function(){return this.loadOnExpand},hideNode:function(g){g=this.getNode(g);if(!g){return}g.visible=false;this._doUpdateTreeNodeEl(g);var d=this._getNodeEl(g,1);var f=this._getNodeEl(g,2);if(d){d.style.display="none"}if(f){f.style.display="none"}},showNode:function(b){b=this.getNode(b);if(!b){return}b.visible=true;this._doUpdateTreeNodeEl(b)},enableNode:function(i){i=this.getNode(i);if(!i){return}i.enabled=true;var j=this._getNodeEl(i,1);var f=this._getNodeEl(i,2);if(j){mini.removeClass(j,"mini-disabled")}if(f){mini.removeClass(f,"mini-disabled")}var g=this._getCheckBoxEl(i);if(g){g.disabled=false}},disableNode:function(i){i=this.getNode(i);if(!i){return}i.enabled=false;var j=this._getNodeEl(i,1);var f=this._getNodeEl(i,2);if(j){mini.addClass(j,"mini-disabled")}if(f){mini.addClass(f,"mini-disabled")}var g=this._getCheckBoxEl(i);if(g){g.disabled=true}},imgPath:"",setImgPath:function(b){this.imgPath=b},getImgPath:function(){return this.imgPath},imgField:"img",setImgField:function(b){this.imgField=b},getImgField:function(){return this.imgField},getAttrs:function(q){var j=mini.TreeGrid.superclass.getAttrs.call(this,q);mini._ParseString(q,j,["value","url","idField","textField","iconField","nodesField","parentField","valueField","checkedField","leafIcon","folderIcon","leafField","ondrawnode","onbeforenodeselect","onnodeselect","onnodemousedown","onnodeclick","onnodedblclick","onbeforenodecheck","onnodecheck","onbeforeexpand","onexpand","onbeforecollapse","oncollapse","dragGroupName","dropGroupName","onendedit","expandOnLoad","ondragstart","onbeforedrop","ondrop","ongivefeedback","treeColumn","onaddnode","onremovenode","onmovenode","imgPath","imgField"]);mini._ParseBool(q,j,["allowSelect","showCheckBox","showRadioButton","showExpandButtons","showTreeIcon","showTreeLines","checkRecursive","enableHotTrack","showFolderCheckBox","resultAsTree","allowDrag","allowDrop","showArrow","expandOnDblClick","removeOnCollapse","autoCheckParent","loadOnExpand","expandOnNodeClick"]);if(j.expandOnLoad){var s=parseInt(j.expandOnLoad);if(mini.isNumber(s)){j.expandOnLoad=s}else{j.expandOnLoad=j.expandOnLoad=="true"?true:false}}var r=j.idField||this.getIdField();var o=j.textField||this.getTextField();var p=j.iconField||this.getIconField();var k=j.nodesField||this.getNodesField();function l(i){var a=[];for(var H=0,b=i.length;H<b;H++){var d=i[H];var G=mini.getChildNodes(d);var F=G[0];var A=G[1];if(!F||!A){F=d}var C=jQuery(F);var f={};var g=f[r]=F.getAttribute("value");f[p]=C.attr("iconCls");f[o]=F.innerHTML;a.add(f);var D=C.attr("expanded");if(D){f.expanded=D=="false"?false:true}var c=C.attr("allowSelect");if(c){f.allowSelect=c=="false"?false:true}if(!A){continue}var E=mini.getChildNodes(A);var B=l(E);if(B.length>0){f[k]=B}}return a}var n=l(mini.getChildNodes(q));if(n.length>0){j.data=n}if(!j.idField&&j.valueField){j.idField=j.valueField}return j}});mini.regClass(mini.TreeGrid,"TreeGrid");mini.Tree=function(){mini.Tree.superclass.constructor.call(this);var b=[{name:"node",header:"",field:this.getTextField(),width:"auto",allowDrag:true,editor:{type:"textbox"}}];this._columnModel.setColumns(b);this._column=this._columnModel.getColumn("node");mini.removeClass(this.el,"mini-treegrid");mini.addClass(this.el,"mini-tree-nowrap");this.setBorderStyle("border:0")};mini.extend(mini.Tree,mini.TreeGrid,{setTextField:function(b){this._dataSource.setTextField(b);this._columnModel.updateColumn("node",{field:b});this.textField=b},uiCls:"mini-tree",_rowHoverCls:"mini-tree-node-hover",_rowSelectedCls:"mini-tree-selectedNode",_getRecordByEvent:function(f,g){var d=mini.Tree.superclass._getRecordByEvent.call(this,f);if(g===false){return d}if(d&&mini.findParent(f.target,"mini-tree-nodeshow")){return d}return null},_treeColumn:"node",defaultRowHeight:22,_getRowHeight:function(d){var c=this.defaultRowHeight;if(d._height){c=parseInt(d._height);if(isNaN(parseInt(d._height))){c=rowHeight}}return c},showHeader:false,showTopbar:false,showFooter:false,showColumns:false,showHGridLines:false,showVGridLines:false,showTreeLines:true,setTreeColumn:null,setColumns:null,getColumns:null,frozen:null,unFrozen:null,showModified:false,setNodeText:function(f,g){f=this.getNode(f);if(!f){return}var d={};d[this.getTextField()]=g;this.updateNode(f,d)},setNodeIconCls:function(d,f){d=this.getNode(d);if(!d){return}var g={};g[this.iconField]=f;this.updateNode(d,g)},_OnCellMouseDown:function(b){if(this._editInput){this._editInput.blur()}this.fire("cellmousedown",b)},isEditingNode:function(b){return this._editingNode==b},beginEdit:function(o){o=this.getNode(o);if(!o){return}var j=this.getColumn(0);var n=mini._getMap(j.field,o);var l={record:o,node:o,column:j,field:j.field,value:n,cancel:false};this.fire("cellbeginedit",l);if(l.cancel==true){return}this._editingNode=o;this._doUpdateNodeTitle(o);var i=this;function k(){var a=i._id+"$edit$"+o._id;i._editInput=document.getElementById(a);i._editInput.focus();mini.selectRange(i._editInput,0,1000);mini.on(i._editInput,"keydown",i.__OnEditInputKeyDown,i);mini.on(i._editInput,"blur",i.__OnEditInputBlur,i)}setTimeout(function(){k()},100);k()},cancelEdit:function(c){var d=this._editingNode;this._editingNode=null;if(d){if(c!==false){this._doUpdateNodeTitle(d)}mini.un(this._editInput,"keydown",this.__OnEditInputKeyDown,this);mini.un(this._editInput,"blur",this.__OnEditInputBlur,this)}this._editInput=null},__OnEditInputKeyDown:function(d){if(d.keyCode==13){var f=this._editingNode;var g=this._editInput.value;this._editingNode=null;this.setNodeText(f,g);this.cancelEdit(false);this.fire("endedit",{node:f,text:g})}else{if(d.keyCode==27){this.cancelEdit()}}},__OnEditInputBlur:function(d){var f=this._editingNode;if(f){var g=this._editInput.value;this.cancelEdit();this.setNodeText(f,g);this.fire("endedit",{node:f,text:g})}},addRowCls:function(i,g){var j=this._getRowEl(i,1);var f=this._getRowEl(i,2);if(j){mini.addClass(j.firstChild,g)}if(f){mini.addClass(f.firstChild,g)}},removeRowCls:function(i,g){var j=this._getRowEl(i,1);var f=this._getRowEl(i,2);if(j){mini.removeClass(j,g);mini.removeClass(j.firstChild,g)}if(f){mini.removeClass(f,g);mini.removeClass(f.firstChild,g)}},scrollIntoView:function(c){c=this.getNode(c);if(!c){return}if(!this.isVisibleNode(c)){this.expandPath(c)}var d=this;setTimeout(function(){var a=d._getNodeEl(c,2);mini.scrollIntoView(a,d._rowsViewEl,false)},10)}});mini.regClass(mini.Tree,"Tree");mini._Tree_Expander=function(b){this.owner=b;mini.on(b.el,"click",this.__OnClick,this);mini.on(b.el,"dblclick",this.__OnDblClick,this)};mini._Tree_Expander.prototype={_canToggle:function(){return !this.owner._dataSource._isNodeLoading()},__OnClick:function(i){var g=this.owner;var j=g._getRecordByEvent(i,false);if(!j||j.enabled===false){return}if(mini.findParent(i.target,"mini-tree-checkbox")){return}var f=g.isLeaf(j);if(mini.findParent(i.target,g._eciconCls)){if(this._canToggle()==false){return}g._tryToggleNode(j)}else{if(g.expandOnNodeClick&&!f&&!g._inAniming){if(this._canToggle()==false){return}g._tryToggleNode(j)}}},__OnDblClick:function(i){var g=this.owner;var j=g._getRecordByEvent(i,false);if(!j||j.enabled===false){return}var f=g.isLeaf(j);if(g._inAniming){return}if(mini.findParent(i.target,g._eciconCls)){return}if(g.expandOnNodeClick){return}if(g.expandOnDblClick&&!f){if(this._canToggle()==false){return}i.preventDefault();g._tryToggleNode(j)}}};mini._Tree_AsyncLoader=function(b){this.owner=b;b.on("beforeexpand",this.__OnBeforeNodeExpand,this)};mini._Tree_AsyncLoader.prototype={__OnBeforeNodeExpand:function(j){var i=this.owner;var k=j.node;var g=i.isLeaf(k);var l=k[i.getNodesField()];if(!g&&(!l||l.length==0)){if(i.loadOnExpand&&k.asyncLoad!==false){j.cancel=true;i.loadNode(k)}}}};mini.Richtext=function(){mini.Richtext.superclass.constructor.call(this)};mini.extend(mini.Richtext,mini.Control,{width:"100%",height:300,uiCls:"mini-richtext",_create:function(){this.el=document.createElement("div");this.el.innerHTML='<textarea style="display:none"></textarea>';this._fromEditor=this.el.firstChild;this._editor=new mini.TextArea();this._editor.setVisible(false);this._editor.render(this.el);var b=this;mini.loadRes("ckeditor",function(){b._initEditor()})},render:function(b){mini.Richtext.superclass.constructor.call(this,b)},_initEditor:function(){var b=this;setTimeout(function(){b._doInitEditor()},1)},_doInitEditor:function(){if(this.isRender()==false){return}if(this.editor){return}var b=this;this._editor.set({name:b.name,id:b.id+"_editor"});this._fromEditor.id=this.id+"_fromEditor";this.editor=CKEDITOR.replace(b._fromEditor.id,{width:b.width.replace("px",""),height:b.height.replace("px","")-100,readOnly:b.readOnly});this.editor.isReady=false;this.editor.on("instanceReady",function(a){a.editor.resize(a.editor.config.width,b.height.replace("px",""));a.editor.isReady=true;b.setValue(b.value);b.fire("initeditor")});this.editor.on("resize",function(d){var a=d.editor.container.$.clientHeight;mini.Richtext.superclass.setHeight.call(b,a)})},setValue:function(b){if(this.editor&&this.editor.isReady){this.editor.setData(b);this._editor.setValue(b)}else{this.value=b}},getValue:function(){if(this.editor){return this.editor.getData()}return this.value},setSubmitData:function(){if(this._editor){this._editor.setValue(this.getValue())}},getSubmitData:function(){if(this._editor){return this._editor.getValue()}return this.getValue()},setWidth:function(b){mini.Richtext.superclass.setWidth.call(this,b);if(this.editor){this.editor.resize(b,this.getHeight())}},setHeight:function(b){mini.Richtext.superclass.setHeight.call(this,b);if(this.editor){this.editor.resize(this.getWidth(),b)}},setReadOnly:function(b){if(this.editor){this.editor.setReadOnly(b);this.readOnly=b}else{this.readOnly=b}},getReadOnly:function(){if(this.editor){return this.editor.readOnly}return this.readOnly}});mini.regClass(mini.Richtext,"richtext");(function(){mini.DictCheckboxGroup=function(){mini.DictCheckboxGroup.superclass.constructor.call(this)};mini.DictRadioGroup=function(){mini.DictRadioGroup.superclass.constructor.call(this)};mini.DictComboBox=function(){mini.DictComboBox.superclass.constructor.call(this)};var d={map:{},loadingMap:{},removeEmpty:function(a){for(var b=0,f=a.length;b<f;b++){if(a[b]&&a[b].__NullItem){a.splice(b,1)}}},getDictName:function(i,k){var j=[];for(var b=0,l=i.length;b<l;b++){var a=i[b];if(nui.fn.contains(k,a.dictID)){j.push(a.dictName)}}return j.join(",")},ajaxLoad:function(a){var b={dictTypeId:a.dictTypeId};mini.ajax({url:"com.primeton.components.nui.DictLoader.getDictData.biz.ext",data:b,type:"POST",async:false,success:function(g){var i=g.dictList;d.map[dictTypeId]=i;a._setDictData(i)}})},getDictText:function(i,b){var g=d.map[i];if(g){return d.getDictName(g,b)}var a="";mini.ajax({url:"com.primeton.components.nui.DictLoader.getDictData.biz.ext",data:{dictTypeId:i},type:"POST",async:false,success:function(f){var j=f.dictList;d.map[i]=j;a=d.getDictName(j,b)}});return a},loadData:function(){var b=this.dictTypeId;if(!b){return}var a=d.map[b];if(!a){mini.ajax({url:"com.primeton.components.nui.DictLoader.getDictData.biz.ext",data:{dictTypeId:b},type:"POST",async:false,success:function(g){var i=g.dictList;d.map[b]=i}});a=d.map[b]}d.removeEmpty(a);this._setDictData(a)}};mini.getDictText=d.getDictText;var c={dictTypeId:"",textField:"dictName",valueField:"dictID",_initData:function(){d.loadData.call(this)},_setDictData:function(a){this.loadData(a);if(this.value){this.setValue(this.value)}}};c.uiCls="mini-dictcheckboxgroup";jQuery.extend(c,{uiCls:"mini-dictcheckboxgroup",set:function(a){mini.DictCheckboxGroup.superclass.set.call(this,a);this._initData()},getAttrs:function(b){var f=mini.DictCheckboxGroup.superclass.getAttrs.call(this,b);var a=jQuery(b);mini._ParseString(b,f,["dictTypeId"]);return f}});mini.extend(mini.DictCheckboxGroup,mini.CheckBoxList,c);jQuery.extend(c,{uiCls:"mini-dictradiogroup",set:function(a){mini.DictRadioGroup.superclass.set.call(this,a);this._initData()},getAttrs:function(b){var f=mini.DictRadioGroup.superclass.getAttrs.call(this,b);var a=jQuery(b);mini._ParseString(b,f,["dictTypeId"]);return f}});mini.extend(mini.DictRadioGroup,mini.RadioButtonList,c);jQuery.extend(c,{uiCls:"mini-dictcombobox",_afterApply:function(a){mini.DictComboBox.superclass._afterApply.call(this,a);this._initData()},getAttrs:function(b){var f=mini.DictComboBox.superclass.getAttrs.call(this,b);var a=jQuery(b);mini._ParseString(b,f,["dictTypeId"]);return f},_setDictData:function(a){this.setValueField(this.valueField);this.setTextField(this.textField);this.setData(a);if(this.value){var b=this.value;this.value="";this.setValue(b)}}});mini.extend(mini.DictComboBox,mini.ComboBox,c);mini.regClass(mini.DictCheckboxGroup,"dictcheckboxgroup");mini.regClass(mini.DictRadioGroup,"dictradiogroup");mini.regClass(mini.DictComboBox,"dictcombobox")})(mini);(function(b){b.ajax=function(g){var a=g.url;if(a&&a.length>4&&a.lastIndexOf(".ext")==a.length-4){if(!g.dataType){g.dataType="json"}if(!g.contentType){g.contentType="application/json; charset=UTF-8"}if(g.data&&mini.isNull(g.data.pageIndex)==false){var f=g.data.page={};f.begin=g.data.pageIndex*g.data.pageSize;f.length=g.data.pageSize}if(g.dataType=="json"&&typeof(g.data)=="object"){g.data=mini.encode(g.data);if(g.data=="{}"){delete g.data}g.type="POST"}}return window.jQuery.ajax(g)}})(mini);(function(g){g.getClassByUICls=function(a){a=a.toLowerCase();var b=this.uiClasses[a];if(!b){a=a.replace("nui-","mini-");b=this.uiClasses[a]}return b};g.DatePicker.prototype.valueFormat="yyyy-MM-dd HH:mm:ss";g.ajax=function(b){var c=b.url;if(c&&c.length>4&&c.lastIndexOf(".ext")==c.length-4){if(!b.dataType){b.dataType="json"}if(!b.contentType){b.contentType="application/json; charset=UTF-8"}if(b.data&&mini.isNull(b.data.pageIndex)==false){var a=b.data.page={};a.begin=b.data.pageIndex*b.data.pageSize;a.length=b.data.pageSize}if(b.dataType=="json"&&typeof(b.data)=="object"){b.data=mini.encode(b.data);if(b.data=="{}"){delete b.data}b.type="POST"}}return window.jQuery.ajax(b)};g.fn={contains:function(b,a){return(","+b+",").indexOf(","+a+",")!=-1},endWidth:function(b,a){if(b.length<a.length){return false}return b.substr(b.length-a.length)===a},startWidth:function(b,a){return b.substr(0,a.length)===a}};var d=jQuery;var f={map:{},loaded:{},timeSeed:true,path:"",isAbsolutePath:function(a){return g.fn.startWidth(a,"http")||g.fn.startWidth(a,"/")},getJSPath:function(b){var k=document.scripts;for(var c=0,l=k.length;c<l;c++){var a=k[c].src;a=a.split("?")[0];var i=g.fn.endWidth(a,b);if(i){return a.substr(0,a.lastIndexOf("/"))+"/"}}return""},hasLoaded:function(a){return this.loaded[a]},getLoadInfo:function(a){return this.loaded[a]},loadCSS:function(b){if(!d.isArray(b)){b=[b]}for(var a=0,c=b.length;a<c;a++){this.loadCSS(b[a])}},loadJS:function(a,l,n){if(!d.isArray(a)){a=[a]}var o=a.length;var b=0;if(n){var c=function(j,k){f._loadJS(a[j],function(){j++;if(j<o){c(j,k)}else{k()}})};c(0,l)}else{for(var i=0;i<o;i++){f._loadJS(a[i],function(){b++;if(b==o){l()}})}}},_loadCSS:function(b,a){if(this.getLoadInfo(b)){return}a=a||document;var c=a.createElement("link");c.type="text/css";if(NUI.timeSeed){c.href=b+"?"+(new Date())}else{c.href=b}c.rel="stylesheet";a.getElementsByTagName("head")[0].appendChild(c);this.loaded[b]=true;return c},_loadJS:function(a,j,b){j=j||function(){};if(!f.isAbsolutePath(a)){a=f.path+a}var i=this.getLoadInfo(a);if(i){switch(i.status){case"loading":i.handler.push(j);break;case"loaded":j();break}return}else{this.loaded[a]={status:"loading",handler:[j]}}b=b||document;var c=b.createElement("script");c.type="text/javascript";if(this.timeSeed){c.src=a+"?"+(new Date())}else{c.src=a}c.onreadystatechange=c.onload=function(){if(!this.readyState||(this.readyState=="complete"||this.readyState=="loaded")){f.loaded[a]=f.loaded[a]||{};f.loaded[a].status="loaded";var p=f.loaded[a].handler;for(var o=0,q=p.length;o<q;o++){var n=p[o];if(n&&typeof(n)=="function"){n()}}}};b.getElementsByTagName("head")[0].appendChild(c);return c}};f.path=f.getJSPath("nui.js");g.res={hasLoaded:function(a){return f.loaded[a]},add:function(b,a){a=a||{};a.js=a.js||[];a.css=a.css||[];a.order=a.order||false;f.map[b]=a},remove:function(a){delete f.map[a]},get:function(a){return f.map[a]},load:function(a,c){var b=this.get(a);if(!b){c();return}f.loadCSS(b.css);f.loadJS(b.js,c,b.order)}};g.loadRes=function(a,b){g.res.load(a,b)};g.res.add("ckeditor",{js:["resource/ckeditor/ckeditor.js"]});g.res.add("swfupload",{});window.nui=g})(mini);mini.MenuBarX=function(){mini.MenuBarX.superclass.constructor.call(this)};mini.extend(mini.MenuBarX,mini.MenuBar,{uiCls:"mini-menubarx",_itemType:"menuitemx"});mini.regClass(mini.MenuBarX,"menubarx");mini.MenuItemX=function(){mini.MenuItemX.superclass.constructor.call(this)};mini.extend(mini.MenuItemX,mini.MenuItem,{setMenu:function(c){if(mini.isArray(c)){c={type:"menu",items:c}}if(this.menu!==c){var d=mini._getTopMINI();this.menu=d.getAndCreate(c);this.menu.hide();this.menu.ownerItem=this;this.doUpdate();this.menu.on("itemschanged",this.__OnItemsChanged,this);this.menu.window=d.window}},showMenu:function(){if(this.menu&&this.menu.isDisplay()==false){this.menu.setHideAction("outerclick");var b={xAlign:"outright",yAlign:"top",outXAlign:"outleft",popupCls:"mini-menu-popup"};if(this.ownerMenu&&this.ownerMenu.vertical==false){b.xAlign="left";b.yAlign="below";b.outXAlign=null}b.window=window;b.topWindow=this.menu.window;this.menu.showAtEl(this.el,b)}}});mini.regClass(mini.MenuItemX,"menuitemx");mini.Menu.prototype._getWindowOffset=function(d){var g=d.window,f=d.topWindow;if(g&&f&&g!=f){return mini._getWindowOffset(g,f)}else{return[0,0]}};mini._getTopMINI=function(){var c=[];function d(a){try{a.___try=1;if(!a.mini){return}c.push(a)}catch(b){}if(a.parent&&a.parent!=a){d(a.parent)}}d(window);return c[c.length-1].mini};mini._getWindowOffset=function(q,u){var r=[];function w(a){var b=a.parent;var d=b.document.getElementsByTagName("iframe");for(var f=0,g=d.length;f<g;f++){var c=d[f];if(c.contentWindow==a){r.add(c);break}}if(b!=u){w(b)}}w(q);r.reverse();var i=0,l=0;var p=u.mini;for(var t=0,v=r.length;t<v;t++){var x=r[t];var s=p.getBox(x);i+=s.x;l+=s.y;var o=p.getBorders(x);i+=o.left;l+=o.top;p=x.contentWindow.mini}return[i,l]};var __TopMINI=mini._getTopMINI();mini.DatePickerX=function(){mini.DatePickerX.superclass.constructor.call(this)};mini.extend(mini.DatePickerX,mini.DatePicker,{uiCls:"mini-datepickerx",destroy:function(c){if(this._calendar){this._calendar.destroy();this._calendar=null}var d=__TopMINI;d.DatePicker._Calendar=null;mini.DatePickerX.superclass.destroy.call(this,c)},_createPopup:function(){var b=__TopMINI;this.popup=new b.Popup();this.popup.setShowAction("none");this.popup.setHideAction("outerclick");this.popup.setPopupEl(this.el);this.popup.on("BeforeClose",this.__OnPopupBeforeClose,this);b.on(this.popup.el,"keydown",this.__OnPopupKeyDown,this);this._calendar=this._getCalendar()},_getCalendar:function(){var d=__TopMINI;if(!d.DatePicker._Calendar){var c=d.DatePicker._Calendar=new d.Calendar();c.setStyle("border:0;")}return d.DatePicker._Calendar},_doShowAtEl:function(g,d){var f=this.getPopup();f._getWindowOffset=mini.Menu.prototype._getWindowOffset;d.window=window;d.topWindow=__TopMINI.window;f.showAtEl(g,d)}});mini.regClass(mini.DatePickerX,"DatePickerX");nui.Tabs.prototype._doUpdateBottom=function(){var k=this.tabPosition=="bottom";var F="";if(k){F+='<div class="mini-tabs-scrollCt">';F+='<div class="mini-tabs-nav"><a class="mini-tabs-leftButton" href="javascript:void(0)" hideFocus onclick="return false"></a><a class="mini-tabs-rightButton" href="javascript:void(0)" hideFocus onclick="return false"></a></div>';F+='<div class="mini-tabs-buttons"></div>'}F+='<div class="mini-tabs-headers">';var G=this.getTabRows();for(var x=0,z=G.length;x<z;x++){var j=G[x];var H="";F+='<table class="mini-tabs-header" cellspacing="0" cellpadding="0"><tr><td class="mini-tabs-space mini-tabs-firstSpace"><div></div></td>';for(var s=0,A=j.length;s<A;s++){var C=j[s];var D=this._createTabId(C);if(!C.visible){continue}var l=this.tabs.indexOf(C);var H=C.headerCls||"";if(C.enabled==false){H+=" mini-disabled"}F+='<td id="'+D+'" index="'+l+'"  class="mini-tab '+H+'" style="'+C.headerStyle+'">';if(C.iconCls||C.iconStyle){F+='<span class="mini-tab-icon '+C.iconCls+'" style="'+C.iconStyle+'"></span>'}F+='<span class="mini-tab-text">'+C.title+"</span>";if(C.showCloseButton){var E="";if(C.enabled){E="onmouseover=\"mini.addClass(this, 'mini-tab-close-hover')\" onmouseout=\"mini.removeClass(this, 'mini-tab-close-hover')\""}F+='<span class="mini-tab-close" '+E+"></span>"}F+="</td>";if(s!=A-1){F+='<td class="mini-tabs-space2"><div></div></td>'}}F+='<td class="mini-tabs-space mini-tabs-lastSpace" ><div></div></td></tr></table>'}if(k){F+="</div>"}F+="</div>";this._doClearElement();mini.append(this._td2El,F);var B=this._td2El;this._headerEl=B.lastChild.lastChild;if(k){this._navEl=this._headerEl.parentNode.firstChild;this._leftButtonEl=this._navEl.firstChild;this._rightButtonEl=this._navEl.childNodes[1]}switch(this.tabAlign){case"center":var i=this._headerEl.childNodes;for(var s=0,A=i.length;s<A;s++){var y=i[s];var w=y.getElementsByTagName("td");w[0].style.width="50%";w[w.length-1].style.width="50%"}break;case"right":var i=this._headerEl.childNodes;for(var s=0,A=i.length;s<A;s++){var y=i[s];var w=y.getElementsByTagName("td");w[0].style.width="100%"}break;case"fit":break;default:var i=this._headerEl.childNodes;for(var s=0,A=i.length;s<A;s++){var y=i[s];var w=y.getElementsByTagName("td");w[w.length-1].style.width="100%"}break}};nui.Tabs.prototype.doLayout=function(){if(!this.canLayout()){return}this._handleIFrameOverflow();var V=this.isAutoHeight();O=this.getHeight(true);Y=this.getWidth();var X=O;var M=Y;if(this.showBody){this._bodyEl.style.display=""}else{this._bodyEl.style.display="none"}if(this.plain){mini.addClass(this.el,"mini-tabs-plain")}else{mini.removeClass(this.el,"mini-tabs-plain")}if(!V&&this.showBody){var i=jQuery(this._headerEl).outerHeight();var ae=jQuery(this._headerEl).outerWidth();if(this.tabPosition=="top"||this.tabPosition=="bottom"){i=jQuery(this._headerEl.parentNode).outerHeight()}if(this.tabPosition=="left"||this.tabPosition=="right"){Y=Y-ae}else{O=O-i}if(jQuery.boxModel){var U=mini.getPaddings(this._bodyEl);var w=mini.getBorders(this._bodyEl);O=O-U.top-U.bottom-w.top-w.bottom;Y=Y-U.left-U.right-w.left-w.right}margin=mini.getMargins(this._bodyEl);O=O-margin.top-margin.bottom;Y=Y-margin.left-margin.right;if(O<0){O=0}if(Y<0){Y=0}this._bodyEl.style.width=Y+"px";this._bodyEl.style.height=O+"px";if(this.tabPosition=="left"||this.tabPosition=="right"){var ai=this._headerEl.getElementsByTagName("tr")[0];var T=ai.childNodes;var W=T[0].getElementsByTagName("tr");var ad=last=all=0;for(var R=0,l=W.length;R<l;R++){var ai=W[R];var Z=jQuery(ai).outerHeight();all+=Z;if(R==0){ad=Z}if(R==l-1){last=Z}}switch(this.tabAlign){case"center":var S=parseInt((X-(all-ad-last))/2);for(var R=0,l=T.length;R<l;R++){T[R].firstChild.style.height=X+"px";var ab=T[R].firstChild;var W=ab.getElementsByTagName("tr");var I=W[0],K=W[W.length-1];I.style.height=S+"px";K.style.height=S+"px"}break;case"right":for(var R=0,l=T.length;R<l;R++){var ab=T[R].firstChild;var W=ab.getElementsByTagName("tr");var ai=W[0];var Q=X-(all-ad);if(Q>=0){ai.style.height=Q+"px"}}break;case"fit":for(var R=0,l=T.length;R<l;R++){T[R].firstChild.style.height=X+"px"}break;default:for(var R=0,l=T.length;R<l;R++){var ab=T[R].firstChild;var W=ab.getElementsByTagName("tr");var ai=W[W.length-1];var Q=X-(all-last);if(Q>=0){ai.style.height=Q+"px"}}break}}}else{this._bodyEl.style.width="auto";this._bodyEl.style.height="auto"}var af=this.getTabBodyEl(this.activeIndex);if(af){if(!V&&this.showBody){var O=mini.getHeight(this._bodyEl,true);if(jQuery.boxModel){var U=mini.getPaddings(af);var w=mini.getBorders(af);O=O-U.top-U.bottom-w.top-w.bottom}af.style.height=O+"px"}else{af.style.height="auto"}}switch(this.tabPosition){case"bottom":var ah=this._headerEl.childNodes;for(var R=0,l=ah.length;R<l;R++){var ab=ah[R];mini.removeClass(ab,"mini-tabs-header2");if(l>1&&R!=0){mini.addClass(ab,"mini-tabs-header2")}}break;case"left":var T=this._headerEl.firstChild.rows[0].cells;for(var R=0,l=T.length;R<l;R++){var ac=T[R];mini.removeClass(ac,"mini-tabs-header2");if(l>1&&R==0){mini.addClass(ac,"mini-tabs-header2")}}break;case"right":var T=this._headerEl.firstChild.rows[0].cells;for(var R=0,l=T.length;R<l;R++){var ac=T[R];mini.removeClass(ac,"mini-tabs-header2");if(l>1&&R!=0){mini.addClass(ac,"mini-tabs-header2")}}break;default:var ah=this._headerEl.childNodes;for(var R=0,l=ah.length;R<l;R++){var ab=ah[R];mini.removeClass(ab,"mini-tabs-header2");if(l>1&&R==0){mini.addClass(ab,"mini-tabs-header2")}}break}mini.removeClass(this.el,"mini-tabs-scroll");var ac=mini.byClass("mini-tabs-lastSpace",this.el);var P=mini.byClass("mini-tabs-buttons",this.el);var ag=this._headerEl.parentNode;ag.style.paddingRight="0px";if(this._navEl){this._navEl.style.display="none"}if(P){P.style.display="none"}mini.setWidth(ag,M);if((this.tabPosition=="top"||this.tabPosition=="bottom")&&this.tabAlign=="left"){this._headerEl.style.width="auto";P.style.display="block";var J=M;var aa=this._headerEl.firstChild.offsetWidth-ac.offsetWidth;var L=P.firstChild?P.offsetWidth:0;if(aa+L>J){this._navEl.style.display="block";this._navEl.style.right=L+"px";var N=this._navEl.offsetWidth;var Y=J-L-N;mini.setWidth(this._headerEl,Y)}}this._scrollToTab(this.activeIndex);this._doScrollButton();mini.layout(this._bodyEl);this.fire("layout")};nui.Tabs.prototype._doScrollButton=function(){if(this.tabPosition=="top"||this.tabPosition=="bottom"){mini.removeClass(this._leftButtonEl,"mini-disabled");mini.removeClass(this._rightButtonEl,"mini-disabled");if(this._headerEl.scrollLeft==0){mini.addClass(this._leftButtonEl,"mini-disabled")}var g=this.getTabEl(this.tabs.length-1);if(g){var f=mini.getBox(g);var d=mini.getBox(this._headerEl);if(f.right<=d.right){mini.addClass(this._rightButtonEl,"mini-disabled")}}}};nui.Tabs.prototype._scrollToTab=function(g){var j=this._headerEl.scrollLeft;if(this.tabPosition=="top"||this.tabPosition=="bottom"){this._headerEl.scrollLeft=j;var k=this.getTabEl(g);if(k){var l=this;var i=mini.getBox(k);var n=mini.getBox(l._headerEl);if(i.x<n.x){l._headerEl.scrollLeft-=(n.x-i.x)}else{if(i.right>n.right){l._headerEl.scrollLeft+=(i.right-n.right)}}}}};nui.Tabs.prototype.__OnMouseDown=function(i){clearInterval(this._scrollTimer);if(this.tabPosition=="top"||this.tabPosition=="bottom"){var j=this;var f=0,g=10;if(i.target==this._leftButtonEl){this._scrollTimer=setInterval(function(){j._headerEl.scrollLeft-=g;f++;if(f>5){g=18}if(f>10){g=25}j._doScrollButton()},25)}else{if(i.target==this._rightButtonEl){this._scrollTimer=setInterval(function(){j._headerEl.scrollLeft+=g;f++;if(f>5){g=18}if(f>10){g=25}j._doScrollButton()},25)}}mini.on(document,"mouseup",this.__OnDocMouseUp,this)}};